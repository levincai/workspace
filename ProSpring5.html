<!--if IE]><![endif]-->
<!DOCTYPE html>
<!--if IE 8]><html class="no-js ie8 oldie" lang="en" prefix="og: http://ogp.me/ns/# og:book: http://ogp.me/ns/book# og:video: http://ogp.me/ns/video#"            itemscope itemtype="http://schema.org/Book http://schema.org/ItemPage" data-login-url="/accounts/login/"data-offline-url="/"data-url="/library/view/pro-spring-5/9781484228081/A315511_5_En_1_Chapter.html"data-csrf-cookie="csrfsafari"data-highlight-privacy=""  data-user-id="3866890"  data-user-uuid="72b95c3c-5b13-4319-82fa-5c73754754ca"  data-username="levinxccai"  data-account-type="B2B"    data-activated-trial-date="11/06/2017"  data-archive="9781484228081"  data-publishers="Apress"  data-htmlfile-name="A315511_5_En_1_Chapter.html"  data-epub-title="Pro Spring 5: An In-Depth Guide to the Spring Framework and Its Tools" data-debug=0 data-testing=0><![endif]-->
<!--if gt IE 8]><!-->
<html class="js flexbox flexboxlegacy no-touch websqldatabase indexeddb history csscolumns csstransforms localstorage sessionstorage applicationcache svg inlinesvg zoom fa-events-icons-ready" data-account-type="B2B" data-activated-trial-date="11/06/2017" data-archive="9781484228081" data-csrf-cookie="csrfsafari" data-debug="0" data-epub-title="Pro Spring 5: An In-Depth Guide to the Spring Framework and Its Tools" data-highlight-privacy="" data-htmlfile-name="A315511_5_En_1_Chapter.html" data-login-url="/accounts/login/" data-offline-url="/" data-publishers="Apress" data-testing="0" data-url="/library/view/pro-spring-5/9781484228081/A315511_5_En_1_Chapter.html" data-user-id="3866890" data-user-uuid="72b95c3c-5b13-4319-82fa-5c73754754ca" data-username="levinxccai" itemscope="" itemtype="http://schema.org/Book http://schema.org/ItemPage" lang="en" prefix="og: http://ogp.me/ns/# og:book: http://ogp.me/ns/book# og:video: http://ogp.me/ns/video#" style="">
<!--![endif]-->

<head>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <link href="cid:css-0faaf77f-53c7-4081-8dd7-708f696230af@mhtml.blink" rel="stylesheet" type="text/css"/>
    <link href="cid:css-a9235ac3-94d2-4004-8d6e-3e52de81fb4b@mhtml.blink" rel="stylesheet" type="text/css"/>
    <link href="cid:css-d625425e-5784-46c3-bb8d-5bd775419804@mhtml.blink" rel="stylesheet" type="text/css"/>
    <link href="cid:css-240616c6-3c18-40e8-aa0a-057bb233785b@mhtml.blink" rel="stylesheet" type="text/css"/>
    <link href="cid:css-198334fc-d4c5-4fcc-b7eb-7d6609c32702@mhtml.blink" rel="stylesheet" type="text/css"/>
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible"/>
    <meta content="Safari Books Online" name="author"/>
    <meta content="telephone=no" name="format-detection"/>
    <meta content="on" http-equiv="cleartype"/>
    <meta content="True" name="HandheldFriendly"/>
    <meta content="320" name="MobileOptimized"/>
    <meta content="app-id=881697395, app-argument=safaridetail://9781484228081" name="apple-itunes-app"/>
    <meta content="width=device-width, minimum-scale=1.0, initial-scale=1.0, maximum-scale=1.0" name="viewport"/>
    <meta content="4503599627559754" property="twitter:account_id"/>
    <link href="https://learning.oreilly.com/static/images/apple-touch-icon.0c29511d2d72.png" rel="apple-touch-icon"/>
    <link href="https://learning.oreilly.com/favicon.ico" rel="shortcut icon" type="image/x-icon"/>
    <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,300,400,600,700,900,200italic,300italic,400italic,600italic,700italic,900italic" rel="stylesheet" type="text/css"/>
    <title>A315511_5_En_1_Chapter</title>
    <link href="https://learning.oreilly.com/static/CACHE/css/output.8054605313ed.css" rel="stylesheet" type="text/css"/>
    <link href="https://learning.oreilly.com/static/css/annotator.e3b0c44298fc.css" rel="stylesheet" type="text/css"/>
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_1_Chapter.html" rel="canonical"/>
    <meta content="© Iuliana Cosmina, Rob Harrop, Chris Schaefer, and Clarence Ho 2017 Iuliana Cosmina, Rob Harrop, Chris Schaefer and Clarence HoPro Spring 5https://doi.org/10.1007/978-1-4842-2808-1_1 1. Introducing Spring Iuliana Cosmina1 , Rob Harrop2, Chris Schaefer3 ...!--begin&gt; " name="description"/>
    <meta content="1. Introducing Spring" property="og:title"/>
    <meta content="/library/view/pro-spring-5/9781484228081/" itemprop="isPartOf"/>
    <meta content="1. Introducing Spring" itemprop="name"/>
    <meta content="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_1_Chapter.html" itemprop="url" property="og:url"/>
    <meta content="Safari" property="og:site_name"/>
    <meta content="https://learning.oreilly.com/library/cover/9781484228081/" itemprop="thumbnailUrl" property="og:image"/>
    <meta content="© Iuliana Cosmina, Rob Harrop, Chris Schaefer, and Clarence Ho 2017 Iuliana Cosmina, Rob Harrop, Chris Schaefer and Clarence HoPro Spring 5https://doi.org/10.1007/978-1-4842-2808-1_1 1. Introducing Spring Iuliana Cosmina1 , Rob Harrop2, Chris Schaefer3 ...!--begin&gt; " itemprop="description" property="og:description"/>
    <meta content="en" itemprop="inLanguage"/>
    <meta content="Apress" itemprop="publisher"/>
    <meta content="book" property="og:type"/>
    <meta content="9781484228081" itemprop="isbn" property="og:book:isbn"/>
    <meta content="Clarence Ho" itemprop="author" property="og:book:author"/>
    <meta content="Chris Schaefer" itemprop="author" property="og:book:author"/>
    <meta content="Rob Harrop" itemprop="author" property="og:book:author"/>
    <meta content="Iuliana Cosmina" itemprop="author" property="og:book:author"/>
    <meta content="summary" name="twitter:card"/>
    <meta content="@safari" name="twitter:site"/>
    <link href="https://use.fontawesome.com/840a321d95.css" media="all" rel="stylesheet"/>
</head>

<body class="reading sidenav nav-collapsed  scalefonts library">
<a name="1_"></a>

    <div class="application" id="container" style="height: auto;">
        <div class="js-toc">
            <section role="document">
                <div id="sbo-rt-content" style="max-width:72.5em; transform: none;">
                    <div class="annotator-wrapper">
                        <!--egin Abstract-->
                        <div class="MainTitleSection">
                            <h1 class="ChapterTitle" xml:lang="en">1. Introducing Spring</h1>
                        </div>
                        <div class="AuthorGroup">
                            <div class="AuthorNames"><span class="Author"><span class="AuthorName">Iuliana Cosmina</span><sup>1 <span class="ContactIcon"></span></sup>, </span><span class="Author"><span class="AuthorName">Rob Harrop</span><sup>2</sup>, </span>
                                <span class="Author"><span class="AuthorName">Chris Schaefer</span><sup>3</sup> and </span><span class="Author"><span class="AuthorName">Clarence Ho</span><sup>4</sup></span>
                            </div>
                            <div class="Affiliations">
                                <div class="Affiliation" id="Aff5"><span class="AffiliationNumber">(1)</span>
                                    <div class="AffiliationText">Sibiu, Sibiu, Romania</div>
                                </div>
                                <div class="Affiliation" id="Aff6"><span class="AffiliationNumber">(2)</span>
                                    <div class="AffiliationText">Reddish, UK</div>
                                </div>
                                <div class="Affiliation" id="Aff7"><span class="AffiliationNumber">(3)</span>
                                    <div class="AffiliationText">Venice, Florida, USA</div>
                                </div>
                                <div class="Affiliation" id="Aff8"><span class="AffiliationNumber">(4)</span>
                                    <div class="AffiliationText">Hong Kong, China</div>
                                </div>
                                <div class="ClearBoth"> </div>
                            </div>
                        </div>
                        <!--nd Abstract-->
                        <div class="Fulltext">
                            <div class="Para" id="Par1">When we think of the community of <span id="ITerm1">Java developers              </span>, we are reminded of the hordes of gold rush prospectors of the late 1840s, frantically panning the rivers of North America, looking for
                                fragments of gold. As Java developers, our rivers run rife with open source projects, but, like the prospectors, finding a useful project can be time-consuming and arduous.</div>
                            <div class="Para" id="Par2">A common gripe with many open source Java projects is that they are conceived merely out of the need to fill the gap in the implementation of the latest buzzword-heavy technology or pattern. Having said that, many high-quality,
                                usable projects meet and address a real need for real applications, and in the course of this book, you will meet a subset of these projects. You will get to know one in particular rather well—Spring. The first version
                                of Spring was released in October 2002 and consisted of a small core with an <span id="ITerm2">inversion of control (IoC)      </span> <span id="ITerm3">                                  </span> container that was easy
                                to configure and use. Over the years Spring has become the main replacement of <span id="ITerm4">Java Enterprise Edition (JEE)      </span> servers and has grown into a full-blown technology made up of many distinct projects,
                                each with its own purpose, so whether you want to build microservices, applications, or classical ERPs, Spring has a project for that.</div>
                            <div class="Para" id="Par3">Throughout this book, you will see many applications of different open source technologies, all of which are unified under the Spring Framework. When working with Spring, an application developer can use a large variety of
                                open source tools, without needing to write reams of code and without coupling an application too closely to any particular tool.</div>
                            <div class="Para" id="Par4">In this chapter, as its title indicates, we introduce you to the Spring Framework, rather than presenting any solid examples or explanations. If you are already familiar with Spring, you might want to skip this chapter and
                                proceed straight to Chapter <span class="ExternalRef"><a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_2_Chapter.html"><span class="RefSource">2</span></a>
                                </span>.</div>
                            <div class="Section1 RenderAsSection1" id="Sec1">
                                <h2 class="Heading">What Is Spring?</h2>
                                <div class="Para" id="Par5">Perhaps one the hardest parts of explaining Spring is classifying exactly what it is. Typically, Spring is <span id="ITerm5">described                  </span> as a lightweight framework for building Java applications,
                                    but that statement brings up two interesting points.</div>
                                <div class="Para" id="Par6">First, you can use Spring to build any application in Java (for example, stand-alone, web, or JEE applications), unlike many other frameworks (such as Apache Struts, which is limited to web applications).</div>
                                <div class="Para ParaOneEmphasisChild" id="Par7">Second, the <span class="EmphasisTypeItalic">lightweight</span> part of the description doesn’t really refer to the number of classes or the size of the distribution but rather defines the principle of the Spring philosophy
                                    as a whole—that is, minimal impact. Spring is lightweight in the sense that you have to make few, if any, changes to your application code to gain the benefits of Spring Core, and should you choose to stop using Spring
                                    at any point, you will find doing so quite simple.</div>
                                <div class="Para" id="Par8">Notice that we qualified that last statement to refer to Spring Core only—many of the extra Spring components, such as data access, require a much closer coupling to the Spring Framework. However, the benefits of this coupling
                                    are quite clear, and throughout the book we present techniques for minimizing the impact this has on your application.</div>
                                <div class="Section2 RenderAsSection2" id="Sec2">
                                    <h3 class="Heading">Evolution of the Spring Framework</h3>
                                    <div class="Para" id="Par9">The Spring Framework originated from the book <span class="EmphasisTypeItalic">Expert One-on-One: J2EE Design and Development</span> by Rod Johnson (Wrox, 2002). Over the last decade, the Spring Framework has grown
                                        dramatically in core functionality, associated projects, and community support. With the new major release of the Spring Framework, it’s worthwhile to take a quick look back at important features that have come
                                        along with each milestone release of Spring, leading up to Spring Framework 5.0.
                                        <div class="UnorderedList">
                                            <ul class="UnorderedListMarkBullet">
                                                <li>
                                                    <div class="Para" id="Par10"> <span id="ITerm6">                      <span class="EmphasisTypeItalic">Spring 0.9</span> </span>: This is the first public release of the framework, based on the book <span class="EmphasisTypeItalic">Expert One-on-One: J2EE Design and Development</span>,
                                                        that offered a bean configuration foundation, AOP support, a JDBC abstraction framework, abstract transaction support, and so on. This version does not have official reference documentation, but
                                                        you can find the existing sources and documentation on SourceForge.<a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_1_Chapter.html#Fn1" id="Fn1_source"><sup>1</sup></a>                                                        </div>
                                                </li>
                                                <li>
                                                    <div class="Para" id="Par12"> <span id="ITerm7">                      <span class="EmphasisTypeItalic">Spring 1.x</span> </span>: This is the first version released with official reference documentation. It is composed of the seven
                                                        modules shown in Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_1_Chapter.html#Fig1">1-1</a></span>.
                                                        <div class="Figure" id="Fig1">
                                                            <div class="MediaObject" id="MO1"><img alt="A315511_5_En_1_Fig1_HTML.jpg" data-mfp-src="/library/view/pro-spring-5/9781484228081/A315511_5_En_1_Fig1_HTML.jpg" height="187" src="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_1_Fig1_HTML.jpg" width="440"/></div>
                                                            <div class="Caption" xml:lang="en">
                                                                <div class="CaptionContent"><span class="CaptionNumber">Figure 1-1.</span>
                                                                    <div class="SimplePara">Overview of the Spring Framework, version 1.x</div>
                                                                </div>
                                                        </div>
                                                    </div>
                                                    <div class="UnorderedList">
                                                        <ul class="UnorderedListMarkDash">
                                                            <li>
                                                                <div class="Para" id="Par13"> <span id="ITerm8">                            <span class="EmphasisTypeItalic">Spring Core</span> </span>: Bean container and supporting utilities</div>
                                                            </li>
                                                            <li>
                                                                <div class="Para" id="Par14"> <span class="EmphasisTypeItalic">Spring</span> <span id="ITerm9">                            <span class="EmphasisTypeItalic">Context</span> </span>: <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>,
                                                                    UI, validation, JNDI, <span id="ITerm10">Enterprise JavaBeans (EJB)                      </span>, remoting, and mail support</div>
                                                            </li>
                                                            <li>
                                                                <div class="Para" id="Par15"> <span class="EmphasisTypeItalic">Spring DAO</span>: Transaction infrastructure, <span id="ITerm11">Java Database Connectivity (JDBC)                      </span>, and <span id="ITerm12">data access object (DAO)                      </span>                                                                    support</div>
                                                            </li>
                                                            <li>
                                                                <div class="Para" id="Par16"> <span class="EmphasisTypeItalic">Spring ORM</span>: Hibernate, iBATIS, and <span id="ITerm13">Java Data Objects (JDO)                      </span> support</div>
                                                            </li>
                                                            <li>
                                                                <div class="Para" id="Par17"> <span class="EmphasisTypeItalic">Spring AOP</span>: An AOP Alliance–compliant <span id="ITerm14">aspect-oriented programming (AOP)                      </span> implementation</div>
                                                            </li>
                                                            <li>
                                                                <div class="Para ParaOneEmphasisChild" id="Par18"> <span class="EmphasisTypeItalic">Spring Web</span>: Basic integration features such as multipart functionality, context initialization through servlet listeners, and a web-oriented application
                                                                    context</div>
                                                            </li>
                                                            <li>
                                                                <div class="Para" id="Par19"> <span class="EmphasisTypeItalic">Spring Web MVC</span>: Web-based <span id="ITerm15">Model-View-Controller (MVC)                      </span> framework</div>
                                                            </li>
                                                        </ul>
                                                    </div>
                                        </div>
                                        </li>
                                        <li>
                                            <div class="Para" id="Par20"> <span id="ITerm16">                      <span class="EmphasisTypeItalic">Spring 2.x</span> </span>: This is composed of the six modules shown in Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_1_Chapter.html#Fig2">1-2</a></span>.
                                                The Spring Context module is now included in Spring Core, and all Spring web components have been represented here by a single item.
                                                <div class="Figure" id="Fig2">
                                                    <div class="MediaObject" id="MO2"><img alt="A315511_5_En_1_Fig2_HTML.jpg" data-mfp-src="/library/view/pro-spring-5/9781484228081/A315511_5_En_1_Fig2_HTML.jpg" height="190" src="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_1_Fig2_HTML.jpg" width="440"/></div>
                                                    <div class="Caption" xml:lang="en">
                                                        <div class="CaptionContent"><span class="CaptionNumber">Figure 1-2.</span>
                                                            <div class="SimplePara">Overview of the Spring Framework, version 2.x</div>
                                                        </div>
                                                </div>
                                            </div>
                                            <div class="UnorderedList">
                                                <ul class="UnorderedListMarkDash">
                                                    <li>
                                                        <div class="Para" id="Par21">Easier XML configuration through the use of the new XML Schema–based configuration rather than the DTD format. Notable areas of improvement include bean definitions, AOP, and declarative transactions.</div>
                                                    </li>
                                                    <li>
                                                        <div class="Para" id="Par22">New bean scopes for web and portal usage (request, session, and global sessions).</div>
                                                    </li>
                                                    <li>
                                                        <div class="Para ParaOneEmphasisChild" id="Par23"> <span class="EmphasisFontCategoryNonProportional">@AspectJ</span> annotation support for AOP development.</div>
                                                    </li>
                                                    <li>
                                                        <div class="Para" id="Par24">Java Persistence API (JPA) abstraction layer.</div>
                                                    </li>
                                                    <li>
                                                        <div class="Para" id="Par25">Full support for asynchronous JMS message-driven POJOs (for plain old Java objects).</div>
                                                    </li>
                                                    <li>
                                                        <div class="Para ParaOneEmphasisChild" id="Par26">JDBC simplifications including <span class="EmphasisFontCategoryNonProportional">SimpleJdbcTemplate</span> when using Java 5+.</div>
                                                    </li>
                                                    <li>
                                                        <div class="Para ParaOneEmphasisChild" id="Par27">JDBC named parameter support (<span class="EmphasisFontCategoryNonProportional">NamedParameterJdbcTemplate</span>).</div>
                                                    </li>
                                                    <li>
                                                        <div class="Para" id="Par28">Form tag library for Spring MVC.</div>
                                                    </li>
                                                    <li>
                                                        <div class="Para" id="Par29">Introduction of the Portlet MVC framework.</div>
                                                    </li>
                                                    <li>
                                                        <div class="Para" id="Par30">Dynamic language support. Beans can be written in JRuby, Groovy, and BeanShell.</div>
                                                    </li>
                                                    <li>
                                                        <div class="Para" id="Par31">Notification support and controllable MBean registration in JMX.</div>
                                                    </li>
                                                    <li>
                                                        <div class="Para ParaOneEmphasisChild" id="Par32"> <span class="EmphasisFontCategoryNonProportional">TaskExecutor</span> abstraction introduced for scheduling tasks.</div>
                                                    </li>
                                                    <li>
                                                        <div class="Para" id="Par33">Java 5 annotation support, specifically for <span class="EmphasisFontCategoryNonProportional">@Transactional</span>, <span class="EmphasisFontCategoryNonProportional">@Required</span>, and
                                                            <span class="EmphasisFontCategoryNonProportional">@AspectJ</span>.</div>
                                                    </li>
                                                </ul>
                                            </div>
                                    </div>
                                    </li>
                                    <li>
                                        <div class="Para" id="Par34"> <span id="ITerm17">                      <span class="EmphasisTypeItalic">Spring 2.5.x</span> </span>: This version has the following features:
                                            <div class="UnorderedList">
                                                <ul class="UnorderedListMarkDash">
                                                    <li>
                                                        <div class="Para" id="Par35">A new configuration annotation called <span class="EmphasisFontCategoryNonProportional">@Autowired</span> and support for JSR-250 annotations (<span class="EmphasisFontCategoryNonProportional">@Resource</span>,
                                                            <span class="EmphasisFontCategoryNonProportional">@PostConstruct</span>, <span class="EmphasisFontCategoryNonProportional">@PreDestroy</span>)</div>
                                                    </li>
                                                    <li>
                                                        <div class="Para" id="Par36">New stereotype annotations: <span class="EmphasisFontCategoryNonProportional">@Component</span>, <span class="EmphasisFontCategoryNonProportional">@Repository</span>, <span class="EmphasisFontCategoryNonProportional">@Service</span>,
                                                            <span class="EmphasisFontCategoryNonProportional">@Controller</span> </div>
                                                    </li>
                                                    <li>
                                                        <div class="Para" id="Par37">Automatic classpath-scanning support to detect and wire classes annotated with stereotype annotations</div>
                                                    </li>
                                                    <li>
                                                        <div class="Para" id="Par38">AOP updates, including a new bean pointcut element and AspectJ load-time weaving</div>
                                                    </li>
                                                    <li>
                                                        <div class="Para" id="Par39">Full WebSphere transaction management support</div>
                                                    </li>
                                                    <li>
                                                        <div class="Para" id="Par40">In addition to the Spring MVC <span class="EmphasisFontCategoryNonProportional">@Controller</span> annotation, <span class="EmphasisFontCategoryNonProportional">@RequestMapping</span>, <span class="EmphasisFontCategoryNonProportional">@RequestParam</span>,
                                                            and <span class="EmphasisFontCategoryNonProportional">@ModelAttribute</span> annotations added to support request handling through annotation configuration</div>
                                                    </li>
                                                    <li>
                                                        <div class="Para" id="Par41">Tiles 2 support</div>
                                                    </li>
                                                    <li>
                                                        <div class="Para" id="Par42">JSF 1.2 support</div>
                                                    </li>
                                                    <li>
                                                        <div class="Para" id="Par43">JAX-WS 2.0/2.1 support</div>
                                                    </li>
                                                    <li>
                                                        <div class="Para" id="Par44">Introduction of the Spring TestContext Framework, providing annotation-driven and integration testing support, agnostic of the testing framework being used</div>
                                                    </li>
                                                    <li>
                                                        <div class="Para" id="Par45"> <span id="ITerm18">Ability                                              </span> to deploy a Spring application context as a JCA adapter</div>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </li>
                                    <li>
                                        <div class="Para" id="Par46"> <span id="ITerm19">                      <span class="EmphasisTypeItalic">Spring 3.0.x</span> </span>: This is the first version of Spring based on Java 5 and is designed to take full advantage of Java 5 features
                                            such as generics, varargs, and other language improvements. This version introduces the Java-based <span class="EmphasisFontCategoryNonProportional">@Configuration</span> model. The framework modules have been
                                            revised to be managed separately with one source tree per module JAR. This is abstractly depicted in Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_1_Chapter.html#Fig3">1-3</a></span>.
                                            <div class="Figure" id="Fig3">
                                                <div class="MediaObject" id="MO3"><img alt="A315511_5_En_1_Fig3_HTML.jpg" data-mfp-src="/library/view/pro-spring-5/9781484228081/A315511_5_En_1_Fig3_HTML.jpg" height="259" src="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_1_Fig3_HTML.jpg" width="440"/></div>
                                                <div class="Caption" xml:lang="en">
                                                    <div class="CaptionContent"><span class="CaptionNumber">Figure 1-3.</span>
                                                        <div class="SimplePara">Overview of the Spring Framework, version 3.0.x</div>
                                                    </div>
                                        </div>
                                </div>
                                <div class="UnorderedList">
                                    <ul class="UnorderedListMarkDash">
                                        <li>
                                            <div class="Para" id="Par47">Support for Java 5 features such as generics, varargs, and other improvements</div>
                                        </li>
                                        <li>
                                            <div class="Para" id="Par48">First-class support for Callables, Futures, <span class="EmphasisFontCategoryNonProportional">ExecutorService</span> adapters, and <span class="EmphasisFontCategoryNonProportional">ThreadFactory</span> integration</div>
                                        </li>
                                        <li>
                                            <div class="Para" id="Par49">Framework modules now managed separately with one source tree per module JAR</div>
                                        </li>
                                        <li>
                                            <div class="Para" id="Par50">Introduction of the <span id="ITerm20">Spring Expression Language (SpEL)                      </span> </div>
                                        </li>
                                        <li>
                                            <div class="Para" id="Par51">Integration of core Java Config features and annotations</div>
                                        </li>
                                        <li>
                                            <div class="Para" id="Par52">General-purpose type conversion system and field-formatting system</div>
                                        </li>
                                        <li>
                                            <div class="Para" id="Par53">Comprehensive REST support</div>
                                        </li>
                                        <li>
                                            <div class="Para" id="Par54">New MVC <span id="ITerm21">XML                                              </span> namespace and additional annotations such as <span class="EmphasisFontCategoryNonProportional">@CookieValue</span> and
                                                <span class="EmphasisFontCategoryNonProportional">@RequestHeaders</span> for Spring MVC</div>
                                        </li>
                                        <li>
                                            <div class="Para" id="Par55">Validation enhancements and JSR-303 (Bean Validation) support</div>
                                        </li>
                                        <li>
                                            <div class="Para ParaOneEmphasisChild" id="Par56">Early support for Java EE 6, including <span class="EmphasisFontCategoryNonProportional">@Async/@Asynchronous</span> annotation, JSR-303, JSF 2.0, JPA 2.0, and so on</div>
                                        </li>
                                        <li>
                                            <div class="Para" id="Par57">Support for embedded databases such as HSQL, H2, and Derby</div>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                            </li>
                            <li>
                                <div class="Para" id="Par58"> <span id="ITerm22">                      <span class="EmphasisTypeItalic">Spring 3.1.x</span> </span>: This version has the following features:
                                    <div class="UnorderedList">
                                        <ul class="UnorderedListMarkDash">
                                            <li>
                                                <div class="Para" id="Par59">New cache abstraction</div>
                                            </li>
                                            <li>
                                                <div class="Para ParaOneEmphasisChild" id="Par60">Bean definition profiles can be defined in XML as well as support for the <span class="EmphasisFontCategoryNonProportional">@Profile</span> annotation</div>
                                            </li>
                                            <li>
                                                <div class="Para" id="Par61">Environment abstraction for unified property management</div>
                                            </li>
                                            <li>
                                                <div class="Para" id="Par62">Annotation equivalents for common Spring XML namespace elements such as <span class="EmphasisFontCategoryNonProportional">@ComponentScan</span>, <span class="EmphasisFontCategoryNonProportional">@EnableTransactionManagement</span>,
                                                    <span class="EmphasisFontCategoryNonProportional">@EnableCaching</span>, <span class="EmphasisFontCategoryNonProportional">@EnableWebMvc</span>, <span class="EmphasisFontCategoryNonProportional">@EnableScheduling</span>,
                                                    <span class="EmphasisFontCategoryNonProportional">@EnableAsync</span>, <span class="EmphasisFontCategoryNonProportional">@EnableAspectJAutoProxy</span>, <span class="EmphasisFontCategoryNonProportional">@EnableLoadTimeWeaving</span>,
                                                    and <span class="EmphasisFontCategoryNonProportional">@EnableSpringConfigured</span> </div>
                                            </li>
                                            <li>
                                                <div class="Para" id="Par63">Support for Hibernate 4</div>
                                            </li>
                                            <li>
                                                <div class="Para ParaOneEmphasisChild" id="Par64">Spring TestContext Framework support for <span class="EmphasisFontCategoryNonProportional">@Configuration</span> classes and bean definition profiles</div>
                                            </li>
                                            <li>
                                                <div class="Para" id="Par65">c: namespace for simplified constructor injection</div>
                                            </li>
                                            <li>
                                                <div class="Para" id="Par66">Support for Servlet 3 code-based configuration of the Servlet container</div>
                                            </li>
                                            <li>
                                                <div class="Para" id="Par67">Ability to bootstrap the JPA <span class="EmphasisFontCategoryNonProportional">EntityManagerFactory</span> without <span class="EmphasisFontCategoryNonProportional">persistence.xml</span> </div>
                                            </li>
                                            <li>
                                                <div class="Para" id="Par68"> <span class="EmphasisFontCategoryNonProportional">Flash</span> and <span class="EmphasisFontCategoryNonProportional">RedirectAttributes</span> added to Spring MVC, allowing attributes to survive a redirect
                                                    by using the HTTP session</div>
                                            </li>
                                            <li>
                                                <div class="Para" id="Par69">URI template variable enhancements</div>
                                            </li>
                                            <li>
                                                <div class="Para" id="Par70">Ability to annotate Spring MVC <span class="EmphasisFontCategoryNonProportional">@RequestBody</span> controller method arguments with <span class="EmphasisFontCategoryNonProportional">@Valid</span> </div>
                                            </li>
                                            <li>
                                                <div class="Para" id="Par71"> <span id="ITerm23">Ability                                              </span> to annotate Spring MVC controller method arguments with the <span class="EmphasisFontCategoryNonProportional">@RequestPart</span>                                                    annotation</div>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </li>
                            <li>
                                <div class="Para" id="Par72"> <span id="ITerm24">                      <span class="EmphasisTypeItalic">Spring 3.2.x</span> </span>: This version has the following features:
                                    <div class="UnorderedList">
                                        <ul class="UnorderedListMarkDash">
                                            <li>
                                                <div class="Para" id="Par73">Support for Servlet 3–based asynchronous request processing.</div>
                                            </li>
                                            <li>
                                                <div class="Para" id="Par74">New Spring MVC test framework.</div>
                                            </li>
                                            <li>
                                                <div class="Para" id="Par75">New Spring MVC annotations <span class="EmphasisFontCategoryNonProportional">@ControllerAdvice</span> and <span class="EmphasisFontCategoryNonProportional">@MatrixVariable</span>.</div>
                                            </li>
                                            <li>
                                                <div class="Para" id="Par76">Support for generic types in <span class="EmphasisFontCategoryNonProportional">RestTemplate</span> and in <span class="EmphasisFontCategoryNonProportional">@RequestBody</span> arguments.</div>
                                            </li>
                                            <li>
                                                <div class="Para" id="Par77">Jackson JSON 2 support.</div>
                                            </li>
                                            <li>
                                                <div class="Para" id="Par78">Support for Tiles 3.</div>
                                            </li>
                                            <li>
                                                <div class="Para" id="Par79"> <span class="EmphasisFontCategoryNonProportional">@RequestBody</span> or an <span class="EmphasisFontCategoryNonProportional">@RequestPart</span> argument can now be followed by an <span class="EmphasisFontCategoryNonProportional">Errors</span>                                                    argument, making it possible to handle validation errors.</div>
                                            </li>
                                            <li>
                                                <div class="Para" id="Par80">Ability to exclude URL patterns by using the MVC namespace and Java Config configuration options.</div>
                                            </li>
                                            <li>
                                                <div class="Para ParaOneEmphasisChild" id="Par81">Support for <span class="EmphasisFontCategoryNonProportional">@DateTimeFormat</span> without Joda Time.</div>
                                            </li>
                                            <li>
                                                <div class="Para" id="Par82">Global date and time formatting.</div>
                                            </li>
                                            <li>
                                                <div class="Para" id="Par83">Concurrency refinements across the framework, minimizing locks and generally improving concurrent creation of scoped/prototyped beans</div>
                                            </li>
                                            <li>
                                                <div class="Para" id="Par84">New Gradle-based build system.</div>
                                            </li>
                                            <li>
                                                <div class="Para" id="Par85">Migration to GitHub (<span class="ExternalRef"><a href="https://github.com/SpringSource/spring-framework"><span class="RefSource">                              <span class="EmphasisFontCategoryNonProportional">https://github.com/SpringSource/spring-framework</span>                                                    </span>
                                                    </a>
                                                    </span>).</div>
                                            </li>
                                            <li>
                                                <div class="Para" id="Par86">Refined Java SE 7/OpenJDK 7 support in the framework and third-party dependencies. CGLIB and ASM are now included as part of Spring. AspectJ 1.7 is supported in addition to 1.6.</div>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </li>
                            <li>
                                <div class="Para" id="Par87"> <span id="ITerm25">                      <span class="EmphasisTypeItalic">Spring 4.0.x</span> </span>: This is a major Spring release and the first to fully support Java 8. Older versions of Java can be used, but the minimum
                                    requirement has been raised to Java SE6. Deprecated classes and methods were removed, and the module organization is pretty much the same, as depicted in Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_1_Chapter.html#Fig4">1-4</a></span>.
                                    <div class="Figure" id="Fig4">
                                        <div class="MediaObject" id="MO4"><img alt="A315511_5_En_1_Fig4_HTML.jpg" data-mfp-src="/library/view/pro-spring-5/9781484228081/A315511_5_En_1_Fig4_HTML.jpg" height="256" src="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_1_Fig4_HTML.jpg" width="440"/></div>
                                        <div class="Caption" xml:lang="en">
                                            <div class="CaptionContent"><span class="CaptionNumber">Figure 1-4.</span>
                                                <div class="SimplePara">Overview of the Spring Framework, version 4.0.x</div>
                                            </div>
                                </div>
                        </div>
                        <div class="UnorderedList">
                            <ul class="UnorderedListMarkDash">
                                <li>
                                    <div class="Para" id="Par88">Improved getting-started experience via a series of Getting Started guides on the new <span class="ExternalRef"><a href="http://www.spring.io/guides"><span class="RefSource">                              <span class="EmphasisFontCategoryNonProportional">www.spring.io/guides</span>                                        </span>
                                        </a>
                                        </span> web site</div>
                                </li>
                                <li>
                                    <div class="Para" id="Par89">Removal of deprecated packages and methods from the prior Spring 3 version</div>
                                </li>
                                <li>
                                    <div class="Para" id="Par90">Java 8 support, raising the minimum Java version to 6 update 18</div>
                                </li>
                                <li>
                                    <div class="Para" id="Par91">Java EE 6 and above is now considered the baseline for Spring Framework 4.0</div>
                                </li>
                                <li>
                                    <div class="Para" id="Par92">Groovy bean definition DSL, allowing bean definitions to be configured via Groovy syntax</div>
                                </li>
                                <li>
                                    <div class="Para" id="Par93">Core container, testing, and general web improvements</div>
                                </li>
                                <li>
                                    <div class="Para" id="Par94">WebSocket, SockJS, and STOMP messaging</div>
                                </li>
                            </ul>
                        </div>
                    </div>
                    </li>
                    <li>
                        <div class="Para" id="Par95"> <span id="ITerm26">                      <span class="EmphasisTypeItalic">Spring 4.2.x</span> </span>: This version has the following features:
                            <div class="UnorderedList">
                                <ul class="UnorderedListMarkDash">
                                    <li>
                                        <div class="Para ParaOneEmphasisChild" id="Par96">Core improvements (eg., introduction of <span class="EmphasisFontCategoryNonProportional">@AliasFor</span> and modification of existing annotation to make use of it)</div>
                                    </li>
                                    <li>
                                        <div class="Para" id="Par97">Full support for Hibernate ORM 5.0</div>
                                    </li>
                                    <li>
                                        <div class="Para" id="Par98">JMS and web <span id="ITerm27">improvements                                              </span> </div>
                                    </li>
                                    <li>
                                        <div class="Para" id="Par99">WebSocket messaging improvements</div>
                                    </li>
                                    <li>
                                        <div class="Para" id="Par100">Testing improvements, most notably the introduction of <span class="EmphasisFontCategoryNonProportional">@Commit</span> to replace <span class="EmphasisFontCategoryNonProportional">@Rollback(false)</span> and the
                                            introduction of the <span class="EmphasisFontCategoryNonProportional">AopTestUtils</span> utility class that allows access to the underlying object hidden behind a Spring proxy</div>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </li>
                    <li>
                        <div class="Para" id="Par101"> <span id="ITerm28">                      <span class="EmphasisTypeItalic">Spring 4.3.x</span> </span>: This version has the following features:
                            <div class="UnorderedList">
                                <ul class="UnorderedListMarkDash">
                                    <li>
                                        <div class="Para" id="Par102">The programming model has been refined.</div>
                                    </li>
                                    <li>
                                        <div class="Para ParaOneEmphasisChild" id="Par103">Considerable improvements in the core container (inclusions of ASM 5.1, CGLIB 3.2.4, and Objenesis 2.4 in <span class="EmphasisFontCategoryNonProportional">spring-core.jar</span>) and MVC.</div>
                                    </li>
                                    <li>
                                        <div class="Para" id="Par104">Composed annotations were added.</div>
                                    </li>
                                    <li>
                                        <div class="Para" id="Par105">Spring TestContext Framework requires JUnit 4.12 or higher.</div>
                                    </li>
                                    <li>
                                        <div class="Para" id="Par106">Support for new libraries, including Hibernate ORM 5.2, Hibernate Validator 5.3, Tomcat 8.5 and 9.0, Jackson 2.8, and so on</div>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </li>
                    <li>
                        <div class="Para" id="Par107"> <span id="ITerm29">                      <span class="EmphasisTypeItalic">Spring 5.0.x</span> </span>: This is a major release. The entire framework codebase is based on Java 8 and is fully compatible with Java 9 as of July 2016.
                            <a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_1_Chapter.html#Fn2" id="Fn2_source"><sup>2</sup></a>
                                <div class="UnorderedList">
                                    <ul class="UnorderedListMarkDash">
                                        <li>
                                            <div class="Para" id="Par109">Support was dropped for Portlet, Velocity, JasperReports, XMLBeans, JDO, Guava, Tiles2, and Hibernate3.</div>
                                        </li>
                                        <li>
                                            <div class="Para" id="Par110">XML configuration namespaces are now streamed to unversioned schemas; version-specific declarations are still supported but validated against the latest XSD schema.</div>
                                        </li>
                                        <li>
                                            <div class="Para" id="Par111">Overall improvements were introduced by harnessing the full power of Java 8 features.</div>
                                        </li>
                                        <li>
                                            <div class="Para" id="Par112">The <span class="EmphasisFontCategoryNonProportional">Resource</span> abstraction provides <span class="EmphasisFontCategoryNonProportional">isFile</span> indicator for defensive <span class="EmphasisFontCategoryNonProportional">getFile</span>                                                access.</div>
                                        </li>
                                        <li>
                                            <div class="Para ParaOneEmphasisChild" id="Par113">Full Servlet 3.1 signature support in Spring-provided <span class="EmphasisFontCategoryNonProportional">Filter</span> implementations.</div>
                                        </li>
                                        <li>
                                            <div class="Para" id="Par114">Support for Protobuf 3.0.</div>
                                        </li>
                                        <li>
                                            <div class="Para" id="Par115">Support for JMS 2.0+, JPA 2.1+.<span id="ITerm30">                                                                                  </span> </div>
                                        </li>
                                        <li>
                                            <div class="Para" id="Par116">Introduction of Spring Web Flow, a project that is an alternative to <span class="EmphasisFontCategoryNonProportional">Spring MVC</span> built on a reactive foundation, which means that it is fully asynchronous
                                                and non-blocking, intended for use in an event-loop execution model vs. traditional large thread pool with a thread-per-request execution model (built upon Project Reactor<a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_1_Chapter.html#Fn3" id="Fn3_source"><sup>3</sup></a>).</div>
                                        </li>
                                        <li>
                                            <div class="Para" id="Par118">The web and core modules were adapted to the reactive programming model.<a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_1_Chapter.html#Fn4" id="Fn4_source"><sup>4</sup></a>                                                </div>
                                        </li>
                                        <li>
                                            <div class="Para" id="Par120">There are a lot of improvements in the Spring test module. JUnit 5 is now supported, and new annotations were introduced to support the Jupiter programming and extension model such as <span class="EmphasisFontCategoryNonProportional">@SpringJUnitConfig</span>,
                                                <span class="EmphasisFontCategoryNonProportional">@SpringJUnitWebConfig</span>, <span class="EmphasisFontCategoryNonProportional">@EnabledIf</span>, <span class="EmphasisFontCategoryNonProportional">@DisabledIf</span>.</div>
                                        </li>
                                        <li>
                                            <div class="Para" id="Par121">Support for parallel test execution in the Spring TestContext Framework.</div>
                                        </li>
                                    </ul>
                                </div>
                        </div>
                    </li>
                    </ul>
                </div>
        </div>
    </div>
    <div class="Section2 RenderAsSection2" id="Sec3">
        <h3 class="Heading">Inverting Control or Injecting Dependencies?</h3>
        <div class="Para" id="Par122">The core of the Spring Framework is based on the principle of inversion of control. IoC is a technique that externalizes the creation and management of component dependencies. Consider an example in which class <span class="EmphasisFontCategoryNonProportional">Foo</span>            depends on an instance of class <span class="EmphasisFontCategoryNonProportional">Bar</span> to perform some kind of processing. Traditionally, <span class="EmphasisFontCategoryNonProportional">Foo</span> creates an instance of <span class="EmphasisFontCategoryNonProportional">Bar</span>            by using the <span class="EmphasisFontCategoryNonProportional">new</span> operator or obtains one from some kind of factory class. Using the IoC approach, an instance of <span class="EmphasisFontCategoryNonProportional">Bar</span> (or a subclass)
            is provided to <span class="EmphasisFontCategoryNonProportional">Foo</span> at runtime by some external process. This behavior, the injection of dependencies at runtime, led to IoC being renamed by Martin Fowler as the much more descriptive
            <span class="EmphasisTypeItalic">dependency injection</span> (DI). Chapter <span class="ExternalRef"><a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_3_Chapter.html"><span class="RefSource">3</span></a>
            </span>
            discusses the precise nature of the dependencies managed by DI.</div>
        <div class="Para ParaTypeImportant" id="Par123"><img alt="A315511_5_En_1_Figa_HTML.jpg" data-mfp-src="/library/view/pro-spring-5/9781484228081/A315511_5_En_1_Figa_HTML.jpg" height="28" src="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_1_Figa_HTML.jpg" width="30"/>            As you will see in Chapter <span class="ExternalRef"><a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_3_Chapter.html"><span class="RefSource">3</span></a>
            </span>, using the term <span class="EmphasisTypeItalic">dependency injection</span> when referring to inversion of control is always correct. In the context of Spring, you can use the terms interchangeably, without any loss of meaning.</div>
        <div class="Para" id="Par124">Spring’s DI implementation is based on two core Java concepts: JavaBeans and interfaces. When you use Spring as the DI provider, you gain the flexibility of defining dependency configuration within your applications in different ways (for example,
            XML files, Java configuration classes, annotations within your code, or the new Groovy bean definition method). <span id="ITerm31">JavaBeans (POJOs)                      </span> provide a standard mechanism for creating Java resources that
            are configurable in a number of ways, such as constructors and setter methods. In Chapter <span class="ExternalRef"><a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_3_Chapter.html"><span class="RefSource">3</span></a>
            </span>, you will see how Spring uses the JavaBean specification to form the core of its DI configuration model; in fact, any Spring-managed resource is referred to as a <span class="EmphasisTypeItalic">bean</span>. If you are unfamiliar with JavaBeans,
            refer to the quick primer we present at the beginning of Chapter <span class="ExternalRef"><a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_3_Chapter.html"><span class="RefSource">3</span></a>
            </span>.</div>
    <div class="Para" id="Par125"> <span id="ITerm32">Interfaces                      </span> and DI are technologies that are mutually beneficial. Clearly designing and coding an application to interfaces makes for a flexible application, but the complexity of wiring together an application
        designed using interfaces is quite high and places an additional coding burden on developers. By using DI, you reduce the amount of code you need to use an interface-based design in your application to almost zero. Likewise, by using interfaces,
        you can get the most out of DI because your beans can utilize any interface implementation to satisfy their dependency. The use of interfaces also allows Spring to utilize JDK dynamic proxies (the Proxy pattern) to provide powerful concepts such
        as AOP for crosscutting concerns.</div>
    <div class="Para" id="Par126">In the context of DI, Spring acts more like a container than a framework—providing instances of your application classes with all the dependencies they need—but it does so in a much less intrusive way. Using Spring for DI relies on nothing more than
        following the JavaBeans naming conventions within your classes—there are no special classes from which to inherit or proprietary naming schemes to follow. If anything, the only change you make in an application that uses DI is to expose more properties
        on your JavaBeans, thus allowing more dependencies to be injected at runtime.</div>
    </div>
    <div class="Section2 RenderAsSection2" id="Sec4">
        <h3 class="Heading"> <span id="ITerm33">Evolution          </span> of Dependency Injection</h3>
        <div class="Para" id="Par127">In the past few years, thanks to the popularity gained by Spring and other DI frameworks, DI has gained wide acceptance among Java developer communities. At the same time, developers were convinced that using DI was a best practice in application
            development, and the benefits of using DI were also well understood.</div>
        <div class="Para" id="Par128">The popularity of DI was acknowledged when the <span id="ITerm34">Java Community Process (JCP)          </span> adopted JSR-330 (Dependency Injection for Java) in 2009. JSR-330 had become a formal Java specification request, and as you might expect,
            one of the specification leads was Rod Johnson—the founder of the Spring Framework. In JEE 6, JSR-330 became one of the included specifications of the entire technology stack. In the meantime, the EJB architecture (starting from version 3.0)
            was also revamped dramatically; it adopted the DI model in order to ease the development of various Enterprise JavaBeans apps.</div>
        <div class="Para" id="Par129">Although we leave the full discussion of DI until Chapter <span class="ExternalRef"><a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_3_Chapter.html"><span class="RefSource">3</span></a>
            </span>, it is worth taking a look at the benefits of using DI rather than a more traditional approach.
            <div class="UnorderedList">
                <ul class="UnorderedListMarkBullet">
                    <li>
                        <div class="Para ParaOneEmphasisChild" id="Par130"> <span class="EmphasisTypeItalic">Reduced glue code</span>: One of the biggest plus points of DI is its ability to dramatically reduce the amount of code you have to write to glue the components of your application together. Often
                            this code is trivial, so creating a dependency involves simply creating a new instance of an object. However, the glue code can get quite complex when you need to look up dependencies in a JNDI repository or when the dependencies
                            cannot be invoked directly, as is the case with remote resources. In these cases, DI can really simplify the glue code by providing automatic JNDI lookup and automatic proxying of remote resources.</div>
                    </li>
                    <li>
                        <div class="Para ParaOneEmphasisChild" id="Par131"> <span class="EmphasisTypeItalic">Simplified application configuration</span>: By adopting DI, you can greatly simplify the process of configuring an application. You can use a variety of options to configure those classes that
                            were injectable to other classes. You can use the same technique to express the dependency requirements to the “injector” for injecting the appropriate bean instance or property. In addition, DI makes it much simpler to swap
                            one implementation of a dependency for another. Consider the case where you have a DAO component that performs data operations against a PostgreSQL database and you want to upgrade to Oracle. Using DI, you can simply reconfigure
                            the appropriate dependency on your business objects to use the Oracle implementation rather than the PostgreSQL one.</div>
                    </li>
                    <li>
                        <div class="Para ParaOneEmphasisChild" id="Par132"> <span class="EmphasisTypeItalic">Ability to manage common dependencies in a single repository</span>: Using a traditional approach to dependency management of common services—for example, data source connection, transaction, and
                            remote services—you create instances (or lookup from some factory classes) of your dependencies where they are needed (within the dependent class). This will cause the dependencies to spread across the classes in your application,
                            and changing them can prove problematic. When you use DI, all the information about those common dependencies is contained in a single repository, making the management of dependencies much simpler and less error prone.</div>
                    </li>
                    <li>
                        <div class="Para" id="Par133"> <span class="EmphasisTypeItalic">Improved</span> <span id="ITerm35">                      <span class="EmphasisTypeItalic">testability</span> </span>: When you design your classes for DI, you make it possible to replace dependencies
                            easily. This is especially handy when you are testing your application. Consider a business object that performs some complex processing; for part of this, it uses a DAO to access data stored in a relational database. For your
                            test, you are not interested in testing the DAO; you simply want to test the business object with various sets of data. In a traditional approach, whereby the business object is responsible for obtaining an instance of the
                            DAO itself, you have a hard time testing this, because you are unable to easily replace the DAO implementation with a mock implementation that returns your test data sets. Instead, you need to make sure your test database contains
                            the correct data and uses the full DAO implementation for your tests. Using DI, you can create a mock implementation of the DAO object that returns the test data sets, and then you can pass this to your business object for
                            testing. This mechanism can be extended for testing any tier of your application and is especially useful for testing web components where you can create mock implementations of <span class="EmphasisFontCategoryNonProportional">HttpServletRequest</span>                            and <span class="EmphasisFontCategoryNonProportional">HttpServletResponse</span>.</div>
                    </li>
                    <li>
                        <div class="Para ParaOneEmphasisChild" id="Par134"> <span class="EmphasisTypeItalic">Fostering of good application design</span>: Designing for DI means, in general, designing against interfaces. A typical injection-oriented application is designed so that all major components are
                            defined as interfaces, and then concrete implementations of these interfaces are created and hooked together using the DI container. This kind of design was possible in Java before the advent of DI and DI-based containers such
                            as Spring, but by using Spring, you get a whole host of DI features for free, and you are able to concentrate on building your application logic, not a framework to support it.</div>
                    </li>
                </ul>
            </div>
        </div>
        <div class="Para" id="Par135">As you can see from this list, DI provides a lot of benefits for your application, but it is not without its drawbacks. In particular, DI can make it difficult for someone not intimately familiar with the code to see just what implementation of
            a particular dependency is being hooked into which objects. Typically, this is a problem only when developers are inexperienced with DI; after becoming more experienced and following good DI coding practice (for example, putting all injectable
            classes within each application layer into the same package), developers will be able to discover the whole picture easily. For the most part, the massive benefits far outweigh this small drawback, but you should consider this when planning
            your application.</div>
    </div>
    <div class="Section2 RenderAsSection2" id="Sec5">
        <h3 class="Heading">Beyond Dependency Injection</h3>
        <div class="Para" id="Par136">Spring Core alone, with its advanced DI capabilities, is a worthy tool, but where Spring really excels is in its myriad of additional features, all elegantly designed and built using the principles of DI. Spring provides features for all layers
            of an application, from helper <span id="ITerm36">application programming interfaces (APIs)          </span> for data access right through to advanced MVC capabilities. What is great about these features in Spring is that, although Spring
            often provides its own approach, you can easily integrate them with other tools in Spring, making these tools first-class members of the Spring family.</div>
        <div class="Section3 RenderAsSection3" id="Sec6">
            <h4 class="Heading">Support for <span id="ITerm37">Java 9            </span> <span id="ITerm38">                                                    </span> </h4>
            <div class="Para" id="Par137">Java 8 brings many exciting features that Spring Framework 5 supports, most notably lambda expressions and method references with Spring’s callback interfaces. The Spring 5 release plan was aligned with the initial release plan for JDK 9,
                and although the release deadline for JDK 9 has been postponed, Spring 5 was released according to plan. It is estimated that Spring 5.1 will fully embrace JDK 9. Spring 5 will make use of JDK 9 features such as compact strings, the ALPN
                stack, and the new HTTP Client implementation. While Spring Framework 4.0 supports Java 8, compatibility is still maintained back to JDK 6 update 18. The use of a more recent version of Java such as 7 or 8 is recommended for new development
                projects. Spring 5.0 requires Java 8+ because the Spring development team has applied the Java 8 language level to the entire framework codebase, but Spring 5 was built on JDK 9 too, even from the start, to provide comprehensive support
                for advertised features of JDK 9.</div>
        </div>
        <div class="Section3 RenderAsSection3" id="Sec7">
            <h4 class="Heading">Aspect-Oriented <span id="ITerm39">Programming            </span> with Spring</h4>
            <div class="Para" id="Par138"> <span id="ITerm40">AOP                          </span> provides the ability to implement crosscutting logic—that is, logic that applies to many parts of your application—in a single place and to have that logic applied across your application
                automatically. Spring’s approach to AOP is to create dynamic proxies to the target objects and weave the objects with the configured advice to execute the crosscutting logic. By the nature of JDK dynamic proxies, target objects must implement
                an interface declaring the method in which the AOP advice will be applied. Another popular AOP library is the Eclipse AspectJ project,<a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_1_Chapter.html#Fn5" id="Fn5_source"><sup>5</sup></a> which provides more-powerful features including object construction, class loading, and stronger crosscutting capability. However, the good news for Spring and AOP developers is that
                starting from version 2.0, Spring offers much tighter integration with AspectJ. The following are some highlights:
                <div class="UnorderedList">
                    <ul class="UnorderedListMarkBullet">
                        <li>
                            <div class="Para" id="Par140">Support for AspectJ-style pointcut expressions</div>
                        </li>
                        <li>
                            <div class="Para ParaOneEmphasisChild" id="Par141">Support for <span class="EmphasisFontCategoryNonProportional">@AspectJ</span> annotation style, while still using Spring AOP for weaving</div>
                        </li>
                        <li>
                            <div class="Para" id="Par142">Support for aspects implemented in AspectJ for DI</div>
                        </li>
                        <li>
                            <div class="Para ParaOneEmphasisChild" id="Par143">Support for load-time weaving within the Spring <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> </div>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="Para ParaTypeImportant" id="Par144"> <img alt="A315511_5_En_1_Figa_HTML.jpg" data-mfp-src="/library/view/pro-spring-5/9781484228081/A315511_5_En_1_Figa_HTML.jpg" height="28" src="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_1_Figa_HTML.jpg" width="30"/>                Starting with Spring Framework version 3.2, <span class="EmphasisFontCategoryNonProportional">@AspectJ</span> annotation support can be enabled with Java configuration.</div>
            <div class="Para" id="Par145">Both kinds of AOP have their place, and in most cases, Spring AOP is sufficient for addressing an application’s crosscutting requirements. However, for more complicated requirements, AspectJ can be used, and both Spring AOP and AspectJ can
                be mixed in the same Spring-powered application.</div>
            <div class="Para" id="Par146">AOP has many applications. A typical one given in many of the traditional AOP examples involves performing some kind of logging, but AOP has found uses well beyond the trivial logging applications. Indeed, within the Spring Framework itself,
                AOP is used for many purposes, particularly in transaction management. Spring AOP is covered in full detail in Chapter <span class="ExternalRef"><a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_5_Chapter.html"><span class="RefSource">5</span></a>
                </span>, where we show you typical uses of AOP within the Spring Framework and your own applications, as well as AOP performance and areas where traditional technologies are better suited than AOP.</div>
        </div>
        <div class="Section3 RenderAsSection3" id="Sec8">
            <h4 class="Heading">Spring Expression Language</h4>
            <div class="Para" id="Par147"> <span id="ITerm41">              <span class="EmphasisTypeItalic">Expression Language</span> (EL) </span> <span id="ITerm42">                                                    </span> is a technology to allow an application to manipulate
                Java objects at runtime. However, the problem with EL is that different technologies provide their own EL implementations and syntaxes. For example, Java Server Pages (JSP) and Java Server Faces (JSF) both have their own EL, and their
                syntaxes are different. To solve the problem, the Unified Expression Language (EL) was created.</div>
            <div class="Para ParaOneEmphasisChild" id="Par148">Because the Spring Framework is evolving so quickly, there is a need for a standard expression language that can be shared among all the Spring Framework modules as well as other Spring projects. Consequently, starting in version 3.0, Spring
                introduced the <span class="EmphasisTypeItalic">Spring Expression Language</span>. SpEL provides powerful features for evaluating expressions and for accessing Java objects and Spring beans at runtime. The result can be used in the application
                or injected into other JavaBeans.</div>
        </div>
        <div class="Section3 RenderAsSection3" id="Sec9">
            <h4 class="Heading">Validation in Spring</h4>
            <div class="Para" id="Par149"> <span id="ITerm43">Validation                          </span> is another large topic in any kind of application. The ideal scenario is that the validation rules of the attributes within JavaBeans containing business data can be applied in
                a consistent way, regardless of whether the data manipulation request is initiated from the front end, a batch job, or remotely (for example, via web services, RESTful web services, or remote procedure calls [RPCs]).</div>
            <div class="Para" id="Par150">To address these concerns, Spring provides a built-in validation API by way of the <span class="EmphasisFontCategoryNonProportional">Validator</span> interface. This interface provides a simple yet concise mechanism allowing you to encapsulate
                your validation logic into a class responsible for validating the target object. In addition to the target object, the validate method takes an <span class="EmphasisFontCategoryNonProportional">Errors</span> object, which is used to collect
                any validation errors that may occur.</div>
            <div class="Para" id="Par151">Spring also provides a handy utility class, <span class="EmphasisFontCategoryNonProportional">ValidationUtils</span>, which provides convenience methods for invoking other validators, checking for common problems such as empty strings, and
                reporting errors back to the provided <span class="EmphasisFontCategoryNonProportional">Errors</span> object.</div>
            <div class="Para" id="Par152">Driven by need, the JCP also developed JSR-303 (Bean Validation), which provides a standard way of defining bean validation rules. For example, when applying the <span class="EmphasisFontCategoryNonProportional">@NotNull</span> annotation
                to a bean’s property, it mandates that the attribute shouldn’t contain a <span class="EmphasisFontCategoryNonProportional">null</span> value before being able to persist into the database.</div>
            <div class="Para" id="Par153">Starting in version 3.0, Spring provides out-of-the-box support for JSR-303. To use the API, just declare a <span class="EmphasisFontCategoryNonProportional">LocalValidatorFactoryBean</span> and inject the <span class="EmphasisFontCategoryNonProportional">Validator</span>                interface into any Spring-managed beans. Spring will resolve the underlying implementation for you. By default, Spring will first look for the Hibernate Validator (<span class="EmphasisFontCategoryNonProportional">hibernate.org/subprojects/validator</span>),
                which is a popular JSR-303 implementation. Many front-end technologies (for example, JSF 2 and Google Web Toolkit), including Spring MVC, also support the application of JSR-303 validation in the user interface. The time when developers
                needed to program the same validation logic in both the user interface and the back-end layer is gone. Chapter <span class="ExternalRef"><a href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_10_Chapter.html"><span class="RefSource">10</span></a>
                </span>
                discusses the details.</div>
            <div class="Para ParaTypeImportant" id="Par154"> <img alt="A315511_5_En_1_Figa_HTML.jpg" data-mfp-src="/library/view/pro-spring-5/9781484228081/A315511_5_En_1_Figa_HTML.jpg" height="28" src="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_1_Figa_HTML.jpg" width="30"/>                Starting with Spring Framework version 4.0, the 1.1 version of JSR-349 (Bean Validation) is supported.</div>
        </div>
        <div class="Section3 RenderAsSection3" id="Sec10">
            <h4 class="Heading">Accessing Data in Spring</h4>
            <div class="Para" id="Par155"> <span id="ITerm44">Data access                          </span> and persistence seem to be the most discussed topics in the Java world. Spring provides excellent integration with a choice selection of these data access tools. In addition,
                Spring makes plain-vanilla JDBC a viable option for many projects, with its simplified wrapper APIs around the standard API. Spring’s data access module provides out-of-the-box support for JDBC, Hibernate, JDO, and the JPA.</div>
            <div class="Para ParaTypeImportant" id="Par156"> <img alt="A315511_5_En_1_Figa_HTML.jpg" data-mfp-src="/library/view/pro-spring-5/9781484228081/A315511_5_En_1_Figa_HTML.jpg" height="28" src="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_1_Figa_HTML.jpg" width="30"/>                Starting with Spring Framework version 4.0, iBATIS support has been removed. The MyBatis-Spring project provides integration with Spring, and you can find more information at <span class="ExternalRef"><a href="http://mybatis.github.io/spring/"><span class="RefSource">                    <span class="EmphasisFontCategoryNonProportional">http://mybatis.github.io/spring/</span>                </span>
                </a>
                </span>.</div>
            <div class="Para" id="Par157">However, in the past few years, because of the explosive growth of the Internet and cloud computing, besides relational databases, a lot of other “special-purpose” databases were developed. Examples include databases based on key-value pairs
                to handle extremely large volumes of data (generally referred to as NoSQL), graph databases, and document databases. To help developers support those databases and to not complicate the Spring data access module, a separate project called
                Spring Data<a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_1_Chapter.html#Fn6" id="Fn6_source"><sup>6</sup></a> was created. The project was further split into different
                categories to support more specific database access requirements.</div>
            <div class="Para ParaTypeImportant" id="Par159"> <img alt="A315511_5_En_1_Figa_HTML.jpg" data-mfp-src="/library/view/pro-spring-5/9781484228081/A315511_5_En_1_Figa_HTML.jpg" height="28" src="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_1_Figa_HTML.jpg" width="30"/>                Spring’s support of nonrelational databases is not covered in this book. If you are interested in this topic, the Spring Data project mentioned earlier is a good place to look. The project page details the nonrelational databases that
                it supports, with links to those databases’ home pages.</div>
            <div class="Para" id="Par160">The JDBC support in Spring makes building an application on top of JDBC a realistic undertaking, even for more complex applications. The support for Hibernate, JDO, and JPA makes already simple APIs even simpler, thus easing the burden on
                developers. When using the Spring APIs to access data via any tool, you are able to take advantage of Spring’s excellent transaction support. You’ll find a full discussion of this in Chapter <span class="ExternalRef"><a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_9_Chapter.html"><span class="RefSource">9</span></a>
                </span>.</div>
            <div class="Para" id="Par161">One of the nicest features in Spring is the ability to easily mix and match data access technologies within an application. For instance, you may be running an application with Oracle, using Hibernate for much of your data access logic. However,
                if you want to take advantage of some Oracle-specific features, it is simple to implement that part of your data access tier by using Spring’s JDBC APIs.</div>
        </div>
        <div class="Section3 RenderAsSection3" id="Sec11">
            <h4 class="Heading"> <span id="ITerm45">Object/XML Mapping                          </span> in Spring</h4>
            <div class="Para" id="Par162">Most applications need to integrate or provide services to other applications. One common requirement is to exchange data with other systems, either on a regular basis or in real time. In terms of data format, XML is the most commonly used.
                As a result, you will often need to transform a JavaBean into XML format, and vice versa. Spring supports many common Java-to-XML mapping frameworks and, as usual, eliminates the need for directly coupling to any specific implementation.
                Spring provides common interfaces for marshalling (transforming JavaBeans into XML) and unmarshalling (transforming XML into Java objects) for DI into any Spring beans. Common libraries such as Java Architecture for XML Binding (JAXB)
                <span id="ITerm46">                                                    </span>, Castor, XStream, JiBX, and XMLBeans are supported. In Chapter <span class="ExternalRef"><a href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_12_Chapter.html"><span class="RefSource">12</span></a>
                </span>, when we discuss remotely accessing a Spring application for business data in XML format, you will see how to use Spring’s <span id="ITerm47">Object/XML Mapping (OXM)            </span> support in your application.</div>
        </div>
        <div class="Section3 RenderAsSection3" id="Sec12">
            <h4 class="Heading">Managing Transactions</h4>
            <div class="Para" id="Par163">Spring provides an excellent abstraction layer for <span id="ITerm48">transaction management                          </span>, allowing for programmatic and declarative transaction control. By using the Spring abstraction layer for transactions,
                you can make it simple to change the underlying transaction protocol and resource managers. You can start with simple, local, resource-specific transactions and move to global, multiresource transactions without having to change your code.
                Transactions are covered in full detail in Chapter <span class="ExternalRef"><a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_9_Chapter.html"><span class="RefSource">9</span></a>
                </span>.</div>
        </div>
        <div class="Section3 RenderAsSection3" id="Sec13">
            <h4 class="Heading">Simplifying and Integrating with <span id="ITerm49">JEE                          </span> </h4>
            <div class="Para" id="Par164">With the growing acceptance of DI frameworks such as Spring, a lot of developers have chosen to construct applications by using DI frameworks in favor of JEE’s EJB approach. As a result, the JCP communities also realize the complexity of EJB.
                Starting in version 3.0 of the EJB specification, the API was simplified, so it now embraces many of the concepts from DI.</div>
            <div class="Para" id="Par165">However, for those applications that were built on EJB or need to deploy the Spring-based applications in a JEE container and utilize the application server’s enterprise services (for example, Java Transaction API’s Transaction Manager, data
                source connection pooling, and JMS connection factories), Spring also provides simplified support for those technologies. For EJB, Spring provides a simple declaration to perform the JNDI lookup and inject into Spring beans. On the reverse
                side, Spring also provides simple annotation for injecting Spring beans into EJBs.</div>
            <div class="Para" id="Par166">For any resources stored in a JNDI-accessible location, Spring allows you to do away with the complex lookup code and have JNDI-managed resources injected as dependencies into other objects at runtime. As a side effect of this, your application
                becomes decoupled from JNDI, allowing you more scope for code reuse in the future.</div>
        </div>
        <div class="Section3 RenderAsSection3" id="Sec14">
            <h4 class="Heading">MVC in the Web <span id="ITerm50">Tier                          </span> </h4>
            <div class="Para" id="Par167">Although Spring can be used in almost any setting, from the desktop to the Web, it provides a rich array of classes to support the creation of web-based applications. Using Spring, you have maximum flexibility when you are choosing how to
                implement your web front end. For developing web applications, the MVC pattern is the most popular practice. In recent versions, Spring has gradually evolved from a simple web framework into a full-blown MVC implementation. First, view
                support in Spring MVC is extensive. In addition to standard support for JSP and <span id="ITerm51">Java Standard Tag Library (JSTL)            </span>, which is greatly bolstered by the Spring tag libraries, you can take advantage of fully
                integrated support for Apache Velocity, FreeMarker, Apache Tiles, Thymeleaf, and XSLT. In addition, you will find a set of base view classes that make it simple to add Microsoft Excel, PDF, and JasperReports output to your applications.</div>
            <div class="Para" id="Par168">In many cases, you will find Spring MVC sufficient for your web application development needs. However, Spring can also integrate with other popular web frameworks such as Struts, JSF, Atmosphere, <span id="ITerm52">Google Web Toolkit (GWT)            </span>,
                and so on.</div>
        <div class="Para" id="Par169">In the past few years, the technology of web frameworks has evolved quickly. Users have required more responsive and interactive experiences, and that has resulted in the rise of Ajax as a widely adopted technology in developing <span id="ITerm53">rich Internet applications (RIAs)            </span>.
            On the other hand, users also want to be able to access their applications from any device, including smartphones and tablets. This creates a need for web frameworks that support HTML5, JavaScript, and CSS3. In Chapter <span class="ExternalRef"><a href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_16_Chapter.html"><span class="RefSource">16</span></a>
            </span>, we discuss developing web applications by using Spring MVC.</div>
    </div>
    <div class="Section3 RenderAsSection3" id="Sec15">
        <h4 class="Heading"> <span id="ITerm54">WebSocket Support                          </span> </h4>
        <div class="Para" id="Par170">Starting with Spring Framework 4.0, support for JSR-356 (Java API for WebSocket) is available. WebSocket defines an API for creating a persistent connection between a client and server, typically implemented in web browsers and servers. WebSocket-style
            development opens the door for efficient, full-duplex communication enabling real-time message exchanges for highly responsive applications. Use of WebSocket support is detailed further in Chapter <span class="ExternalRef"><a href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_17_Chapter.html"><span class="RefSource">17</span></a>
            </span>.</div>
    </div>
    <div class="Section3 RenderAsSection3" id="Sec16">
        <h4 class="Heading"> <span id="ITerm55">Remoting Support                          </span> </h4>
        <div class="Para" id="Par171">Accessing or exposing remote components in Java has never been the simplest of jobs. Using Spring, you can take advantage of extensive support for a wide range of remoting techniques to quickly expose and access remote services. Spring provides
            support for a variety of remote access mechanisms, including Java Remote Method Invocation (RMI), JAX-WS, Caucho Hessian and Burlap, JMS, Advanced Message Queuing Protocol (AMQP), and REST. In addition to these remoting protocols, Spring provides
            its own HTTP-based invoker that is based on standard Java serialization. By applying Spring’s dynamic proxying capabilities, you can have a proxy to a remote resource injected as a dependency into one of your classes, thus removing the need
            to couple your application to a specific remoting implementation and also reducing the amount of code you need to write for your application. We discuss remote support in Spring in Chapter <span class="ExternalRef"><a href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_12_Chapter.html"><span class="RefSource">12</span></a>
            </span>.</div>
    </div>
    <div class="Section3 RenderAsSection3" id="Sec17">
        <h4 class="Heading"> <span id="ITerm56">Mail Support                          </span> </h4>
        <div class="Para" id="Par172">Sending e-mail is a typical requirement for many kinds of applications and is given first-class treatment within the Spring Framework. Spring provides a simplified API for sending e-mail messages that fits nicely with the Spring DI capabilities.
            Spring supports the standard JavaMail API. Spring provides the ability to create a prototype message in the DI container and uses this as the base for all messages sent from your application. This allows for easy customization of mail parameters
            such as the subject and sender address. In addition, for customizing the message body, Spring integrates with template engines, such as Apache Velocity; this allows the mail content to be externalized from the Java code.</div>
    </div>
    <div class="Section3 RenderAsSection3" id="Sec18">
        <h4 class="Heading"> <span id="ITerm57">Job Scheduling Support                          </span> </h4>
        <div class="Para" id="Par173">Most nontrivial applications require some kind of scheduling capability. Whether this is for sending updates to customers or performing housekeeping tasks, the ability to schedule code to run at a predefined time is an invaluable tool for developers.
            Spring provides scheduling support that can fulfill most common scenarios. A task can be scheduled either for a fixed interval or by using a Unix cron expression. On the other hand, for task execution and scheduling, Spring integrates with
            other scheduling libraries as well. For example, in the application server environment, Spring can delegate execution to the CommonJ library that is used by many application servers. For job scheduling, Spring also supports libraries including
            the JDK Timer API and Quartz, a commonly used open source scheduling library. The scheduling support in Spring is covered in full in Chapter <span class="ExternalRef"><a href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_11_Chapter.html"><span class="RefSource">11</span></a>
            </span>.</div>
    </div>
    <div class="Section3 RenderAsSection3" id="Sec19">
        <h4 class="Heading"> <span id="ITerm58">Dynamic Scripting Support                          </span> </h4>
        <div class="Para" id="Par174">Starting with JDK 6, Java introduced dynamic language support, in which you can execute scripts written in other languages in a JVM environment. Examples include Groovy, JRuby, and JavaScript. Spring also supports the execution of dynamic scripts
            in a Spring-powered application, or you can define a Spring bean that was written in a dynamic scripting language and injected into other JavaBeans. Spring-supported dynamic scripting languages include Groovy, JRuby, and BeanShell. In Chapter
            <span class="ExternalRef"><a href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_14_Chapter.html"><span class="RefSource">14</span></a>
            </span>, we discuss the support of dynamic scripting in Spring in detail.</div>
    </div>
    <div class="Section3 RenderAsSection3" id="Sec20">
        <h4 class="Heading"> <span id="ITerm59">Simplified Exception Handling                          </span> </h4>
        <div class="Para" id="Par175">One area where Spring really helps reduce the amount of repetitive, boilerplate code you need to write is in exception handling. The core of the Spring philosophy in this respect is that checked exceptions are overused in Java and that a framework
            should not force you to catch any exception from which you are unlikely to be able to recover—a point of view that we agree with wholeheartedly. In reality, many frameworks are designed to reduce the impact of having to write code to handle
            checked exceptions. However, many of these frameworks take the approach of sticking with checked exceptions but artificially reducing the granularity of the exception class hierarchy. One thing you will notice with Spring is that because of
            the convenience afforded to the developer from using unchecked exceptions, the exception hierarchy is remarkably granular. Throughout the book, you will see examples in which the Spring exception-handling mechanisms can reduce the amount of
            code you have to write and, at the same time, improve your ability to identify, classify, and diagnose errors within your application.</div>
    </div>
    </div>
    </div>
    <div class="Section1 RenderAsSection1" id="Sec21">
        <h2 class="Heading">The Spring Project</h2>
        <div class="Para" id="Par176">One of the most endearing things about the Spring project is the level of activity present in the community and the amount of cross-pollination between Spring and other projects such as CGLIB, Apache Geronimo, and AspectJ. One of the most touted
            benefits of open source is that if the project folded tomorrow, you would be left with the code; but let’s face it—you do not want to be left with a codebase the size of Spring to support and improve. For this reason, it is comforting to know
            how well established and active the Spring community is.</div>
        <div class="Section2 RenderAsSection2" id="Sec22">
            <h3 class="Heading"> <span id="ITerm60">Origins of Spring                      </span> </h3>
            <div class="Para ParaOneEmphasisChild" id="Par177">As noted earlier in this chapter, the origins of Spring can be traced back to <span class="EmphasisTypeItalic">Expert One-to-One: J2EE Design and Development</span>. In this book, Rod Johnson presented his own framework, called the Interface
                21 Framework, which he developed to use in his own applications. Released into the open source world, this framework formed the foundation of the Spring Framework as we know it today. Spring proceeded quickly through the early beta and
                release candidate stages, and the first official 1.0 release was made available in March 2004. Since then, Spring has undergone dramatic growth, and at the time of this writing, the latest major version of Spring Framework is 5.0.</div>
        </div>
        <div class="Section2 RenderAsSection2" id="Sec23">
            <h3 class="Heading">The Spring Community</h3>
            <div class="Para" id="Par178">The Spring <span id="ITerm61">community                      </span> is one of the best in any open source project we have encountered. The mailing lists and forums are always active, and progress on new features is usually rapid. The development
                team is truly dedicated to making Spring the most successful of all the Java application frameworks, and this shows in the quality of the code that is reproduced. As we mentioned already, Spring also benefits from excellent relationships
                with other open source projects, a fact that is extremely beneficial when you consider the large amount of dependency the full Spring distribution has. From a user’s perspective, perhaps one of the best features of Spring is the excellent
                documentation and test suite that accompany the distribution. Documentation is provided for almost all the features of Spring, making it easy for new users to pick up the framework. The test suite Spring provides is impressively comprehensive—the
                development team writes tests for everything. If they discover a bug, they fix that bug by first writing a test that highlights the bug and then getting the test to pass. Fixing bugs and creating new features is not limited just to the
                development team! You can contribute code through pull requests against any portfolio of Spring projects through the official GitHub repositories (<span class="ExternalRef"><a href="http://github.com/spring-projects"><span class="RefSource">                  <span class="EmphasisFontCategoryNonProportional">http://github.com/spring-projects</span>                </span>
                </a>
                </span>). Additionally, issues can be created and tracked by way of the official Spring JIRA (<span class="ExternalRef"><a href="https://jira.spring.io/secure/Dashboard.jspa"><span class="RefSource">                  <span class="EmphasisFontCategoryNonProportional">https://jira.spring.io/secure/Dashboard.jspa</span>                </span>
                </a>
                </span>). What does all this mean to you? Well, put simply, it means you can be confident in the quality of the Spring Framework and confident that, for the foreseeable future, the Spring development team will continue to improve what is already
                an excellent framework.</div>
        </div>
        <div class="Section2 RenderAsSection2" id="Sec24">
            <h3 class="Heading">The Spring Tool Suite</h3>
            <div class="Para" id="Par179">To ease the development of Spring-based applications in Eclipse, Spring created the Spring IDE project. Soon after that, SpringSource, the company behind Spring founded by Rod Johnson, created an integrated tool called the <span id="ITerm62">Spring Tool Suite (STS)          </span>                <span id="ITerm63">                                              </span>, which can be downloaded from <span class="ExternalRef"><a href="https://spring.io/tools"><span class="RefSource">                  <span class="EmphasisFontCategoryNonProportional">https://spring.io/tools</span>                </span>
                </a>
                </span>. Although it used to be a paid-for product, the tool is now freely available. The tool integrates the Eclipse IDE, Spring IDE, Mylyn (a task-based development environment in Eclipse), Maven for Eclipse, AspectJ Development Tools, and
                many other useful Eclipse plug-ins into a single package. In each new version, more features are being added, such as Groovy scripting language support, a graphical Spring configuration editor, visual development tools for projects such
                as Spring Batch and Spring Integration, and support for the Pivotal tc Server application server.</div>
            <div class="Para ParaTypeImportant" id="Par180"> <img alt="A315511_5_En_1_Figa_HTML.jpg" data-mfp-src="/library/view/pro-spring-5/9781484228081/A315511_5_En_1_Figa_HTML.jpg" height="28" src="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_1_Figa_HTML.jpg" width="30"/>                SpringSource was bought by VMware and incorporated into Pivotal Software.</div>
            <div class="Para" id="Par181">In addition to the Java-based suite, a Groovy/Grails Tool Suite is available with similar capabilities but targeted at Groovy and Grails development (<span class="ExternalRef"><a href="http://spring.io/tools"><span class="RefSource">                  <span class="EmphasisFontCategoryNonProportional">http://spring.io/tools</span>                </span>
                </a>
                </span>).</div>
        </div>
        <div class="Section2 RenderAsSection2" id="Sec25">
            <h3 class="Heading">The Spring Security Project</h3>
            <div class="Para" id="Par182">The <span id="ITerm64">Spring Security project          </span> <span id="ITerm65">                                              </span> (<span class="ExternalRef"><a href="http://projects.spring.io/spring-security"><span class="RefSource">                  <span class="EmphasisFontCategoryNonProportional">http://projects.spring.io/spring-security</span>                </span>
                </a>
                </span>), formerly known as the Acegi Security System for Spring, is another important project within the Spring portfolio. Spring Security provides comprehensive support for both web application and method-level security. It tightly integrates
                with the Spring Framework and other commonly used authentication mechanisms, such as HTTP basic authentication, form-based login, X.509 certificate, and single sign-on (SSO) products (for example, CA SiteMinder). It provides role-based
                access control to application resources, and in applications with more-complicated security requirements (for example, data segregations), use of an access control list (ACL) is supported. However, Spring Security is mostly used in securing
                web applications, which we discuss in detail in Chapter <span class="ExternalRef"><a href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_16_Chapter.html"><span class="RefSource">16</span></a>
                </span>.</div>
        </div>
        <div class="Section2 RenderAsSection2" id="Sec26">
            <h3 class="Heading"> <span id="ITerm66">Spring Boot          </span> <span id="ITerm67">                                              </span> </h3>
            <div class="Para" id="Par183">Setting up the basis of an application is a cumbersome job. Configuration files for the project must be created, and additional tools (like an application server) must be installed and configured. Spring Boot (<span class="ExternalRef"><a href="http://projects.spring.io/spring-boot/"><span class="RefSource">                  <span class="EmphasisFontCategoryNonProportional">http://projects.spring.io/spring-boot/</span>                </span>
                </a>
                </span>) is a Spring project that makes it easy to create stand-alone, production-grade Spring-based applications that you can just run. Spring Boot comes with out-of-the-box configurations for different types of Spring applications that are
                packed in <span class="EmphasisTypeItalic">starter</span> packages. The <span class="EmphasisFontCategoryNonProportional">web-starter</span> package, for example, contains a preconfigured and easily customizable web application context
                and supports Tomcat 7+, Jetty 8+, and Undertow 1.3 embedded servlet containers out of the box.</div>
            <div class="Para" id="Par184">Spring Boot also wraps up all dependencies a Spring application needs, taking into account compatibility between versions. At the time of writing, the current version of Spring Boot is 2.0.0.RELEASE.</div>
            <div class="Para" id="Par185">Spring Boot is covered in Chapter <span class="ExternalRef"><a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_4_Chapter.html"><span class="RefSource">4</span></a>
                </span>, as an alternative Spring project configuration, and most of the projects assigned to later chapters will be run using Spring Boot because it makes development and testing more practical and faster.</div>
        </div>
        <div class="Section2 RenderAsSection2" id="Sec27">
            <h3 class="Heading"> <span id="ITerm68">Spring Batch and Integration                      </span> </h3>
            <div class="Para" id="Par186">Needless to say, batch job execution and integration are common use cases in applications. To cope with this need and to make it easy for developers in these areas, Spring created the Spring Batch and Spring Integration projects. Spring Batch
                provides a common framework and various policies for batch job implementation, reducing a lot of boilerplate code. By implementing the <span id="ITerm69">Enterprise Integration Patterns (EIP)          </span>, Spring Integration can make
                integrating Spring applications with external systems easy. We discuss the details in Chapter <span class="ExternalRef"><a href="https://doi.org/10.1007/978-1-4842-2808-1_20"><span class="RefSource">20</span></a>
                </span>.</div>
        </div>
        <div class="Section2 RenderAsSection2" id="Sec28">
            <h3 class="Heading">Many Other Projects</h3>
            <div class="Para" id="Par187">We’ve covered the core modules of Spring and some of the major projects within the Spring portfolio, but there are many other projects that have been driven by the need of the community for different requirements. Some examples include Spring
                Boot, Spring XD, Spring for Android, Spring Mobile, Spring Social, and Spring AMQP. Some of these projects are discussed further in Chapter <span class="ExternalRef"><a href="https://doi.org/10.1007/978-1-4842-2808-1_20"><span class="RefSource">20</span></a>
                </span>. For additional details, you can refer to the Spring by Pivotal web site (<span class="ExternalRef"><a href="http://www.spring.io/projects"><span class="RefSource">                  <span class="EmphasisFontCategoryNonProportional">www.spring.io/projects</span>                </span>
                </a>
                </span>).</div>
        </div>
    </div>
    <div class="Section1 RenderAsSection1" id="Sec29">
        <h2 class="Heading">Alternatives to Spring</h2>
        <div class="Para" id="Par188">Going back to our previous comments on the number of open source projects, you should not be surprised to learn that Spring is not the only framework offering dependency injection features or full end-to-end solutions for building applications.
            In fact, there are almost too many projects to mention. In the spirit of being open, we include a brief discussion of several of these frameworks here, but it is our belief that none of these platforms offers quite as comprehensive a solution
            as that available in Spring.</div>
        <div class="Section2 RenderAsSection2" id="Sec30">
            <h3 class="Heading"> <span id="ITerm70">JBoss Seam Framework                      </span> </h3>
            <div class="Para" id="Par189">Founded by Gavin King (the creator of the Hibernate ORM library), the Seam Framework (<span class="ExternalRef"><a href="http://seamframework.org/"><span class="RefSource">                  <span class="EmphasisFontCategoryNonProportional">http://seamframework.org</span>                </span>
                </a>
                </span>) is another full-blown DI-based framework. It supports web application front-end development (JSF), business logic layer (EJB 3), and JPA for persistence. As you can see, the main difference between Seam and Spring is that the Seam Framework
                is built entirely on JEE standards. JBoss also contributes the ideas in the Seam Framework back to the JCP and has become JSR-299 (Contexts and Dependency Injection for the Java EE Platform).</div>
        </div>
        <div class="Section2 RenderAsSection2" id="Sec31">
            <h3 class="Heading">Google Guice</h3>
            <div class="Para" id="Par190">Another popular DI framework is <span id="ITerm71">Google Guice                      </span> (<span class="ExternalRef"><a href="http://code.google.com/p/google-guice"><span class="RefSource">                  <span class="EmphasisFontCategoryNonProportional">http://code.google.com/p/google-guice</span>                </span>
                </a>
                </span>). Led by the search engine giant Google, Guice is a lightweight framework that focuses on providing DI for application configuration management. It was also the reference implementation of JSR-330 (Dependency Injection for Java).</div>
        </div>
        <div class="Section2 RenderAsSection2" id="Sec32">
            <h3 class="Heading">PicoContainer</h3>
            <div class="Para" id="Par191"> <span id="ITerm72">PicoContainer          </span> <span id="ITerm73">                                              </span> (<span class="ExternalRef"><a href="http://picocontainer.com/"><span class="RefSource">                  <span class="EmphasisFontCategoryNonProportional">http://picocontainer.com</span>                </span>
                </a>
                </span>) is an exceptionally small DI container that allows you to use DI for your application without introducing any dependencies other than PicoContainer. Because PicoContainer is nothing more than a DI container, you may find that as your
                application grows, you need to introduce another <span id="ITerm74">framework          </span> <span id="ITerm75">                                              </span>, such as Spring, in which case you would have been better off using
                Spring from the start. However, if all you need is a tiny DI container, then PicoContainer is a good choice, but since Spring packages the DI container separately from the rest of the framework, you can just as easily use that and keep
                the flexibility for the future.</div>
        </div>
        <div class="Section2 RenderAsSection2" id="Sec33">
            <h3 class="Heading"> <span id="ITerm76">JEE 7 Container          </span> <span id="ITerm77">                                              </span> <a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_1_Chapter.html#Fn7" id="Fn7_source"><sup>7</sup></a> </h3>
            <div class="Para" id="Par193">As discussed previously, the concept of DI was widely adopted and also realized by JCP. When you are developing an application for application servers compliant with JEE 7 (JSR-342), you can use standard DI techniques across all layers.</div>
        </div>
    </div>
    <div class="Section1 RenderAsSection1" id="Sec34">
        <h2 class="Heading">Summary</h2>
        <div class="Para" id="Par194">In this chapter, we gave you a high-level view of the Spring Framework, complete with discussions of all the major features, and we guided you to the relevant sections of the book where these features are discussed in detail. After reading this
            chapter, you should understand what Spring can do for you; all that remains is to see <span class="EmphasisTypeItalic">how</span> it can do it. In the next chapter, we discuss all the information you need to know to get up and running with
            a basic Spring application. We show you how to obtain the Spring Framework and discuss the packaging options, the test suite, and the documentation. Also, Chapter <span class="ExternalRef"><a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_2_Chapter.html"><span class="RefSource">2</span></a>
            </span>
            introduces some basic Spring code, including a time-honored Hello World example in all its DI-based glory.</div>
    </div>
    <div class="FootnoteSection">
        <div class="Heading">Footnotes</div>
        <div class="Footnote" id="Fn1"><span class="FootnoteNumber"><a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_1_Chapter.html#Fn1_source">1</a></span>
            <div class="FootnoteParas">
                <div class="Para" id="Par11">You can download older versions of Spring including 0.9 from the SourceForge site: <span class="ExternalRef"><a href="https://sourceforge.net/projects/springframework/files/springframework/"><span class="RefSource">                            <span class="EmphasisFontCategoryNonProportional">https://sourceforge.net/projects/springframework/files/springframework/</span>                    </span>
                    </a>
                    </span>.</div>
            </div>
            <div class="ClearBoth"> </div>
        </div>
        <div class="Footnote" id="Fn2"><span class="FootnoteNumber"><a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_1_Chapter.html#Fn2_source">2</a></span>
            <div class="FootnoteParas">
                <div class="Para" id="Par108">Keep in mind that Java 9 will be released officially to the public in September 2017, according to the Oracle schedule available at <span class="ExternalRef"><a href="http://openjdk.java.net/projects/jdk9/"><span class="RefSource">                            <span class="EmphasisFontCategoryNonProportional">http://openjdk.java.net/projects/jdk9/</span>                    </span>
                    </a>
                    </span>.</div>
            </div>
            <div class="ClearBoth"> </div>
        </div>
        <div class="Footnote" id="Fn3"><span class="FootnoteNumber"><a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_1_Chapter.html#Fn3_source">3</a></span>
            <div class="FootnoteParas">
                <div class="Para" id="Par117">Project Reactor implements the Reactive Streams API specification; see <span class="ExternalRef"><a href="https://projectreactor.io/"><span class="RefSource">                                  <span class="EmphasisFontCategoryNonProportional">https://projectreactor.io/</span>                    </span>
                    </a>
                    </span>.</div>
            </div>
            <div class="ClearBoth"> </div>
        </div>
        <div class="Footnote" id="Fn4"><span class="FootnoteNumber"><a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_1_Chapter.html#Fn4_source">4</a></span>
            <div class="FootnoteParas">
                <div class="Para" id="Par119">Reactive programming is a style of micro-architecture involving intelligent routing and consumption of events. This should lead to nonblocking applications that are asynchronous and event-driven and require a small number of threads to
                    scale vertically within the JVM, rather than horizontally through clustering.</div>
            </div>
            <div class="ClearBoth"> </div>
        </div>
    </div>
    </div>
    </div>
    </div>
    </section>
    </div>
    </div>
    <div class="font-flyout" style="top: 201.028px; left: 1280px;"></div>



<hr/>
<!--if IE]><![endif]-->

<!--if IE 8]><html class="no-js ie8 oldie" lang="en" prefix="og: http://ogp.me/ns/# og:book: http://ogp.me/ns/book# og:video: http://ogp.me/ns/video#"            itemscope itemtype="http://schema.org/Book http://schema.org/ItemPage" data-login-url="/accounts/login/"data-offline-url="/"data-url="/library/view/pro-spring-5/9781484228081/A315511_5_En_2_Chapter.html"data-csrf-cookie="csrfsafari"data-highlight-privacy=""  data-user-id="3866890"  data-user-uuid="72b95c3c-5b13-4319-82fa-5c73754754ca"  data-username="levinxccai"  data-account-type="B2B"    data-activated-trial-date="11/06/2017"  data-archive="9781484228081"  data-publishers="Apress"  data-htmlfile-name="A315511_5_En_2_Chapter.html"  data-epub-title="Pro Spring 5: An In-Depth Guide to the Spring Framework and Its Tools" data-debug=0 data-testing=0><![endif]-->
<!--if gt IE 8]><!-->

<!--![endif]-->




<a name="2_"></a>

    <div class="application" id="container" style="height: auto;">
        <div class="js-toc">
            <section role="document">
                <div id="sbo-rt-content" style="max-width:72.5em; transform: none;">
                    <div class="annotator-wrapper">
                        <!--egin Abstract-->
                        <div class="MainTitleSection">
                            <h1 class="ChapterTitle" xml:lang="en">2. Getting Started</h1>
                        </div>
                        <div class="AuthorGroup">
                            <div class="AuthorNames"><span class="Author"><span class="AuthorName">Iuliana Cosmina</span><sup>1 <span class="ContactIcon"></span></sup>, </span><span class="Author"><span class="AuthorName">Rob Harrop</span><sup>2</sup>, </span>
                                <span class="Author"><span class="AuthorName">Chris Schaefer</span><sup>3</sup> and </span><span class="Author"><span class="AuthorName">Clarence Ho</span><sup>4</sup></span>
                            </div>
                            <div class="Affiliations">
                                <div class="Affiliation" id="Aff5"><span class="AffiliationNumber">(1)</span>
                                    <div class="AffiliationText">Sibiu, Sibiu, Romania</div>
                                </div>
                                <div class="Affiliation" id="Aff6"><span class="AffiliationNumber">(2)</span>
                                    <div class="AffiliationText">Reddish, UK</div>
                                </div>
                                <div class="Affiliation" id="Aff7"><span class="AffiliationNumber">(3)</span>
                                    <div class="AffiliationText">Venice, Florida, USA</div>
                                </div>
                                <div class="Affiliation" id="Aff8"><span class="AffiliationNumber">(4)</span>
                                    <div class="AffiliationText">Hong Kong, China</div>
                                </div>
                                <div class="ClearBoth"> </div>
                            </div>
                        </div>
                        <!--nd Abstract-->
                        <div class="Fulltext">
                            <div class="Para" id="Par1">Often the hardest part of learning to use any new development tool is figuring out where to begin. Typically, this problem is worse when the tool offers as many choices as Spring. Fortunately, getting started with Spring isn’t
                                that hard if you know where to look first. In this chapter, we present you with all the basic knowledge you need to get off to a flying start. Specifically, you will look at the following:
                                <div class="UnorderedList">
                                    <ul class="UnorderedListMarkBullet">
                                        <li>
                                            <div class="Para" id="Par2"> <span class="EmphasisTypeItalic">Obtaining Spring</span>: The first logical step is to obtain or build the Spring <span id="ITerm1">JAR files                          </span>. If you want to get up and running
                                                quickly, simply use the dependency management snippets in your build system with the examples provided at <span class="ExternalRef"><a href="http://projects.spring.io/spring-framework"><span class="RefSource">                    <span class="EmphasisFontCategoryNonProportional">http://projects.spring.io/spring-framework</span>                                                </span>
                                                </a>
                                                </span>. However, if you want to be on the cutting edge of Spring development, check out the latest version of the source code from Spring’s GitHub repository.<a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_2_Chapter.html#Fn1" id="Fn1_source"><sup>1</sup></a> </div>
                                        </li>
                                        <li>
                                            <div class="Para" id="Par4"> <span class="EmphasisTypeItalic">Spring</span> <span id="ITerm2">                  <span class="EmphasisTypeItalic">packaging options</span> </span>: Spring packaging is modular; it allows you to pick and choose
                                                which components you want to use in your application and to include only those components when you are distributing your application. Spring has many modules, but you need only a subset of these modules
                                                depending on your application’s needs. Each module has its compiled binary code in a JAR file along with corresponding Javadoc and source JARs.</div>
                                        </li>
                                        <li>
                                            <div class="Para" id="Par5"> <span class="EmphasisTypeItalic">Spring</span> <span id="ITerm3">                  <span class="EmphasisTypeItalic">guides</span> </span>: The new Spring web site includes a Guides section located at <span class="ExternalRef"><a href="http://spring.io/guides"><span class="RefSource">                    <span class="EmphasisFontCategoryNonProportional">http://spring.io/guides</span>                                                </span>
                                                </a>
                                                </span>. The guides are meant to be quick, hands-on instructions for building the Hello World version of any development task with Spring. These guides also reflect the latest Spring project releases and techniques,
                                                providing you with the most up-to-date samples available.</div>
                                        </li>
                                        <li>
                                            <div class="Para" id="Par6"> <span id="ITerm4">                  <span class="EmphasisTypeItalic">Test suite and documentation</span> </span>: One of the things members of the Spring community are most proud of is their comprehensive test
                                                suite and documentation set. Testing is a big part of what the team does. The documentation set provided with the standard distribution is also excellent.</div>
                                        </li>
                                        <li>
                                            <div class="Para" id="Par7"> <span class="EmphasisTypeItalic">Putting some Spring into Hello World</span>: All bad punning aside, we think the best way to get started with any new programming tool is to dive right in and write some code.
                                                We present a simple example, which is a full DI-based implementation of everyone’s favorite <span id="ITerm5">Hello World application                          </span>. Don’t be alarmed if you don’t understand
                                                all the code right away; full discussions follow later in the book.</div>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                            <div class="Para" id="Par8">If you are already familiar with the basics of the Spring Framework, feel free to proceed straight to Chapter <span class="ExternalRef"><a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_3_Chapter.html"><span class="RefSource">3</span></a>
                                </span>
                                to dive into IoC and DI in Spring. However, even if you are familiar with the basics of Spring, you may find some of the discussions in this chapter interesting, especially those on packaging and dependencies.</div>
                            <div class="Section1 RenderAsSection1" id="Sec1">
                                <h2 class="Heading">Obtaining the Spring Framework</h2>
                                <div class="Para" id="Par9">Before you can get started with any Spring development, you need to obtain the Spring libraries. You have a couple of options for retrieving the libraries: you can use your build system to bring in the modules you want
                                    to use, or you can check out and build the code from the <span id="ITerm6">Spring GitHub repository                  </span>. Using a dependency management tool such as Maven or Gradle is often the most straightforward
                                    approach; all you need to do is declare the dependency in the configuration file and let the tool obtain the required libraries for you.</div>
                                <div class="Para ParaTypeImportant" id="Par10"><img alt="A315511_5_En_2_Figa_HTML.jpg" data-mfp-src="/library/view/pro-spring-5/9781484228081/A315511_5_En_2_Figa_HTML.jpg" height="28" src="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_2_Figa_HTML.jpg" width="30"/>                                    If you have an Internet connection and use a build tool such as Maven or Gradle in combination with a smart IDE like Eclipse or IntelliJ IDEA, you can download the Javadoc and libraries automatically so you can access
                                    them during development. When you upgrade the versions in the build configuration files when building the project, the libraries and Javadoc will be updated too.</div>
                                <div class="Section2 RenderAsSection2" id="Sec2">
                                    <h3 class="Heading">Getting Started Quickly</h3>
                                    <div class="Para" id="Par11">Visit the Spring Framework project page<a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_2_Chapter.html#Fn2" id="Fn2_source"><sup>2</sup></a> to obtain
                                        a dependency management snippet for your build system to include the latest-release RELEASE version of Spring in your project. You can also use milestones/nightly snapshots for upcoming releases or previous versions.</div>
                                    <div class="Para" id="Par13">When using Spring Boot, there is no need to specify the Spring version you want to use, as Spring Boot provides opinionated “starter” <span id="ITerm7">project object model (POM) files          </span> to simplify your
                                        Maven configuration and default Gradle starter configuration. Just keep in mind that Spring Boot versions that precede version 2.0.0.RELEASE use Spring 4.<span class="EmphasisTypeItalic">x</span> versions.</div>
                        </div>
                        <div class="Section2 RenderAsSection2" id="Sec3">
                            <h3 class="Heading">Checking Spring Out of <span id="ITerm8">GitHub                      </span> </h3>
                            <div class="Para" id="Par14">If you want to learn about new features before they make their way even into the snapshots, you can check out the source code directly from Pivotal’s GitHub repository. To check out the latest version of the Spring code, first
                                install Git, which you can download from <span class="ExternalRef"><a href="http://git-scm.com/"><span class="RefSource">                  <span class="EmphasisFontCategoryNonProportional">http://git-scm.com</span> </span>
                                </a>
                                </span>. Then open a terminal shell and run the following command:</div>
                            <div class="Para" id="Par15">
                                <div class="ProgramCode" id="PC1">
                                    <div class="FixedLine">git clone git://github.com/spring-projects/spring-framework.git</div>
                                </div>
                            </div>
                            <div class="Para ParaOneEmphasisChild" id="Par16">See the <span class="EmphasisFontCategoryNonProportional">README.md</span> file in the project root for full details and requirements on how to build from source.</div>
                        </div>
                        <div class="Section2 RenderAsSection2" id="Sec4">
                            <h3 class="Heading">Using the Right <span id="ITerm9">JDK                      </span> </h3>
                            <div class="Para" id="Par17">The Spring Framework is built in Java, which means you need to be able to execute Java applications on your computer to use it. For this you need to install Java. There are three widely used Java acronyms when people talk about
                                Java applications development.
                                <div class="UnorderedList">
                                    <ul class="UnorderedListMarkBullet">
                                        <li>
                                            <div class="Para" id="Par18">A <span id="ITerm10">Java virtual machine (JVM)                </span> is an abstract machine. It is a specification that provides a runtime environment in which Java bytecode can be executed.</div>
                                        </li>
                                        <li>
                                            <div class="Para" id="Par19">The <span id="ITerm11">Java Runtime Environment (JRE)                </span> is used to provide a runtime environment. It is the implementation of the JVM that physically exists. It contains a set of libraries
                                                and other files that the JVM uses at runtime. Oracle bought Sun Microsystems in 2010; since then, new versions and patches have been actively provided. Other companies, such as IBM, provide their own implementations
                                                of the JVM.</div>
                                        </li>
                                        <li>
                                            <div class="Para" id="Par20">The <span id="ITerm12">Java Development Kit (JDK)                </span> <span id="ITerm13">                                                                </span> contains the JRE, documentation, and Java tools.
                                                This is what Java developers install on their machines. A smart editor like IntelliJ IDEA or Eclipse will require you to provide the location of the JDK so classes and documentation can be loaded and used
                                                during development.</div>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                            <div class="Para" id="Par21">If you are using a build tool like Maven or Gradle (the source code accompanying the book is organized in a Gradle multimodule project), it will require a JVM as well; Maven and Gradle are both Java-based projects themselves.</div>
                            <div class="Para" id="Par22">The latest stable Java version is Java 8, and Java 9 is scheduled to be released on 21 September 2017. You can download the JDK from <span class="ExternalRef"><a href="https://www.oracle.com/"><span class="RefSource">                  <span class="EmphasisFontCategoryNonProportional">https://www.oracle.com/</span>                                </span>
                                </a>
                                </span>. By default it will be installed in some default location on your computer, depending on your operating system. If you want to use Maven or Gradle from the command line, you need to define environment variables for the
                                JDK and Maven/Gradle and to add the path to their executables to the system path. You can find instructions on how to do this on the official site for each product and in the appendix of this book.</div>
                        <div class="Para" id="Par23">Chapter <span class="ExternalRef"><a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_1_Chapter.html"><span class="RefSource">1</span></a>
                            </span> presented a list with Spring versions and the required JDK version. The Spring version covered in the book is 5.0.<span class="EmphasisTypeItalic">x</span>. The source code presented in the book is written using Java 8 syntax,
                            so you need at least JDK version 8 to be able to compile and run the examples.</div>
                    </div>
                </div>
                <div class="Section1 RenderAsSection1" id="Sec5">
                    <h2 class="Heading">Understanding Spring Packaging</h2>
                    <div class="Para" id="Par24"> <span class="EmphasisTypeItalic">Spring modules</span> are simply <span id="ITerm14">JAR files                  </span> that package the required code for that module. After you understand the purpose of each module, you can select
                        the modules required in your project and include them in your code. As of Spring version 5.0.0.RELEASE, Spring comes with 21 modules, packaged into 21 JAR files. Table <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_2_Chapter.html#Tab1">2-1</a></span>                        describes these JAR files and their corresponding modules. The actual JAR file name is, for example, <span class="EmphasisFontCategoryNonProportional">spring-aop-5.0.0.RELEASE.jar</span>, though we have included only the specific
                        module portion for simplicity (as in <span class="EmphasisFontCategoryNonProportional">aop</span>, for example).
                        <div class="Table" id="Tab1">
                            <div class="Caption" xml:lang="en">
                                <div class="CaptionContent"><span class="CaptionNumber">Table 2-1.</span>
                                    <div class="SimplePara">Spring modules</div>
                                </div>
                            </div>
                            <table border="1">
                                <colgroup>
                                    <col>
                                    <col>
                                </colgroup>
                                <thead>
                                    <tr class="header">
                                        <th>
                                            <div class="SimplePara">Module</div>
                                        </th>
                                        <th>
                                            <div class="SimplePara">Description</div>
                                        </th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr class="noclass">
                                        <td>
                                            <div class="SimplePara"> <span class="EmphasisFontCategoryNonProportional">aop</span> </div>
                                        </td>
                                        <td>
                                            <div class="SimplePara">This module contains all the classes you need to use Spring’s AOP features within your application. You also need to include this JAR in your application if you plan to use other features in Spring that use
                                                AOP, such as declarative transaction management. Moreover, classes that support integration with AspectJ are packed in this module.</div>
                                        </td>
                                    </tr>
                                    <tr class="noclass">
                                        <td>
                                            <div class="SimplePara"> <span class="EmphasisFontCategoryNonProportional">aspects</span> </div>
                                        </td>
                                        <td>
                                            <div class="SimplePara">This module contains all the classes for advanced integration with the AspectJ AOP library. For example, if you are using Java classes for your Spring configuration and need AspectJ-style annotation-driven transaction
                                                management, you will need this module.</div>
                                        </td>
                                    </tr>
                                    <tr class="noclass">
                                        <td>
                                            <div class="SimplePara"> <span class="EmphasisFontCategoryNonProportional">beans</span> </div>
                                        </td>
                                        <td>
                                            <div class="SimplePara">This module contains all the classes for supporting Spring’s manipulation of Spring beans. Most of the classes here support Spring’s bean factory implementation. For example, the classes required for processing
                                                the Spring XML configuration file and Java annotations are packed into this module.</div>
                                        </td>
                                    </tr>
                                    <tr class="noclass">
                                        <td>
                                            <div class="SimplePara"> <span class="EmphasisFontCategoryNonProportional">beans-groovy</span> </div>
                                        </td>
                                        <td>
                                            <div class="SimplePara">This module contains Groovy classes for supporting Spring’s manipulation of Spring beans.</div>
                                        </td>
                                    </tr>
                                    <tr class="noclass">
                                        <td>
                                            <div class="SimplePara"> <span class="EmphasisFontCategoryNonProportional">context</span> </div>
                                        </td>
                                        <td>
                                            <div class="SimplePara">This module contains classes that provide many extensions to Spring Core. You will find that all classes need to use Spring’s <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> feature
                                                (covered in Chapter <span class="ExternalRef"><a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_5_Chapter.html"><span class="RefSource">5</span></a>
                                                </span>), along with classes for Enterprise JavaBeans (EJB), Java Naming and Directory Interface (JNDI), and Java Management Extensions (JMX) integration. Also contained in this module are the Spring remoting classes,
                                                classes for integration with dynamic scripting languages (for example, JRuby, Groovy, and BeanShell), JSR-303 (Bean Validation), scheduling and task execution, and so on.</div>
                                        </td>
                                    </tr>
                                    <tr class="noclass">
                                        <td>
                                            <div class="SimplePara"> <span id="ITerm15">                          <span class="EmphasisFontCategoryNonProportional">context</span> </span> <span class="EmphasisFontCategoryNonProportional">-indexer</span> </div>
                                        </td>
                                        <td>
                                            <div class="SimplePara">This module contains an indexer implementation that provides access to the candidates that are defined in <span class="EmphasisFontCategoryNonProportional">META-INF/spring.components</span>. The core class
                                                <span class="EmphasisFontCategoryNonProportional">CandidateComponentsIndex</span> is not meant to be used externally.</div>
                                        </td>
                                    </tr>
                                    <tr class="noclass">
                                        <td>
                                            <div class="SimplePara"> <span class="EmphasisFontCategoryNonProportional">context-support</span> </div>
                                        </td>
                                        <td>
                                            <div class="SimplePara">This module contains further extensions to the <span class="EmphasisFontCategoryNonProportional">spring-context</span> module. On the user-interface side, there are classes for mail support and integration with
                                                templating engines such as Velocity, FreeMarker, and JasperReports. Also, integration with various task execution and scheduling libraries including CommonJ and Quartz are packaged here.</div>
                                        </td>
                                    </tr>
                                    <tr class="noclass">
                                        <td>
                                            <div class="SimplePara"> <span class="EmphasisFontCategoryNonProportional">core</span> </div>
                                        </td>
                                        <td>
                                            <div class="SimplePara">This is the main module that you will need for every Spring application. In this JAR file, you will find all the classes that are shared among all other Spring modules (for example, classes for accessing configuration
                                                files). Also, in this JAR, you will find selections of extremely useful utility classes that are used throughout the Spring codebase and that you can use in your own application.</div>
                                        </td>
                                    </tr>
                                    <tr class="noclass">
                                        <td>
                                            <div class="SimplePara"> <span class="EmphasisFontCategoryNonProportional">expression</span> </div>
                                        </td>
                                        <td>
                                            <div class="SimplePara">This module contains all support classes for Spring Expression Language (SpEL).</div>
                                        </td>
                                    </tr>
                                    <tr class="noclass">
                                        <td>
                                            <div class="SimplePara"> <span class="EmphasisFontCategoryNonProportional">instrument</span> </div>
                                        </td>
                                        <td>
                                            <div class="SimplePara">This module includes Spring’s instrumentation agent for JVM bootstrapping. This JAR file is required for using load-time weaving with AspectJ in a Spring application.</div>
                                        </td>
                                    </tr>
                                    <tr class="noclass">
                                        <td>
                                            <div class="SimplePara"> <span class="EmphasisFontCategoryNonProportional">dbc</span> </div>
                                        </td>
                                        <td>
                                            <div class="SimplePara">This module includes all classes for JDBC support. You will need this module for all applications that require database access. Classes for supporting data sources, JDBC data types, JDBC templates, native JDBC
                                                connections, and so on, are packed in this module.</div>
                                        </td>
                                    </tr>
                                    <tr class="noclass">
                                        <td>
                                            <div class="SimplePara"> <span class="EmphasisFontCategoryNonProportional">jms</span> </div>
                                        </td>
                                        <td>
                                            <div class="SimplePara">This module includes all classes for JMS support.</div>
                                        </td>
                                    </tr>
                                    <tr class="noclass">
                                        <td>
                                            <div class="SimplePara"> <span class="EmphasisFontCategoryNonProportional">messaging</span> </div>
                                        </td>
                                        <td>
                                            <div class="SimplePara">This module contains key abstractions taken from the Spring Integration project to serve as a foundation for message-based applications and adds support for STOMP messages.</div>
                                        </td>
                                    </tr>
                                    <tr class="noclass">
                                        <td>
                                            <div class="SimplePara"> <span class="EmphasisFontCategoryNonProportional">orm</span> </div>
                                        </td>
                                        <td>
                                            <div class="SimplePara">This module extends Spring’s standard JDBC feature set with support for popular ORM tools including Hibernate, JDO, JPA, and the data mapper iBATIS. Many of the classes in this JAR depend on classes contained
                                                in the <span class="EmphasisFontCategoryNonProportional">spring-jdbc</span> JAR file, so you definitely need to include that in your application as well.</div>
                                        </td>
                                    </tr>
                                    <tr class="noclass">
                                        <td>
                                            <div class="SimplePara"> <span class="EmphasisFontCategoryNonProportional">oxm</span> </div>
                                        </td>
                                        <td>
                                            <div class="SimplePara">This module provides support for <span id="ITerm16">Object/XML Mapping (OXM)                    </span>. Classes for the abstraction of XML marshalling and unmarshalling and support for popular tools such as
                                                Castor, JAXB, XMLBeans, and XStream are packed into this module.</div>
                                        </td>
                                    </tr>
                                    <tr class="noclass">
                                        <td>
                                            <div class="SimplePara"> <span class="EmphasisFontCategoryNonProportional">test</span> </div>
                                        </td>
                                        <td>
                                            <div class="SimplePara">Spring provides a set of mock classes to aid in testing your applications, and many of these mock classes are used within the Spring test suite, so they are well tested and make testing your applications much
                                                simpler. Certainly we have found great use for the mock <span class="EmphasisFontCategoryNonProportional">HttpServletRequest</span> and <span class="EmphasisFontCategoryNonProportional">HttpServletResponse</span>                                                classes in unit tests for our web applications. On the other hand, Spring provides a tight integration with the JUnit unit-testing framework, and many classes that support the development of JUnit test cases
                                                are provided in this module; for example, <span class="EmphasisFontCategoryNonProportional">SpringJUnit4ClassRunner</span> provides a simple way to bootstrap the Spring <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>                                                in a unit test environment.</div>
                                        </td>
                                    </tr>
                                    <tr class="noclass">
                                        <td>
                                            <div class="SimplePara"> <span class="EmphasisFontCategoryNonProportional">tx</span> </div>
                                        </td>
                                        <td>
                                            <div class="SimplePara">This module provides all classes for supporting Spring’s transaction infrastructure. You will find classes from the transaction abstraction layer to support the Java Transaction API (JTA) and integration with
                                                application servers from major vendors.</div>
                                        </td>
                                    </tr>
                                    <tr class="noclass">
                                        <td>
                                            <div class="SimplePara"> <span class="EmphasisFontCategoryNonProportional">web</span> </div>
                                        </td>
                                        <td>
                                            <div class="SimplePara">This module contains the core classes for using Spring in your web applications, including classes for loading an <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> feature automatically,
                                                file upload support classes, and a bunch of useful classes for performing repetitive tasks such as parsing integer values from the query string.</div>
                                        </td>
                                    </tr>
                                    <tr class="noclass">
                                        <td>
                                            <div class="SimplePara"> <span class="EmphasisFontCategoryNonProportional">web-reactive</span> </div>
                                        </td>
                                        <td>
                                            <div class="SimplePara">This module contains core interfaces and classes for Spring Web Reactive model.</div>
                                        </td>
                                    </tr>
                                    <tr class="noclass">
                                        <td>
                                            <div class="SimplePara"> <span class="EmphasisFontCategoryNonProportional">web-</span> <span id="ITerm17">                          <span class="EmphasisFontCategoryNonProportional">mvc</span> </span>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="SimplePara">This module contains all the classes for Spring’s own MVC framework. If you are using a separate MVC framework for your application, you won’t need any of the classes from this JAR file. Spring MVC is covered
                                                in more detail in Chapter <span class="ExternalRef"><a href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_16_Chapter.html"><span class="RefSource">16</span></a>
                                                </span>.</div>
                                        </td>
                                    </tr>
                                    <tr class="noclass">
                                        <td>
                                            <div class="SimplePara"> <span class="EmphasisFontCategoryNonProportional">websocket</span> </div>
                                        </td>
                                        <td>
                                            <div class="SimplePara">This module provides support for JSR-356 (Java API for WebSocket).</div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="Section2 RenderAsSection2" id="Sec6">
                        <h3 class="Heading">Choosing Modules for Your <span id="ITerm18">Application                      </span> </h3>
                        <div class="Para" id="Par25">Without a dependency management tool such as Maven or Gradle, choosing which modules to use in your application may be a bit tricky. For example, if you require Spring’s bean factory and DI support only, you still need several
                            modules including <span class="EmphasisFontCategoryNonProportional">spring-core</span>, <span class="EmphasisFontCategoryNonProportional">spring-beans</span>, <span class="EmphasisFontCategoryNonProportional">spring-context</span>,
                            and <span class="EmphasisFontCategoryNonProportional">spring-aop</span>. If you need Spring’s web application support, you then need to further add <span class="EmphasisFontCategoryNonProportional">spring-web</span> and so
                            on. Thanks to build tool features such as Maven’s transitive dependencies support, all required third-party libraries would be included automatically.</div>
                    </div>
                    <div class="Section2 RenderAsSection2" id="Sec7">
                        <h3 class="Heading">Accessing Spring Modules on the <span id="ITerm19">Maven Repository                      </span> </h3>
                        <div class="Para" id="Par26">Founded by Apache Software Foundation, Maven<a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_2_Chapter.html#Fn3" id="Fn3_source"><sup>3</sup></a> has become one of
                            the most popular tools in managing the dependencies for Java applications, from open source to enterprise environments. Maven is a powerful application building, packaging, and dependency management tool. It manages the entire
                            build cycle of an application, from resource processing and compiling to testing and packaging. There also exists a large number of Maven plug-ins for various tasks, such as updating databases and deploying a packaged application
                            to a specific server (for example, Tomcat, JBoss, or WebSphere). As of this writing, the current Maven version is 3.3.9.</div>
                        <div class="Para" id="Par97">Almost all open source projects support distribution of libraries via the Maven repository. The most popular one is the Maven Central repository hosted on Apache, and you can access and search for the existence and related information
                            of an artifact on the Maven Central web site.<a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_2_Chapter.html#Fn4" id="Fn4_source"><sup>4</sup></a> If you download
                            and install Maven into your development machine, you automatically gain access to the Maven Central repository. Some other open source communities (for example, JBoss and Spring by Pivotal) also provide their own Maven repository
                            for their users. However, to be able to access those repositories, you need to add the repository into your Maven’s setting file or in your project’s POM file.</div>
                        <div class="Para" id="Par30">A detailed discussion of <span id="ITerm20">Maven                      </span> is not in the scope of this book, and you can always refer to the online documentation or books that give you a detailed reference to Maven. However,
                            since Maven is widely adopted, it’s worth mentioning the typical structure of the project packaging on the Maven repository.</div>
                        <div class="Para" id="Par31">A group ID, artifact ID, packaging type, and version identify each Maven artifact. For example, for log4j, the group ID is <span class="EmphasisFontCategoryNonProportional">log4j</span>, the artifact ID is <span class="EmphasisFontCategoryNonProportional">log4j</span>,
                            and the packaging type is <span class="EmphasisFontCategoryNonProportional">jar</span>. Under that, different versions are defined. For example, for version 1.2.12, the artifact’s file name becomes <span class="EmphasisFontCategoryNonProportional">log4j-1.2.17.jar</span>                            under the group ID, artifact ID, and version folder. Maven configuration files are written in XML and must respect the Maven standard syntax defined by the <span class="ExternalRef"><a href="http://maven.apache.org/maven-v4_0_0.xsd"><span class="RefSource">                  <span class="EmphasisFontCategoryNonProportional">http://maven.apache.org/maven-v4_0_0.xsd</span>                            </span>
                            </a>
                            </span> schema. The default name of a Maven configuration file for a project is <span class="EmphasisFontCategoryNonProportional">om.xml</span>, and a sample file is shown here:</div>
                        <div class="Para" id="Par32">
                            <div class="ProgramCode" id="PC2">
                                <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#1c02ff">&lt;<span style="font-weight:700">project</span>
    <span style="font-style:italic">xmlns</span>=<span style="color:#036a07">http://maven.apache.org/POM/4.0.0</span>
    <span style="font-style:italic">xmlns</span>:xsi=<span style="color:#036a07">http://www.w3.org/2001/XMLSchema-instance</span>
    <span style="font-style:italic">xsi</span>:schemaLocation=<span style="color:#036a07">http://maven.apache.org/POM/4.0.0
    http://maven.apache.org/maven-v4_0_0.xsd</span>&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">modelVersion</span>&gt;</span>4.0.0<span style="color:#1c02ff">&lt;/<span style="font-weight:700">modelVersion</span>&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">groupId</span>&gt;</span>com.apress.prospring5.ch02<span style="color:#1c02ff">&lt;/<span style="font-weight:700">groupId</span>&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">artifactId</span>&gt;</span>hello-world<span style="color:#1c02ff">&lt;/<span style="font-weight:700">artifactId</span>&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">packaging</span>&gt;</span>jar<span style="color:#1c02ff">&lt;/<span style="font-weight:700">packaging</span>&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">version</span>&gt;</span>5.0-SNAPSHOT<span style="color:#1c02ff">&lt;/<span style="font-weight:700">version</span>&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">name</span>&gt;</span>hello-world<span style="color:#1c02ff">&lt;/<span style="font-weight:700">name</span>&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">properties</span>&gt;</span>
        <span style="color:#1c02ff">&lt;<span style="font-weight:700">project</span>.build.sourceEncoding&gt;</span>UTF-8<span style="color:#1c02ff">&lt;/<span style="font-weight:700">project</span>.build.sourceEncoding&gt;</span>
        <span style="color:#1c02ff">&lt;<span style="font-weight:700">spring</span>.version&gt;</span>5.0.0.RELEASE<span style="color:#1c02ff">&lt;/<span style="font-weight:700">spring</span>.version&gt;</span>
    <span style="color:#1c02ff">&lt;/<span style="font-weight:700">properties</span>&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">dependencies</span>&gt;</span>
        <span style="color:#06f;font-style:italic">&lt;!-- https://mvnrepository.com/artifact/log4j/log4j --&gt;</span>
        <span style="color:#1c02ff">&lt;<span style="font-weight:700">dependency</span>&gt;</span>
            <span style="color:#1c02ff">&lt;<span style="font-weight:700">groupId</span>&gt;</span>log4j<span style="color:#1c02ff">&lt;/<span style="font-weight:700">groupId</span>&gt;</span>
            <span style="color:#1c02ff">&lt;<span style="font-weight:700">artifactId</span>&gt;</span>log4j<span style="color:#1c02ff">&lt;/<span style="font-weight:700">artifactId</span>&gt;</span>
            <span style="color:#1c02ff">&lt;<span style="font-weight:700">version</span>&gt;</span>1.2.17<span style="color:#1c02ff">&lt;/<span style="font-weight:700">version</span>&gt;</span>
        <span style="color:#1c02ff">&lt;/<span style="font-weight:700">dependency</span>&gt;</span>
    <span style="color:#1c02ff">&lt;/<span style="font-weight:700">dependencies</span>&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">build</span>&gt;</span>
        <span style="color:#1c02ff">&lt;<span style="font-weight:700">plugins</span>&gt;</span>
            <span style="color:#1c02ff">&lt;<span style="font-weight:700">plugin</span>&gt;</span>

//...

<span style="color:#1c02ff">&lt;/<span style="font-weight:700">plugin</span>&gt;</span>
        <span style="color:#1c02ff">&lt;/<span style="font-weight:700">plugins</span>&gt;</span>
    <span style="color:#1c02ff">&lt;/<span style="font-weight:700">build</span>&gt;</span>
<span style="color:#1c02ff">&lt;/<span style="font-weight:700">project</span>&gt;</span>
</pre></div>
                            </div>
                        </div>
                        <div class="Para" id="Par33">Maven also defines a typical standard project structure, as depicted in Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_2_Chapter.html#Fig1">2-1</a></span>.
                            <div class="Figure" id="Fig1">
                                <div class="MediaObject" id="MO1"><img alt="A315511_5_En_2_Fig1_HTML.jpg" data-mfp-src="/library/view/pro-spring-5/9781484228081/A315511_5_En_2_Fig1_HTML.jpg" height="193" src="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_2_Fig1_HTML.jpg" width="240"/></div>
                                <div class="Caption" xml:lang="en">
                                    <div class="CaptionContent"><span class="CaptionNumber">Figure 2-1.</span>
                                        <div class="SimplePara">Typical Maven project <span id="ITerm21">structure                                      </span> </div>
                                    </div>
                        </div>
                    </div>
                </div>
                <div class="Para" id="Par34">The <span class="EmphasisFontCategoryNonProportional">main</span> directory contains the classes (the <span class="EmphasisFontCategoryNonProportional">java</span> directory) and configuration files (the <span class="EmphasisFontCategoryNonProportional">resources</span>                    directory) for the application.</div>
                <div class="Para" id="Par35">The <span class="EmphasisFontCategoryNonProportional">test</span> directory contains the classes (the <span class="EmphasisFontCategoryNonProportional">java</span> directory) and configuration files (the <span class="EmphasisFontCategoryNonProportional">resources</span>                    directory) that are used to test the application from the <span class="EmphasisFontCategoryNonProportional">main</span> directory.</div>
        </div>
        <div class="Section2 RenderAsSection2" id="Sec8">
            <h3 class="Heading">Accessing Spring Modules Using <span id="ITerm22">Gradle                      </span> </h3>
            <div class="Para" id="Par36">The Maven project standard structure and artifact categorization and organization is important because Gradle respects the same rules and even uses the Maven central repository to retrieve artifacts. Gradle is a powerful build tool that has
                given up the bloated XML for configuration and switched to the simplicity and flexibility of Groovy. At the time of writing, the current version of Gradle is 4.0.<a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_2_Chapter.html#Fn5" id="Fn5_source"><sup>5</sup></a> Starting with version 4.<span class="EmphasisTypeItalic">x</span>, the Spring team has switched to using Gradle for the configuration of every Spring product. That is why the source
                code for this book can be built and executed using Gradle too. The default name of a Gradle configuration file for a project is <span class="EmphasisFontCategoryNonProportional">build.gradle</span>. The equivalent of the <span class="EmphasisFontCategoryNonProportional">pom.xml</span>                file depicted earlier (well, one version of it) is shown here:</div>
            <div class="Para" id="Par38">
                <div class="ProgramCode" id="PC3">
                    <div class="LineGroup">
                        <div class="FixedLine"><pre style="background:#fff;color:#000">group <span style="color:#036a07">com.apress.prospring5.ch02</span>
version <span style="color:#036a07">5.0-SNAPSHOT</span>
apply <span style="color:#c5060b;font-weight:700">plugin</span>: <span style="color:#036a07">java</span>
repositories {
    mavenCentral()
}
ext {
    springVersion <span style="color:#00f;font-weight:700">=</span> <span style="color:#036a07">5.0.0.RELEASE</span>
}
tasks<span style="color:#00f;font-weight:700">.</span>withType(<span style="color:#00f;font-weight:700">JavaCompile</span>) {
    options<span style="color:#00f;font-weight:700">.</span>encoding <span style="color:#00f;font-weight:700">=</span> <span style="color:#036a07">UTF-8</span>
}
dependencies {
    compile <span style="color:#c5060b;font-weight:700">group</span>: <span style="color:#036a07">log4j</span>,
    <span style="color:#c5060b;font-weight:700">name</span>: <span style="color:#036a07">log4j</span>,
    <span style="color:#c5060b;font-weight:700">version</span>: <span style="color:#036a07">1.2.17</span><span style="color:#00f;font-weight:700">..</span>.
}
</pre></div>
                    </div>
                </div>
            </div>
            <div class="Para" id="Par39">That’s way more readable, right? As you can observe, the artifacts are identified using the group, artifact, and version as previously introduced with Maven, but the property names differ. And since Gradle is not in the scope of this book
                either, the coverage for it must end here.</div>
        </div>
        <div class="Section2 RenderAsSection2" id="Sec9">
            <h3 class="Heading">Using <span id="ITerm24">Spring Documentation                      </span> </h3>
            <div class="Para" id="Par40">One of the aspects of Spring that makes it such a useful framework for developers who are building real applications is its wealth of well-written, accurate documentation. In every release, the Spring Framework’s documentation team works hard
                to ensure that all the documentation is finished and polished by the development team. This means that every feature of Spring is not only fully documented in the Javadoc but is also covered in the Spring reference manual included in every
                distribution. If you haven’t yet familiarized yourself with the Spring Javadoc and the reference manual, do so now. This book is not a replacement for either of these resources; rather, it is a complementary reference, demonstrating how
                to build a Spring-based application from the ground up.</div>
        </div>
        <div class="Section2 RenderAsSection2" id="Sec10">
            <h3 class="Heading">Putting a Spring into Hello World</h3>
            <div class="Para" id="Par41">We hope by this point in the book you appreciate that Spring is a solid, well-supported project that has all the makings of a great tool for application development. However, one thing is missing—we haven’t shown you any code yet. We are sure
                you are dying to see Spring in action, and because we cannot go any longer without getting into the code, let’s do just that. Do not worry if you do not fully understand all the code in this section; we go into much more detail on all
                the topics as we proceed through the book.</div>
        </div>
        <div class="Section2 RenderAsSection2" id="Sec11">
            <h3 class="Heading">Building the Sample <span id="ITerm25">Hello World Application                      </span> </h3>
            <div class="Para" id="Par42">Now, we are sure you are familiar with the traditional Hello World example, but just in case you have been living on the moon for the past 30 years, the following code snippet shows the Java version in all its glory:</div>
            <div class="Para" id="Par43">
                <div class="ProgramCode" id="PC4">
                    <div class="LineGroup">
                        <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch2</span>;
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">HelloWorld</span> {
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span>...<span style="font-style:italic">args</span>) {
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">Hello World!</span>);
    }
}
</pre></div>
                    </div>
                </div>
            </div>
            <div class="Para" id="Par44">As <span id="ITerm26">examples                      </span> go, this one is pretty simple—it does the job, but it is not very extensible. What if we want to change the message? What if we want to output the message differently, maybe to standard
                error instead of standard output or enclosed in HTML tags rather than as plain text? We are going to redefine the requirements for the sample application and say that it must support a simple, flexible mechanism for changing the message,
                and it must be easy to change the rendering behavior. In the basic Hello World example, you can make both of these changes quickly and easily by just changing the code as appropriate. However, in a bigger application, recompiling takes
                time, and it requires the application to be fully tested again. A better solution is to externalize the message content and read it in at runtime, perhaps from the command-line arguments shown in the following code snippet:</div>
            <div class="Para" id="Par45">
                <div class="ProgramCode" id="PC5">
                    <div class="LineGroup">
                        <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch2</span>;
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">HelloWorldWithCommandLine</span> {
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span>...<span style="font-style:italic">args</span>) {
        <span style="color:#00f;font-weight:700">if</span> (args<span style="color:#00f;font-weight:700">.</span>length <span style="color:#00f;font-weight:700">&gt;</span> <span style="color:#0000cd">0</span>) {
            <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(args[<span style="color:#0000cd">0</span>]);
        } <span style="color:#00f;font-weight:700">else</span> {
            <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">Hello World!</span>);
        }
    }
}
</pre></div>
                    </div>
                </div>
            </div>
            <div class="Para" id="Par46">This example accomplishes what we wanted—we can now change the message without changing the code. However, there is still a problem with this application: the component responsible for rendering the message is also responsible for obtaining
                the message. Changing how the message is obtained means changing the code in the renderer. Add to this the fact that we still cannot change the renderer easily; doing so means changing the class that launches the application.</div>
            <div class="Para" id="Par47">If we take this application a step further (away from the basics of Hello World), a better solution is to refactor the rendering and message retrieval logic into separate components. Plus, if we really want to make your application flexible,
                we should have these components implement interfaces and define the interdependencies between the components and the launcher using these interfaces. By refactoring the message retrieval logic, we can define a simple <span class="EmphasisFontCategoryNonProportional">MessageProvider</span>                interface with a single method, <span class="EmphasisFontCategoryNonProportional">getMessage()</span>, as shown in the following code snippet:</div>
        <div class="Para" id="Par48">
            <div class="ProgramCode" id="PC6">
                <div class="LineGroup">
                    <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch2.decoupled</span>;
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">interface</span> <span style="text-decoration:underline">MessageProvider</span> {
    <span style="color:#00f;font-weight:700">String</span> <span style="color:#0000a2;font-weight:700">getMessage</span>();
}
</pre></div>
                </div>
            </div>
        </div>
        <div class="Para" id="Par49">The <span id="ITerm27">            <span class="EmphasisFontCategoryNonProportional">MessageRenderer</span> interface </span> is implemented by all components that can render messages, and such a component is depicted in the following code snippet:</div>
        <div class="Para" id="Par50">
            <div class="ProgramCode" id="PC7">
                <div class="LineGroup">
                    <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">interface</span> <span style="text-decoration:underline">MessageRenderer</span> {
    <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">render</span>();
    <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setMessageProvider</span>(<span style="color:#00f;font-weight:700">MessageProvider</span> <span style="font-style:italic">provider</span>);
    <span style="color:#00f;font-weight:700">MessageProvider</span> <span style="color:#0000a2;font-weight:700">getMessageProvider</span>();
}
</pre></div>
                </div>
            </div>
    </div>
    <div class="Para" id="Par51">As you can see, the <span class="EmphasisFontCategoryNonProportional">MessageRenderer</span> interface declares a method, <span class="EmphasisFontCategoryNonProportional">render()</span>, and also a JavaBean-style method, <span class="EmphasisFontCategoryNonProportional">setMessageProvider()</span>.
        Any <span class="EmphasisFontCategoryNonProportional">MessageRenderer</span> implementations are decoupled from message retrieval and delegate that responsibility to the <span class="EmphasisFontCategoryNonProportional">MessageProvider</span>        instance with which they are supplied. Here, <span class="EmphasisFontCategoryNonProportional">MessageProvider</span> is a dependency of <span class="EmphasisFontCategoryNonProportional">MessageRenderer</span>. Creating simple implementations
        of these interfaces is easy, as shown in the following code snippet:</div>
    <div class="Para" id="Par52">
        <div class="ProgramCode" id="PC8">
            <div class="LineGroup">
                <div class="FixedLine">
                  <pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch2.decoupled</span>;
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">HelloWorldMessageProvider</span> <span style="color:#00f;font-weight:700">implements</span> <span style="font-style:italic">MessageProvider</span> {
    <span style="color:#00f;font-weight:700">@Override</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">String</span> <span style="color:#0000a2;font-weight:700">getMessage</span>() {
        <span style="color:#00f;font-weight:700">return</span> <span style="color:#036a07">Hello World!</span>;
    }
}</pre></div>
            </div>
        </div>
    </div>
    <div class="Para" id="Par53">You can see that we have created a simple <span class="EmphasisFontCategoryNonProportional">MessageProvider</span> that always returns “Hello World!” as the message. The <span id="ITerm29">            <span class="EmphasisFontCategoryNonProportional">StandardOutMessageRenderer</span>        class </span> shown next is just as simple:</div>
    <div class="Para" id="Par54">
        <div class="ProgramCode" id="PC9">
            <div class="LineGroup">
                <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch2.decoupled</span>;
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">StandardOutMessageRenderer</span> <span style="color:#00f;font-weight:700">implements</span> <span style="font-style:italic">MessageRenderer</span> {
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">MessageProvider</span> messageProvider;<span style="color:#00f;font-weight:700">@Override</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">render</span>() {
        <span style="color:#00f;font-weight:700">if</span> (messageProvider <span style="color:#00f;font-weight:700">==</span> <span style="color:#585cf6;font-weight:700">null</span>) {
            <span style="color:#00f;font-weight:700">throw</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">RuntimeException</span>(<span style="color:#036a07">You must set the property messageProvider of class:</span> <span style="color:#00f;font-weight:700">+</span> <span style="color:#00f;font-weight:700">StandardOutMessageRenderer</span><span style="color:#00f;font-weight:700">.</span>class<span style="color:#00f;font-weight:700">.</span>getName());
        }
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(messageProvider<span style="color:#00f;font-weight:700">.</span>getMessage());
    }<span style="color:#00f;font-weight:700">@Override</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setMessageProvider</span>(<span style="color:#00f;font-weight:700">MessageProvider</span> <span style="font-style:italic">provider</span>) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>messageProvider <span style="color:#00f;font-weight:700">=</span> provider;
    }<span style="color:#00f;font-weight:700">@Override</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">MessageProvider</span> <span style="color:#0000a2;font-weight:700">getMessageProvider</span>() {
        <span style="color:#00f;font-weight:700">return</span> <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>messageProvider;
    }
}
</pre></div>
            </div>
        </div>
    </div>
    <div class="Para ParaOneEmphasisChild" id="Par55">Now all that remains is to rewrite the <span class="EmphasisFontCategoryNonProportional">main()</span> method of the entry class.</div>
    <div class="Para" id="Par56">
        <div class="ProgramCode" id="PC10">
            <div class="LineGroup">
                <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch2.decoupled</span>;
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">HelloWorldDecoupled</span> {
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span>...<span style="font-style:italic">args</span>) {
        <span style="color:#00f;font-weight:700">MessageRenderer</span> mr <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">StandardOutMessageRenderer</span>();
        <span style="color:#00f;font-weight:700">MessageProvider</span> mp <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">HelloWorldMessageProvider</span>();
        mr<span style="color:#00f;font-weight:700">.</span>setMessageProvider(mp);
        mr<span style="color:#00f;font-weight:700">.</span>render();
    }
}
</pre></div>
            </div>
        </div>
    </div>
    <div class="Para" id="Par57">Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_2_Chapter.html#Fig2">2-2</a></span> depicts the abstract schema of the application built so far.
        <div class="Figure" id="Fig2">
            <div class="MediaObject" id="MO2"><img alt="A315511_5_En_2_Fig2_HTML.jpg" data-mfp-src="/library/view/pro-spring-5/9781484228081/A315511_5_En_2_Fig2_HTML.jpg" height="295" src="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_2_Fig2_HTML.jpg" width="570"/></div>
            <div class="Caption" xml:lang="en">
                <div class="CaptionContent"><span class="CaptionNumber">Figure 2-2.</span>
                    <div class="SimplePara">A little more decoupled <span id="ITerm31">Hello World application                                      </span> </div>
                </div>
        </div>
    </div>
    </div>
    <div class="Para" id="Par58">The code here is fairly simple. We instantiate instances of <span id="ITerm32">                <span class="EmphasisFontCategoryNonProportional">HelloWorldMessageProvider</span> </span> and <span id="ITerm33">                <span class="EmphasisFontCategoryNonProportional">StandardOutMessageRenderer</span>        </span>, although the declared types are <span class="EmphasisFontCategoryNonProportional">MessageProvider</span> and <span class="EmphasisFontCategoryNonProportional">MessageRenderer</span>, respectively. This is because we need to interact only
        with the methods provided by the interface in the programming logic, and <span class="EmphasisFontCategoryNonProportional">HelloWorldMessageProvider</span> and <span class="EmphasisFontCategoryNonProportional">StandardOutMessageRenderer</span>        already implemented those interfaces, respectively. Then, we pass <span class="EmphasisFontCategoryNonProportional">MessageProvider</span> to <span class="EmphasisFontCategoryNonProportional">MessageRenderer</span> and invoke <span class="EmphasisFontCategoryNonProportional">MessageRenderer.render()</span>.
        If we compile and run this program, we get the expected “Hello World!” output. Now, this example is more like what we are looking for, but there is one small problem. Changing the implementation of either the <span class="EmphasisFontCategoryNonProportional">MessageRenderer</span>        or <span class="EmphasisFontCategoryNonProportional">MessageProvider</span> interface means a change to the code. To get around this, we can create a simple factory class that reads the implementation class names from a properties file and instantiates
        them on behalf of the application, as shown here:</div>
    <div class="Para" id="Par59">
        <div class="ProgramCode" id="PC11">
            <div class="LineGroup">
                <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch2.decoupled</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">java.util.Properties</span>;
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">MessageSupportFactory</span> {
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">MessageSupportFactory</span> instance;
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">Properties</span> props;
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">MessageRenderer</span> renderer;
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">MessageProvider</span> provider;
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#0000a2;font-weight:700">MessageSupportFactory</span>() {
        props <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">Properties</span>();
        <span style="color:#00f;font-weight:700">try</span> {
            props<span style="color:#00f;font-weight:700">.</span>load(<span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>getClass()<span style="color:#00f;font-weight:700">.</span>getResourceAsStream(<span style="color:#036a07">/msf.properties</span>));
            <span style="color:#00f;font-weight:700">String</span> rendererClass <span style="color:#00f;font-weight:700">=</span> props<span style="color:#00f;font-weight:700">.</span>getProperty(<span style="color:#036a07">renderer.class</span>);
            <span style="color:#00f;font-weight:700">String</span> providerClass <span style="color:#00f;font-weight:700">=</span> props<span style="color:#00f;font-weight:700">.</span>getProperty(<span style="color:#036a07">provider.class</span>);
            renderer <span style="color:#00f;font-weight:700">=</span> (<span style="color:#00f;font-weight:700">MessageRenderer</span>) <span style="color:#00f;font-weight:700">Class</span><span style="color:#00f;font-weight:700">.</span>forName(rendererClass)<span style="color:#00f;font-weight:700">.</span>newInstance();
            provider <span style="color:#00f;font-weight:700">=</span> (<span style="color:#00f;font-weight:700">MessageProvider</span>) <span style="color:#00f;font-weight:700">Class</span><span style="color:#00f;font-weight:700">.</span>forName(providerClass)<span style="color:#00f;font-weight:700">.</span>newInstance();
        } <span style="color:#00f;font-weight:700">catch</span>(<span style="color:#00f;font-weight:700">Exception</span> ex) {
            ex<span style="color:#00f;font-weight:700">.</span>printStackTrace();
        }
    }
    <span style="color:#00f;font-weight:700">static</span> {
        instance <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">MessageSupportFactory</span>();
    }
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">MessageSupportFactory</span> <span style="color:#0000a2;font-weight:700">getInstance</span>() {
        <span style="color:#00f;font-weight:700">return</span> instance;
    }
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">MessageRenderer</span> <span style="color:#0000a2;font-weight:700">getMessageRenderer</span>() {
        <span style="color:#00f;font-weight:700">return</span> renderer;
    }
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">MessageProvider</span> <span style="color:#0000a2;font-weight:700">getMessageProvider</span>() {
        <span style="color:#00f;font-weight:700">return</span> provider;
    }
}
</pre></div>
            </div>
        </div>
    </div>
    <div class="Para" id="Par60">The implementation here is trivial and naive, the error handling is simplistic, and the name of the configuration file is hard-coded, but we already have a substantial amount of code. The <span id="ITerm34">configuration file                      </span>        for this class is quite simple.</div>
    <div class="Para" id="Par61">
        <div class="ProgramCode" id="PC12">
            <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch2.decoupled</span>;
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">HelloWorldDecoupledWithFactory</span> {
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span>...<span style="font-style:italic">args</span>) {
        <span style="color:#00f;font-weight:700">MessageRenderer</span> mr <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">MessageSupportFactory</span><span style="color:#00f;font-weight:700">.</span>getInstance()<span style="color:#00f;font-weight:700">.</span>getMessageRenderer();
        <span style="color:#00f;font-weight:700">MessageProvider</span> mp <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">MessageSupportFactory</span><span style="color:#00f;font-weight:700">.</span>getInstance()<span style="color:#00f;font-weight:700">.</span>getMessageProvider();
        mr<span style="color:#00f;font-weight:700">.</span>setMessageProvider(mp);
        mr<span style="color:#00f;font-weight:700">.</span>render();
    }
}
</pre></div>
            </div>
        </div>
    </div>
    <div class="Para" id="Par64">Before we move on to see how we can introduce Spring into this application, let’s quickly recap what we have done. Starting with the simple Hello World application, we defined two additional requirements that the application must fulfill. The first
        was that changing the message should be simple, and the second was that changing the rendering mechanism should also be simple. To meet these requirements, we used two interfaces: <span class="EmphasisFontCategoryNonProportional">MessageProvider</span>        and <span class="EmphasisFontCategoryNonProportional">MessageRenderer</span>. The <span id="ITerm35">            <span class="EmphasisFontCategoryNonProportional">MessageRenderer</span> interface </span> depends on an implementation of the
        <span class="EmphasisFontCategoryNonProportional">MessageProvider</span> interface to be able to retrieve a message to render. Finally, we added a simple factory class to retrieve the names of the implementation classes and instantiate them as applicable.</div>
    </div>
    <div class="Section2 RenderAsSection2" id="Sec12">
        <h3 class="Heading">Refactoring with Spring</h3>
        <div class="Para" id="Par65">The final example shown earlier met the goals laid out for the sample application, but there are still problems with it. The first problem is that we had to write a lot of glue code to piece the application together, while at the same time keeping
            the components loosely coupled. The second problem is that we still had to provide the implementation of <span class="EmphasisFontCategoryNonProportional">MessageRenderer</span> with an instance of <span class="EmphasisFontCategoryNonProportional">MessageProvider</span>            manually. We can solve both of these problems by using Spring. To solve the problem of too much glue code, we can completely remove the <span class="EmphasisFontCategoryNonProportional">MessageSupportFactory</span> class from the application
            and replace it with a Spring interface, <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>. Don’t worry too much about this interface; for now, it is enough to know that this interface is used by Spring for storing
            all the environmental information with regard to an application being managed by Spring. This interface extends another interface, <span id="ITerm36">                <span class="EmphasisFontCategoryNonProportional">ListableBeanFactory</span>            </span>, which acts as the provider for any Spring-managed bean instance.</div>
        <div class="Para" id="Par66">
            <div class="ProgramCode" id="PC14">
                <div class="LineGroup">
                    <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch2</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.ApplicationContext</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.support.ClassPathXmlApplicationContext</span>;
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">HelloWorldSpringDI</span> {
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span> <span style="font-style:italic">args</span>) {
        <span style="color:#00f;font-weight:700">ApplicationContext</span> ctx <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">ClassPathXmlApplicationContext</span>(<span style="color:#036a07">spring/app-context.xml</span>);
        <span style="color:#00f;font-weight:700">MessageRenderer</span> mr <span style="color:#00f;font-weight:700">=</span> ctx<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#036a07">renderer</span>, <span style="color:#00f;font-weight:700">MessageRenderer</span><span style="color:#00f;font-weight:700">.</span>class);
        mr<span style="color:#00f;font-weight:700">.</span>render();
    }
}
</pre></div>
                </div>
            </div>
        </div>
        <div class="Para" id="Par67">In the previous code snippet, you can see that the <span class="EmphasisFontCategoryNonProportional">main()</span> method obtains an instance of <span class="EmphasisFontCategoryNonProportional">ClassPathXmlApplicationContext</span> (the application
            configuration information is loaded from the file <span class="EmphasisFontCategoryNonProportional">spring/app-context.xml</span> in the project’s classpath), typed as <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>,
            and from this, it obtains the <span class="EmphasisFontCategoryNonProportional">MessageRenderer</span> instances by using the <span class="EmphasisFontCategoryNonProportional">ApplicationContext.getBean()</span> method. Don’t worry too much
            about the <span class="EmphasisFontCategoryNonProportional">getBean()</span> method for now; just know that this method reads the application configuration (in this case, an XML file), initializes Spring’s <span id="ITerm37">            <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>            environment </span>, and then returns the configured bean<a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_2_Chapter.html#Fn6" id="Fn6_source"><sup>6</sup></a> instance. This
            XML file (<span class="EmphasisFontCategoryNonProportional">app-context.xml</span>) serves the same purpose as the one used for <span class="EmphasisFontCategoryNonProportional">MessageSupportFactory</span>.</div>
        <div class="Para" id="Par69">
            <div class="ProgramCode" id="PC15">
                <div class="LineGroup">
                    <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#68685b">&lt;?<span style="color:#888">xml</span><span style="color:#888"> version</span>=<span style="color:#888">1.0</span><span style="color:#888"> encoding</span>=<span style="color:#888">UTF-8</span>?&gt;</span>
<span style="color:#1c02ff">&lt;<span style="font-weight:700">beans</span> <span style="font-style:italic">xmlns</span>=<span style="color:#036a07">http://www.springframework.org/schema/beans</span>
    <span style="font-style:italic">xmlns</span>:xsi=<span style="color:#036a07">http://www.w3.org/2001/XMLSchema-instance</span>
    <span style="font-style:italic">xmlns</span>:p=<span style="color:#036a07">http://www.springframework.org/schema/p</span>
    <span style="font-style:italic">xsi</span>:schemaLocation=<span style="color:#036a07">http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans.xsd</span>&gt;</span>
  <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">provider</span>
        <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch2.decoupled.HelloWorldMessageProvider</span>/&gt;</span>
  <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">renderer</span>
        <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch2.decoupled.StandardOutMessageRenderer</span>
        <span style="font-style:italic">p</span>:messageProvider-ref=<span style="color:#036a07">provider</span>/&gt;</span>
<span style="color:#1c02ff">&lt;/<span style="font-weight:700">beans</span>&gt;</span>
</pre></div>
                </div>
            </div>
        </div>
        <div class="Para" id="Par70">The previous file shows a typical Spring <span id="ITerm38">            <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> configuration </span>. First, Spring’s namespaces are declared, and the default namespace is
            <span class="EmphasisFontCategoryNonProportional">beans</span>. The <span class="EmphasisFontCategoryNonProportional">beans</span> namespace is used to declare the beans that need to be managed by Spring and to declare their dependency requirements (for the preceding example, the renderer
                bean’s <span class="EmphasisFontCategoryNonProportional">messageProvider</span> property is referencing the provider bean). Spring will resolve and inject those dependencies.</div>
        <div class="Para" id="Par71">Afterward, we declare the bean with the ID <span class="EmphasisFontCategoryNonProportional">provider</span> and the corresponding implementation class. When Spring sees this bean definition during the <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>            initialization, it will instantiate the class and store it with the specified ID.</div>
        <div class="Para" id="Par72">Then the <span class="EmphasisFontCategoryNonProportional">renderer</span> bean is declared, with the corresponding implementation class. Remember that this bean depends on the <span id="ITerm39">            <span class="EmphasisFontCategoryNonProportional">MessageProvider</span>            interface </span> for getting the message to render. To inform Spring about the DI requirement, we use the <span class="EmphasisFontCategoryNonProportional">p</span> namespace attribute. The tag attribute <span class="EmphasisFontCategoryNonProportional">p:messageProvider-ref=&quot;provider&quot;</span>            tells Spring that the bean’s property, <span class="EmphasisFontCategoryNonProportional">messageProvider</span>, should be injected with another bean. The bean to be injected into the property should reference a bean with the ID <span class="EmphasisFontCategoryNonProportional">provider</span>.
            When Spring sees this definition, it will instantiate the class, look up the bean’s property named <span class="EmphasisFontCategoryNonProportional">messageProvider</span>, and inject it with the bean instance with the ID <span class="EmphasisFontCategoryNonProportional">provider</span>.</div>
        <div class="Para" id="Par73">As you can see, upon the initialization of Spring’s <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>, the <span class="EmphasisFontCategoryNonProportional">main()</span> method now just obtains the <span class="EmphasisFontCategoryNonProportional">MessageRenderer</span>            bean by using its type-safe <span id="ITerm40">            <span class="EmphasisFontCategoryNonProportional">getBean()</span> method </span> (passing in the ID and the expected return type, which is the <span class="EmphasisFontCategoryNonProportional">MessageRenderer</span>            interface) and calls <span class="EmphasisFontCategoryNonProportional">render()</span>; Spring has created the <span class="EmphasisFontCategoryNonProportional">MessageProvider</span> implementation and injected it into the <span class="EmphasisFontCategoryNonProportional">MessageRenderer</span>            implementation. Notice that we didn’t have to make any changes to the classes that are being wired together using Spring. In fact, these classes have no reference to Spring and are completely oblivious to its existence. However, this isn’t
            always the case. Your classes can implement Spring-specified interfaces to interact in a variety of ways with the DI container.</div>
    <div class="Para ParaOneEmphasisChild" id="Par74">With your new Spring configuration and modified <span class="EmphasisFontCategoryNonProportional">main()</span> method, let’s see it in action. Using Gradle, enter the following commands into your terminal to build the project and the root of your
        source code:</div>
    <div class="Para" id="Par75">
        <div class="ProgramCode" id="PC16">
            <div class="FixedLine">gradle clean build copyDependencies</div>
        </div>
    </div>
    <div class="Para" id="Par76">The only required Spring module to be declared in your configuration file is <span class="EmphasisFontCategoryNonProportional">spring-context</span>. Gradle will automatically bring in any transitive dependencies required for this module. In Figure
        <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_2_Chapter.html#Fig3">2-3</a></span> you can see the transitive dependencies of <span id="ITerm41">                <span class="EmphasisFontCategoryNonProportional">spring-context.jar</span>        </span>.
        <div class="Figure" id="Fig3">
            <div class="MediaObject" id="MO3"><img alt="A315511_5_En_2_Fig3_HTML.jpg" data-mfp-src="/library/view/pro-spring-5/9781484228081/A315511_5_En_2_Fig3_HTML.jpg" height="173" src="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_2_Fig3_HTML.jpg" width="440"/></div>
            <div class="Caption" xml:lang="en">
                <div class="CaptionContent"><span class="CaptionNumber">Figure 2-3.</span>
                    <div class="SimplePara">spring-context and its transitive dependencies depicted in IntelliJ IDEA</div>
                </div>
        </div>
    </div>
    </div>
    <div class="Para" id="Par77">The previous command will build the project from scratch, deleting previously generated files, and copy all required dependencies in the same location where the resulting artifact is placed, under <span class="EmphasisFontCategoryNonProportional">build/libs</span>.
        This path value will also be used as an appending prefix to the library files added to <span class="EmphasisFontCategoryNonProportional">MANIFEST.MF</span> when building the JAR. See the Chapter <span class="ExternalRef"><a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_2_Chapter.html"><span class="RefSource">2</span></a>
        </span>
        source code (available on the Apress web site), specifically the Gradle <span class="EmphasisFontCategoryNonProportional">hellor-world/build.properties</span> file, for more information if you are unfamiliar with the Gradle JAR building configuration
        and process. Finally, to run the Spring DI sample, enter the following commands:</div>
    <div class="Para" id="Par78">
        <div class="ProgramCode" id="PC17">
            <div class="FixedLine">cd build/libs; java -jar hello-world-5.0-SNAPSHOT.jar</div>
        </div>
    </div>
    <div class="Para" id="Par79">At this point, you should see some log statements generated by the Spring container’s startup process followed by the expected Hello World output.</div>
    <div class="Section3 RenderAsSection3" id="Sec13">
        <h4 class="Heading">Spring Configuration Using Annotations</h4>
        <div class="Para" id="Par80">Starting with Spring 3.0, XML configuration files are no longer necessary when developing a Spring application. They can be replaced with annotations and configuration classes. <span id="ITerm42">Configuration classes                          </span>            are Java classes annotated with <span class="EmphasisFontCategoryNonProportional">@Configuration</span> that contain bean definitions (methods annotated with <span class="EmphasisFontCategoryNonProportional">@Bean</span>) or are configured
            themselves to identify bean definitions in the application by annotating them with <span class="EmphasisFontCategoryNonProportional">@ComponentScanning</span>. The <span id="ITerm43">equivalent                           </span>of the
            <span class="EmphasisFontCategoryNonProportional">app-context.xml</span> file presented earlier is shown here:</div>
        <div class="Para" id="Par81">
            <div class="ProgramCode" id="PC18">
                <div class="LineGroup">
                    <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch2.annotated</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch2.decoupled.HelloWorldMessageProvider</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch2.decoupled.MessageProvider</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch2.decoupled.MessageRenderer</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch2.decoupled.StandardOutMessageRenderer</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.annotation.Bean</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.annotation.Configuration</span>;@<span style="color:#00f;font-weight:700">Configuration</span>
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">HelloWorldConfiguration</span> {
    <span style="color:#06f;font-style:italic">// equivalent to &lt;bean id=&quot;provider&quot; class=&quot;..&quot;/&gt;</span>
    <span style="color:#00f;font-weight:700">@Bean</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">MessageProvider</span> <span style="color:#0000a2;font-weight:700">provider</span>() {
        <span style="color:#00f;font-weight:700">return</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">HelloWorldMessageProvider</span>();
    }
    <span style="color:#06f;font-style:italic">// equivalent to  &lt;bean id=&quot;renderer&quot; class=&quot;..&quot;/&gt;</span>
    <span style="color:#00f;font-weight:700">@Bean</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">MessageRenderer</span> <span style="color:#0000a2;font-weight:700">renderer</span>() {
        <span style="color:#00f;font-weight:700">MessageRenderer</span> renderer <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">StandardOutMessageRenderer</span>();
        renderer<span style="color:#00f;font-weight:700">.</span>setMessageProvider(provider());
        <span style="color:#00f;font-weight:700">return</span> renderer;
    }
}
</pre></div>
                </div>
            </div>
        </div>
        <div class="Para" id="Par82">The <span class="EmphasisFontCategoryNonProportional">main()</span> method has to be modified to replace <span id="ITerm44">                  <span class="EmphasisFontCategoryNonProportional">ClassPathXmlApplicationContext</span> </span> with
            another <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> implementation that knows how to read bean definitions from configuration classes. That class is <span class="EmphasisFontCategoryNonProportional">AnnotationConfigApplicationContext</span>.</div>
        <div class="Para" id="Par83">
            <div class="ProgramCode" id="PC19">
                <div class="LineGroup">
                    <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch2.annotated</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch2.decoupled.MessageRenderer</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.ApplicationContext</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.annotation.AnnotationConfigApplicationContext</span>;
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">HelloWorldSpringAnnotated</span> {
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span>...<span style="font-style:italic">args</span>) {
        <span style="color:#00f;font-weight:700">ApplicationContext</span> ctx <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">AnnotationConfigApplicationContext</span>(<span style="color:#00f;font-weight:700">HelloWorldConfiguration</span><span style="color:#00f;font-weight:700">.</span>class);
        <span style="color:#00f;font-weight:700">MessageRenderer</span> mr <span style="color:#00f;font-weight:700">=</span> ctx<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#036a07">renderer</span>, <span style="color:#00f;font-weight:700">MessageRenderer</span><span style="color:#00f;font-weight:700">.</span>class);
        mr<span style="color:#00f;font-weight:700">.</span>render();
    }
}
</pre></div>
            </div>
    </div>
    </div>
    <div class="Para" id="Par84">This is just one version of <span id="ITerm45">configuration                          </span> using annotations and configuration classes. Without XML, things get pretty flexible when it comes to Spring configuration. You’ll learn more about that
        later in this book, but the focus when it comes to configuration is on Java configuration and annotations.</div>
    <div class="Para ParaTypeImportant" id="Par85"> <img alt="A315511_5_En_2_Figa_HTML.jpg" data-mfp-src="/library/view/pro-spring-5/9781484228081/A315511_5_En_2_Figa_HTML.jpg" height="28" src="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_2_Figa_HTML.jpg" width="30"/>        Some of the interfaces and classes defined in the Hello World sample may be used in later chapters. Although we showed the full source code in this sample, future chapters may show condensed versions of code to be less verbose, especially in the
        case of incremental code modifications. The code has been organized a little, and all classes that can be used in Spring future examples were placed under the <span class="EmphasisFontCategoryNonProportional">com.apress.prospring5.ch2.decoupled</span>        and <span class="EmphasisFontCategoryNonProportional">com.apress.prospring5.ch2.annotated</span> packages, but keep in mind in a real application you would want to layer your code appropriately.</div>
    </div>
    </div>
    </div>
    <div class="Section1 RenderAsSection1" id="Sec14">
        <h2 class="Heading">Summary</h2>
        <div class="Para" id="Par86">In this chapter, we presented you with all the background information you need to get up and running with Spring. We showed you how to get started with Spring through dependency management systems and the current development version directly from
            GitHub. We described how Spring is packaged and the dependencies you need for each of Spring’s features. Using this information, you can make informed decisions about which of the Spring JAR files your application needs and which dependencies
            you need to distribute with your application. Spring’s documentation, guides, and test suite provide Spring users with an ideal base from which to start their Spring development, so we took some time to investigate what is made available by
            Spring. Finally, we presented an example of how, using Spring DI, it is possible to make the traditional Hello World a loosely coupled, extendable message-rendering application. The important thing to realize is that we only scratched the
            surface of Spring DI in this chapter, and we barely made a dent in Spring as a whole. In the next chapter, we take look at IoC and DI in Spring.</div>
    </div>
    <div class="FootnoteSection">
        <div class="Heading">Footnotes</div>
        <div class="Footnote" id="Fn1"><span class="FootnoteNumber"><a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_2_Chapter.html#Fn1_source">1</a></span>
            <div class="FootnoteParas">
                <div class="Para" id="Par3">Find Spring’s GitHub repository at <span class="ExternalRef"><a href="http://github.com/spring-projects/spring-framework"><span class="RefSource">                        <span class="EmphasisFontCategoryNonProportional">http://github.com/spring-projects/spring-framework</span>                    </span>
                    </a>
                    </span>.</div>
            </div>
            <div class="ClearBoth"> </div>
        </div>
        <div class="Footnote" id="Fn2"><span class="FootnoteNumber"><a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_2_Chapter.html#Fn2_source">2</a></span>
            <div class="FootnoteParas">
                <div class="Para" id="Par12"> <span class="ExternalRef"><a href="http://projects.spring.io/spring-framework"><span class="RefSource">                      <span class="EmphasisFontCategoryNonProportional">http://projects.spring.io/spring-framework</span> </span>
                    </a>
                    </span>
                </div>
            </div>
            <div class="ClearBoth"> </div>
        </div>
        <div class="Footnote" id="Fn3"><span class="FootnoteNumber"><a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_2_Chapter.html#Fn3_source">3</a></span>
            <div class="FootnoteParas">
                <div class="Para" id="Par27"> <span class="ExternalRef"><a href="http://maven.apache.org/"><span class="RefSource">                      <span class="EmphasisFontCategoryNonProportional">http://maven.apache.org</span> </span>
                    </a>
                    </span>
                </div>
            </div>
            <div class="ClearBoth"> </div>
        </div>
        <div class="Footnote" id="Fn4"><span class="FootnoteNumber"><a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_2_Chapter.html#Fn4_source">4</a></span>
            <div class="FootnoteParas">
                <div class="Para" id="Par28"> <span class="ExternalRef"><a href="http://search.maven.org/"><span class="RefSource">                      <span class="EmphasisFontCategoryNonProportional">http://search.maven.org</span> </span>
                    </a>
                    </span>
                </div>
            </div>
            <div class="ClearBoth"> </div>
        </div>
        <div class="Footnote" id="Fn5"><span class="FootnoteNumber"><a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_2_Chapter.html#Fn5_source">5</a></span>
            <div class="FootnoteParas">
                <div class="Para" id="Par37">On the official project site you can find detailed instructions on how to download, install, and configure Gradle for development: <span class="ExternalRef"><a href="https://gradle.org/install"><span class="RefSource">                      <span class="EmphasisFontCategoryNonProportional">https://gradle.org/install</span>                    </span>
                    </a>
                    </span>.</div>
            </div>
            <div class="ClearBoth"> </div>
        </div>
        <div class="Footnote" id="Fn6"><span class="FootnoteNumber"><a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_2_Chapter.html#Fn6_source">6</a></span>
            <div class="FootnoteParas">
                <div class="Para ParaOneEmphasisChild" id="Par68">A <span class="EmphasisTypeItalic">bean</span> is what an instance of a class is called in Spring.</div>
            </div>
            <div class="ClearBoth"> </div>
        </div>
    </div>
    </div>
    <div class="annotator-outer annotator-viewer viewer annotator-hide"> </div>
    </div>
    </div>
    </section>
    </div>
    </div>



<hr/>
<!--if IE]><![endif]-->

<!--if IE 8]><html class="no-js ie8 oldie" lang="en" prefix="og: http://ogp.me/ns/# og:book: http://ogp.me/ns/book# og:video: http://ogp.me/ns/video#"            itemscope itemtype="http://schema.org/Book http://schema.org/ItemPage" data-login-url="/accounts/login/"data-offline-url="/"data-url="/library/view/pro-spring-5/9781484228081/A315511_5_En_3_Chapter.html"data-csrf-cookie="csrfsafari"data-highlight-privacy=""  data-user-id="3866890"  data-user-uuid="72b95c3c-5b13-4319-82fa-5c73754754ca"  data-username="levinxccai"  data-account-type="B2B"    data-activated-trial-date="11/06/2017"  data-archive="9781484228081"  data-publishers="Apress"  data-htmlfile-name="A315511_5_En_3_Chapter.html"  data-epub-title="Pro Spring 5: An In-Depth Guide to the Spring Framework and Its Tools" data-debug=0 data-testing=0><![endif]-->
<!--if gt IE 8]><!-->

<!--![endif]-->




<a name="3_"></a>

    <div class="application" id="container" style="height: auto;">
      <div class="js-toc">
        <section role="document">
          <div id="sbo-rt-content" style="max-width:72.5em; transform: none;">
            <div class="annotator-wrapper"><!--egin Abstract-->
                    <div class="MainTitleSection">
                        <h1 class="ChapterTitle" xml:lang="en">3. Introducing IoC and DI in Spring</h1>
                    </div>
                    <div class="AuthorGroup">
                        <div class="AuthorNames"><span class="Author"><span class="AuthorName">Iuliana Cosmina</span><sup>1 <span class="ContactIcon"></span></sup>, </span><span class="Author"><span class="AuthorName">Rob Harrop</span><sup>2</sup>, </span>
                            <span class="Author"><span class="AuthorName">Chris Schaefer</span><sup>3</sup> and </span><span class="Author"><span class="AuthorName">Clarence Ho</span><sup>4</sup></span>
                        </div>
                        <div class="Affiliations">
                            <div class="Affiliation" id="Aff5"><span class="AffiliationNumber">(1)</span>
                                <div class="AffiliationText">Sibiu, Sibiu, Romania</div>
                            </div>
                            <div class="Affiliation" id="Aff6"><span class="AffiliationNumber">(2)</span>
                                <div class="AffiliationText">Reddish, UK</div>
                            </div>
                            <div class="Affiliation" id="Aff7"><span class="AffiliationNumber">(3)</span>
                                <div class="AffiliationText">Venice, Florida, USA</div>
                            </div>
                            <div class="Affiliation" id="Aff8"><span class="AffiliationNumber">(4)</span>
                                <div class="AffiliationText">Hong Kong, China</div>
                            </div>
                            <div class="ClearBoth"> </div>
                        </div>
                    </div>
                    <!--nd Abstract-->
                    <div class="Fulltext">
                        <div class="Para" id="Par1">In Chapter <span class="ExternalRef"><a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_2_Chapter.html"><span class="RefSource">2</span></a>
                            </span>, we covered the basic principles of inversion of control. Practically, dependency injection is a specialized form of IoC, although you will often find that the two terms are used interchangeably. In this chapter, we give you
                            a much more detailed look at IoC and DI, formalizing the relationship between the two concepts and looking in great detail at how Spring fits into the picture.</div>
                        <div class="Para" id="Par2">After defining both and looking at Spring’s relationship with them, we explore the concepts that are essential to Spring’s implementation of DI. This chapter covers only the basics of Spring’s DI implementation; we discuss more
                            advanced DI features in Chapter <span class="ExternalRef"><a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_4_Chapter.html"><span class="RefSource">4</span></a>
                            </span>. More specifically, this chapter covers the following topics:
                            <div class="UnorderedList">
                                <ul class="UnorderedListMarkBullet">
                                    <li>
                                        <div class="Para ParaOneEmphasisChild" id="Par3"> <span class="EmphasisTypeItalic">Inversion of control concepts</span>: In this section, we discuss the various kinds of IoC, including dependency injection and dependency lookup. This section presents the differences
                                            between the various IoC approaches as well as the pros and cons of each.</div>
                                    </li>
                                    <li>
                                        <div class="Para ParaOneEmphasisChild" id="Par4"> <span class="EmphasisTypeItalic">Inversion of control in Spring</span>: This section looks at IoC capabilities available in Spring and how they are implemented. In particular, you’ll see the dependency injection
                                            services that Spring offers, including setter, constructor, and Method Injection.</div>
                                    </li>
                                    <li>
                                        <div class="Para" id="Par5"> <span class="EmphasisTypeItalic">Dependency injection in Spring</span>: This section covers Spring’s implementation of the IoC container. For bean definition and DI requirements, <span class="EmphasisFontCategoryNonProportional">BeanFactory</span>                                            is the main interface an application interacts with. However, other than the first few, the remainder of the sample code provided in this chapter focuses on using Spring’s <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>                                            interface, which is an extension of <span class="EmphasisFontCategoryNonProportional">BeanFactory</span> and provides much more powerful features. We cover the difference between <span class="EmphasisFontCategoryNonProportional">BeanFactory</span>                                            and <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> in later sections.</div>
                                    </li>
                                    <li>
                                        <div class="Para" id="Par6"> <span class="EmphasisTypeItalic">Configuring the Spring application context</span>: The final part of this chapter focuses on using the XML and annotation approaches for <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>                                            configuration. Groovy and Java configuration are further discussed in Chapter <span class="ExternalRef"><a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_4_Chapter.html"><span class="RefSource">4</span></a>
                                            </span>. This section starts with a discussion of DI configuration and moves on to present additional services provided by <span class="EmphasisFontCategoryNonProportional">BeanFactory</span> such as bean inheritance,
                                            life-cycle management, and autowiring.</div>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div class="Section1 RenderAsSection1" id="Sec1">
                            <h2 class="Heading">Inversion of Control and Dependency Injection</h2>
                            <div class="Para" id="Par7">At its core, IoC, and therefore DI, aims to offer a simpler mechanism for provisioning component dependencies (often referred to as an object’s <span class="EmphasisTypeItalic">collaborators</span>) and managing these dependencies
                                throughout their life cycles. A component that requires certain dependencies is often referred to as the <span class="EmphasisTypeItalic">dependent object</span> or, in the case of IoC, the <span class="EmphasisTypeItalic">target</span>.
                                In general, IoC can be decomposed into two subtypes: dependency injection and dependency lookup. These subtypes are further decomposed into concrete implementations of the IoC services. From this definition, you can clearly
                                see that when we are talking about DI, we are always talking about IoC, but when we are talking about IoC, we are not always talking about DI (for example, dependency lookup is also a form of IoC).</div>
                        </div>
                        <div class="Section1 RenderAsSection1" id="Sec2">
                            <h2 class="Heading">Types of Inversion of Control</h2>
                            <div class="Para" id="Par8">You may be wondering why there are two types of IoC and why these types are split further into different implementations. There seems to be no clear answer to this question; certainly the different types provide a level of
                                flexibility, but to us, it seems that IoC is more of a mixture of old and new ideas. The two types of IoC represent this. Dependency lookup is a much more traditional approach, and at first glance, it seems more familiar
                                to Java programmers. Dependency injection, although it appears counterintuitive at first, is actually much more flexible and usable than dependency lookup. With dependency lookup–style IoC, a component must acquire a reference
                                to a dependency, whereas with dependency injection, the dependencies are injected into the component by the IoC container. Dependency lookup comes in two types: dependency pull and <span id="ITerm1">contextualized dependency lookup (CDL)        </span>.
                                Dependency injection also has two common flavors: constructor and setter dependency injection.</div>
                            <div class="Para ParaTypeImportant" id="Par9"><img alt="A315511_5_En_3_Figa_HTML.jpg" data-mfp-src="/library/view/pro-spring-5/9781484228081/A315511_5_En_3_Figa_HTML.jpg" height="28" src="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_3_Figa_HTML.jpg" width="30"/>                                For the discussions in this section, we are not concerned with how the fictional IoC container comes to know about all the different dependencies, just that at some point, it performs the actions described for each mechanism.</div>
                            <div class="Section2 RenderAsSection2" id="Sec3">
                                <h3 class="Heading">Dependency Pull</h3>
                                <div class="Para" id="Par10">To a Java developer, dependency pull is the most familiar types of IoC. In <span id="ITerm2">dependency pull                      </span>, dependencies are pulled from a registry as required. Anyone who has ever written
                                    code to access an EJB (2.1 or prior versions) has used dependency pull (that is, via the JNDI API to look up an EJB component). Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_3_Chapter.html#Fig1">3-1</a></span>                                    shows the scenario of dependency pull via the lookup mechanism.
                                    <div class="Figure" id="Fig1">
                                        <div class="MediaObject" id="MO1"><img alt="A315511_5_En_3_Fig1_HTML.jpg" data-mfp-src="/library/view/pro-spring-5/9781484228081/A315511_5_En_3_Fig1_HTML.jpg" height="137" src="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_3_Fig1_HTML.jpg" width="320"/></div>
                                        <div class="Caption" xml:lang="en">
                                            <div class="CaptionContent"><span class="CaptionNumber">Figure 3-1.</span>
                                                <div class="SimplePara">Dependency pull via JNDI <span id="ITerm3">lookup                                      </span> </div>
                                            </div>
                                    </div>
                                </div>
                        </div>
                        <div class="Para" id="Par11">Spring also offers dependency pull as a mechanism for retrieving the components that the framework manages; you saw this in action in Chapter <span class="ExternalRef"><a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_2_Chapter.html"><span class="RefSource">2</span></a>
                            </span>. The following code sample shows a typical dependency pull lookup in a Spring-based application:</div>
                        <div class="Para" id="Par12">
                            <div class="ProgramCode" id="PC1">
                                <div class="LineGroup">
                                    <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.ApplicationContext</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.support.ClassPathXmlApplicationContext</span>;
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">DependencyPull</span> {
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span>...<span style="font-style:italic">args</span>) {
        <span style="color:#00f;font-weight:700">ApplicationContext</span> ctx <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">ClassPathXmlApplicationContext</span>(<span style="color:#036a07">spring/app-context.xml</span>);
        <span style="color:#00f;font-weight:700">MessageRenderer</span> mr <span style="color:#00f;font-weight:700">=</span> ctx<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#036a07">renderer</span>, <span style="color:#00f;font-weight:700">MessageRenderer</span><span style="color:#00f;font-weight:700">.</span>class);
        mr<span style="color:#00f;font-weight:700">.</span>render();
    }
}
</pre></div>
                                </div>
                            </div>
                        </div>
                        <div class="Para" id="Par13">This kind of IoC is not only prevalent in JEE-based applications (using EJB 2.1 or prior versions), which make extensive use of JNDI lookups to obtain dependencies from a registry, but also pivotal to working with Spring in many
                            environments.</div>
                    </div>
                    <div class="Section2 RenderAsSection2" id="Sec4">
                        <h3 class="Heading">Contextualized Dependency Lookup</h3>
                        <div class="Para" id="Par14"> <span id="ITerm4">            <span class="EmphasisTypeItalic">Contextualized dependency lookup</span> (CDL) </span> is similar, in some respects, to dependency pull, but in CDL, lookup is performed against the container that is
                            managing the resource, not from some central registry, and it is usually performed at some set point. Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_3_Chapter.html#Fig2">3-2</a></span>                            shows the <span id="ITerm5">CDL                      </span> mechanism.
                            <div class="Figure" id="Fig2">
                                <div class="MediaObject" id="MO2"><img alt="A315511_5_En_3_Fig2_HTML.jpg" data-mfp-src="/library/view/pro-spring-5/9781484228081/A315511_5_En_3_Fig2_HTML.jpg" height="188" src="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_3_Fig2_HTML.jpg" width="240"/></div>
                                <div class="Caption" xml:lang="en">
                                    <div class="CaptionContent"><span class="CaptionNumber">Figure 3-2.</span>
                                        <div class="SimplePara">Contextualized dependency lookup</div>
                                    </div>
                            </div>
                        </div>
                    </div>
                    <div class="Para" id="Par15">CDL works by having the component implement an interface similar to that in the following code snippet:</div>
                    <div class="Para" id="Par16">
                        <div class="ProgramCode" id="PC2">
                            <div class="LineGroup">
                                <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3</span>;
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">interface</span> <span style="text-decoration:underline">ManagedComponent</span> {
    <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">performLookup</span>(<span style="color:#00f;font-weight:700">Container</span> <span style="font-style:italic">container</span>);
}
</pre></div>
                            </div>
                        </div>
                    </div>
                    <div class="Para" id="Par17">By <span id="ITerm6">implementing          </span> <span id="ITerm7">                                              </span> this interface, a component is signaling to the container that it wants to obtain a dependency. The container
                        is usually provided by the underlying application server or framework (for example, Tomcat or JBoss) or framework (for example, Spring). The following code snippet shows a simple <span class="EmphasisFontCategoryNonProportional">Container</span>                        interface that provides a dependency lookup service:</div>
                    <div class="Para" id="Par18">
                        <div class="ProgramCode" id="PC3">
                            <div class="LineGroup">
                                <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3</span>;
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">interface</span> <span style="text-decoration:underline">Container</span> {
    <span style="color:#00f;font-weight:700">Object</span> <span style="color:#0000a2;font-weight:700">getDependency</span>(<span style="color:#00f;font-weight:700">String</span> <span style="font-style:italic">key</span>);
}
</pre></div>
                            </div>
                        </div>
                    </div>
                    <div class="Para" id="Par19">When the container is ready to pass dependencies to a component, it calls <span id="ITerm8">                <span class="EmphasisFontCategoryNonProportional">performLookup()</span> </span> on each component in turn. The component can
                        then look up its dependencies by using the <span class="EmphasisFontCategoryNonProportional">Container</span> interface, as shown in the following code snippet:</div>
                    <div class="Para" id="Par20">
                        <div class="ProgramCode" id="PC4">
                            <div class="LineGroup">
                                <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3</span>;
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">ContextualizedDependencyLookup</span>
<span style="color:#00f;font-weight:700">implements</span> <span style="font-style:italic">ManagedComponent</span> {
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">Dependency</span> dependency;<span style="color:#00f;font-weight:700">@Override</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">performLookup</span>(<span style="color:#00f;font-weight:700">Container</span> <span style="font-style:italic">container</span>) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>dependency <span style="color:#00f;font-weight:700">=</span> (<span style="color:#00f;font-weight:700">Dependency</span>) container<span style="color:#00f;font-weight:700">.</span>getDependency(<span style="color:#036a07">myDependency</span>);
    }

    <span style="color:#00f;font-weight:700">@Override</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">String</span> <span style="color:#0000a2;font-weight:700">toString</span>() {
        <span style="color:#00f;font-weight:700">return</span> dependency<span style="color:#00f;font-weight:700">.</span>toString();
    }
}
</pre></div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="Section2 RenderAsSection2" id="Sec5">
                    <h3 class="Heading"> <span id="ITerm11">Constructor                      </span> Dependency Injection</h3>
                    <div class="Para ParaOneEmphasisChild" id="Par21"> <span class="EmphasisTypeItalic">Constructor dependency injection</span> occurs when a component’s dependencies are provided to it in its constructor (or constructors). The component declares a constructor or a set of constructors,
                        taking as arguments its dependencies, and the IoC container passes the dependencies to the component when instantiation occurs, as shown in the following code snippet:</div>
                    <div class="Para" id="Par22">
                        <div class="ProgramCode" id="PC5">
                            <div class="LineGroup">
                                <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3</span>;
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">ConstructorInjection</span> {
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">Dependency</span> dependency;
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#0000a2;font-weight:700">ConstructorInjection</span>(<span style="color:#00f;font-weight:700">Dependency</span> <span style="font-style:italic">dependency</span>) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>dependency <span style="color:#00f;font-weight:700">=</span> dependency;
    }
    
    <span style="color:#00f;font-weight:700">@Override</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">String</span> <span style="color:#0000a2;font-weight:700">toString</span>() {
        <span style="color:#00f;font-weight:700">return</span> dependency<span style="color:#00f;font-weight:700">.</span>toString();
    }
}
</pre></div>
                            </div>
                        </div>
                    </div>
                    <div class="Para" id="Par23">An obvious consequence of using constructor injection is that an object cannot be created without its dependencies; thus, they are mandatory.</div>
                </div>
                <div class="Section2 RenderAsSection2" id="Sec6">
                    <h3 class="Heading">Setter Dependency Injection</h3>
                    <div class="Para" id="Par24">In <span id="ITerm12">                <span class="EmphasisTypeItalic">setter</span> </span> <span class="EmphasisTypeItalic">dependency injection</span>, the IoC container injects a component’s dependencies via JavaBean-style setter
                        methods. A component’s setters expose the dependencies the IoC container can manage. The following code sample shows a typical setter dependency injection–based component:</div>
                    <div class="Para" id="Par25">
                        <div class="ProgramCode" id="PC6">
                            <div class="LineGroup">
                                <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3</span>;
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">SetterInjection</span> {
        <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">Dependency</span> dependency;
        <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setDependency</span>(<span style="color:#00f;font-weight:700">Dependency</span> <span style="font-style:italic">dependency</span>) {
            <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>dependency <span style="color:#00f;font-weight:700">=</span> dependency;
        }
        <span style="color:#00f;font-weight:700">@Override</span>
        <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">String</span> <span style="color:#0000a2;font-weight:700">toString</span>() {
            <span style="color:#00f;font-weight:700">return</span> dependency<span style="color:#00f;font-weight:700">.</span>toString();
        }
}
</pre></div>
                            </div>
                        </div>
                    </div>
                    <div class="Para" id="Par26">An obvious <span id="ITerm13">consequence                      </span> of using setter injection is that an object can be created without its dependencies, and they can be provided later by calling the setter.</div>
                    <div class="Para" id="Par27">Within the container, the dependency requirement exposed by the <span id="ITerm14">            <span class="EmphasisFontCategoryNonProportional">setDependency()</span> method </span> is referred to by the JavaBeans-style name,
                        <span class="EmphasisFontCategoryNonProportional">dependency</span>. In practice, setter injection is the most widely used injection mechanism, and it is one of the simplest IoC mechanisms to implement.</div>
                    <div class="Para ParaTypeImportant" id="Par28"> <img alt="A315511_5_En_3_Figa_HTML.jpg" data-mfp-src="/library/view/pro-spring-5/9781484228081/A315511_5_En_3_Figa_HTML.jpg" height="28" src="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_3_Figa_HTML.jpg" width="30"/>                        There is a another type of injection supported in Spring called <span id="ITerm15">                <span class="EmphasisTypeItalic">field injection</span> </span>, but this will be covered later in the chapter, when you learn about
                        autowiring using the <span class="EmphasisFontCategoryNonProportional">@Autowire</span> annotation.</div>
                </div>
                <div class="Section2 RenderAsSection2" id="Sec7">
                    <h3 class="Heading"> <span id="ITerm16">Injection vs. Lookup                      </span> </h3>
                    <div class="Para" id="Par29">Choosing which style of IoC to use—injection or lookup—is not usually a difficult decision. In many cases, the type of IoC you use is mandated by the container you are using. For instance, if you are using EJB 2.1 or prior versions,
                        you must use lookup-style IoC (via JNDI) to obtain an EJB from the JEE container. In Spring, aside from initial bean lookups, your components and their dependencies are always wired together using injection-style IoC.</div>
                    <div class="Para ParaTypeImportant" id="Par30"> <img alt="A315511_5_En_3_Figa_HTML.jpg" data-mfp-src="/library/view/pro-spring-5/9781484228081/A315511_5_En_3_Figa_HTML.jpg" height="28" src="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_3_Figa_HTML.jpg" width="30"/>                        When you are using Spring, you can access EJB resources without needing to perform an explicit lookup. Spring can act as an adapter between lookup and injection-style IoC systems, thus allowing you to manage all resources by using
                        injection.</div>
                <div class="Para" id="Par31">The real question is this: given the choice, which method should you use, injection or lookup? The answer is most definitely injection. If you look at the code in the previous code samples, you can clearly see that using injection has
                    zero impact on your components’ code. The dependency pull code, on the other hand, must actively obtain a reference to the registry and interact with it to obtain the dependencies, and using CDL requires your classes to implement a
                    specific interface and look up all dependencies manually. When you are using injection, the most your classes have to do is allow dependencies to be injected by using either constructors or setters.</div>
                <div class="Para" id="Par32">Using injection, you are free to use your classes completely decoupled from the IoC container that is supplying dependent objects with their collaborators manually, whereas with lookup, your classes are always dependent on the classes
                    and interfaces defined by the container. Another drawback with lookup is that it becomes difficult to test your classes in isolation from the container. Using injection, testing your components is trivial because you can simply provide
                    the dependencies yourself by using the appropriate constructor or setter.</div>
                <div class="Para ParaTypeImportant" id="Par33"> <img alt="A315511_5_En_3_Figa_HTML.jpg" data-mfp-src="/library/view/pro-spring-5/9781484228081/A315511_5_En_3_Figa_HTML.jpg" height="28" src="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_3_Figa_HTML.jpg" width="30"/>                    For a more complete discussion of testing by using dependency injection and Spring, refer to Chapter <span class="ExternalRef"><a href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_13_Chapter.html"><span class="RefSource">13</span></a>
                    </span>.</div>
                <div class="Para" id="Par34">Lookup-based solutions are, by necessity, more complex than injection-based ones. Although complexity is nothing to be afraid of, we question the validity of adding unneeded complexity to a process as central to your application as dependency
                    management.</div>
                <div class="Para" id="Par35">All of these reasons aside, the biggest reason to choose injection over lookup is that it makes your life easier. You write substantially less code when you are using injection, and the code that you do write is simple and can, in general,
                    be automated by a good <span id="ITerm17">IDE                      </span>. You will notice that all the code in the injection samples is passive, in that it doesn’t actively try to accomplish a task. The most exciting thing you see
                    in injection code is that objects get stored in a field only; no other code is involved in pulling the dependency from any registry or container. Therefore, the code is much simpler and less error prone. Passive code is much simpler
                    to maintain than active code because there is very little that can go wrong. Consider the following code taken from the CDL example:</div>
                <div class="Para" id="Par36">
                    <div class="ProgramCode" id="PC7">
                        <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> performLookup(<span style="color:#00f;font-weight:700">Container</span> container) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>dependency <span style="color:#00f;font-weight:700">=</span> (<span style="color:#00f;font-weight:700">Dependency</span>) container<span style="color:#00f;font-weight:700">.</span>getDependency(<span style="color:#036a07">myDependency</span>);
}
</pre></div>
                    </div>
                </div>
                <div class="Para ParaOneEmphasisChild" id="Par37">In this code, plenty could go wrong: the dependency key could change, the container instance could be <span class="EmphasisFontCategoryNonProportional">null</span>, or the returned dependency might be the incorrect type. We refer to this
                    code as having a lot of moving parts, because plenty of things can break. Using dependency lookup might decouple the components of your application, but it adds complexity in the additional code required to couple these components
                    back together in order to perform any useful tasks.</div>
            </div>
            <div class="Section2 RenderAsSection2" id="Sec8">
                <h3 class="Heading"> <span id="ITerm18">Setter Injection vs. Constructor Injection                      </span> </h3>
                <div class="Para ParaOneEmphasisChild" id="Par38">Now that we have established which method of IoC is preferable, you still need to choose whether to use setter injection or constructor injection. <span class="EmphasisTypeItalic">Constructor injection</span> is particularly useful when
                    you absolutely must have an instance of the dependency class before your component is used. Many containers, Spring included, provide a mechanism for ensuring that all dependencies are defined when you use setter injection, but by
                    using constructor injection, you assert the requirement for the dependency in a container-agnostic manner. Constructor injection also helps achieve the use of immutable objects.</div>
                <div class="Para" id="Par39"> <span class="EmphasisTypeItalic">Setter injection</span> is useful in a variety of cases. If the component is exposing its dependencies to the container but is happy to provide its own defaults, setter injection is usually the best way
                    to accomplish this. Another benefit of setter injection is that it allows dependencies to be declared on an interface, although this is not as useful as you might first think. Consider a typical business interface with one business
                    method, <span class="EmphasisFontCategoryNonProportional">defineMeaningOfLife()</span>. If, in addition to this method, you define a setter for injection such as <span class="EmphasisFontCategoryNonProportional">setEncylopedia()</span>,
                    you are mandating that all implementations must use or at least be aware of the encyclopedia dependency. However, you don’t need to define <span class="EmphasisFontCategoryNonProportional">setEncylopedia()</span> in the business interface.
                    Instead, you can define the method in the classes implementing the business interface. While programming in this way, all recent IoC containers, Spring included, can work with the component in terms of the business interface but still
                    provide the dependencies of the implementing class. An example of this may clarify this <span id="ITerm19">matter                       </span>slightly. Consider the business interface in the following code snippet:</div>
                <div class="Para" id="Par40">
                    <div class="ProgramCode" id="PC8">
                        <div class="LineGroup">
                            <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3</span>;
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">interface</span> <span style="text-decoration:underline">Oracle</span> {
    <span style="color:#00f;font-weight:700">String</span> <span style="color:#0000a2;font-weight:700">defineMeaningOfLife</span>();
}
</pre></div>
                        </div>
                    </div>
                </div>
                <div class="Para" id="Par41">Notice that the business interface does not define any setters for dependency injection. This interface could be implemented as shown in the following code snippet:</div>
                <div class="Para" id="Par42">
                    <div class="ProgramCode" id="PC9">
                        <div class="LineGroup">
                            <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3</span>;
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">BookwormOracle</span> <span style="color:#00f;font-weight:700">implements</span> <span style="font-style:italic">Oracle</span> {
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">Encyclopedia</span> encyclopedia;
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setEncyclopedia</span>(<span style="color:#00f;font-weight:700">Encyclopedia</span> <span style="font-style:italic">encyclopedia</span>) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>encyclopedia <span style="color:#00f;font-weight:700">=</span> encyclopedia;
    }
    <span style="color:#00f;font-weight:700">@Override</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">String</span> <span style="color:#0000a2;font-weight:700">defineMeaningOfLife</span>() {
        <span style="color:#00f;font-weight:700">return</span> <span style="color:#036a07">Encyclopedias are a waste of money - go see the world instead</span>;
    }
}
</pre></div>
                        </div>
                    </div>
                </div>
                <div class="Para" id="Par43">As you can see, the <span id="ITerm20">            <span class="EmphasisFontCategoryNonProportional">BookwormOracle</span> class </span> not only implements the Oracle interface but also defines the setter for dependency injection. Spring
                    is more than comfortable dealing with a structure like this. There is absolutely no need to define the dependencies on the business interface. The ability to use interfaces to define dependencies is an often-touted benefit of setter
                    injection, but in actuality, you should strive to keep setters used solely for injection out of your interfaces. Unless you are absolutely sure that all implementations of a particular business interface require a particular dependency,
                    let each implementation class define its own dependencies and keep the business interface for business methods.</div>
                <div class="Para" id="Par44">Although you shouldn’t always place setters for dependencies in a business interface, placing setters and getters for configuration parameters in the business interface is a good idea and makes setter injection a valuable tool. We consider
                    configuration parameters to be a special case for dependencies. Certainly your components depend on the configuration data, but configuration data is significantly different from the types of dependency you have seen so far. We will
                    discuss the differences shortly, but for now, consider the business interface shown in the following code snippet:</div>
                <div class="Para" id="Par45">
                    <div class="ProgramCode" id="PC10">
                        <div class="LineGroup">
                            <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3</span>;
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">interface</span> <span style="text-decoration:underline">NewsletterSender</span> {
    <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setSmtpServer</span>(<span style="color:#00f;font-weight:700">String</span> <span style="font-style:italic">smtpServer</span>);
    <span style="color:#00f;font-weight:700">String</span> <span style="color:#0000a2;font-weight:700">getSmtpServer</span>();
    <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setFromAddress</span>(<span style="color:#00f;font-weight:700">String</span> <span style="font-style:italic">fromAddress</span>);
    <span style="color:#00f;font-weight:700">String</span> <span style="color:#0000a2;font-weight:700">getFromAddress</span>();
    <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">send</span>();
}
</pre></div>
                        </div>
                    </div>
                </div>
                <div class="Para" id="Par46">Classes that send a set of newsletters via e-mail implement the <span id="ITerm21">            <span class="EmphasisFontCategoryNonProportional">NewsletterSender</span> interface </span> <span id="ITerm22">                                              </span>.
                    The <span class="EmphasisFontCategoryNonProportional">send()</span> method is the only business method, but notice that we have defined two JavaBean properties on the interface. Why are we doing this when we just said that you shouldn’t
                    define dependencies in the business interface? The reason is that these values, the SMTP server address and the address the e-mails are sent from, are not dependencies in the practical sense; rather, they are configuration details
                    that affect how all implementations of the <span class="EmphasisFontCategoryNonProportional">NewsletterSender</span> interface function. The question here then is this: what is the difference between a configuration parameter and any
                    other kind of dependency? In most cases, you can clearly see whether a dependency should be classified as a configuration parameter, but if you are not sure, look for the following three characteristics that point to a configuration
                    parameter:
                    <div class="UnorderedList">
                        <ul class="UnorderedListMarkBullet">
                            <li>
                                <div class="Para" id="Par47">Configuration parameters are passive. In the <span class="EmphasisFontCategoryNonProportional">NewsletterSender</span> example depicted in the previous code snippet, the SMTP server parameter is an example of a passive
                                    dependency. Passive dependencies are not used directly to perform an action; instead, they are used internally or by another dependency to perform their actions. In the <span class="EmphasisFontCategoryNonProportional">MessageRenderer</span>                                    example from Chapter <span class="ExternalRef"><a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_2_Chapter.html"><span class="RefSource">2</span></a>
                                    </span>, the <span class="EmphasisFontCategoryNonProportional">MessageProvider</span> dependency was not passive; it performed a function that was necessary for the <span class="EmphasisFontCategoryNonProportional">MessageRenderer</span>                                    to complete its task.</div>
                            </li>
                            <li>
                                <div class="Para" id="Par48">Configuration parameters are usually information, not other components. By this we mean that a configuration parameter is usually some piece of information that a component needs to complete its work. Clearly, the SMTP
                                    server is a piece of information required by the <span class="EmphasisFontCategoryNonProportional">NewsletterSender</span>, but the <span class="EmphasisFontCategoryNonProportional">MessageProvider</span> is really
                                    another component that the <span class="EmphasisFontCategoryNonProportional">MessageRenderer</span> needs to function correctly.</div>
                            </li>
                            <li>
                                <div class="Para" id="Par49">Configuration parameters are usually simple values or collections of simple values. This is really a by-product of the previous two points, but configuration parameters are usually simple values. In Java this means they
                                    are a primitive (or the corresponding wrapper class) or a <span class="EmphasisFontCategoryNonProportional">String</span> or collections of these values. Simple values are generally passive. This means you can’t do
                                    much with a <span class="EmphasisFontCategoryNonProportional">String</span> other than manipulate the data it represents; and you almost always use these values for information purposes, for example, an <span class="EmphasisFontCategoryNonProportional">int</span>                                    value that represents the port number that a network socket should listen on or a <span class="EmphasisFontCategoryNonProportional">String</span> that represents the SMTP server through which an e-mail program should
                                    send messages.</div>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="Para" id="Par50">When considering whether to define <span id="ITerm23">configuration                      </span> options in the business interface, also consider whether the configuration parameter is applicable to all implementations of the business
                    interface or just one. For instance, in the case of implementations of <span class="EmphasisFontCategoryNonProportional">NewsletterSender</span>, it is obvious that all implementations need to know which SMTP server to use when sending
                    e-mails. However, we would probably choose to leave the configuration option that flags whether to send secure e-mail off the business interface because not all e-mail APIs are capable of this, and it is correct to assume that many
                    implementations will not take security into consideration at all.</div>
                <div class="Para ParaTypeImportant" id="Par51"> <img alt="A315511_5_En_3_Figa_HTML.jpg" data-mfp-src="/library/view/pro-spring-5/9781484228081/A315511_5_En_3_Figa_HTML.jpg" height="28" src="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_3_Figa_HTML.jpg" width="30"/>                    Recall that in Chapter <span class="ExternalRef"><a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_2_Chapter.html"><span class="RefSource">2</span></a>
                    </span> it was chosen to define the dependencies in the business purposes. This was for illustration purposes and should not be treated in any way as a best practice.</div>
                <div class="Para" id="Par52">Setter injection also allows you to swap dependencies for a different implementation on the fly without creating a new instance of the parent component. Spring’s JMX support makes this possible. Perhaps the biggest benefit of setter injection
                    is that it is the least intrusive of the injection mechanisms.</div>
                <div class="Para" id="Par53">In general, you should choose an injection type based on your use case. Setter-based injection allows dependencies to be swapped out without creating new objects and also lets your class choose appropriate defaults without the need to
                    explicitly inject an object. Constructor injection is a good choice when you want to ensure that dependencies are being passed to a component and when designing for immutable objects. Do keep in mind that while constructor injection
                    ensures that all dependencies are provided to a component, most containers provide a mechanism to ensure this as well but may incur a cost of coupling your code to the framework.</div>
            </div>
    </div>
    <div class="Section1 RenderAsSection1" id="Sec9">
        <h2 class="Heading">Inversion of Control in Spring</h2>
        <div class="Para" id="Par54">As mentioned earlier, inversion of control is a big part of what Spring does. The core of Spring’s implementation is based on dependency injection, although dependency lookup features are provided as well. When Spring provides collaborators to
            a dependent object automatically, it does so using dependency injection. In a Spring-based application, it is always preferable to use dependency injection to pass collaborators to dependent objects rather than have the dependent objects obtain
            the collaborators via lookup. Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_3_Chapter.html#Fig3">3-3</a></span> shows Spring’s dependency injection mechanism. Although
            <span id="ITerm24">dependency injection                  </span> is the preferred mechanism for wiring together collaborators and dependent objects, you need dependency lookup to access the dependent objects. In many environments, Spring cannot
            automatically wire up all of your application components by using dependency injection, and you must use dependency lookup to access the initial set of components. For example, in stand-alone Java applications, you need to bootstrap Spring’s
            container in the <span class="EmphasisFontCategoryNonProportional">main()</span> method and obtain the dependencies (via the <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> interface) for processing programmatically.
            However, when you are building web applications by using Spring’s MVC support, Spring can avoid this by gluing your entire application together automatically. Wherever it is possible to use <span id="ITerm25">dependency injection                  </span>            with Spring, you should do so; otherwise, you can fall back on the dependency lookup capabilities. You will see examples of both in action during the course of this chapter, and we will point them out when they first arise.
            <div class="Figure" id="Fig3">
                <div class="MediaObject" id="MO3"><img alt="A315511_5_En_3_Fig3_HTML.jpg" data-mfp-src="/library/view/pro-spring-5/9781484228081/A315511_5_En_3_Fig3_HTML.jpg" height="53" src="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_3_Fig3_HTML.jpg" width="360"/></div>
                <div class="Caption" xml:lang="en">
                    <div class="CaptionContent"><span class="CaptionNumber">Figure 3-3.</span>
                        <div class="SimplePara">Spring’s dependency injection mechanism</div>
                    </div>
            </div>
        </div>
    </div>
    <div class="Para" id="Par55">An interesting feature of Spring’s IoC container is that it has the ability to act as an adapter between its own dependency injection container and external dependency lookup containers. We discuss this feature later in this chapter.</div>
    <div class="Para" id="Par56">Spring supports both constructor and setter injection and bolsters the standard IoC feature set with a whole host of useful additions to make your life easier.</div>
    <div class="Para" id="Par57">The rest of this chapter introduces the basics of Spring’s DI container, complete with plenty of examples.</div>
    </div>
    <div class="Section1 RenderAsSection1" id="Sec10">
        <h2 class="Heading">Dependency Injection in Spring</h2>
        <div class="Para" id="Par58">Spring’s support for dependency injection is comprehensive and, as you will see in Chapter <span class="ExternalRef"><a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_4_Chapter.html"><span class="RefSource">4</span></a>
            </span>, goes beyond the standard IoC feature set we have discussed so far. The rest of this chapter addresses the basics of Spring’s dependency injection container, looking at setter, constructor, and Method Injection, along with a detailed look
            at how dependency injection is configured in Spring.</div>
        <div class="Section2 RenderAsSection2" id="Sec11">
            <h3 class="Heading"> <span id="ITerm26">Beans and BeanFactory                      </span> </h3>
            <div class="Para" id="Par59">The core of Spring’s dependency injection container is the <span class="EmphasisFontCategoryNonProportional">BeanFactory</span> interface. <span class="EmphasisFontCategoryNonProportional">BeanFactory</span> is responsible for managing components,
                including their dependencies as well as their life cycles. In Spring, the term <span class="EmphasisTypeItalic">bean</span> is used to refer to any component managed by the container. Typically, your beans adhere, at some level, to the
                JavaBeans specification, but this is not required, especially if you plan to use constructor injection to wire your beans together.</div>
            <div class="Para" id="Par60">If your application needs only DI support, you can interact with the Spring DI container via the <span class="EmphasisFontCategoryNonProportional">BeanFactory</span> interface. In this case, your application must create an instance of a class
                that implements the <span class="EmphasisFontCategoryNonProportional">BeanFactory</span> interface and configures it with bean and dependency information. After this is complete, your application can access the beans via <span class="EmphasisFontCategoryNonProportional">BeanFactory</span>                and get on with its processing.</div>
            <div class="Para" id="Par61">In some cases, all of this setup is handled automatically (for example, in a web application, Spring’s <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> will be bootstrapped by the web container during application
                startup via a Spring-provided <span class="EmphasisFontCategoryNonProportional">ContextLoaderListener</span> class declared in the <span class="EmphasisFontCategoryNonProportional">web.xml</span> descriptor file). But in many cases, you
                need to code the setup yourself. All of the examples in this chapter require manual setup of the <span class="EmphasisFontCategoryNonProportional">BeanFactory</span> implementation.</div>
            <div class="Para" id="Par62">Although the <span class="EmphasisFontCategoryNonProportional">BeanFactory</span> can be configured programmatically, it is more common to see it configured externally using some kind of configuration file. Internally, bean configuration is
                represented by instances of classes that implement the <span class="EmphasisFontCategoryNonProportional">BeanDefinition</span> interface. The bean configuration stores information not only about a bean itself but also about the beans that
                it depends on. For any <span class="EmphasisFontCategoryNonProportional">BeanFactory</span> implementation classes that also implement the <span class="EmphasisFontCategoryNonProportional">BeanDefinitionReader</span> interface, you can
                read the <span class="EmphasisFontCategoryNonProportional">BeanDefinition</span> data from a configuration file, using either <span class="EmphasisFontCategoryNonProportional">PropertiesBeanDefinitionReader</span> or <span class="EmphasisFontCategoryNonProportional">XmlBeanDefinitionReader. PropertiesBeanDefinitionReader</span>                reads the bean definition from properties files, while <span class="EmphasisFontCategoryNonProportional">XmlBeanDefinitionReader</span> reads from XML <span id="ITerm27">files                      </span>.</div>
            <div class="Para" id="Par63">So, you can identify your beans within <span class="EmphasisFontCategoryNonProportional">BeanFactory</span>; each bean can be assigned an ID, a name, or both. A bean can also be instantiated without any ID or name (known as an <span class="EmphasisTypeItalic">anonymous bean</span>)
                or as an inner bean within another bean. Each bean has at least one name but can have any number of names (additional names are separated by commas). Any names after the first are considered aliases for the same bean. You use bean IDs
                or names to retrieve a bean from <span class="EmphasisFontCategoryNonProportional">BeanFactory</span> and also to establish dependency relationships (that is, bean X depends on bean Y).</div>
        </div>
        <div class="Section2 RenderAsSection2" id="Sec12">
            <h3 class="Heading"> <span id="ITerm28">BeanFactory Implementations                      </span> </h3>
            <div class="Para ParaOneEmphasisChild" id="Par64">The description of the <span class="EmphasisFontCategoryNonProportional">BeanFactory</span> interface may appear overly complex, but in practice, this is not the case. Take a look at a simple example. Let’s say you have an implementation that
                mimics an oracle that can tell you the meaning of life.</div>
            <div class="Para" id="Par65">
                <div class="ProgramCode" id="PC11">
                    <div class="LineGroup">
                        <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#06f;font-style:italic">//interface</span>
<span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3</span>;
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">interface</span> <span style="text-decoration:underline">Oracle</span> {
    <span style="color:#00f;font-weight:700">String</span> <span style="color:#0000a2;font-weight:700">defineMeaningOfLife</span>();
}
<span style="color:#06f;font-style:italic">//implementation</span>
<span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3</span>;
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">BookwormOracle</span> <span style="color:#00f;font-weight:700">implements</span> <span style="font-style:italic">Oracle</span> {
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">Encyclopedia</span> encyclopedia;
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setEncyclopedia</span>(<span style="color:#00f;font-weight:700">Encyclopedia</span> <span style="font-style:italic">encyclopedia</span>) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>encyclopedia <span style="color:#00f;font-weight:700">=</span> encyclopedia;
    }
    <span style="color:#00f;font-weight:700">@Override</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">String</span> <span style="color:#0000a2;font-weight:700">defineMeaningOfLife</span>() {
        <span style="color:#00f;font-weight:700">return</span> <span style="color:#036a07">Encyclopedias are a waste of money - go see the world instead</span>;
    }
}
</pre></div>
                    </div>
                </div>
            </div>
            <div class="Para" id="Par66">Now let’s see, in a stand-alone Java <span id="ITerm29">program                      </span>, how Spring’s <span class="EmphasisFontCategoryNonProportional">BeanFactory</span> can be initialized and obtain the <span class="EmphasisFontCategoryNonProportional">oracle</span>                bean for processing. Here’s the code:</div>
            <div class="Para" id="Par67">
                <div class="ProgramCode" id="PC12">
                    <div class="LineGroup">
                        <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.beans.factory.support.DefaultListableBeanFactory</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.beans.factory.xml.XmlBeanDefinitionReader</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.core.io.ClassPathResource</span>;
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">XmlConfigWithBeanFactory</span> {
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span>...<span style="font-style:italic">args</span>) {
        <span style="color:#00f;font-weight:700">DefaultListableBeanFactory</span> factory <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">DefaultListableBeanFactory</span>();
        <span style="color:#00f;font-weight:700">XmlBeanDefinitionReader</span> rdr <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">XmlBeanDefinitionReader</span>(factory);
        rdr<span style="color:#00f;font-weight:700">.</span>loadBeanDefinitions(<span style="color:#00f;font-weight:700">new</span>
        <span style="color:#00f;font-weight:700">ClassPathResource</span>(<span style="color:#036a07">spring/xml-bean-factory-config.xml</span>));
        <span style="color:#00f;font-weight:700">Oracle</span> oracle <span style="color:#00f;font-weight:700">=</span> (<span style="color:#00f;font-weight:700">Oracle</span>) factory<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#036a07">oracle</span>);
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(oracle<span style="color:#00f;font-weight:700">.</span>defineMeaningOfLife());
    }
}
</pre></div>
                    </div>
                </div>
            </div>
            <div class="Para" id="Par68">In the previous code sample, you can see that we are using <span class="EmphasisFontCategoryNonProportional">DefaultListableBeanFactory</span>, which is one of the two main <span class="EmphasisFontCategoryNonProportional">BeanFactory</span>                implementations supplied with Spring, and that we are reading in the <span class="EmphasisFontCategoryNonProportional">BeanDefinition</span> information from an XML file by using <span class="EmphasisFontCategoryNonProportional">XmlBeanDefinitionReader</span>.
                Once the <span class="EmphasisFontCategoryNonProportional">BeanFactory</span> implementation is created and configured, we retrieve the <span class="EmphasisFontCategoryNonProportional">oracle</span> bean by using its name, <span class="EmphasisFontCategoryNonProportional">oracle</span>,
                which is configured in the XML configuration file.</div>
            <div class="Para" id="Par69">
                <div class="ProgramCode" id="PC13">
                    <div class="LineGroup">
                        <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#68685b">&lt;?<span style="color:#888">xml</span><span style="color:#888"> version</span>=<span style="color:#888">1.0</span><span style="color:#888"> encoding</span>=<span style="color:#888">UTF-8</span>?&gt;</span>
<span style="color:#1c02ff">&lt;<span style="font-weight:700">beans</span> <span style="font-style:italic">xmlns</span>=<span style="color:#036a07">http://www.springframework.org/schema/beans</span>
    <span style="font-style:italic">xmlns</span>:xsi=<span style="color:#036a07">http://www.w3.org/2001/XMLSchema-instance</span>
    <span style="font-style:italic">xsi</span>:schemaLocation=<span style="color:#036a07">http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans.xsd</span>&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">oracle</span>
        <span style="font-style:italic">name</span>=<span style="color:#036a07">wiseworm</span>
        <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch3.BookwormOracle</span>/&gt;</span>
<span style="color:#1c02ff">&lt;/<span style="font-weight:700">beans</span>&gt;</span>
</pre></div>
                    </div>
                </div>
            </div>
            <div class="Para ParaTypeImportant" id="Par70"> <img alt="A315511_5_En_3_Figa_HTML.jpg" data-mfp-src="/library/view/pro-spring-5/9781484228081/A315511_5_En_3_Figa_HTML.jpg" height="28" src="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_3_Figa_HTML.jpg" width="30"/>                When declaring a Spring XSD location, it’s a best practice to not include the version number. This resolution is already handled for you by Spring as the versioned XSD file is configured through a pointer in the <span class="EmphasisFontCategoryNonProportional">spring.schemas</span>                file. This file resides in the <span class="EmphasisFontCategoryNonProportional">spring-beans</span> module defined as a dependency in your project. This also prevents you from having to modify all of your bean files when upgrading to
                a new version of Spring.</div>
            <div class="Para" id="Par71">The previous file declares a Spring bean, gives it an ID of <span class="EmphasisFontCategoryNonProportional">oracle</span> and a name of <span class="EmphasisFontCategoryNonProportional">wiseworm</span>, and tells Spring that the underlying
                implementation class is <span class="EmphasisFontCategoryNonProportional">com.apress.prospring4.ch3.BookwormOracle</span>. Don’t worry too much about the configuration at the moment; we discuss the details in later sections.</div>
            <div class="Para ParaOneEmphasisChild" id="Par72">Having the configuration defined, run the program shown in the previous code sample; you will see the phrase returned by the <span class="EmphasisFontCategoryNonProportional">defineMeaningOfLife()</span> method in the console output.</div>
        <div class="Para" id="Par73">In addition to <span class="EmphasisFontCategoryNonProportional">XmlBeanDefinitionReader</span>, Spring also provides <span class="EmphasisFontCategoryNonProportional">PropertiesBeanDefinitionReader</span>, which allows you to manage your bean
            configuration by using properties rather than XML. Although properties are ideal for small, simple applications, they can quickly become cumbersome when you are dealing with a large number of beans. For this reason, it is preferable to use
            the XML configuration format for all but the most trivial of applications.</div>
    <div class="Para" id="Par74">Of course, you are free to define your own <span class="EmphasisFontCategoryNonProportional">BeanFactory</span> implementations, although be aware that doing so is quite involved; you need to implement a lot more interfaces than just <span class="EmphasisFontCategoryNonProportional">BeanFactory</span>        to get the same level of functionality you have with the supplied <span class="EmphasisFontCategoryNonProportional">BeanFactory</span> implementations. If all you want to do is define a new configuration mechanism, create your definition reader
        by developing a class that extends the <span class="EmphasisFontCategoryNonProportional">DefaultListableBeanFactory</span> class, which has the <span class="EmphasisFontCategoryNonProportional">BeanFactory</span> interface implemented.</div>
    </div>
    <div class="Section2 RenderAsSection2" id="Sec13">
        <h3 class="Heading"> <span id="ITerm31">ApplicationContext                      </span> </h3>
        <div class="Para" id="Par75">In Spring, the <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> interface is an extension to <span class="EmphasisFontCategoryNonProportional">BeanFactory</span>. In addition to DI services, <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>            provides other services, such as transaction and AOP service, message source for internationalization (i18n), and application event handling, to name a few. In developing Spring-based applications, it’s recommended that you interact with Spring
            via the <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> interface. Spring supports the bootstrapping of <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> by manual coding (instantiate it
            manually and load the appropriate configuration) or in a web container environment via <span class="EmphasisFontCategoryNonProportional">ContextLoaderListener</span>. From this point onward, all the sample code in this book uses <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>            and its implementations.</div>
    </div>
    </div>
    <div class="Section1 RenderAsSection1" id="Sec14">
        <h2 class="Heading">Configuring ApplicationContext</h2>
        <div class="Para" id="Par76">Having discussed the basic concepts of IoC and DI and gone through a simple example of using Spring’s <span class="EmphasisFontCategoryNonProportional">BeanFactory</span> interface, let’s dive into the details of how to configure a Spring application.
            In the following sections, we go through various aspects of configuring Spring applications. Specifically, we should focus our attention on the <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> interface, which provides
            many more configuration options than the traditional <span class="EmphasisFontCategoryNonProportional">BeanFactory</span> interface.</div>
        <div class="Section2 RenderAsSection2" id="Sec15">
            <h3 class="Heading">Setting Spring <span id="ITerm32">Configuration Options                      </span> </h3>
            <div class="Para" id="Par77">Before we dive into the details of configuring Spring’s <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>, let’s take a look at the options that are available for defining an application’s configuration within Spring.
                Originally, Spring supported defining beans through either properties or an XML file. Since the release of JDK 5 and Spring’s support of Java annotations, Spring (starting from Spring 2.5) also supports using Java annotations when configuring
                <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>. So, which one is better, XML or annotations? There have been lots of debates on this topic, and you can find numerous discussions on the Internet.<a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_3_Chapter.html#Fn1" id="Fn1_source"><sup>1</sup></a> There is no definite answer, and each approach has its pros and cons. Using an XML file can externalize all configuration from Java code, while annotations allow the developer to
                define and view the DI setup from within the code. Spring also supports a mix of the two approaches in a single <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>. One common approach is to define the application
                infrastructure (for example, data source, transaction manager, JMS connection factory, or JMX) in an XML file, while defining the DI configuration (injectable beans and beans’ dependencies) in annotations. However, no matter which option
                you choose, stick to it and deliver the message clearly across the entire development team. Agreeing on the style to use and keeping it consistent across the application will make ongoing development and maintenance activities much easier.</div>
            <div class="Para" id="Par79">To facilitate your understanding of both the XML and annotation configuration, we provide sample code for XML and annotations side by side whenever appropriate, but the focus of this book will be on annotations and Java configuration, as XML
                was already covered in the previous editions of this book.</div>
    </div>
    <div class="Section2 RenderAsSection2" id="Sec16">
        <h3 class="Heading">Basic Configuration Overview</h3>
        <div class="Para" id="Par80">For <span id="ITerm33">XML configuration                      </span>, you need to declare the required namespace base provided by Spring that your application requires. The following configuration sample shows the most basic sample, which declares
            only the bean’s namespace for you to define the Spring beans. We refer to this configuration file as <span class="EmphasisFontCategoryNonProportional">app-context-xml.xml</span> for XML-style configuration throughout the samples.</div>
        <div class="Para" id="Par81">
            <div class="ProgramCode" id="PC14">
                <div class="LineGroup">
                    <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#68685b">&lt;?<span style="color:#888">xml</span><span style="color:#888"> version</span>=<span style="color:#888">1.0</span><span style="color:#888"> encoding</span>=<span style="color:#888">UTF-8</span>?&gt;</span>
<span style="color:#1c02ff">&lt;<span style="font-weight:700">beans</span> <span style="font-style:italic">xmlns</span>=<span style="color:#036a07">http://www.springframework.org/schema/beans</span>
    <span style="font-style:italic">xmlns</span>:xsi=<span style="color:#036a07">http://www.w3.org/2001/XMLSchema-instance</span>
    <span style="font-style:italic">xmlns</span>:c=<span style="color:#036a07">http://www.springframework.org/schema/c</span>
    <span style="font-style:italic">xsi</span>:schemaLocation=<span style="color:#036a07">http://www.springframework.org/schema/beans
    http://www.springframework.org/schema/beans/spring-beans.xsd</span>&gt;</span>
<span style="color:#1c02ff">&lt;/<span style="font-weight:700">beans</span>&gt;</span>
</pre></div>
                </div>
            </div>
    </div>
    <div class="Para" id="Par82">Besides beans, Spring provides a large number of other namespaces for different purposes. Some examples include context for <span id="ITerm34">            <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> configuration </span>,
        <span class="EmphasisFontCategoryNonProportional">aop</span> for AOP support, and <span class="EmphasisFontCategoryNonProportional">tx</span> for transactional support. Namespaces are covered in the appropriate chapters.</div>
    <div class="Para ParaOneEmphasisChild" id="Par83">To use Spring’s annotation support in your application, you need to declare the tags shown in the next configuration sample in your XML configuration. We refer to this configuration file as <span class="EmphasisFontCategoryNonProportional">app-context-annotation.xml</span>        for XML configuration with annotation support throughout the samples.</div>
    <div class="Para" id="Par84">
        <div class="ProgramCode" id="PC15">
            <div class="LineGroup">
                <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#68685b">&lt;?<span style="color:#888">xml</span><span style="color:#888"> version</span>=<span style="color:#888">1.0</span><span style="color:#888"> encoding</span>=<span style="color:#888">UTF-8</span>?&gt;</span>
<span style="color:#1c02ff">&lt;<span style="font-weight:700">beans</span>
    <span style="font-style:italic">xmlns</span>=<span style="color:#036a07">http://www.springframework.org/schema/beans</span>
    <span style="font-style:italic">xmlns</span>:xsi=<span style="color:#036a07">http://www.w3.org/2001/XMLSchema-instance</span>
    <span style="font-style:italic">xmlns</span>:context=<span style="color:#036a07">http://www.springframework.org/schema/context</span>
    <span style="font-style:italic">xmlns</span>:c=<span style="color:#036a07">http://www.springframework.org/schema/c</span>
       <span style="font-style:italic">xsi</span>:schemaLocation=<span style="color:#036a07">http://www.springframework.org/schema/beans
          http://www.springframework.org/schema/beans/spring-beans.xsd
          http://www.springframework.org/schema/context
          http://www.springframework.org/schema/context/spring-context.xsd</span>&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">context</span><span style="font-weight:700">:</span><span style="font-weight:700">component-scan</span>
          <span style="font-style:italic">base-package</span>=<span style="color:#036a07">com.apress.prospring5.ch3.annotation</span>/&gt;</span>
<span style="color:#1c02ff">&lt;/<span style="font-weight:700">beans</span>&gt;</span>
</pre></div>
            </div>
        </div>
    </div>
    <div class="Para" id="Par85">The <span class="EmphasisFontCategoryNonProportional">&lt;context:component-scan&gt;</span> tag tells Spring to scan the code for injectable beans annotated with <span class="EmphasisFontCategoryNonProportional">@Component</span>, <span class="EmphasisFontCategoryNonProportional">@Controller</span>,
        <span class="EmphasisFontCategoryNonProportional">@Repository</span>, and <span class="EmphasisFontCategoryNonProportional">@Service</span> as well as supporting the <span class="EmphasisFontCategoryNonProportional">@Autowired</span>, <span class="EmphasisFontCategoryNonProportional">@Inject</span>,
        and <span class="EmphasisFontCategoryNonProportional">@Resource</span> annotations under the package (and all its subpackages) specified. In the <span class="EmphasisFontCategoryNonProportional">&lt;context:component-scan&gt;</span> tag, multiple
        packages can be defined by using either a comma, a semicolon, or a space as the delimiter. Moreover, the tag supports inclusion and exclusion of a component scan for more fine-grained control. For example, consider the following configuration
        sample:</div>
    <div class="Para" id="Par86">
        <div class="ProgramCode" id="PC16">
            <div class="LineGroup">
                <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#68685b">&lt;?<span style="color:#888">xml</span><span style="color:#888"> version</span>=<span style="color:#888">1.0</span><span style="color:#888"> encoding</span>=<span style="color:#888">UTF-8</span>?&gt;</span>
<span style="color:#1c02ff">&lt;<span style="font-weight:700">beans</span>
    <span style="font-style:italic">xmlns</span>=<span style="color:#036a07">http://www.springframework.org/schema/beans</span>
    <span style="font-style:italic">xmlns</span>:xsi=<span style="color:#036a07">http://www.w3.org/2001/XMLSchema-instance</span>
    <span style="font-style:italic">xmlns</span>:context=<span style="color:#036a07">http://www.springframework.org/schema/context</span>
    <span style="font-style:italic">xmlns</span>:c=<span style="color:#036a07">http://www.springframework.org/schema/c</span>
       <span style="font-style:italic">xsi</span>:schemaLocation=<span style="color:#036a07">http://www.springframework.org/schema/beans
          http://www.springframework.org/schema/beans/spring-beans.xsd
          http://www.springframework.org/schema/context
          http://www.springframework.org/schema/context/spring-context.xsd</span>&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">context</span><span style="font-weight:700">:</span><span style="font-weight:700">component-scan</span>
          <span style="font-style:italic">base-package</span>=<span style="color:#036a07">com.apress.prospring5.ch3.annotation</span>&gt;</span>
        <span style="color:#1c02ff">&lt;<span style="font-weight:700">context</span><span style="font-weight:700">:</span><span style="font-weight:700">exclude-filter</span> <span style="font-style:italic">type</span>=<span style="color:#036a07">assignable</span>
            <span style="font-style:italic">expression</span>=<span style="color:#036a07">com.example.NotAService</span>/&gt;</span>
    <span style="color:#1c02ff">&lt;/<span style="font-weight:700">context</span><span style="font-weight:700">:</span><span style="font-weight:700">component-scan</span>&gt;</span>
<span style="color:#1c02ff">&lt;/<span style="font-weight:700">beans</span>&gt;</span>
</pre></div>
            </div>
        </div>
    </div>
    <div class="Para ParaOneEmphasisChild" id="Par87">The previous tag tells Spring to scan the package as specified but omit the classes that were assignable to the type as specified in the expression (can be either a class or an interface). Besides the exclude filter, you can also use an include filter.
        And for the type, you can use annotation, regex, assignable, AspectJ, or custom (with your own filter class that implements <span class="EmphasisFontCategoryNonProportional">org.springframework.core.type.filter.TypeFilter</span>) as the filter
        criteria. The expression format depends on the type you specified.</div>
    </div>
    <div class="Section2 RenderAsSection2" id="Sec17">
        <h3 class="Heading">Declaring Spring <span id="ITerm35">Components                      </span> </h3>
        <div class="Para" id="Par88">After you develop some kind of service class and want to use it in a Spring-based application, you need to tell Spring that those beans are eligible for injection to other beans and have Spring manage them for you. Consider the sample in Chapter
            <span class="ExternalRef"><a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_2_Chapter.html"><span class="RefSource">2</span></a>
            </span>, where <span class="EmphasisFontCategoryNonProportional">MessageRender</span> outputs the message and depends on <span class="EmphasisFontCategoryNonProportional">MessageProvider</span> to provide the message to render. The following code
            sample depicts the interfaces and the implementation of the two services:</div>
        <div class="Para" id="Par89">
            <div class="ProgramCode" id="PC17">
                <div class="LineGroup">
                    <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch2.decoupled</span>;
<span style="color:#06f;font-style:italic">//renderer interface</span>
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">interface</span> <span style="text-decoration:underline">MessageRenderer</span> {
    <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">render</span>();
    <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setMessageProvider</span>(<span style="color:#00f;font-weight:700">MessageProvider</span> <span style="font-style:italic">provider</span>);
    <span style="color:#00f;font-weight:700">MessageProvider</span> <span style="color:#0000a2;font-weight:700">getMessageProvider</span>();
}
<span style="color:#06f;font-style:italic">// rendered implementation</span>
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">StandardOutMessageRenderer</span>
<span style="color:#00f;font-weight:700">implements</span> <span style="font-style:italic">MessageRenderer</span> {
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">MessageProvider</span> messageProvider;<span style="color:#00f;font-weight:700">@Override</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">render</span>() {
        <span style="color:#00f;font-weight:700">if</span> (messageProvider <span style="color:#00f;font-weight:700">==</span> <span style="color:#585cf6;font-weight:700">null</span>) {
            <span style="color:#00f;font-weight:700">throw</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">RuntimeException</span>(<span style="color:#036a07">You must set the property messageProvider of class:</span> <span style="color:#00f;font-weight:700">+</span> <span style="color:#00f;font-weight:700">StandardOutMessageRenderer</span><span style="color:#00f;font-weight:700">.</span>class<span style="color:#00f;font-weight:700">.</span>getName());
        }
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(messageProvider<span style="color:#00f;font-weight:700">.</span>getMessage());
    }
    
    <span style="color:#00f;font-weight:700">@Override</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setMessageProvider</span>(<span style="color:#00f;font-weight:700">MessageProvider</span> <span style="font-style:italic">provider</span>) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>messageProvider <span style="color:#00f;font-weight:700">=</span> provider;
    }
    
    <span style="color:#00f;font-weight:700">@Override</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">MessageProvider</span> <span style="color:#0000a2;font-weight:700">getMessageProvider</span>() {
        <span style="color:#00f;font-weight:700">return</span> <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>messageProvider;
    }
}
<span style="color:#06f;font-style:italic">//provider interface</span>
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">interface</span> <span style="text-decoration:underline">MessageProvider</span> {
    <span style="color:#00f;font-weight:700">String</span> <span style="color:#0000a2;font-weight:700">getMessage</span>();
}
<span style="color:#06f;font-style:italic">//provider implementation</span>
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">HelloWorldMessageProvider</span> <span style="color:#00f;font-weight:700">implements</span> <span style="font-style:italic">MessageProvider</span> {<span style="color:#00f;font-weight:700">@Override</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">String</span> <span style="color:#0000a2;font-weight:700">getMessage</span>() {
        <span style="color:#00f;font-weight:700">return</span> <span style="color:#036a07">Hello World!</span>;
    }
}
</pre></div>
                </div>
            </div>
        </div>
        <div class="Para ParaTypeImportant" id="Par90"> <img alt="A315511_5_En_3_Figa_HTML.jpg" data-mfp-src="/library/view/pro-spring-5/9781484228081/A315511_5_En_3_Figa_HTML.jpg" height="28" src="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_3_Figa_HTML.jpg" width="30"/>            The classes shown previously are part of the <span class="EmphasisFontCategoryNonProportional">com.apress.prospring5.ch2.decoupled</span> package. They are used in the project specific to this chapter as well, because in a real production
            application, developers try to reuse code instead of duplicating it. That is why, as you will see when you will get the sources, the project for Chapter <span class="ExternalRef"><a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_2_Chapter.html"><span class="RefSource">2</span></a>
            </span>
            is defined as a dependency for some of the projects for Chapter <span class="ExternalRef"><a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_3_Chapter.html"><span class="RefSource">3</span></a>
            </span>.</div>
        <div class="Para" id="Par91">To declare bean definitions in an <span id="ITerm37">XML                       </span>file, the <span class="EmphasisFontCategoryNonProportional">&lt;bean ../&gt;</span> tag is used, and the resulting <span class="EmphasisFontCategoryNonProportional">app-context-xml.xml</span>            file now looks like this:</div>
        <div class="Para" id="Par92">
            <div class="ProgramCode" id="PC18">
                <div class="LineGroup">
                    <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#68685b">&lt;?<span style="color:#888">xml</span><span style="color:#888"> version</span>=<span style="color:#888">1.0</span><span style="color:#888"> encoding</span>=<span style="color:#888">UTF-8</span>?&gt;</span>
<span style="color:#1c02ff">&lt;<span style="font-weight:700">beans</span>
    <span style="font-style:italic">xmlns</span>=<span style="color:#036a07">http://www.springframework.org/schema/beans</span>
    <span style="font-style:italic">xmlns</span>:xsi=<span style="color:#036a07">http://www.w3.org/2001/XMLSchema-instance</span>
    <span style="font-style:italic">xmlns</span>:p=<span style="color:#036a07">http://www.springframework.org/schema/p</span>
    <span style="font-style:italic">xsi</span>:schemaLocation=<span style="color:#036a07">http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans.xsd</span>&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">provider</span>
        <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch2.decoupled.HelloWorldMessageProvider</span>/&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">renderer</span>
        <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch2.decoupled.StandardOutMessageRenderer</span>
         <span style="font-style:italic">p</span>:messageProvider-ref=<span style="color:#036a07">provider</span>/&gt;</span>
<span style="color:#1c02ff">&lt;/<span style="font-weight:700">beans</span>&gt;</span>
</pre></div>
                </div>
            </div>
        </div>
        <div class="Para" id="Par93">The previous tags declare two beans, one with an ID of <span class="EmphasisFontCategoryNonProportional">provider</span> with the <span class="EmphasisFontCategoryNonProportional">HelloWorldMessageProvider</span> implementation, and the other
            with an ID of <span class="EmphasisFontCategoryNonProportional">renderer</span> with the <span class="EmphasisFontCategoryNonProportional">StandardOutMessageRenderer</span> implementation.</div>
        <div class="Para" id="Par94">Starting with this example, namespaces will no longer be added to configuration samples, unless new namespaces will be introduced, as this will make the bean definitions more visible.</div>
        <div class="Para" id="Par95">To create bean definitions using <span id="ITerm38">annotations                      </span>, the bean classes must be annotated with the appropriate stereotype annotation,<a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_3_Chapter.html#Fn2" id="Fn2_source"><sup>2</sup></a> and the methods or constructors must be annotated with <span class="EmphasisFontCategoryNonProportional">@Autowired</span> to tell the Spring IoC container to look for a bean of that
            type and use it as an argument when calling that method. In the following code snippet, the annotations used to create the bean definition are underlined. The stereotype annotations can have as a parameter the name of the resulting bean.</div>
        <div class="Para" id="Par97">
            <div class="ProgramCode" id="PC19">
                <div class="LineGroup">
                    <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.annotation</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch2.decoupled.MessageProvider</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.stereotype.Component</span>;
<span style="color:#06f;font-style:italic">//simple bean</span>
@Component(<span style="color:#036a07">provider</span>)
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">HelloWorldMessageProvider</span> <span style="color:#00f;font-weight:700">implements</span> <span style="font-style:italic">MessageProvider</span> {

<span style="color:#00f;font-weight:700">@Override</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">String</span> <span style="color:#0000a2;font-weight:700">getMessage</span>() {
        <span style="color:#00f;font-weight:700">return</span> <span style="color:#036a07">Hello World!</span>;
    }
}

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch2.decoupled.MessageProvider</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch2.decoupled.MessageRenderer</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.stereotype.Service</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.beans.factory.annotation.Autowired</span>;
<span style="color:#06f;font-style:italic">//complex, service bean</span>
@Service(<span style="color:#036a07">renderer</span>)
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">StandardOutMessageRenderer</span>
<span style="color:#00f;font-weight:700">implements</span> <span style="font-style:italic">MessageRenderer</span> {
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">MessageProvider</span> messageProvider;

<span style="color:#00f;font-weight:700">@Override</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">render</span>() {
        <span style="color:#00f;font-weight:700">if</span> (messageProvider <span style="color:#00f;font-weight:700">==</span> <span style="color:#585cf6;font-weight:700">null</span>) {
            <span style="color:#00f;font-weight:700">throw</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">RuntimeException</span>(<span style="color:#036a07">You must set the property messageProvider of class:</span> <span style="color:#00f;font-weight:700">+</span> <span style="color:#00f;font-weight:700">StandardOutMessageRenderer</span><span style="color:#00f;font-weight:700">.</span>class<span style="color:#00f;font-weight:700">.</span>getName());
        }
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(messageProvider<span style="color:#00f;font-weight:700">.</span>getMessage());
    }
    <span style="color:#00f;font-weight:700">@Override</span>
    <span style="color:#00f;font-weight:700">@Autowired</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setMessageProvider</span>(<span style="color:#00f;font-weight:700">MessageProvider</span> <span style="font-style:italic">provider</span>) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>messageProvider <span style="color:#00f;font-weight:700">=</span> provider;
    }
    
    <span style="color:#00f;font-weight:700">@Override</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">MessageProvider</span> <span style="color:#0000a2;font-weight:700">getMessageProvider</span>() {
        <span style="color:#00f;font-weight:700">return</span> <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>messageProvider;
    }
}
</pre></div>
                </div>
            </div>
    </div>
    <div class="Para" id="Par98">When bootstrapping Spring’s <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> with the XML configuration depicted here, in file <span class="EmphasisFontCategoryNonProportional">app-context-annotation.xml</span>, Spring will
        seek out those components and instantiate the beans with the specified names:</div>
    <div class="Para" id="Par99">
        <div class="ProgramCode" id="PC20">
            <div class="LineGroup">
                <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#68685b">&lt;?<span style="color:#888">xml</span><span style="color:#888"> version</span>=<span style="color:#888">1.0</span><span style="color:#888"> encoding</span>=<span style="color:#888">UTF-8</span>?&gt;</span>
<span style="color:#1c02ff">&lt;<span style="font-weight:700">beans</span>
    <span style="font-style:italic">xmlns</span>=<span style="color:#036a07">http://www.springframework.org/schema/beans</span>
    <span style="font-style:italic">xmlns</span>:xsi=<span style="color:#036a07">http://www.w3.org/2001/XMLSchema-instance</span>
    <span style="font-style:italic">xmlns</span>:context=<span style="color:#036a07">http://www.springframework.org/schema/context</span>
       <span style="font-style:italic">xsi</span>:schemaLocation=<span style="color:#036a07">http://www.springframework.org/schema/beans
          http://www.springframework.org/schema/beans/spring-beans.xsd
          http://www.springframework.org/schema/context
          http://www.springframework.org/schema/context/spring-context.xsd</span>&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">context</span><span style="font-weight:700">:</span><span style="font-weight:700">component-scan</span>
          <span style="font-style:italic">base-package</span>=<span style="color:#036a07">com.apress.prospring5.ch3.annotation</span>/&gt;</span>
<span style="color:#1c02ff">&lt;/<span style="font-weight:700">beans</span>&gt;</span>
</pre></div>
            </div>
        </div>
    </div>
    <div class="Para ParaOneEmphasisChild" id="Par100">Using either approach doesn’t affect the way you obtain the beans from <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>.</div>
    <div class="Para" id="Par101">
        <div class="ProgramCode" id="PC21">
            <div class="LineGroup">
                <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch2.decoupled.MessageRenderer</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.support.GenericXmlApplicationContext</span>;
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">DeclareSpringComponents</span> {
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span>...<span style="font-style:italic">args</span>) {
        <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span> ctx <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span>();
        ctx<span style="color:#00f;font-weight:700">.</span>load(<span style="color:#036a07">classpath:spring/app-context-xml.xml</span>);
        ctx<span style="color:#00f;font-weight:700">.</span>refresh();
        <span style="color:#00f;font-weight:700">MessageRenderer</span> messageRenderer <span style="color:#00f;font-weight:700">=</span> ctx<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#036a07">renderer</span>, <span style="color:#00f;font-weight:700">MessageRenderer</span><span style="color:#00f;font-weight:700">.</span>class);
        messageRenderer<span style="color:#00f;font-weight:700">.</span>render();
        ctx<span style="color:#00f;font-weight:700">.</span>close();
    }
}
</pre></div>
            </div>
        </div>
    </div>
    <div class="Para" id="Par102">Instead of <span class="EmphasisFontCategoryNonProportional">DefaultListableBeanFactory</span>, an instance of <span id="ITerm41">                <span class="EmphasisFontCategoryNonProportional">GenericXmlApplicationContext</span> </span> is instantiated.
        The <span class="EmphasisFontCategoryNonProportional">GenericXmlApplicationContext</span> class implements the <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> interface and is able to bootstrap Spring’s <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>        from the configurations defined in XML files.</div>
    <div class="Para" id="Par103">You can swap the <span class="EmphasisFontCategoryNonProportional">app-context-xml.xml</span> file with <span class="EmphasisFontCategoryNonProportional">app-context-annotation.xml</span> in the provided source code for this chapter, and you will
        find that both cases produce the same result: “Hello World!” is printed. The only difference is that after the swap the beans providing the functionality are the ones defined with annotations in the <span class="EmphasisFontCategoryNonProportional">com.apress.prospring5.ch3.annotation</span>        package.</div>
    <div class="Section3 RenderAsSection3" id="Sec18">
        <h4 class="Heading">Using <span id="ITerm42">Java Configuration                          </span> </h4>
        <div class="Para" id="Par104">In Chapter <span class="ExternalRef"><a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_1_Chapter.html"><span class="RefSource">1</span></a>
            </span> we mentioned that <span class="EmphasisFontCategoryNonProportional">app-context-xml.xml</span> can be replaced with a configuration class, without modifying the classes representing the bean types being created. This is useful when the bean
            types that the application needs are part of third-party libraries that cannot be modified. Such a configuration class is annotated with <span class="EmphasisFontCategoryNonProportional">@Configuration</span> and contains methods annotated
            with <span class="EmphasisFontCategoryNonProportional">@Bean</span> that are called directly by the Spring IoC container to instantiate the beans. The bean name will be the same as the name of the method used to create it. The class is shown
            in the following code sample, and the method names are underlined to make obvious how the resulting beans will be named:</div>
        <div class="Para" id="Par105">
            <div class="ProgramCode" id="PC22">
                <div class="LineGroup">
                    <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch2.annotated</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch2.decoupled.HelloWorldMessageProvider</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch2.decoupled.MessageProvider</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch2.decoupled.MessageRenderer</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch2.decoupled.StandardOutMessageRenderer</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.annotation.Bean</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.annotation.Configuration</span>;@<span style="color:#00f;font-weight:700">Configuration</span>
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">HelloWorldConfiguration</span> {
    
    <span style="color:#00f;font-weight:700">@Bean</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">MessageProvider</span> <span style="color:#0000a2;font-weight:700">provider</span>() {
        <span style="color:#00f;font-weight:700">return</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">HelloWorldMessageProvider</span>();
    }
    
    <span style="color:#00f;font-weight:700">@Bean</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">MessageRenderer</span> <span style="color:#0000a2;font-weight:700">renderer</span>() {
        <span style="color:#00f;font-weight:700">MessageRenderer</span> renderer <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">StandardOutMessageRenderer</span>();
        renderer<span style="color:#00f;font-weight:700">.</span>setMessageProvider(provider());
        <span style="color:#00f;font-weight:700">return</span> renderer;
    }
}
</pre></div>
                </div>
            </div>
        </div>
        <div class="Para ParaOneEmphasisChild" id="Par106">To read the configuration from this class, a different implementation of <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> is needed.</div>
        <div class="Para" id="Par107">
            <div class="ProgramCode" id="PC23">
                <div class="LineGroup">
                    <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch2.annotated</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch2.decoupled.MessageRenderer</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.ApplicationContext</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.annotation.AnnotationConfigApplicationContext</span>;
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">HelloWorldSpringAnnotated</span> {
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span>...<span style="font-style:italic">args</span>) {
        <span style="color:#00f;font-weight:700">ApplicationContext</span> ctx <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">AnnotationConfigApplicationContext</span>(<span style="color:#00f;font-weight:700">HelloWorldConfiguration</span><span style="color:#00f;font-weight:700">.</span>class);
        <span style="color:#00f;font-weight:700">MessageRenderer</span> mr <span style="color:#00f;font-weight:700">=</span> ctx<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#036a07">renderer</span>, <span style="color:#00f;font-weight:700">MessageRenderer</span><span style="color:#00f;font-weight:700">.</span>class);
        mr<span style="color:#00f;font-weight:700">.</span>render();
    }
}
</pre></div>
            </div>
        </div>
    </div>
    <div class="Para" id="Par108">Instead of <span class="EmphasisFontCategoryNonProportional">DefaultListableBeanFactory</span>, an instance of <span class="EmphasisFontCategoryNonProportional">AnnotationConfigApplicationContext</span> is instantiated. The <span class="EmphasisFontCategoryNonProportional">AnnotationConfigApplicationContext</span>        class implements the <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> interface and is able to bootstrap Spring’s <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> from the configurations defined
        by the <span class="EmphasisFontCategoryNonProportional">HelloWorldConfiguration</span> class. <span id="ITerm44">                                                    </span> </div>
    <div class="Para" id="Par109">A configuration class can be used to read the annotated beans definitions as well. In this case, because the bean’s definition configuration is part of the bean class, the class will no longer need any <span class="EmphasisFontCategoryNonProportional">@Bean</span>        annotated methods. But, to be able to look for bean definitions inside Java classes, component scanning has to be enabled. This is done by annotating the configuration class with an annotation that is the equivalent of the <span class="EmphasisFontCategoryNonProportional">&lt;context:component-scanning ../&gt;</span>        element. This annotation is <span class="EmphasisFontCategoryNonProportional">@ComponentScanning</span> and has the same parameters as the XML analogous element.</div>
    <div class="Para" id="Par110">
        <div class="ProgramCode" id="PC24">
            <div class="LineGroup">
                <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.annotation</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.annotation.ComponentScan</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.annotation.Configuration</span>;

@ComponentScan(basePackages <span style="color:#00f;font-weight:700">=</span> {
    <span style="color:#036a07">com.apress.prospring5.ch3.annotation</span>
})
@<span style="color:#00f;font-weight:700">Configuration</span>
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">HelloWorldConfiguration</span> {}
</pre></div>
            </div>
        </div>
    </div>
    <div class="Para ParaOneEmphasisChild" id="Par111">The code to bootstrap a Spring environment using <span class="EmphasisFontCategoryNonProportional">AnnotationConfigApplicationContext</span> will work with this class too, with no additional changes.</div>
    <div class="Para" id="Par112">In real-life production applications, there might be legacy code, developed with older versions of Spring, or requirements might be of such a nature that require XML and configuration classes. Fortunately, XML and Java configuration can be mixed in
        more than one way. For example, a configuration class can import bean definitions from an XML file (or more) using <span class="EmphasisFontCategoryNonProportional">@ImportResource</span>, and the same bootstrapping using <span class="EmphasisFontCategoryNonProportional">AnnotationConfigApplicationContext</span>        will work in this case as well.</div>
    <div class="Para" id="Par113">
        <div class="ProgramCode" id="PC25">
            <div class="LineGroup">
                <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.mixed</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.annotation.ComponentScan</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.annotation.Configuration</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.annotation.ImportResource</span>;
@ImportResource(locations <span style="color:#00f;font-weight:700">=</span> {
    <span style="color:#036a07">classpath:spring/app-context-xml.xml</span>
})
@<span style="color:#00f;font-weight:700">Configuration</span>
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">HelloWorldConfiguration</span> {}
</pre></div>
            </div>
        </div>
    </div>
    <div class="Para" id="Par114">So, Spring allows you to be really creative when defining your beans; you’ll learn more about this in Chapter <span class="ExternalRef"><a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_4_Chapter.html"><span class="RefSource">4</span></a>
        </span>, which is focused solely on Spring application <span id="ITerm45">configuration                          </span>.</div>
    </div>
    <div class="Section3 RenderAsSection3" id="Sec19">
        <h4 class="Heading">Using Setter Injection</h4>
        <div class="Para" id="Par115">To configure <span id="ITerm46">setter injection                          </span> by using XML configuration, you need to specify <span class="EmphasisFontCategoryNonProportional">&lt;property&gt;</span> tags under the <span class="EmphasisFontCategoryNonProportional">&lt;bean&gt;</span>            tag for each <span class="EmphasisFontCategoryNonProportional">&lt;property&gt;</span> into which you want to inject a dependency. For example, to assign the message provider bean to the <span class="EmphasisFontCategoryNonProportional">messageProvider</span>            property of the <span class="EmphasisFontCategoryNonProportional">messageRenderer</span> bean, you simply change the <span class="EmphasisFontCategoryNonProportional">&lt;bean&gt;</span> tag for the <span class="EmphasisFontCategoryNonProportional">renderer</span>            bean, as shown in the following code snippet:</div>
        <div class="Para" id="Par116">
            <div class="ProgramCode" id="PC26">
                <div class="LineGroup">
                    <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#1c02ff">&lt;<span style="font-weight:700">beans</span> ...&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">renderer</span>
        <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch2.decoupled.StandardOutMessageRenderer</span>&gt;</span>
        <span style="color:#1c02ff">&lt;<span style="font-weight:700">property</span> <span style="font-style:italic">name</span>=<span style="color:#036a07">messageProvider</span> <span style="font-style:italic">ref</span>=<span style="color:#036a07">provider</span>/&gt;</span>
    <span style="color:#1c02ff">&lt;/<span style="font-weight:700">bean</span>&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">provider</span>
        <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch2.decoupled.HelloWorldMessageProvider</span>/&gt;</span>
<span style="color:#1c02ff">&lt;/<span style="font-weight:700">beans</span>&gt;</span>
</pre></div>
                </div>
            </div>
        </div>
        <div class="Para" id="Par117">From this code, we can see that the <span class="EmphasisFontCategoryNonProportional">provider</span> bean is assigned to the <span class="EmphasisFontCategoryNonProportional">messageProvider</span> property. You can use the <span class="EmphasisFontCategoryNonProportional">ref</span>            attribute to assign a bean reference to a property (discussed in more detail shortly).</div>
        <div class="Para ParaOneEmphasisChild" id="Par118">If you are using Spring 2.5 or newer and have the <span class="EmphasisFontCategoryNonProportional">p namespace</span> declared in your XML configuration file, you can declare the injection as shown in the following code snippet:</div>
        <div class="Para" id="Par119">
            <div class="ProgramCode" id="PC27">
                <div class="LineGroup">
                    <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#68685b">&lt;?<span style="color:#888">xml</span><span style="color:#888"> version</span>=<span style="color:#888">1.0</span><span style="color:#888"> encoding</span>=<span style="color:#888">UTF-8</span>?&gt;</span>
<span style="color:#1c02ff">&lt;<span style="font-weight:700">beans</span>
    <span style="font-style:italic">xmlns</span>=<span style="color:#036a07">http://www.springframework.org/schema/beans</span>
    <span style="font-style:italic">xmlns</span>:xsi=<span style="color:#036a07">http://www.w3.org/2001/XMLSchema-instance</span>
    <span style="font-style:italic">xmlns</span>:p=<span style="color:#036a07">http://www.springframework.org/schema/p</span>
       <span style="font-style:italic">xsi</span>:schemaLocation=<span style="color:#036a07">http://www.springframework.org/schema/beans
          http://www.springframework.org/schema/beans/spring-beans.xsd</span>&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">renderer</span>
        <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch2.decoupled.StandardOutMessageRenderer</span>
        <span style="font-style:italic">p</span>:messageProvider-ref=<span style="color:#036a07">provider</span>/&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">provider</span>
        <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch2.decoupled.HelloWorldMessageProvider</span>/&gt;</span>
<span style="color:#1c02ff">&lt;/<span style="font-weight:700">beans</span>&gt;</span>
</pre></div>
                </div>
            </div>
        </div>
        <div class="Para ParaTypeImportant" id="Par120"> <img alt="A315511_5_En_3_Figa_HTML.jpg" data-mfp-src="/library/view/pro-spring-5/9781484228081/A315511_5_En_3_Figa_HTML.jpg" height="28" src="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_3_Figa_HTML.jpg" width="30"/>            The <span class="EmphasisFontCategoryNonProportional">p namespace</span> is not defined in an XSD file and exists only in Spring core; therefore, no XSD is declared in the <span class="EmphasisFontCategoryNonProportional">schemaLocation</span>            attribute.</div>
        <div class="Para ParaOneEmphasisChild" id="Par121">With annotations, it’s even simpler. You just need to add an <span class="EmphasisFontCategoryNonProportional">@Autowired</span> annotation to the setter method, as shown in the following code snippet:</div>
        <div class="Para" id="Par122">
            <div class="ProgramCode" id="PC28">
                <div class="LineGroup">
                    <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.annotation</span>;
.<span style="color:#00f;font-weight:700">.</span>.
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.beans.factory.annotation.Autowired</span>;
@Service(<span style="color:#036a07">renderer</span>)
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">StandardOutMessageRenderer</span> <span style="color:#00f;font-weight:700">implements</span> <span style="font-style:italic">MessageRenderer</span> {
    .<span style="color:#00f;font-weight:700">.</span>.
    <span style="color:#00f;font-weight:700">@Override</span>
    <span style="color:#00f;font-weight:700">@Autowired</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setMessageProvider</span>(<span style="color:#00f;font-weight:700">MessageProvider</span> <span style="font-style:italic">provider</span>) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>messageProvider <span style="color:#00f;font-weight:700">=</span> provider;
    }
}
</pre></div>
                </div>
            </div>
        </div>
        <div class="Para" id="Par123">Since we declared the <span class="EmphasisFontCategoryNonProportional">&lt;context:component-scan&gt;</span> tag in the XML configuration file, during the initialization of Spring’s <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>,
            Spring will discover those <span class="EmphasisFontCategoryNonProportional">@Autowired</span> annotations and inject the dependency as required.</div>
        <div class="Para ParaTypeImportant" id="Par124"> <img alt="A315511_5_En_3_Figa_HTML.jpg" data-mfp-src="/library/view/pro-spring-5/9781484228081/A315511_5_En_3_Figa_HTML.jpg" height="28" src="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_3_Figa_HTML.jpg" width="30"/>            Instead of <span class="EmphasisFontCategoryNonProportional">@Autowired</span>, you can use <span class="EmphasisFontCategoryNonProportional">@Resource(name=&quot;messageProvider&quot;)</span> to achieve the same result. <span class="EmphasisFontCategoryNonProportional">@Resource</span>            is one of the annotations in the JSR-250 standard that defines a common set of Java annotations for use on both JSE and JEE platforms. Different from <span class="EmphasisFontCategoryNonProportional">@Autowired</span>, the <span class="EmphasisFontCategoryNonProportional">@Resource</span>            annotation supports the <span class="EmphasisFontCategoryNonProportional">name</span> parameter for more fine-grained DI requirements. Additionally, Spring supports use of the <span class="EmphasisFontCategoryNonProportional">@Inject</span>            annotation introduced as part of JSR-299 (Contexts and Dependency Injection for the Java EE Platform). <span class="EmphasisFontCategoryNonProportional">@Inject</span> is equivalent in behavior to Spring’s <span class="EmphasisFontCategoryNonProportional">@Autowired</span>            annotation.</div>
        <div class="Para" id="Par125">To verify the result, you can use <span class="EmphasisFontCategoryNonProportional">DeclareSpringComponents</span> that was presented earlier. As in the previous section, you can swap the <span class="EmphasisFontCategoryNonProportional">app-context-xml.xml</span>            file with <span class="EmphasisFontCategoryNonProportional">app-context-annotation.xml</span> in the provided source code for this <span id="ITerm48">chapter                          </span>, and you will find that both cases produce the same
            result: “Hello World!” is printed.</div>
    </div>
    <div class="Section3 RenderAsSection3" id="Sec20">
        <h4 class="Heading">Using <span id="ITerm49">Constructor Injection                          </span> </h4>
        <div class="Para" id="Par126">In the previous example, the <span class="EmphasisFontCategoryNonProportional">MessageProvider</span> implementation, <span class="EmphasisFontCategoryNonProportional">HelloWorldMessageProvider</span>, returned the same hard-coded message for
            each call of the <span class="EmphasisFontCategoryNonProportional">getMessage()</span> method. In the Spring configuration file, you can easily create a configurable <span class="EmphasisFontCategoryNonProportional">MessageProvider</span>            that allows the message to be defined externally, as shown in the following code snippet:</div>
        <div class="Para" id="Par127">
            <div class="ProgramCode" id="PC29">
                <div class="LineGroup">
                    <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.xml</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch2.decoupled.MessageProvider</span>;
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">ConfigurableMessageProvider</span>
<span style="color:#00f;font-weight:700">implements</span> <span style="font-style:italic">MessageProvider</span> {
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">String</span> message;
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#0000a2;font-weight:700">ConfigurableMessageProvider</span>(<span style="color:#00f;font-weight:700">String</span> <span style="font-style:italic">message</span>) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>message <span style="color:#00f;font-weight:700">=</span> message;
    }
    <span style="color:#00f;font-weight:700">@Override</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">String</span> <span style="color:#0000a2;font-weight:700">getMessage</span>() {
        <span style="color:#00f;font-weight:700">return</span> message;
    }
}
</pre></div>
                </div>
            </div>
        </div>
        <div class="Para" id="Par128">As you can see, it is impossible to create an instance of <span class="EmphasisFontCategoryNonProportional">ConfigurableMessageProvider</span> without providing a value for the message (unless you supply <span class="EmphasisFontCategoryNonProportional">null</span>).
            This is exactly what we want, and this class is ideally suited for use with <span class="EmphasisTypeItalic">constructor injection</span>. The following code snippet shows how you can redefine the <span class="EmphasisFontCategoryNonProportional">provider</span>            bean definition to create an instance of <span class="EmphasisFontCategoryNonProportional">ConfigurableMessageProvider</span> <span class="EmphasisTypeItalic">,</span> injecting the message by using constructor injection:</div>
        <div class="Para" id="Par129">
            <div class="ProgramCode" id="PC30">
                <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#1c02ff">&lt;<span style="font-weight:700">beans</span>
    <span style="font-style:italic">xmlns</span>=<span style="color:#036a07">http://www.springframework.org/schema/beans</span>
    <span style="font-style:italic">xmlns</span>:xsi=<span style="color:#036a07">http://www.w3.org/2001/XMLSchema-instance</span>
       <span style="font-style:italic">xsi</span>:schemaLocation=<span style="color:#036a07">http://www.springframework.org/schema/beans
          http://www.springframework.org/schema/beans/spring-beans.xsd</span>&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">messageProvider</span>
        <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch3.xml.ConfigurableMessageProvider</span>&gt;</span>
        <span style="color:#1c02ff">&lt;<span style="font-weight:700">constructor-arg</span> <span style="font-style:italic">value</span>=<span style="color:#036a07">I hope that someone gets my message in a bottle</span>/&gt;</span>
    <span style="color:#1c02ff">&lt;/<span style="font-weight:700">bean</span>&gt;</span>
<span style="color:#1c02ff">&lt;/<span style="font-weight:700">beans</span>&gt;</span>
</pre></div>
            </div>
        </div>
        <div class="Para" id="Par130">In this code, instead of using a <span class="EmphasisFontCategoryNonProportional">&lt;property&gt;</span> tag, we used a <span class="EmphasisFontCategoryNonProportional">&lt;constructor-arg&gt;</span> tag. Because we are not passing in another
            bean this time, just a <span class="EmphasisFontCategoryNonProportional">String</span> literal, we use the <span class="EmphasisFontCategoryNonProportional">value</span> attribute instead of <span class="EmphasisFontCategoryNonProportional">ref</span>            to specify the value for the constructor argument. When you have more than one constructor argument or your class has more than one constructor, you need to give each <span class="EmphasisFontCategoryNonProportional">&lt;constructor-arg&gt;</span>            tag an index attribute to specify the index of the argument, starting at 0, in the constructor signature. It is always best to use the index attribute whenever you are dealing with constructors that have multiple arguments, to avoid confusion
            between the parameters and ensure that Spring picks the correct constructor.</div>
        <div class="Para" id="Par131">In addition to the <span class="EmphasisFontCategoryNonProportional">p</span> namespace, as of Spring 3.1, you can also use the <span class="EmphasisFontCategoryNonProportional">c</span> namespace, as shown here:</div>
        <div class="Para" id="Par132">
            <div class="ProgramCode" id="PC31">
                <div class="LineGroup">
                    <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#1c02ff">&lt;<span style="font-weight:700">beans</span>
    <span style="font-style:italic">xmlns</span>=<span style="color:#036a07">http://www.springframework.org/schema/beans</span>
    <span style="font-style:italic">xmlns</span>:xsi=<span style="color:#036a07">http://www.w3.org/2001/XMLSchema-instance</span>
    <span style="font-style:italic">xmlns</span>:c=<span style="color:#036a07">http://www.springframework.org/schema/c</span>
    <span style="font-style:italic">xsi</span>:schemaLocation=<span style="color:#036a07">http://www.springframework.org/schema/beans
    http://www.springframework.org/schema/beans/spring-beans.xsd</span>&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">provider</span>
        <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch3.xml.ConfigurableMessageProvider</span>
        <span style="font-style:italic">c</span>:message=<span style="color:#036a07">I hope that someone gets my message in a bottle</span>/&gt;</span>
<span style="color:#1c02ff">&lt;/<span style="font-weight:700">beans</span>&gt;</span>
</pre></div>
                </div>
            </div>
        </div>
        <div class="Para ParaTypeImportant" id="Par133"> <img alt="A315511_5_En_3_Figa_HTML.jpg" data-mfp-src="/library/view/pro-spring-5/9781484228081/A315511_5_En_3_Figa_HTML.jpg" height="28" src="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_3_Figa_HTML.jpg" width="30"/>            The <span class="EmphasisFontCategoryNonProportional">c</span> namespace is not defined in an XSD file either and exists only in Spring Core; therefore, no XSD is declared in the <span class="EmphasisFontCategoryNonProportional">schemaLocation</span>            attribute.</div>
        <div class="Para" id="Par134">To use an <span id="ITerm51">annotation                           </span>for constructor injection, we also use the <span class="EmphasisFontCategoryNonProportional">@Autowired</span> annotation in the target bean’s constructor method, which is
            an alternative option to the one using setter injection, as shown in the following code snippet:</div>
        <div class="Para" id="Par135">
            <div class="ProgramCode" id="PC32">
                <div class="LineGroup">
                    <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.annotated</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch2.decoupled.MessageProvider</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.beans.factory.annotation.Autowired</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.stereotype.Service</span>;
@Service(<span style="color:#036a07">provider</span>)
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">ConfigurableMessageProvider</span> <span style="color:#00f;font-weight:700">implements</span> <span style="font-style:italic">MessageProvider</span> {
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">String</span> message;
    <span style="color:#00f;font-weight:700">@Autowired</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#0000a2;font-weight:700">ConfigurableMessageProvider</span>(
        (@<span style="color:#00f;font-weight:700">Value</span>(&quot;<span style="color:#00f;font-weight:700">Configurable</span> <span style="font-style:italic">message</span>&quot;) String message) {
            <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>message <span style="color:#00f;font-weight:700">=</span> message;
        }
        <span style="color:#00f;font-weight:700">@Override</span> <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">String</span> <span style="color:#0000a2;font-weight:700">getMessage</span>() {
            <span style="color:#00f;font-weight:700">return</span> <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>message;
        }
    }
</pre></div>
                </div>
            </div>
        </div>
        <div class="Para ParaOneEmphasisChild" id="Par136">From the previous code, we can see that we use another annotation, <span class="EmphasisFontCategoryNonProportional">@Value</span>, to define the value to be injected into the constructor. This is the way in Spring we inject values into a bean.
            Besides simple strings, we can use the powerful SpEL for dynamic value injection (more on this later in this chapter).</div>
        <div class="Para" id="Par137">However, hard-coding the value in the code is not a good idea; to change it, we would need to recompile the program. Even if you choose annotation-style DI, a good practice is to externalize those values for injection. To externalize the message,
            let’s define the message as a Spring bean in the annotation configuration file, as shown in the following code snippet:</div>
        <div class="Para" id="Par138">
            <div class="ProgramCode" id="PC33">
                <div class="LineGroup">
                    <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#1c02ff">&lt;<span style="font-weight:700">beans</span> ...&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">context</span><span style="font-weight:700">:</span><span style="font-weight:700">component-scan</span>
          <span style="font-style:italic">base-package</span>=<span style="color:#036a07">com.apress.prospring5.ch3.annotated</span>/&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">message</span> <span style="font-style:italic">class</span>=<span style="color:#036a07">java.lang.String</span>
          <span style="font-style:italic">c</span>:_0=<span style="color:#036a07">I hope that someone gets my message in a bottle</span>/&gt;</span>
<span style="color:#1c02ff">&lt;/<span style="font-weight:700">beans</span>&gt;</span>
</pre></div>
                </div>
            </div>
        </div>
        <div class="Para" id="Par139">Here we define a bean with an <span id="ITerm52">ID                          </span> of <span class="EmphasisFontCategoryNonProportional">message</span> and type of <span class="EmphasisFontCategoryNonProportional">java.lang.String</span>. Notice
            that we also use the <span class="EmphasisFontCategoryNonProportional">c</span> namespace for constructor injection to set the string value, and <span class="EmphasisFontCategoryNonProportional">_0</span> indicates the index for the constructor
            argument. Having the bean declared, we can take away the <span class="EmphasisFontCategoryNonProportional">@Value</span> annotation from the target bean, as shown in the following code snippet:</div>
        <div class="Para" id="Par140">
            <div class="ProgramCode" id="PC34">
                <div class="LineGroup">
                    <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.annotated</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch2.decoupled.MessageProvider</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.beans.factory.annotation.Autowired</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.stereotype.Service</span>;
@Service(<span style="color:#036a07">provider</span>)
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">ConfigurableMessageProvider</span> <span style="color:#00f;font-weight:700">implements</span> <span style="font-style:italic">MessageProvider</span> {
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">String</span> message;
    <span style="color:#00f;font-weight:700">@Autowired</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#0000a2;font-weight:700">ConfigurableMessageProvider</span>(<span style="color:#00f;font-weight:700">String</span> <span style="font-style:italic">message</span>) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>message <span style="color:#00f;font-weight:700">=</span> message;
    }
    <span style="color:#00f;font-weight:700">@Override</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">String</span> <span style="color:#0000a2;font-weight:700">getMessage</span>() {
        <span style="color:#00f;font-weight:700">return</span> <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>message;
    }
}
</pre></div>
                </div>
            </div>
        </div>
        <div class="Para" id="Par141">Since we declare that the message bean and its ID are the same as the name of the argument specified in the constructor, Spring will detect the annotation and inject the value into the constructor method. Now run the test by using the following
            code against both the XML (<span class="EmphasisFontCategoryNonProportional">app-context.xml.xml</span>) and annotation configurations (<span class="EmphasisFontCategoryNonProportional">app-context-annotation.xml</span>), and the configured
            message will be displayed in both cases:</div>
        <div class="Para" id="Par142">
            <div class="ProgramCode" id="PC35">
                <div class="LineGroup">
                    <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch2.decoupled.MessageProvider</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.support.GenericXmlApplicationContext</span>;
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">DeclareSpringComponents</span> {
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span>...<span style="font-style:italic">args</span>) {
        <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span> ctx <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span>();
        ctx<span style="color:#00f;font-weight:700">.</span>load(<span style="color:#036a07">classpath:spring/app-context-annotation.xml</span>);
        ctx<span style="color:#00f;font-weight:700">.</span>refresh();
        <span style="color:#00f;font-weight:700">MessageProvider</span> messageProvider <span style="color:#00f;font-weight:700">=</span> ctx<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#036a07">provider</span>, <span style="color:#00f;font-weight:700">MessageProvider</span><span style="color:#00f;font-weight:700">.</span>class);
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(messageProvider<span style="color:#00f;font-weight:700">.</span>getMessage());
    }
}
</pre></div>
                </div>
            </div>
        </div>
        <div class="Para" id="Par143">In some cases, Spring finds it impossible to tell which constructor we want it to use for constructor injection. This usually arises when we have two constructors with the same number of arguments and the types used in the arguments are represented
            in the same way. Consider the following code:</div>
        <div class="Para" id="Par144">
            <div class="ProgramCode" id="PC36">
                <div class="LineGroup">
                    <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.xml</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.support.GenericXmlApplicationContext</span>;
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">ConstructorConfusion</span> {
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">String</span> someValue;
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#0000a2;font-weight:700">ConstructorConfusion</span>(<span style="color:#00f;font-weight:700">String</span> <span style="font-style:italic">someValue</span>) {
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">ConstructorConfusion(String) called</span>);
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>someValue <span style="color:#00f;font-weight:700">=</span> someValue;
    }
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#0000a2;font-weight:700">ConstructorConfusion</span>(<span style="color:#00f;font-weight:700">int</span> <span style="font-style:italic">someValue</span>) {
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">ConstructorConfusion(int) called</span>);
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>someValue <span style="color:#00f;font-weight:700">=</span> <span style="color:#036a07">Number: </span> <span style="color:#00f;font-weight:700">+</span> <span style="color:#00f;font-weight:700">Integer</span><span style="color:#00f;font-weight:700">.</span>toString(someValue);
    }
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">String</span> <span style="color:#0000a2;font-weight:700">toString</span>() {
        <span style="color:#00f;font-weight:700">return</span> someValue;
    }
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span>...<span style="font-style:italic">args</span>) {
        <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span> ctx <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span>();
        ctx<span style="color:#00f;font-weight:700">.</span>load(<span style="color:#036a07">classpath:spring/app-context-xml.xml</span>);
        ctx<span style="color:#00f;font-weight:700">.</span>refresh();
        <span style="color:#00f;font-weight:700">ConstructorConfusion</span> cc <span style="color:#00f;font-weight:700">=</span> (<span style="color:#00f;font-weight:700">ConstructorConfusion</span>)
        ctx<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#036a07">constructorConfusion</span>);
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(cc);
        ctx<span style="color:#00f;font-weight:700">.</span>close
    }
}
</pre></div>
                </div>
            </div>
        </div>
        <div class="Para" id="Par145">This simply retrieves a bean of type <span class="EmphasisFontCategoryNonProportional">ConstructorConfusion</span> from <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> and <span id="ITerm54">writes                           </span>the
            value to console output. Now look at the following configuration code:</div>
        <div class="Para" id="Par146">
            <div class="ProgramCode" id="PC37">
                <div class="LineGroup">
                    <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#1c02ff">&lt;<span style="font-weight:700">beans</span> ...&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">provider</span>
        <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch3.xml.ConfigurableMessageProvider</span>
        <span style="font-style:italic">c</span>:message=<span style="color:#036a07">I hope that someone gets my message in a bottle</span>/&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">constructorConfusion</span>
        <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch3.xml.ConstructorConfusion</span>&gt;</span>
        <span style="color:#1c02ff">&lt;<span style="font-weight:700">constructor-arg</span>&gt;</span>
            <span style="color:#1c02ff">&lt;<span style="font-weight:700">value</span>&gt;</span>90<span style="color:#1c02ff">&lt;/<span style="font-weight:700">value</span>&gt;</span>
        <span style="color:#1c02ff">&lt;/<span style="font-weight:700">constructor-arg</span>&gt;</span>
    <span style="color:#1c02ff">&lt;/<span style="font-weight:700">bean</span>&gt;</span>
<span style="color:#1c02ff">&lt;/<span style="font-weight:700">beans</span>&gt;</span>
</pre></div>
                </div>
            </div>
        </div>
        <div class="Para" id="Par147">Which of the constructors is called in this case? Running the example yields the following output:</div>
        <div class="Para" id="Par148">
            <div class="ProgramCode" id="PC38">
                <div class="FixedLine">ConstructorConfusion(String) called</div>
            </div>
        </div>
        <div class="Para" id="Par149">This shows that the constructor with the <span class="EmphasisFontCategoryNonProportional">String</span> argument is called. This is not the desired effect, since we want to prefix any integer values passed in by using constructor injection with
            <span class="EmphasisFontCategoryNonProportional">Number:</span>, as shown in the <span class="EmphasisFontCategoryNonProportional">int</span> constructor. To get around this, we need to make a small modification to the configuration, as shown
            in the following code snippet:</div>
        <div class="Para" id="Par150">
            <div class="ProgramCode" id="PC39">
                <div class="LineGroup">
                    <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#1c02ff">&lt;<span style="font-weight:700">beans</span> ...&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">provider</span>
        <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch3.xml.ConfigurableMessageProvider</span>
        <span style="font-style:italic">c</span>:message=<span style="color:#036a07">I hope that someone gets my message in a bottle</span>/&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">constructorConfusion</span>
        <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch3.xml.ConstructorConfusion</span>&gt;</span>
        <span style="color:#1c02ff">&lt;<span style="font-weight:700">constructor-arg</span> <span style="font-style:italic">type</span>=<span style="color:#036a07">int</span>&gt;</span>
            <span style="color:#1c02ff">&lt;<span style="font-weight:700">value</span>&gt;</span>90<span style="color:#1c02ff">&lt;/<span style="font-weight:700">value</span>&gt;</span>
        <span style="color:#1c02ff">&lt;/<span style="font-weight:700">constructor-arg</span>&gt;</span>
    <span style="color:#1c02ff">&lt;/<span style="font-weight:700">bean</span>&gt;</span>
<span style="color:#1c02ff">&lt;/<span style="font-weight:700">beans</span>&gt;</span>
</pre></div>
                </div>
            </div>
        </div>
        <div class="Para" id="Par151">Notice now that the <span class="EmphasisFontCategoryNonProportional">&lt;constructor-arg&gt;</span> tag has an additional attribute, <span class="EmphasisFontCategoryNonProportional">type</span>, that specifies the type of argument Spring should
            look for. Running the example again with the corrected configuration yields the correct output.</div>
        <div class="Para" id="Par152">
            <div class="ProgramCode" id="PC40">
                <div class="FixedLine">ConstructorConfusion(int) called</div>
                <div class="FixedLine">Number: 90</div>
            </div>
        </div>
        <div class="Para" id="Par153">For annotation-style construction injection, the confusion can be avoided by applying the annotation directly to the target constructor method, as shown in the following code snippet:</div>
        <div class="Para" id="Par154">
            <div class="ProgramCode" id="PC41">
                <div class="LineGroup">
                    <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.annotated</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.beans.factory.annotation.Autowired</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.beans.factory.annotation.Value</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.support.GenericXmlApplicationContext</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.stereotype.Service</span>;

@Service(<span style="color:#036a07">constructorConfusion</span>)
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">ConstructorConfusion</span> {
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">String</span> someValue;

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#0000a2;font-weight:700">ConstructorConfusion</span>(<span style="color:#00f;font-weight:700">String</span> <span style="font-style:italic">someValue</span>) {
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">ConstructorConfusion(String) called</span>);
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>someValue <span style="color:#00f;font-weight:700">=</span> someValue;
    }

    <span style="color:#00f;font-weight:700">@Autowired</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#0000a2;font-weight:700">ConstructorConfusion</span>(@<span style="color:#00f;font-weight:700">Value</span>(&quot;<span style="font-style:italic">90</span>&quot;) int someValue) {
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">ConstructorConfusion(int) called</span>);
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>someValue <span style="color:#00f;font-weight:700">=</span> <span style="color:#036a07">Number: </span> <span style="color:#00f;font-weight:700">+</span> <span style="color:#00f;font-weight:700">Integer</span><span style="color:#00f;font-weight:700">.</span>toString(someValue);
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">String</span> <span style="color:#0000a2;font-weight:700">toString</span>() {
        <span style="color:#00f;font-weight:700">return</span> someValue;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span>... <span style="font-style:italic">args</span>) {
        <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span> ctx <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span>();
        ctx<span style="color:#00f;font-weight:700">.</span>load(<span style="color:#036a07">classpath:spring/app-context-annotation.xml</span>);
        ctx<span style="color:#00f;font-weight:700">.</span>refresh();
        <span style="color:#00f;font-weight:700">ConstructorConfusion</span> cc <span style="color:#00f;font-weight:700">=</span> (<span style="color:#00f;font-weight:700">ConstructorConfusion</span>)
                ctx<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#036a07">constructorConfusion</span>);
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(cc);
        ctx<span style="color:#00f;font-weight:700">.</span>close();
    }
}
</pre></div>
                </div>
            </div>
        </div>
        <div class="Para ParaOneEmphasisChild" id="Par155">By applying the <span class="EmphasisFontCategoryNonProportional">@Autowired</span> annotation to the desired constructor method, Spring will use that method to instantiate the bean and inject the value as specified. As before, we should externalize
            the value from the configuration.</div>
        <div class="Para ParaTypeImportant" id="Par156"> <img alt="A315511_5_En_3_Figa_HTML.jpg" data-mfp-src="/library/view/pro-spring-5/9781484228081/A315511_5_En_3_Figa_HTML.jpg" height="28" src="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_3_Figa_HTML.jpg" width="30"/>            The <span class="EmphasisFontCategoryNonProportional">@Autowired</span> annotation can be applied to only one of the constructor methods. If we apply the annotation to more than one constructor method, Spring will complain while bootstrapping
            <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>.</div>
    </div>
    <div class="Section3 RenderAsSection3" id="Sec21">
        <h4 class="Heading">Using <span id="ITerm57">Field Injection            </span> <span id="ITerm58">                                                    </span> </h4>
        <div class="Para" id="Par157">There is a third type of dependency injection supported in Spring called <span class="EmphasisTypeItalic">field injection</span>. As the name says, the dependency is injected directly in the field, with no constructor or setter needed. This is
            done by annotating the class member with the <span class="EmphasisFontCategoryNonProportional">Autowired</span> annotation. This might seem practical, because when the dependency is not needed outside of the object it is part of, it relieves
            the developer of <span id="ITerm59">writing            </span> <span id="ITerm60">                                                    </span> some code that is no longer used after the initial creation of the bean. In the following code snippet,
            the bean of type <span class="EmphasisFontCategoryNonProportional">Singer</span> has a field of type <span class="EmphasisFontCategoryNonProportional">Inspiration</span>:</div>
        <div class="Para" id="Par158">
            <div class="ProgramCode" id="PC42">
                <div class="LineGroup">
                    <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.annotated</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.beans.factory.annotation.Autowired</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.stereotype.Service</span>;

@Service(<span style="color:#036a07">singer</span>)
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">Singer</span> {
    <span style="color:#00f;font-weight:700">@Autowired</span>
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">Inspiration</span> inspirationBean;

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">sing</span>() {
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">... </span> <span style="color:#00f;font-weight:700">+</span> inspirationBean<span style="color:#00f;font-weight:700">.</span>getLyric());
    }
}
</pre></div>
                </div>
            </div>
        </div>
        <div class="Para" id="Par159">The field is private, but the Spring IoC container does not really care about that; it uses reflection to populate the required dependency. The <span class="EmphasisFontCategoryNonProportional">Inspiration</span> class code is shown here; it is
            a simple bean with a <span class="EmphasisFontCategoryNonProportional">String</span> member:</div>
        <div class="Para" id="Par160">
            <div class="ProgramCode" id="PC43">
                <div class="LineGroup">
                    <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.annotated</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.beans.factory.annotation.Value</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.stereotype.Component</span>;

@<span style="color:#00f;font-weight:700">Component</span>
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">Inspiration</span> {
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">String</span> lyric <span style="color:#00f;font-weight:700">=</span>
            <span style="color:#036a07">I can keep the door cracked open, to let light through</span>;

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#0000a2;font-weight:700">Inspiration</span>(
            @<span style="color:#00f;font-weight:700">Value</span>(&quot;<span style="color:#00f;font-weight:700">For</span> <span style="font-style:italic">all</span> <span style="font-style:italic">my</span> <span style="font-style:italic">running</span>, <span style="color:#00f;font-weight:700">I</span> <span style="font-style:italic">can</span> <span style="font-style:italic">understand</span>&quot;) String lyric) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>lyric <span style="color:#00f;font-weight:700">=</span> lyric;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">String</span> <span style="color:#0000a2;font-weight:700">getLyric</span>() {
        <span style="color:#00f;font-weight:700">return</span> lyric;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setLyric</span>(<span style="color:#00f;font-weight:700">String</span> <span style="font-style:italic">lyric</span>) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>lyric <span style="color:#00f;font-weight:700">=</span> lyric;
    }
}
</pre></div>
                </div>
            </div>
        </div>
        <div class="Para" id="Par161">The following <span id="ITerm61">configuration            </span> <span id="ITerm62">                                                    </span> uses component scanning to discover the bean definitions that will be created by the Spring IoC container:</div>
        <div class="Para" id="Par162">
            <div class="ProgramCode" id="PC44">
                <div class="FixedLine">&lt;beans ...&gt;</div>
                <div class="FixedLine">    &lt;context:component-scan</div>
                <div class="FixedLine">            base-package=&quot;com.apress.prospring5.ch3.annotated&quot;/&gt;</div>
                <div class="FixedLine">&lt;/beans&gt;</div>
            </div>
    </div>
    <div class="Para" id="Par163">Finding one bean of type <span class="EmphasisFontCategoryNonProportional">Inspiration</span>, the Spring IoC container will inject that bean in the <span class="EmphasisFontCategoryNonProportional">inspirationBean</span> member of the <span class="EmphasisFontCategoryNonProportional">singer</span>        bean. That is why when running the example depicted in the next code snippet, “For all my running, I can understand” will be printed in the console.</div>
    <div class="Para" id="Par164">
        <div class="ProgramCode" id="PC45">
            <div class="LineGroup">
                <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.annotated</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.support.GenericXmlApplicationContext</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">FieldInjection</span> {
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span>... <span style="font-style:italic">args</span>) {
        <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span> ctx <span style="color:#00f;font-weight:700">=</span>
                <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span>();
        ctx<span style="color:#00f;font-weight:700">.</span>load(<span style="color:#036a07">classpath:spring/app-context.xml</span>);
        ctx<span style="color:#00f;font-weight:700">.</span>refresh();
        <span style="color:#00f;font-weight:700">Singer</span> singerBean <span style="color:#00f;font-weight:700">=</span> ctx<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#00f;font-weight:700">Singer</span><span style="color:#00f;font-weight:700">.</span>class);
        singerBean<span style="color:#00f;font-weight:700">.</span>sing();
        ctx<span style="color:#00f;font-weight:700">.</span>close();
    }
}
</pre></div>
            </div>
        </div>
    </div>
    <div class="Para" id="Par165">But there are drawbacks, and this is why using field injection is usually avoided.
        <div class="UnorderedList">
            <ul class="UnorderedListMarkBullet">
                <li>
                    <div class="Para" id="Par166">Although it is easy to add dependencies this way, we must be careful not to violate the single responsibility principle. Having more dependencies means more responsibilities for a class, which might lead to a difficulty of separating
                        concerns at refactoring time. The situation when a class becomes bloated is easier to see when dependencies are set using constructors or setters but is quite well hidden when using field injection.</div>
                </li>
                <li>
                    <div class="Para" id="Par167">The responsibility of <span id="ITerm63">injecting                  </span> <span id="ITerm64">                                                                      </span> dependencies is passed to the container in Spring, but the
                        class should clearly communicate the type of dependencies needed using a public interface, through methods or constructors. Using field injections, it can become unclear what type of dependency is really needed and if the dependency
                        is mandatory or not.</div>
                </li>
                <li>
                    <div class="Para ParaOneEmphasisChild" id="Par168">Field injection introduces a dependency of the Spring container, as the <span class="EmphasisFontCategoryNonProportional">@Autowired</span> annotation is a Spring component; thus, the bean is no longer a POJO and cannot be instantiated
                        independently.</div>
                </li>
                <li>
                    <div class="Para" id="Par169">Field injection cannot be used for final fields. This type of fields can only be initialized using constructor injection.</div>
                </li>
                <li>
                    <div class="Para" id="Par170">Field injection introduces difficulties when writing tests as the dependencies have to be injected manually.</div>
                </li>
            </ul>
        </div>
    </div>
    </div>
    <div class="Section3 RenderAsSection3" id="Sec22">
        <h4 class="Heading">Using <span id="ITerm65">Injection Parameters                          </span> </h4>
        <div class="Para" id="Par171">In the three previous examples, you saw how to inject other components and values into a bean by using both setter injection and constructor injection. Spring supports a myriad of options for injection parameters, allowing you to inject not only
            other components and simple values but also Java collections, externally defined properties, and even beans in another factory. You can use all of these injection parameter types for both setter injection and constructor injection by using
            the corresponding tag under the <span class="EmphasisFontCategoryNonProportional">&lt;property&gt;</span> and <span class="EmphasisFontCategoryNonProportional">&lt;constructor-args&gt;</span> tags, respectively.</div>
    </div>
    <div class="Section3 RenderAsSection3" id="Sec23">
        <h4 class="Heading">Injecting Simple Values</h4>
        <div class="Para" id="Par172"> <span id="ITerm66">Injecting simple values                          </span> into your beans is easy. To do so, simply specify the value in the configuration tag, wrapped inside a <span class="EmphasisFontCategoryNonProportional">&lt;value&gt;</span>            tag. By default, not only can the <span class="EmphasisFontCategoryNonProportional">&lt;value&gt;</span> tag read <span class="EmphasisFontCategoryNonProportional">String</span> values, but it can also convert these values to any primitive
            or primitive wrapper class. The following code snippet shows a simple bean that has a variety of properties exposed for injection:</div>
        <div class="Para" id="Par173">
            <div class="ProgramCode" id="PC46">
                <div class="LineGroup">
                    <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.xml</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.support.GenericXmlApplicationContext</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">InjectSimple</span> {
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">String</span> name;
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">int</span> age;
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">float</span> height;
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">boolean</span> programmer;
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">Long</span> ageInSeconds;

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span>... <span style="font-style:italic">args</span>) {
        <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span> ctx <span style="color:#00f;font-weight:700">=</span>
                <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span>();
        ctx<span style="color:#00f;font-weight:700">.</span>load(<span style="color:#036a07">classpath:spring/app-context-xml.xml</span>);
        ctx<span style="color:#00f;font-weight:700">.</span>refresh();
        <span style="color:#00f;font-weight:700">InjectSimple</span> simple <span style="color:#00f;font-weight:700">=</span> (<span style="color:#00f;font-weight:700">InjectSimple</span>) ctx<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#036a07">injectSimple</span>);
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(simple);
        ctx<span style="color:#00f;font-weight:700">.</span>close();
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setAgeInSeconds</span>(<span style="color:#00f;font-weight:700">Long</span> <span style="font-style:italic">ageInSeconds</span>) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>ageInSeconds <span style="color:#00f;font-weight:700">=</span> ageInSeconds;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setProgrammer</span>(<span style="color:#00f;font-weight:700">boolean</span> <span style="font-style:italic">programmer</span>) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>programmer <span style="color:#00f;font-weight:700">=</span> programmer;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setAge</span>(<span style="color:#00f;font-weight:700">int</span> <span style="font-style:italic">age</span>) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>age <span style="color:#00f;font-weight:700">=</span> age;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setHeight</span>(<span style="color:#00f;font-weight:700">float</span> <span style="font-style:italic">height</span>) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>height <span style="color:#00f;font-weight:700">=</span> height;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setName</span>(<span style="color:#00f;font-weight:700">String</span> <span style="font-style:italic">name</span>) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>name <span style="color:#00f;font-weight:700">=</span> name;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">String</span> <span style="color:#0000a2;font-weight:700">toString</span>() {
        <span style="color:#00f;font-weight:700">return</span> <span style="color:#036a07">Name: </span> <span style="color:#00f;font-weight:700">+</span> name <span style="color:#00f;font-weight:700">+</span> <span style="color:#036a07">&quot;<span style="color:#26b31a">\n</span>&quot;</span>
                <span style="color:#00f;font-weight:700">+</span> <span style="color:#036a07">Age: </span> <span style="color:#00f;font-weight:700">+</span> age <span style="color:#00f;font-weight:700">+</span> <span style="color:#036a07">&quot;<span style="color:#26b31a">\n</span>&quot;</span>
                <span style="color:#00f;font-weight:700">+</span> <span style="color:#036a07">Age in Seconds: </span> <span style="color:#00f;font-weight:700">+</span> ageInSeconds <span style="color:#00f;font-weight:700">+</span> <span style="color:#036a07">&quot;<span style="color:#26b31a">\n</span>&quot;</span>
                <span style="color:#00f;font-weight:700">+</span> <span style="color:#036a07">Height: </span> <span style="color:#00f;font-weight:700">+</span> height <span style="color:#00f;font-weight:700">+</span> <span style="color:#036a07">&quot;<span style="color:#26b31a">\n</span>&quot;</span>
                <span style="color:#00f;font-weight:700">+</span> <span style="color:#036a07">Is Programmer?: </span> <span style="color:#00f;font-weight:700">+</span> programmer;
    }
}
</pre></div>
    </div>
    </div>
    </div>
    <div class="Para" id="Par174">In addition to the properties, the <span class="EmphasisFontCategoryNonProportional">InjectSimple</span> class also defines the <span class="EmphasisFontCategoryNonProportional">main()</span> method that creates an <span class="EmphasisFontCategoryNonProportional">Application Context</span>        and then retrieves an <span class="EmphasisFontCategoryNonProportional">InjectSimple</span> bean from Spring. The property values of this bean are then written to the console output. The configuration contained in <span class="EmphasisFontCategoryNonProportional">app-context-xml.xml</span>        for this bean is depicted in the following snippet:</div>
    <div class="Para" id="Par175">
        <div class="ProgramCode" id="PC47">
            <div class="LineGroup">
                <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#1c02ff">&lt;<span style="font-weight:700">beans</span> ...&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">injectSimpleConfig</span>
         <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch3.xml.InjectSimpleConfig</span>/&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">injectSimpleSpel</span>
         <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch3.xml.InjectSimpleSpel</span>
        <span style="font-style:italic">p</span>:name=<span style="color:#036a07">John Mayer</span>
        <span style="font-style:italic">p</span>:age=<span style="color:#036a07">39</span>
        <span style="font-style:italic">p</span>:height=<span style="color:#036a07">1.92</span>
        <span style="font-style:italic">p</span>:programmer=<span style="color:#036a07">false</span>
        <span style="font-style:italic">p</span>:ageInSeconds=<span style="color:#036a07">1241401112</span>/&gt;</span>
<span style="color:#1c02ff">&lt;/<span style="font-weight:700">beans</span>&gt;</span>
</pre></div>
            </div>
        </div>
    </div>
    <div class="Para" id="Par176">You can see from the two previous code snippets that it is possible to define properties on your bean that accept <span class="EmphasisFontCategoryNonProportional">String</span> values, primitive values, or primitive wrapper values and then inject
        values for these properties by using the <span class="EmphasisFontCategoryNonProportional">&lt;value&gt;</span> tag. Here is the output created by running this example as expected:</div>
    <div class="Para" id="Par177">
        <div class="ProgramCode" id="PC48">
            <div class="FixedLine">Name: John Mayer</div>
            <div class="FixedLine">Age: 39</div>
            <div class="FixedLine">Age in Seconds: 1241401112</div>
            <div class="FixedLine">Height: 1.92</div>
            <div class="FixedLine">Is Programmer?: false</div>
        </div>
    </div>
    <div class="Para" id="Par178">For annotation-style simple value injection, we can apply the <span class="EmphasisFontCategoryNonProportional">@Value</span> annotation to the bean properties. This time, instead of the setter method, we apply the annotation to the property declaration
        statement, as we can see in the following code snippet (Spring supports the annotation either at the setter method or in the properties): <span id="ITerm69">                                                    </span> </div>
    <div class="Para" id="Par179">
        <div class="ProgramCode" id="PC49">
            <div class="LineGroup">
                <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.annotated</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.beans.factory.annotation.Value</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.support.GenericXmlApplicationContext</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.stereotype.Service</span>;

@Service(<span style="color:#036a07">injectSimple</span>)
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">InjectSimple</span> {
    <span style="color:#00f;font-weight:700">@Value</span>(<span style="color:#036a07">John Mayer</span>)
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">String</span> name;
    <span style="color:#00f;font-weight:700">@Value</span>(<span style="color:#036a07">39</span>)
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">int</span> age;
    <span style="color:#00f;font-weight:700">@Value</span>(<span style="color:#036a07">1.92</span>)
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">float</span> height;
    <span style="color:#00f;font-weight:700">@Value</span>(<span style="color:#036a07">false</span>)
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">boolean</span> programmer;
    <span style="color:#00f;font-weight:700">@Value</span>(<span style="color:#036a07">1241401112</span>)
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">Long</span> ageInSeconds;

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span>... <span style="font-style:italic">args</span>) {
        <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span> ctx <span style="color:#00f;font-weight:700">=</span>
                <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span>();
        ctx<span style="color:#00f;font-weight:700">.</span>load(<span style="color:#036a07">classpath:spring/app-context-annotation.xml</span>);
        ctx<span style="color:#00f;font-weight:700">.</span>refresh();
        <span style="color:#00f;font-weight:700">InjectSimple</span> simple <span style="color:#00f;font-weight:700">=</span> (<span style="color:#00f;font-weight:700">InjectSimple</span>) ctx<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#036a07">injectSimple</span>);
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(simple);
        ctx<span style="color:#00f;font-weight:700">.</span>close();
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">String</span> <span style="color:#0000a2;font-weight:700">toString</span>() {
        <span style="color:#00f;font-weight:700">return</span> <span style="color:#036a07">Name: </span> <span style="color:#00f;font-weight:700">+</span> name <span style="color:#00f;font-weight:700">+</span> <span style="color:#036a07">&quot;<span style="color:#26b31a">\n</span>&quot;</span>
                <span style="color:#00f;font-weight:700">+</span> <span style="color:#036a07">Age: </span> <span style="color:#00f;font-weight:700">+</span> age <span style="color:#00f;font-weight:700">+</span> <span style="color:#036a07">&quot;<span style="color:#26b31a">\n</span>&quot;</span>
                <span style="color:#00f;font-weight:700">+</span> <span style="color:#036a07">Age in Seconds: </span> <span style="color:#00f;font-weight:700">+</span> ageInSeconds <span style="color:#00f;font-weight:700">+</span> <span style="color:#036a07">&quot;<span style="color:#26b31a">\n</span>&quot;</span>
                <span style="color:#00f;font-weight:700">+</span> <span style="color:#036a07">Height: </span> <span style="color:#00f;font-weight:700">+</span> height <span style="color:#00f;font-weight:700">+</span> <span style="color:#036a07">&quot;<span style="color:#26b31a">\n</span>&quot;</span>
                <span style="color:#00f;font-weight:700">+</span> <span style="color:#036a07">Is Programmer?: </span> <span style="color:#00f;font-weight:700">+</span> programmer;
    }
}
</pre></div>
        </div>
    </div>
    </div>
    <div class="Para" id="Par180">This achieves the same result as the XML configuration. <span id="ITerm70">                                                    </span> </div>
    </div>
    <div class="Section3 RenderAsSection3" id="Sec24">
        <h4 class="Heading">Injecting Values by Using SpEL</h4>
        <div class="Para" id="Par181">One powerful feature introduced in Spring 3 is the <span id="ITerm71">Spring Expression Language (SpEL)            </span>. <span id="ITerm72">SpEL                          </span> enables you to evaluate an expression dynamically and then use
            it in Spring’s <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>. You can use the result for injection into Spring beans. In this section, we take a look at how to use SpEL to inject properties from other beans, by
            using the example in the preceding section.</div>
        <div class="Para" id="Par182">Suppose now we want to externalize the values to be injected into a Spring bean in a configuration class, as shown in the following code snippet:</div>
        <div class="Para" id="Par183">
            <div class="ProgramCode" id="PC50">
                <div class="LineGroup">
                    <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.annotated</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.stereotype.Component</span>;

@Component(<span style="color:#036a07">injectSimpleConfig</span>)
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">InjectSimpleConfig</span> {
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">String</span> name <span style="color:#00f;font-weight:700">=</span> <span style="color:#036a07">John Mayer</span>;
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">int</span> age <span style="color:#00f;font-weight:700">=</span> <span style="color:#0000cd">39</span>;
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">float</span> height <span style="color:#00f;font-weight:700">=</span> <span style="color:#0000cd">1.92f</span>;
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">boolean</span> programmer <span style="color:#00f;font-weight:700">=</span> <span style="color:#585cf6;font-weight:700">false</span>;
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">Long</span> ageInSeconds <span style="color:#00f;font-weight:700">=</span> 1_241_401_112L;

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">String</span> <span style="color:#0000a2;font-weight:700">getName</span>() {
        <span style="color:#00f;font-weight:700">return</span> name;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">int</span> <span style="color:#0000a2;font-weight:700">getAge</span>() {
        <span style="color:#00f;font-weight:700">return</span> age;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">float</span> <span style="color:#0000a2;font-weight:700">getHeight</span>() {
        <span style="color:#00f;font-weight:700">return</span> height;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">boolean</span> <span style="color:#0000a2;font-weight:700">isProgrammer</span>() {
        <span style="color:#00f;font-weight:700">return</span> programmer;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">Long</span> <span style="color:#0000a2;font-weight:700">getAgeInSeconds</span>() {
        <span style="color:#00f;font-weight:700">return</span> ageInSeconds;
    }
}
</pre></div>
                </div>
            </div>
        </div>
        <div class="Para" id="Par184">We can then define the bean in the XML configuration and use SpEL to inject the bean’s properties into the dependent bean, as shown in the following configuration snippet:</div>
        <div class="Para" id="Par185">
            <div class="ProgramCode" id="PC51">
                <div class="LineGroup">
                    <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#1c02ff">&lt;<span style="font-weight:700">beans</span> ...&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">injectSimpleConfig</span>
        <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch3.xml.InjectSimpleConfig</span>/&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">injectSimpleSpel</span>
        <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch3.xml.InjectSimpleSpel</span>
        <span style="font-style:italic">p</span>:name=<span style="color:#036a07">#{injectSimpleConfig.name}</span>
        <span style="font-style:italic">p</span>:age=<span style="color:#036a07">#{injectSimpleConfig.age + 1}</span>
        <span style="font-style:italic">p</span>:height=<span style="color:#036a07">#{injectSimpleConfig.height}</span>
        <span style="font-style:italic">p</span>:programmer=<span style="color:#036a07">#{injectSimpleConfig.programmer}</span>
        <span style="font-style:italic">p</span>:ageInSeconds=<span style="color:#036a07">#{injectSimpleConfig.ageInSeconds}</span>/&gt;</span>
<span style="color:#1c02ff">&lt;/<span style="font-weight:700">beans</span>&gt;</span>
</pre></div>
                </div>
            </div>
        </div>
        <div class="Para ParaOneEmphasisChild" id="Par186">Notice that we use the SpEL <span class="EmphasisFontCategoryNonProportional">#{injectSimpleConfig.name}</span> in referencing the property of the other bean. For the age, we add 1 to the value of the bean to indicate that we can use SpEL to manipulate
            the property as we see fit and inject it into the dependent bean. Now we can test the configuration with the program shown in the following code snippet:</div>
        <div class="Para" id="Par187">
            <div class="ProgramCode" id="PC52">
                <div class="LineGroup">
                    <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.xml</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.support.GenericXmlApplicationContext</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">InjectSimpleSpel</span> {
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">String</span> name;
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">int</span> age;
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">float</span> height;
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">boolean</span> programmer;
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">Long</span> ageInSeconds;

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">String</span> <span style="color:#0000a2;font-weight:700">getName</span>() {
        <span style="color:#00f;font-weight:700">return</span> <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>name;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setName</span>(<span style="color:#00f;font-weight:700">String</span> <span style="font-style:italic">name</span>) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>name <span style="color:#00f;font-weight:700">=</span> name;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">int</span> <span style="color:#0000a2;font-weight:700">getAge</span>() {
        <span style="color:#00f;font-weight:700">return</span> <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>age;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setAge</span>(<span style="color:#00f;font-weight:700">int</span> <span style="font-style:italic">age</span>) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>age <span style="color:#00f;font-weight:700">=</span> age;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">float</span> <span style="color:#0000a2;font-weight:700">getHeight</span>() {
        <span style="color:#00f;font-weight:700">return</span> <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>height;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setHeight</span>(<span style="color:#00f;font-weight:700">float</span> <span style="font-style:italic">height</span>) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>height <span style="color:#00f;font-weight:700">=</span> height;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">boolean</span> <span style="color:#0000a2;font-weight:700">isProgrammer</span>() {
        <span style="color:#00f;font-weight:700">return</span> <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>programmer;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setProgrammer</span>(<span style="color:#00f;font-weight:700">boolean</span> <span style="font-style:italic">programmer</span>) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>programmer <span style="color:#00f;font-weight:700">=</span> programmer;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">Long</span> <span style="color:#0000a2;font-weight:700">getAgeInSeconds</span>() {
        <span style="color:#00f;font-weight:700">return</span> <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>ageInSeconds;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setAgeInSeconds</span>(<span style="color:#00f;font-weight:700">Long</span> <span style="font-style:italic">ageInSeconds</span>) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>ageInSeconds <span style="color:#00f;font-weight:700">=</span> ageInSeconds;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">String</span> <span style="color:#0000a2;font-weight:700">toString</span>() {
        <span style="color:#00f;font-weight:700">return</span> <span style="color:#036a07">Name: </span> <span style="color:#00f;font-weight:700">+</span> name <span style="color:#00f;font-weight:700">+</span> <span style="color:#036a07">&quot;<span style="color:#26b31a">\n</span>&quot;</span>
                <span style="color:#00f;font-weight:700">+</span> <span style="color:#036a07">Age: </span> <span style="color:#00f;font-weight:700">+</span> age <span style="color:#00f;font-weight:700">+</span> <span style="color:#036a07">&quot;<span style="color:#26b31a">\n</span>&quot;</span>
                <span style="color:#00f;font-weight:700">+</span> <span style="color:#036a07">Age in Seconds: </span> <span style="color:#00f;font-weight:700">+</span> ageInSeconds <span style="color:#00f;font-weight:700">+</span> <span style="color:#036a07">&quot;<span style="color:#26b31a">\n</span>&quot;</span>
                <span style="color:#00f;font-weight:700">+</span> <span style="color:#036a07">Height: </span> <span style="color:#00f;font-weight:700">+</span> height <span style="color:#00f;font-weight:700">+</span> <span style="color:#036a07">&quot;<span style="color:#26b31a">\n</span>&quot;</span>
                <span style="color:#00f;font-weight:700">+</span> <span style="color:#036a07">Is Programmer?: </span> <span style="color:#00f;font-weight:700">+</span> programmer;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span>... <span style="font-style:italic">args</span>) {
        <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span> ctx <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span>();
        ctx<span style="color:#00f;font-weight:700">.</span>load(<span style="color:#036a07">classpath:spring/app-context-xml.xml</span>);
        ctx<span style="color:#00f;font-weight:700">.</span>refresh();
        <span style="color:#00f;font-weight:700">InjectSimpleSpel</span> simple <span style="color:#00f;font-weight:700">=</span> (<span style="color:#00f;font-weight:700">InjectSimpleSpel</span>) ctx<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#036a07">injectSimpleSpel</span>);
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(simple);
        ctx<span style="color:#00f;font-weight:700">.</span>close();
    }
}
</pre></div>
                </div>
            </div>
        </div>
        <div class="Para" id="Par188">The following is the output of the program:</div>
        <div class="Para" id="Par189">
            <div class="ProgramCode" id="PC53">
                <div class="FixedLine">Name: John Mayer</div>
                <div class="FixedLine">Age: 40</div>
                <div class="FixedLine">Age in Seconds: 1241401112</div>
                <div class="FixedLine">Height: 1.92</div>
                <div class="FixedLine">Is Programmer?: false</div>
            </div>
        </div>
        <div class="Para" id="Par190">When using annotation-style value injection, we just need to substitute the value annotations with the SpEL expressions (see the following code snippet):</div>
        <div class="Para" id="Par191">
            <div class="ProgramCode" id="PC54">
                <div class="LineGroup">
                    <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.annotated</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.beans.factory.annotation.Value</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.support.GenericXmlApplicationContext</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.stereotype.Service</span>;

@Service(<span style="color:#036a07">injectSimpleSpel</span>)
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">InjectSimpleSpel</span> {
    <span style="color:#00f;font-weight:700">@Value</span>(<span style="color:#036a07">#{injectSimpleConfig.name}</span>)
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">String</span> name;
    <span style="color:#00f;font-weight:700">@Value</span>(<span style="color:#036a07">#{injectSimpleConfig.age + 1}</span>)
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">int</span> age;
    <span style="color:#00f;font-weight:700">@Value</span>(<span style="color:#036a07">#{injectSimpleConfig.height}</span>)
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">float</span> height;
    <span style="color:#00f;font-weight:700">@Value</span>(<span style="color:#036a07">#{injectSimpleConfig.programmer}</span>)
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">boolean</span> programmer;
    <span style="color:#00f;font-weight:700">@Value</span>(<span style="color:#036a07">#{injectSimpleConfig.ageInSeconds}</span>)
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">Long</span> ageInSeconds;

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">String</span> <span style="color:#0000a2;font-weight:700">toString</span>() {
        <span style="color:#00f;font-weight:700">return</span> <span style="color:#036a07">Name: </span> <span style="color:#00f;font-weight:700">+</span> name <span style="color:#00f;font-weight:700">+</span> <span style="color:#036a07">&quot;<span style="color:#26b31a">\n</span>&quot;</span>
                <span style="color:#00f;font-weight:700">+</span> <span style="color:#036a07">Age: </span> <span style="color:#00f;font-weight:700">+</span> age <span style="color:#00f;font-weight:700">+</span> <span style="color:#036a07">&quot;<span style="color:#26b31a">\n</span>&quot;</span>
                <span style="color:#00f;font-weight:700">+</span> <span style="color:#036a07">Age in Seconds: </span> <span style="color:#00f;font-weight:700">+</span> ageInSeconds <span style="color:#00f;font-weight:700">+</span> <span style="color:#036a07">&quot;<span style="color:#26b31a">\n</span>&quot;</span>
                <span style="color:#00f;font-weight:700">+</span> <span style="color:#036a07">Height: </span> <span style="color:#00f;font-weight:700">+</span> height <span style="color:#00f;font-weight:700">+</span> <span style="color:#036a07">&quot;<span style="color:#26b31a">\n</span>&quot;</span>
                <span style="color:#00f;font-weight:700">+</span> <span style="color:#036a07">Is Programmer?: </span> <span style="color:#00f;font-weight:700">+</span> programmer;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span>... <span style="font-style:italic">args</span>) {
        <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span> ctx <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span>();
        ctx<span style="color:#00f;font-weight:700">.</span>load(<span style="color:#036a07">classpath:spring/app-context-annotation.xml</span>);
        ctx<span style="color:#00f;font-weight:700">.</span>refresh();
        <span style="color:#00f;font-weight:700">InjectSimpleSpel</span> simple <span style="color:#00f;font-weight:700">=</span> (<span style="color:#00f;font-weight:700">InjectSimpleSpel</span>) ctx<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#036a07">injectSimpleSpel</span>);
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(simple);
        ctx<span style="color:#00f;font-weight:700">.</span>close();
    }
}
</pre></div>
                </div>
            </div>
        </div>
        <div class="Para ParaOneEmphasisChild" id="Par192">The version of <span class="EmphasisFontCategoryNonProportional">InjectSimpleConfig</span> is shown here:</div>
        <div class="Para" id="Par193">
            <div class="ProgramCode" id="PC55">
                <div class="LineGroup">
                    <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.annotated</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.stereotype.Component</span>;

@Component(<span style="color:#036a07">injectSimpleConfig</span>)
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">InjectSimpleConfig</span> {
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">String</span> name <span style="color:#00f;font-weight:700">=</span> <span style="color:#036a07">John Mayer</span>;
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">int</span> age <span style="color:#00f;font-weight:700">=</span> <span style="color:#0000cd">39</span>;
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">float</span> height <span style="color:#00f;font-weight:700">=</span> <span style="color:#0000cd">1.92f</span>;
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">boolean</span> programmer <span style="color:#00f;font-weight:700">=</span> <span style="color:#585cf6;font-weight:700">false</span>;
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">Long</span> ageInSeconds <span style="color:#00f;font-weight:700">=</span> 1_241_401_112L;
    <span style="color:#06f;font-style:italic">// getters here ...</span>
}
</pre></div>
                </div>
            </div>
        </div>
        <div class="Para" id="Par194">In the previous snippet, instead of the <span class="EmphasisFontCategoryNonProportional">@Service annotation</span>, <span class="EmphasisFontCategoryNonProportional">@Component</span> was used. Basically, using <span class="EmphasisFontCategoryNonProportional">@Component</span>            has the same effect as <span class="EmphasisFontCategoryNonProportional">@Service</span>. Both annotations are instructing Spring that the annotated class is a candidate for autodetection using annotation-based configuration and classpath
            scanning. However, since the <span class="EmphasisFontCategoryNonProportional">InjectSimpleConfig</span> class is storing the application configuration, rather than providing a business service, using <span class="EmphasisFontCategoryNonProportional">@Component</span>            makes more sense. Practically, <span class="EmphasisFontCategoryNonProportional">@Service</span> is a specialization of <span class="EmphasisFontCategoryNonProportional">@Component</span>, which indicates that the annotated class is providing
            a business service to other layers within the application.</div>
        <div class="Para" id="Par195">Testing the program will produce the same result. Using SpEL, you can access any Spring-managed beans and properties and manipulate them for application use by Spring’s support of sophisticated language features and syntax.</div>
    </div>
    <div class="Section3 RenderAsSection3" id="Sec25">
        <h4 class="Heading"> <span id="ITerm83">Injecting Beans                          </span> in the Same XML Unit</h4>
        <div class="Para ParaOneEmphasisChild" id="Par196">As you have already seen, it is possible to inject one bean into another by using the <span class="EmphasisFontCategoryNonProportional">ref</span> tag. The next code snippet shows a class that exposes a setter to allow a bean to be injected:</div>
        <div class="Para" id="Par197">
            <div class="ProgramCode" id="PC56">
                <div class="LineGroup">
                    <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.xml</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.support.GenericXmlApplicationContext</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.Oracle</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">InjectRef</span> {
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">Oracle</span> oracle;

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setOracle</span>(<span style="color:#00f;font-weight:700">Oracle</span> <span style="font-style:italic">oracle</span>) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>oracle <span style="color:#00f;font-weight:700">=</span> oracle;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span>... <span style="font-style:italic">args</span>) {
        <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span> ctx <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span>();
        ctx<span style="color:#00f;font-weight:700">.</span>load(<span style="color:#036a07">classpath:spring/app-context-xml.xml</span>);
        ctx<span style="color:#00f;font-weight:700">.</span>refresh();
        <span style="color:#00f;font-weight:700">InjectRef</span> injectRef <span style="color:#00f;font-weight:700">=</span> (<span style="color:#00f;font-weight:700">InjectRef</span>) ctx<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#036a07">injectRef</span>);
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(injectRef);
        ctx<span style="color:#00f;font-weight:700">.</span>close();
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">String</span> <span style="color:#0000a2;font-weight:700">toString</span>() {
        <span style="color:#00f;font-weight:700">return</span> oracle<span style="color:#00f;font-weight:700">.</span>defineMeaningOfLife();
    }
}
</pre></div>
                </div>
            </div>
    </div>
    <div class="Para" id="Par198">To configure Spring to inject one bean into another, you first need to configure two beans: one to be injected and one to be the target of the injection. Once this is done, you simply configure the injection by using the <span class="EmphasisFontCategoryNonProportional">&lt;ref&gt;</span>        tag on the target bean. The following code snippet shows an example of this configuration (file <span class="EmphasisFontCategoryNonProportional">app-context-xml.xml</span>):</div>
    <div class="Para" id="Par199">
        <div class="ProgramCode" id="PC57">
            <div class="LineGroup">
                <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#1c02ff">&lt;<span style="font-weight:700">beans</span> ...&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">oracle</span> <span style="font-style:italic">name</span>=<span style="color:#036a07">wiseworm</span>
        <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch3.BookwormOracle</span>/&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">injectRef</span>
        <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch3.xml.InjectRef</span>&gt;</span>
        <span style="color:#1c02ff">&lt;<span style="font-weight:700">property</span> <span style="font-style:italic">name</span>=<span style="color:#036a07">oracle</span>&gt;</span>
            <span style="color:#1c02ff">&lt;<span style="font-weight:700">ref</span> <span style="font-style:italic">bean</span>=<span style="color:#036a07">oracle</span>/&gt;</span>
        <span style="color:#1c02ff">&lt;/<span style="font-weight:700">property</span>&gt;</span>
    <span style="color:#1c02ff">&lt;/<span style="font-weight:700">bean</span>&gt;</span>
<span style="color:#1c02ff">&lt;/<span style="font-weight:700">beans</span>&gt;</span>
</pre></div>
            </div>
        </div>
    </div>
    <div class="Para ParaOneEmphasisChild" id="Par200">Running the <span class="EmphasisFontCategoryNonProportional">InjectRef</span> class produces the following output:</div>
    <div class="Para" id="Par201">
        <div class="ProgramCode" id="PC58">
            <div class="FixedLine">Encyclopedias are a waste of money - go see the world instead</div>
        </div>
    </div>
    <div class="Para" id="Par202">An important point to note is that the type being injected does not have to be the exact type defined on the target; the types just need to be compatible. Compatible means that if the declared type on the target is an interface, the injected type
        must implement this interface. If the declared type is a class, the injected type must be either the same type or a subtype. In this example, the <span class="EmphasisFontCategoryNonProportional">InjectRef</span> class defines the <span id="ITerm85">              <span class="EmphasisFontCategoryNonProportional">setOracle()</span>        method </span> to receive an instance of <span class="EmphasisFontCategoryNonProportional">Oracle</span>, which is an interface, and the injected type is <span class="EmphasisFontCategoryNonProportional">BookwormOracle</span>, a class that implements
        <span class="EmphasisFontCategoryNonProportional">Oracle</span>. This is a point that causes confusion for some developers, but it is really quite simple. Injection is subject to the same typing rules as any Java code, so as long as you are familiar
        with how Java typing works, understanding typing in injection is easy.</div>
    <div class="Para" id="Par203">In the previous example, the ID of the bean to inject is specified by using the local attribute of the <span class="EmphasisFontCategoryNonProportional">&lt;ref&gt;</span> tag. As you will see later, in the section “Understanding Bean Naming,” you
        can give a bean more than one name so that you can refer to it using a variety of aliases. When you use the local attribute, it means that the <span class="EmphasisFontCategoryNonProportional">&lt;ref&gt;</span> tag only looks at the bean’s ID
        and never at any of its aliases. Moreover, the bean definition should exist in the same XML configuration file. To inject a bean by any name or import one from other XML configuration files, use the bean attribute of the <span class="EmphasisFontCategoryNonProportional">&lt;ref&gt;</span>        tag instead of the local attribute. The following code snippet shows an alternative configuration for the previous example, using an alternative <span id="ITerm86">name                          </span> for the injected bean:</div>
    <div class="Para" id="Par204">
        <div class="ProgramCode" id="PC59">
            <div class="LineGroup">
                <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#1c02ff">&lt;<span style="font-weight:700">beans</span> ...&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">oracle</span> <span style="font-style:italic">name</span>=<span style="color:#036a07">wiseworm</span>
        <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch3.BookwormOracle</span>/&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">injectRef</span>
        <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch3.xml.InjectRef</span>&gt;</span>
        <span style="color:#1c02ff">&lt;<span style="font-weight:700">property</span> <span style="font-style:italic">name</span>=<span style="color:#036a07">oracle</span>&gt;</span>
            <span style="color:#1c02ff">&lt;<span style="font-weight:700">ref</span> <span style="font-style:italic">bean</span>=<span style="color:#036a07">wiseworm</span>/&gt;</span>
        <span style="color:#1c02ff">&lt;/<span style="font-weight:700">property</span>&gt;</span>
    <span style="color:#1c02ff">&lt;/<span style="font-weight:700">bean</span>&gt;</span>
<span style="color:#1c02ff">&lt;/<span style="font-weight:700">beans</span>&gt;</span>
</pre></div>
            </div>
        </div>
    </div>
    <div class="Para" id="Par205">In this example, the <span class="EmphasisFontCategoryNonProportional">oracle</span> bean is given an alias by using the <span class="EmphasisFontCategoryNonProportional">name</span> attribute, and then it is injected into the <span class="EmphasisFontCategoryNonProportional">injectRef</span>        bean by using this alias in conjunction with the bean attribute of the <span class="EmphasisFontCategoryNonProportional">&lt;ref&gt;</span> tag. Don’t worry too much about the naming semantics at this point. We discuss this in much more detail
        later in the chapter. Running the <span class="EmphasisFontCategoryNonProportional">InjectRef</span> class again produces the same result as the previous example.</div>
    </div>
    <div class="Section3 RenderAsSection3" id="Sec26">
        <h4 class="Heading"> <span id="ITerm87">Injection and ApplicationContext Nesting                          </span> </h4>
        <div class="Para" id="Par206">So far, the beans we have been injecting have been located in the same <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> (and hence the same <span class="EmphasisFontCategoryNonProportional">BeanFactory</span>) as the
            beans they are injected into. However, Spring supports a hierarchical structure for <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> so that one context (and hence the associating <span class="EmphasisFontCategoryNonProportional">BeanFactory</span>)
            is considered the parent of another. By allowing <span class="EmphasisFontCategoryNonProportional">ApplicationContexts</span> to be nested, Spring allows you to split your configuration into different files, which is a godsend on larger projects
            with lots of beans.</div>
        <div class="Para" id="Par207">When nesting <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> instances, Spring allows beans in what is considered the child context to reference beans in the parent context. <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>            nesting using <span class="EmphasisFontCategoryNonProportional">GenericXmlApplicationContext</span> is simple to understand. To nest one <span class="EmphasisFontCategoryNonProportional">GenericXmlApplicationContext</span> inside another,
            simply call the <span class="EmphasisFontCategoryNonProportional">setParent()</span> method in the child <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>, as shown in the following code sample:</div>
        <div class="Para" id="Par208">
            <div class="ProgramCode" id="PC60">
                <div class="LineGroup">
                    <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.support.GenericXmlApplicationContext</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">HierarchicalAppContextUsage</span> {
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span>... <span style="font-style:italic">args</span>) {
        <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span> parent <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span>();
        parent<span style="color:#00f;font-weight:700">.</span>load(<span style="color:#036a07">classpath:spring/parent-context.xml</span>);
        parent<span style="color:#00f;font-weight:700">.</span>refresh();
        <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span> child <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span>();
        child<span style="color:#00f;font-weight:700">.</span>load(<span style="color:#036a07">classpath:spring/child-context.xml</span>);
        child<span style="color:#00f;font-weight:700">.</span>setParent(parent);
        child<span style="color:#00f;font-weight:700">.</span>refresh();
        <span style="color:#00f;font-weight:700">Song</span> song1 <span style="color:#00f;font-weight:700">=</span> (<span style="color:#00f;font-weight:700">Song</span>) child<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#036a07">song1</span>);
        <span style="color:#00f;font-weight:700">Song</span> song2 <span style="color:#00f;font-weight:700">=</span> (<span style="color:#00f;font-weight:700">Song</span>) child<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#036a07">song2</span>);
        <span style="color:#00f;font-weight:700">Song</span> song3 <span style="color:#00f;font-weight:700">=</span> (<span style="color:#00f;font-weight:700">Song</span>) child<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#036a07">song3</span>);
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">from parent ctx: </span> <span style="color:#00f;font-weight:700">+</span> song1<span style="color:#00f;font-weight:700">.</span>getTitle());
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">from child ctx: </span> <span style="color:#00f;font-weight:700">+</span> song2<span style="color:#00f;font-weight:700">.</span>getTitle());
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">from parent ctx: </span> <span style="color:#00f;font-weight:700">+</span> song3<span style="color:#00f;font-weight:700">.</span>getTitle());
        child<span style="color:#00f;font-weight:700">.</span>close();
        parent<span style="color:#00f;font-weight:700">.</span>close();
    }
}
</pre></div>
                </div>
            </div>
        </div>
        <div class="Para" id="Par211">Inside the configuration file for the child <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>, referencing a bean in the parent <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> works exactly
            like referencing a bean in the child <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>, unless you have a bean in the child <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> that shares the
            same name. In that case, you simply replace the bean attribute of the <span class="EmphasisFontCategoryNonProportional">ref</span> element with <span class="EmphasisFontCategoryNonProportional">parent</span>, and you are on your way. The following
            configuration snippet depicts the contents of the configuration file for the parent <span class="EmphasisFontCategoryNonProportional">BeanFactory</span>, named <span class="EmphasisFontCategoryNonProportional">parent-context.xml</span>:</div>
        <div class="Para" id="Par212">
            <div class="ProgramCode" id="PC62">
                <div class="LineGroup">
                    <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#1c02ff">&lt;<span style="font-weight:700">beans</span> ...&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">childTitle</span> <span style="font-style:italic">class</span>=<span style="color:#036a07">java.lang.String</span> <span style="font-style:italic">c</span>:_0=<span style="color:#036a07">Daughters</span>/&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">parentTitle</span> <span style="font-style:italic">class</span>=<span style="color:#036a07">java.lang.String</span> <span style="font-style:italic">c</span>:_0=<span style="color:#036a07">Gravity</span>/&gt;</span>
<span style="color:#1c02ff">&lt;/<span style="font-weight:700">beans</span>&gt;</span>
</pre></div>
                </div>
            </div>
    </div>
    <div class="Para" id="Par213">As you can see, this configuration simply defines two beans: <span class="EmphasisFontCategoryNonProportional">childTitle</span> and <span class="EmphasisFontCategoryNonProportional">parentTitle</span>. Both are <span class="EmphasisFontCategoryNonProportional">String</span>        objects with the values <span class="EmphasisFontCategoryNonProportional">Daughters</span> and <span class="EmphasisFontCategoryNonProportional">Gravity</span>. The following configuration snippet depicts the configuration for the child
        <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> that is contained in <span class="EmphasisFontCategoryNonProportional">child-context.xml</span>:</div>
    <div class="Para" id="Par214">
        <div class="ProgramCode" id="PC63">
            <div class="LineGroup">
                <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#1c02ff">&lt;<span style="font-weight:700">beans</span> ...&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">song1</span> <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch3.Song</span>
          <span style="font-style:italic">p</span>:title-ref=<span style="color:#036a07">parentTitle</span>/&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">song2</span> <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch3.Song</span>
          <span style="font-style:italic">p</span>:title-ref=<span style="color:#036a07">childTitle</span>/&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">song3</span> <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch3.Song</span>&gt;</span>
        <span style="color:#1c02ff">&lt;<span style="font-weight:700">property</span> <span style="font-style:italic">name</span>=<span style="color:#036a07">title</span>&gt;</span>
            <span style="color:#1c02ff">&lt;<span style="font-weight:700">ref</span> <span style="font-style:italic">parent</span>=<span style="color:#036a07">childTitle</span>/&gt;</span>
        <span style="color:#1c02ff">&lt;/<span style="font-weight:700">property</span>&gt;</span>
    <span style="color:#1c02ff">&lt;/<span style="font-weight:700">bean</span>&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">childTitle</span> <span style="font-style:italic">class</span>=<span style="color:#036a07">java.lang.String</span> <span style="font-style:italic">c</span>:_0=<span style="color:#036a07">No Such Thing</span>/&gt;</span>
<span style="color:#1c02ff">&lt;/<span style="font-weight:700">beans</span>&gt;</span>
</pre></div>
            </div>
        </div>
    </div>
    <div class="Para" id="Par215">Notice that we have defined four beans here. <span class="EmphasisFontCategoryNonProportional">childTitle</span> in this code is similar to <span class="EmphasisFontCategoryNonProportional">childTitle</span> in the parent except that the <span class="EmphasisFontCategoryNonProportional">String</span>        it represents has a different value, indicating that it is located in the child <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>.</div>
    <div class="Para" id="Par216">The <span class="EmphasisFontCategoryNonProportional">song1</span> bean is using the bean <span class="EmphasisFontCategoryNonProportional">ref</span> attribute to reference the bean named <span class="EmphasisFontCategoryNonProportional">parentTitle</span>.
        Because this bean exists only in the parent <span class="EmphasisFontCategoryNonProportional">BeanFactory</span>, <span class="EmphasisFontCategoryNonProportional">song1</span> receives a reference to that bean. There are two points of interest
        here. First, you can use the bean attribute to reference beans in both the child and the parent <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>s. This makes it easy to reference the beans transparently, allowing you
        to move beans between configuration files as your application grows. The second point of interest is that you can’t use the local attribute to refer to beans in the parent <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>.
        The XML parser checks to see that the value of the local attribute exists as a valid element in the same file, preventing it from being used to reference beans in the parent context.</div>
    <div class="Para" id="Par217">The <span class="EmphasisFontCategoryNonProportional">song2</span> bean is using the bean <span class="EmphasisFontCategoryNonProportional">ref</span> attribute to reference <span class="EmphasisFontCategoryNonProportional">childTitle</span>. Because
        that bean is defined in both <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>s, the <span class="EmphasisFontCategoryNonProportional">song2</span> bean receives a reference to <span class="EmphasisFontCategoryNonProportional">childTitle</span>        in its own <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>. <span id="ITerm90">                                                    </span> </div>
    <div class="Para" id="Par218">The <span class="EmphasisFontCategoryNonProportional">song3</span> bean is using the <span class="EmphasisFontCategoryNonProportional">&lt;ref&gt;</span> tag to reference <span class="EmphasisFontCategoryNonProportional">childTitle</span> directly
        in the parent <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>. Because <span class="EmphasisFontCategoryNonProportional">song3</span> is using the parent attribute of the <span class="EmphasisFontCategoryNonProportional">&lt;ref&gt;</span>        tag, the <span class="EmphasisFontCategoryNonProportional">childTitle</span> instance declared in the child <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> is ignored completely.</div>
    <div class="Para ParaTypeImportant" id="Par219">
    <img alt="A315511_5_En_3_Figa_HTML.jpg" data-mfp-src="/library/view/pro-spring-5/9781484228081/A315511_5_En_3_Figa_HTML.jpg" height="28" src="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_3_Figa_HTML.jpg" width="30"/>        You may have noticed that, unlike <span class="EmphasisFontCategoryNonProportional">song1</span> and <span class="EmphasisFontCategoryNonProportional">song2</span>, the <span class="EmphasisFontCategoryNonProportional">song3</span> bean is not
        using the <span class="EmphasisFontCategoryNonProportional">p</span> namespace. While the <span class="EmphasisFontCategoryNonProportional">p</span> namespace provides handy shortcuts, it does not provide all the capabilities as when using property
        tags, such as referencing a parent bean. While we show it as an example, it’s best to pick either the <span class="EmphasisFontCategoryNonProportional">p</span> namespace or property tags to define your beans, rather than mixing styles (unless
        absolutely necessary).</div>
    <div class="Para ParaOneEmphasisChild" id="Par220">Here is the output from running the <span class="EmphasisFontCategoryNonProportional">HierarchicalAppContextUsage</span> class:</div>
    <div class="Para" id="Par221">
        <div class="ProgramCode" id="PC64">
            <div class="FixedLine">from parent ctx: Gravity</div>
            <div class="FixedLine">from child ctx: No Such Thing</div>
            <div class="FixedLine">from parent ctx: Daughters</div>
        </div>
    </div>
    <div class="Para" id="Par222">As expected, the <span class="EmphasisFontCategoryNonProportional">song1</span> and <span class="EmphasisFontCategoryNonProportional">song3</span> beans both get a reference to beans in the parent <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>,
        whereas the <span class="EmphasisFontCategoryNonProportional">song2</span> bean gets a reference to a bean in the child <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>.</div>
    </div>
    <div class="Section3 RenderAsSection3" id="Sec27">
        <h4 class="Heading">Injecting <span id="ITerm91">Collections                          </span> </h4>
        <div class="Para" id="Par223">Often your beans need access to collections of objects rather than just individual beans or values. Therefore, it should come as no surprise that Spring allows you to inject a collection of objects into one of your beans. Using the collection
            is simple: you choose either <span class="EmphasisFontCategoryNonProportional">&lt;list&gt;</span>, <span class="EmphasisFontCategoryNonProportional">&lt;map&gt;</span>, <span class="EmphasisFontCategoryNonProportional">&lt;set&gt;</span>,
            or <span class="EmphasisFontCategoryNonProportional">&lt;props&gt;</span> to represent a <span class="EmphasisFontCategoryNonProportional">List</span>, <span class="EmphasisFontCategoryNonProportional">Map</span>, <span class="EmphasisFontCategoryNonProportional">Set</span>,
            or <span class="EmphasisFontCategoryNonProportional">Properties</span> instance, and then you pass in the individual items just as you would with any other injection. The <span class="EmphasisFontCategoryNonProportional">&lt;props&gt;</span>            tag allows for only <span class="EmphasisFontCategoryNonProportional">String</span>s to be passed in as the value, because the <span class="EmphasisFontCategoryNonProportional">Properties</span> class allows only for property values to be
            <span class="EmphasisFontCategoryNonProportional">String</span>s. When using <span class="EmphasisFontCategoryNonProportional">&lt;list&gt;</span>, <span class="EmphasisFontCategoryNonProportional">&lt;map&gt;</span>, or <span class="EmphasisFontCategoryNonProportional">&lt;set&gt;</span>,
            you can use any tag you want when injecting into a property, even another collection tag. This allows you to pass in a <span class="EmphasisFontCategoryNonProportional">List</span> of <span class="EmphasisFontCategoryNonProportional">Map</span>s,
            a <span class="EmphasisFontCategoryNonProportional">Map</span> of <span class="EmphasisFontCategoryNonProportional">Set</span>s, or even a <span class="EmphasisFontCategoryNonProportional">List</span> of <span class="EmphasisFontCategoryNonProportional">Map</span>s
            of <span class="EmphasisFontCategoryNonProportional">Set</span>s of <span class="EmphasisFontCategoryNonProportional">List</span>s! The following code snippet shows a class that can have all four of the collection types injected into it:</div>
        <div class="Para" id="Par224">
            <div class="ProgramCode" id="PC65">
                <div class="LineGroup">
                    <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.xml</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.support.GenericXmlApplicationContext</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">java.util.List</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">java.util.Map</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">java.util.Properties</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">java.util.Set</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">CollectionInjection</span> {
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">Map</span> <span style="color:#00f;font-weight:700">&lt;</span> <span style="color:#00f;font-weight:700">String</span>,
    <span style="color:#00f;font-weight:700">Object</span> <span style="color:#00f;font-weight:700">&gt;</span> map;
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">Properties</span> props;
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">Set</span> set;
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">List</span> list;

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span>...<span style="font-style:italic">args</span>) {
        <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span> ctx <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span>();
        ctx<span style="color:#00f;font-weight:700">.</span>load(<span style="color:#036a07">classpath:spring/app-context-xml.xml</span>);
        ctx<span style="color:#00f;font-weight:700">.</span>refresh();
        <span style="color:#00f;font-weight:700">CollectionInjection</span> instance <span style="color:#00f;font-weight:700">=</span> (<span style="color:#00f;font-weight:700">CollectionInjection</span>) ctx<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#036a07">injectCollection</span>);
        instance<span style="color:#00f;font-weight:700">.</span>displayInfo();
        ctx<span style="color:#00f;font-weight:700">.</span>close();
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">displayInfo</span>() {
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">&quot;Map contents:<span style="color:#26b31a">\n</span>&quot;</span>);
        map<span style="color:#00f;font-weight:700">.</span>entrySet()<span style="color:#00f;font-weight:700">.</span>stream()<span style="color:#00f;font-weight:700">.</span>forEach(e <span style="color:#00f;font-weight:700">-</span> <span style="color:#00f;font-weight:700">&gt;</span><span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">Key: </span> <span style="color:#00f;font-weight:700">+</span> e<span style="color:#00f;font-weight:700">.</span>getKey() <span style="color:#00f;font-weight:700">+</span> <span style="color:#036a07"> - Value: </span> <span style="color:#00f;font-weight:700">+</span> e<span style="color:#00f;font-weight:700">.</span>getValue()));
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">&quot;<span style="color:#26b31a">\n</span>Properties contents:<span style="color:#26b31a">\n</span>&quot;</span>);
        props<span style="color:#00f;font-weight:700">.</span>entrySet()<span style="color:#00f;font-weight:700">.</span>stream()<span style="color:#00f;font-weight:700">.</span>forEach(e <span style="color:#00f;font-weight:700">-</span> <span style="color:#00f;font-weight:700">&gt;</span><span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">Key: </span> <span style="color:#00f;font-weight:700">+</span> e<span style="color:#00f;font-weight:700">.</span>getKey() <span style="color:#00f;font-weight:700">+</span> <span style="color:#036a07"> - Value: </span> <span style="color:#00f;font-weight:700">+</span> e<span style="color:#00f;font-weight:700">.</span>getValue()));
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">&quot;<span style="color:#26b31a">\n</span>Set contents:<span style="color:#26b31a">\n</span>&quot;</span>);
        set<span style="color:#00f;font-weight:700">.</span>forEach(obj <span style="color:#00f;font-weight:700">-</span> <span style="color:#00f;font-weight:700">&gt;</span><span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">Value: </span> <span style="color:#00f;font-weight:700">+</span> obj));
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">&quot;<span style="color:#26b31a">\n</span>List contents:<span style="color:#26b31a">\n</span>&quot;</span>);
        list<span style="color:#00f;font-weight:700">.</span>forEach(obj <span style="color:#00f;font-weight:700">-</span> <span style="color:#00f;font-weight:700">&gt;</span><span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">Value: </span> <span style="color:#00f;font-weight:700">+</span> obj));
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setList</span>(<span style="color:#00f;font-weight:700">List</span> <span style="font-style:italic">list</span>) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>list <span style="color:#00f;font-weight:700">=</span> list;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setSet</span>(<span style="color:#00f;font-weight:700">Set</span> <span style="font-style:italic">set</span>) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>set <span style="color:#00f;font-weight:700">=</span> set;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setMap</span>(<span style="color:#00f;font-weight:700">Map</span> &lt; <span style="color:#00f;font-weight:700">String</span>, <span style="color:#00f;font-weight:700">Object</span> &gt; <span style="font-style:italic">map</span>) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>map <span style="color:#00f;font-weight:700">=</span> map;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setProps</span>(<span style="color:#00f;font-weight:700">Properties</span> <span style="font-style:italic">props</span>) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>props <span style="color:#00f;font-weight:700">=</span> props;
    }
}
</pre></div>
                </div>
            </div>
    </div>
    <div class="Para" id="Par225">That is quite a lot of code, but it actually does very little. The <span class="EmphasisFontCategoryNonProportional">main()</span> method retrieves a <span class="EmphasisFontCategoryNonProportional">CollectionInjection</span> bean from Spring and
        then calls the <span id="ITerm94">              <span class="EmphasisFontCategoryNonProportional">displayInfo()</span> method </span>. This method just outputs the contents of the <span class="EmphasisFontCategoryNonProportional">Map</span>,
        <span class="EmphasisFontCategoryNonProportional">Properties</span>, <span class="EmphasisFontCategoryNonProportional">Set</span>, and <span class="EmphasisFontCategoryNonProportional">List</span> instances that will be injected from Spring. The configuration required to inject values for each
            of the properties in the <span class="EmphasisFontCategoryNonProportional">CollectionInjection</span> class is depicted next, and the configuration file is named <span class="EmphasisFontCategoryNonProportional">app-context-xml.xml</span>            <span class="EmphasisTypeItalic">.</span> </div>
    <div class="Para" id="Par226">Also, notice the declaration of the <span class="EmphasisFontCategoryNonProportional">Map&lt;String,Object&gt;</span> property. For JDK versions newer than 5, Spring also supports the strongly typed <span class="EmphasisFontCategoryNonProportional">Collection</span>        declaration and will perform the conversion from the XML configuration to the corresponding type specified accordingly.</div>
    <div class="Para" id="Par227">
        <div class="ProgramCode" id="PC66">
            <div class="LineGroup">
                <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#1c02ff">&lt;<span style="font-weight:700">beans</span> ...&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">lyricHolder</span>
        <span style="font-style:italic">lass</span>=<span style="color:#036a07">com.apress.prospring5.ch3.xml.LyricHolder</span>/&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">injectCollection</span>
         <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch3.xml.CollectionInjection</span>&gt;</span>
        <span style="color:#1c02ff">&lt;<span style="font-weight:700">property</span> <span style="font-style:italic">name</span>=<span style="color:#036a07">map</span>&gt;</span>
            <span style="color:#1c02ff">&lt;<span style="font-weight:700">map</span>&gt;</span>
                <span style="color:#1c02ff">&lt;<span style="font-weight:700">entry</span> <span style="font-style:italic">key</span>=<span style="color:#036a07">someValue</span>&gt;</span>
                    <span style="color:#1c02ff">&lt;<span style="font-weight:700">value</span>&gt;</span>It&apos;s a Friday, we finally made it<span style="color:#1c02ff">&lt;/<span style="font-weight:700">value</span>&gt;</span>
                <span style="color:#1c02ff">&lt;/<span style="font-weight:700">entry</span>&gt;</span>
                <span style="color:#1c02ff">&lt;<span style="font-weight:700">entry</span> <span style="font-style:italic">key</span>=<span style="color:#036a07">someBean</span>&gt;</span>
                    <span style="color:#1c02ff">&lt;<span style="font-weight:700">ref</span> <span style="font-style:italic">bean</span>=<span style="color:#036a07">lyricHolder</span>/&gt;</span>
                <span style="color:#1c02ff">&lt;/<span style="font-weight:700">entry</span>&gt;</span>
            <span style="color:#1c02ff">&lt;/<span style="font-weight:700">map</span>&gt;</span>
        <span style="color:#1c02ff">&lt;/<span style="font-weight:700">property</span>&gt;</span>
        <span style="color:#1c02ff">&lt;<span style="font-weight:700">property</span> <span style="font-style:italic">name</span>=<span style="color:#036a07">props</span>&gt;</span>
            <span style="color:#1c02ff">&lt;<span style="font-weight:700">props</span>&gt;</span>
                <span style="color:#1c02ff">&lt;<span style="font-weight:700">prop</span> <span style="font-style:italic">key</span>=<span style="color:#036a07">firstName</span>&gt;</span>John<span style="color:#1c02ff">&lt;/<span style="font-weight:700">prop</span>&gt;</span>
                <span style="color:#1c02ff">&lt;<span style="font-weight:700">prop</span> <span style="font-style:italic">key</span>=<span style="color:#036a07">secondName</span>&gt;</span>Mayer<span style="color:#1c02ff">&lt;/<span style="font-weight:700">prop</span>&gt;</span>
            <span style="color:#1c02ff">&lt;/<span style="font-weight:700">props</span>&gt;</span>
        <span style="color:#1c02ff">&lt;/<span style="font-weight:700">property</span>&gt;</span>
        <span style="color:#1c02ff">&lt;<span style="font-weight:700">property</span> <span style="font-style:italic">name</span>=<span style="color:#036a07">set</span>&gt;</span>
            <span style="color:#1c02ff">&lt;<span style="font-weight:700">set</span>&gt;</span>
                <span style="color:#1c02ff">&lt;<span style="font-weight:700">value</span>&gt;</span>I can&apos;t believe I get to see your face<span style="color:#1c02ff">&lt;/<span style="font-weight:700">value</span>&gt;</span>
                <span style="color:#1c02ff">&lt;<span style="font-weight:700">ref</span> <span style="font-style:italic">bean</span>=<span style="color:#036a07">lyricHolder</span>/&gt;</span>
            <span style="color:#1c02ff">&lt;/<span style="font-weight:700">set</span>&gt;</span>
        <span style="color:#1c02ff">&lt;/<span style="font-weight:700">property</span>&gt;</span>
        <span style="color:#1c02ff">&lt;<span style="font-weight:700">property</span> <span style="font-style:italic">name</span>=<span style="color:#036a07">list</span>&gt;</span>
            <span style="color:#1c02ff">&lt;<span style="font-weight:700">list</span>&gt;</span>
                <span style="color:#1c02ff">&lt;<span style="font-weight:700">value</span>&gt;</span>You&apos;ve been working and I&apos;ve been waiting<span style="color:#1c02ff">&lt;/<span style="font-weight:700">value</span>&gt;</span>
                <span style="color:#1c02ff">&lt;<span style="font-weight:700">ref</span> <span style="font-style:italic">bean</span>=<span style="color:#036a07">lyricHolder</span>/&gt;</span>
            <span style="color:#1c02ff">&lt;/<span style="font-weight:700">list</span>&gt;</span>
        <span style="color:#1c02ff">&lt;/<span style="font-weight:700">property</span>&gt;</span>
    <span style="color:#1c02ff">&lt;/<span style="font-weight:700">bean</span>&gt;</span>
<span style="color:#1c02ff">&lt;/<span style="font-weight:700">beans</span>&gt;</span>
</pre></div>
        </div>
    </div>
    </div>
    <div class="Para" id="Par228">In this code, you can see that we have injected values into all four setters exposed on the <span class="EmphasisFontCategoryNonProportional">CollectionInjection</span> class. For the <span class="EmphasisFontCategoryNonProportional">map</span> property,
        we have injected a <span class="EmphasisFontCategoryNonProportional">Map</span> instance by using the <span class="EmphasisFontCategoryNonProportional">&lt;map&gt;</span> tag. Notice that each entry is specified using an <span class="EmphasisFontCategoryNonProportional">&lt;entry&gt;</span>        tag, and each has a <span class="EmphasisFontCategoryNonProportional">String</span> key and then an entry value. This entry value can be any value you can inject into a property separately; this example shows the use of the <span class="EmphasisFontCategoryNonProportional">&lt;value&gt;</span>        and <span class="EmphasisFontCategoryNonProportional">&lt;ref&gt;</span> tags to add a <span class="EmphasisFontCategoryNonProportional">String</span> value and a bean reference to the <span class="EmphasisFontCategoryNonProportional">Map</span>.
        The <span class="EmphasisFontCategoryNonProportional">LyricHolder</span> class, which is the type of the <span class="EmphasisFontCategoryNonProportional">lyricHolder</span> bean injected in the map in the previous configuration, is depicted here:</div>
    <div class="Para" id="Par229">
        <div class="ProgramCode" id="PC67">
            <div class="LineGroup">
                <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.xml</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.ContentHolder</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">LyricHolder</span> <span style="color:#00f;font-weight:700">implements</span> <span style="font-style:italic">ContentHolder</span> {
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">String</span> value <span style="color:#00f;font-weight:700">=</span> <span style="color:#036a07">&apos;You be the DJ, I&apos;ll be the driver&apos;</span>;

    <span style="color:#00f;font-weight:700">@Override</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">String</span> <span style="color:#0000a2;font-weight:700">toString</span>() {
        <span style="color:#00f;font-weight:700">return</span> <span style="color:#036a07">LyricHolder: { </span> <span style="color:#00f;font-weight:700">+</span> value <span style="color:#00f;font-weight:700">+</span> <span style="color:#036a07">}</span>;
    }
}
</pre></div>
            </div>
        </div>
        </div>
        <div class="Para" id="Par230">For the <span class="EmphasisFontCategoryNonProportional">props</span> property, we use the <span class="EmphasisFontCategoryNonProportional">&lt;props&gt;</span> tag to create an instance of <span class="EmphasisFontCategoryNonProportional">java.util.Properties</span>            and populate it using &lt;prop&gt; tags. Notice that although the <span class="EmphasisFontCategoryNonProportional">&lt;prop&gt;</span> tag is keyed in a similar manner to the <span class="EmphasisFontCategoryNonProportional">&lt;entry&gt;</span>            tag, we can specify only <span class="EmphasisFontCategoryNonProportional">String</span> values for each property that goes in the <span class="EmphasisFontCategoryNonProportional">Properties</span> instance.</div>
        <div class="Para" id="Par231">Also, for the <span class="EmphasisFontCategoryNonProportional">&lt;map&gt;</span> element there is an alternative, more compact configuration using the <span class="EmphasisFontCategoryNonProportional">value</span> and <span class="EmphasisFontCategoryNonProportional">value-ref</span>            attributes, instead of the <span class="EmphasisFontCategoryNonProportional">&lt;value&gt;</span> and <span class="EmphasisFontCategoryNonProportional">&lt;ref&gt;</span> elements. The <span class="EmphasisFontCategoryNonProportional">map</span>            declared here is equivalent with the one in the previous configuration:</div>
        <div class="Para" id="Par232">
            <div class="ProgramCode" id="PC68">
                <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#1c02ff">&lt;<span style="font-weight:700">property</span> <span style="font-style:italic">name</span>=<span style="color:#036a07">map</span>&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">map</span>&gt;</span>
        <span style="color:#1c02ff">&lt;<span style="font-weight:700">entry</span> <span style="font-style:italic">key</span>=<span style="color:#036a07">someValue</span> <span style="font-style:italic">value</span>=<span style="color:#036a07">It&apos;s a Friday, we finally made it</span>/&gt;</span>
        <span style="color:#1c02ff">&lt;<span style="font-weight:700">entry</span> <span style="font-style:italic">key</span>=<span style="color:#036a07">someBean</span> <span style="font-style:italic">value-ref</span>=<span style="color:#036a07">lyricHolder</span>/&gt;</span>
    <span style="color:#1c02ff">&lt;/<span style="font-weight:700">map</span>&gt;</span>
<span style="color:#1c02ff">&lt;/<span style="font-weight:700">property</span>&gt;</span>
</pre></div>
            </div>
        </div>
        <div class="Para" id="Par233">Both the <span class="EmphasisFontCategoryNonProportional">&lt;list&gt;</span> and <span class="EmphasisFontCategoryNonProportional">&lt;set&gt;</span> tags work in the same way: you specify each element by using any of the individual value tags
            such as <span class="EmphasisFontCategoryNonProportional">&lt;value&gt;</span> and <span class="EmphasisFontCategoryNonProportional">&lt;ref&gt;</span> that are used to inject a single value into a property. In the previous configuration,
            you can see that we have added a <span class="EmphasisFontCategoryNonProportional">String</span> value and a bean reference to both the <span class="EmphasisFontCategoryNonProportional">List</span> and <span class="EmphasisFontCategoryNonProportional">Set</span>            instances.</div>
        <div class="Para" id="Par234">Here is the output generated by the <span class="EmphasisFontCategoryNonProportional">main()</span> method in the class <span class="EmphasisFontCategoryNonProportional">CollectionInjection</span>. As expected, it simply lists the elements added
            to the collections in the configuration file.</div>
        <div class="Para" id="Par235">
            <div class="ProgramCode" id="PC69">
                <div class="LineGroup">
                    <div class="FixedLine">Map contents:</div>
                </div>
                <div class="LineGroup">
                    <div class="FixedLine">Key: someValue - Value: It&apos;s a Friday, we finally made it</div>
                    <div class="FixedLine">Key: someBean - Value: LyricHolder: { &apos;You be the DJ, I&apos;ll be the driver&apos;}</div>
                </div>
                <div class="LineGroup">
                    <div class="FixedLine">Properties contents:</div>
                </div>
                <div class="LineGroup">
                    <div class="FixedLine">Key: secondName - Value: Mayer</div>
                    <div class="FixedLine">Key: firstName - Value: John</div>
                </div>
                <div class="LineGroup">
                    <div class="FixedLine">Set contents:</div>
                </div>
                <div class="LineGroup">
                    <div class="FixedLine">Value: I can&apos;t believe I get to see your face</div>
                    <div class="FixedLine">Value: LyricHolder: { &apos;You be the DJ, I&apos;ll be the driver&apos;}</div>
                </div>
                <div class="LineGroup">
                    <div class="FixedLine">List contents:</div>
                </div>
                <div class="LineGroup">
                    <div class="FixedLine">Value: You&apos;ve been working and I&apos;ve been waiting</div>
                    <div class="FixedLine">Value: LyricHolder: { &apos;You be the DJ, I&apos;ll be the driver&apos;}</div>
                </div>
            </div>
        </div>
        <div class="Para" id="Par236">Remember, with the <span class="EmphasisFontCategoryNonProportional">&lt;list&gt;</span>, <span class="EmphasisFontCategoryNonProportional">&lt;map&gt;</span>, and <span class="EmphasisFontCategoryNonProportional">&lt;set&gt;</span> elements,
            you can employ any of the tags used to set the value of noncollection properties to specify the value of one of the entries in the collection. This is quite a powerful concept because you are not limited just to injecting collections of primitive
            values; you can also inject collections of beans or other collections.</div>
        <div class="Para" id="Par237">Using this functionality,<span id="ITerm97">                                                    </span> it is much easier to modularize your application and provide different, user-selectable implementations of key pieces of application logic.
            Consider a system that allows corporate staff to create, proofread, and order their personalized business stationery online. In this system, the finished artwork for each order is sent to the appropriate printer when it is ready for production.
            The only complication is that some printers want to receive the artwork via e-mail, some via FTP, and others using Secure Copy Protocol (SCP). Using Spring’s collection injection, you can create a standard interface for this functionality,
            as shown in the following code snippet:</div>
        <div class="Para" id="Par238">
            <div class="ProgramCode" id="PC70">
                <div class="LineGroup">
                    <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">interface</span> <span style="text-decoration:underline">ArtworkSender</span> {
    <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">sendArtwork</span>(<span style="color:#00f;font-weight:700">String</span> <span style="font-style:italic">artworkPath</span>, <span style="color:#00f;font-weight:700">Recipient</span> <span style="font-style:italic">recipient</span>);

    <span style="color:#00f;font-weight:700">String</span> <span style="color:#0000a2;font-weight:700">getFriendlyName</span>();

    <span style="color:#00f;font-weight:700">String</span> <span style="color:#0000a2;font-weight:700">getShortName</span>();
}
</pre></div>
                </div>
            </div>
        </div>
        <div class="Para ParaOneEmphasisChild" id="Par239">In the previous example, the <span class="EmphasisFontCategoryNonProportional">Recipient</span> class is an empty class. From this interface, you can create multiple implementations, each of which is capable of describing itself to a human, such
            as the one shown here:</div>
        <div class="Para" id="Par240">
            <div class="ProgramCode" id="PC71">
                <div class="LineGroup">
                    <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">FtpArtworkSender</span>
        <span style="color:#00f;font-weight:700">implements</span> <span style="font-style:italic">ArtworkSender</span> {
    <span style="color:#00f;font-weight:700">@Override</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">sendArtwork</span>(<span style="color:#00f;font-weight:700">String</span> <span style="font-style:italic">artworkPath</span>, <span style="color:#00f;font-weight:700">Recipient</span> <span style="font-style:italic">recipient</span>) {
        <span style="color:#06f;font-style:italic">// ftp logic here...</span>
    }

    <span style="color:#00f;font-weight:700">@Override</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">String</span> <span style="color:#0000a2;font-weight:700">getFriendlyName</span>() {
        <span style="color:#00f;font-weight:700">return</span> <span style="color:#036a07">File Transfer Protocol</span>;
    }

    <span style="color:#00f;font-weight:700">@Override</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">String</span> <span style="color:#0000a2;font-weight:700">getShortName</span>() {
        <span style="color:#00f;font-weight:700">return</span> <span style="color:#036a07">ftp</span>;
    }
}
</pre></div>
                </div>
            </div>
        </div>
        <div class="Para" id="Par241">Imagine that you then develop an <span class="EmphasisFontCategoryNonProportional">ArtworkManager</span> class that supports all available implementations of the <span class="EmphasisFontCategoryNonProportional">Artwork-Sender</span> interface.
            With the implementations in place, you simply pass a <span class="EmphasisFontCategoryNonProportional">List</span> to your <span class="EmphasisFontCategoryNonProportional">ArtworkManager</span> class, and you are on your way. Using the
            <span id="ITerm98"> <span class="EmphasisFontCategoryNonProportional">getFriendlyName()</span> method </span>, you can display a list of delivery options for the system administrator to choose from when you are configuring each stationery template. In addition,
                your application can remain fully decoupled from the individual implementations if you just code to the <span class="EmphasisFontCategoryNonProportional">ArtworkSender</span> interface. We will leave the implementation of the <span class="EmphasisFontCategoryNonProportional">ArtworkManager</span>                class as an exercise for you.</div>
        <div class="Para" id="Par242">Besides the XML configuration, you can use annotations for <span id="ITerm99">collection injection                          </span>. However, you would also like to externalize the values of the collections into the configuration file for easy
            maintenance. The following snippet is the configuration of four different Spring beans that mimic the same collection properties of the previous sample (configuration file <span class="EmphasisFontCategoryNonProportional">app-context-annotation.xml</span>):</div>
        <div class="Para" id="Par243">
            <div class="ProgramCode" id="PC72">
                <div class="LineGroup">
                    <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#68685b">&lt;?<span style="color:#888">xml</span><span style="color:#888"> version</span>=<span style="color:#888">1.0</span><span style="color:#888"> encoding</span>=<span style="color:#888">UTF-8</span>?&gt;</span>

<span style="color:#1c02ff">&lt;<span style="font-weight:700">beans</span> <span style="font-style:italic">xmlns</span>=<span style="color:#036a07">http://www.springframework.org/schema/beans</span>
       <span style="font-style:italic">xmlns</span>:xsi=<span style="color:#036a07">http://www.w3.org/2001/XMLSchema-instance</span>
       <span style="font-style:italic">xmlns</span>:context=<span style="color:#036a07">http://www.springframework.org/schema/context</span>
       <span style="font-style:italic">xmlns</span>:util=<span style="color:#036a07">http://www.springframework.org/schema/util</span>
       <span style="font-style:italic">xsi</span>:schemaLocation=<span style="color:#036a07">http://www.springframework.org/schema/beans
http://www.springframework.org/schema/beans/spring-beans.xsd
http://www.springframework.org/schema/context
http://www.springframework.org/schema/context/spring-context.xsd
http://www.springframework.org/schema/util 
http://www.springframework.org/schema/util/spring-util.xsd</span>&gt;</span>


    <span style="color:#1c02ff">&lt;<span style="font-weight:700">context</span><span style="font-weight:700">:</span><span style="font-weight:700">component-scan</span>
            <span style="font-style:italic">base-package</span>=<span style="color:#036a07">com.apress.prospring5.ch3.annotated</span>/&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">util</span><span style="font-weight:700">:</span><span style="font-weight:700">map</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">map</span> <span style="font-style:italic">map-class</span>=<span style="color:#036a07">java.util.HashMap</span>&gt;</span>
        <span style="color:#1c02ff">&lt;<span style="font-weight:700">entry</span> <span style="font-style:italic">key</span>=<span style="color:#036a07">someValue</span> <span style="font-style:italic">value</span>=<span style="color:#036a07">It&apos;s a Friday, we finally made it</span>/&gt;</span>
        <span style="color:#1c02ff">&lt;<span style="font-weight:700">entry</span> <span style="font-style:italic">key</span>=<span style="color:#036a07">someBean</span> <span style="font-style:italic">value-ref</span>=<span style="color:#036a07">lyricHolder</span>/&gt;</span>
    <span style="color:#1c02ff">&lt;/<span style="font-weight:700">util</span><span style="font-weight:700">:</span><span style="font-weight:700">map</span>&gt;</span>


    <span style="color:#1c02ff">&lt;<span style="font-weight:700">util</span><span style="font-weight:700">:</span><span style="font-weight:700">properties</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">props</span>&gt;</span>
        <span style="color:#1c02ff">&lt;<span style="font-weight:700">prop</span> <span style="font-style:italic">key</span>=<span style="color:#036a07">firstName</span>&gt;</span>John<span style="color:#1c02ff">&lt;/<span style="font-weight:700">prop</span>&gt;</span>
        <span style="color:#1c02ff">&lt;<span style="font-weight:700">prop</span> <span style="font-style:italic">key</span>=<span style="color:#036a07">secondName</span>&gt;</span>Mayer<span style="color:#1c02ff">&lt;/<span style="font-weight:700">prop</span>&gt;</span>
    <span style="color:#1c02ff">&lt;/<span style="font-weight:700">util</span><span style="font-weight:700">:</span><span style="font-weight:700">properties</span>&gt;</span>


    <span style="color:#1c02ff">&lt;<span style="font-weight:700">util</span><span style="font-weight:700">:</span><span style="font-weight:700">set</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">set</span> <span style="font-style:italic">set-class</span>=<span style="color:#036a07">java.util.HashSet</span>&gt;</span>
        <span style="color:#1c02ff">&lt;<span style="font-weight:700">value</span>&gt;</span>I can&apos;t believe I get to see your face<span style="color:#1c02ff">&lt;/<span style="font-weight:700">value</span>&gt;</span>
        <span style="color:#1c02ff">&lt;<span style="font-weight:700">ref</span> <span style="font-style:italic">bean</span>=<span style="color:#036a07">lyricHolder</span>/&gt;</span>
    <span style="color:#1c02ff">&lt;/<span style="font-weight:700">util</span><span style="font-weight:700">:</span><span style="font-weight:700">set</span>&gt;</span>


    <span style="color:#1c02ff">&lt;<span style="font-weight:700">util</span><span style="font-weight:700">:</span><span style="font-weight:700">list</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">list</span> <span style="font-style:italic">list-class</span>=<span style="color:#036a07">java.util.ArrayList</span>&gt;</span>
        <span style="color:#1c02ff">&lt;<span style="font-weight:700">value</span>&gt;</span>You&apos;ve been working and I&apos;ve been waiting<span style="color:#1c02ff">&lt;/<span style="font-weight:700">value</span>&gt;</span>
        <span style="color:#1c02ff">&lt;<span style="font-weight:700">ref</span> <span style="font-style:italic">bean</span>=<span style="color:#036a07">lyricHolder</span>/&gt;</span>
    <span style="color:#1c02ff">&lt;/<span style="font-weight:700">util</span><span style="font-weight:700">:</span><span style="font-weight:700">list</span>&gt;</span>

<span style="color:#1c02ff">&lt;/<span style="font-weight:700">beans</span>&gt;</span>
</pre></div>
                </div>
            </div>
            </div>
            <div class="Para ParaOneEmphasisChild" id="Par244">Let’s also develop an annotation version of the <span class="EmphasisFontCategoryNonProportional">LyricHolder</span> class. The class content is depicted here:</div>
            <div class="Para" id="Par245">
                <div class="ProgramCode" id="PC73">
                    <div class="LineGroup">
                        <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.annotated</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.ContentHolder</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.stereotype.Service</span>;

@Service(<span style="color:#036a07">lyricHolder</span>)
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">LyricHolder</span> <span style="color:#00f;font-weight:700">implements</span> <span style="font-style:italic">ContentHolder</span> {
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">String</span> value <span style="color:#00f;font-weight:700">=</span> <span style="color:#036a07">&apos;You be the DJ, I&apos;ll be the driver&apos;</span>;

    <span style="color:#00f;font-weight:700">@Override</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">String</span> <span style="color:#0000a2;font-weight:700">toString</span>() {
        <span style="color:#00f;font-weight:700">return</span> <span style="color:#036a07">LyricHolder: { </span> <span style="color:#00f;font-weight:700">+</span> value <span style="color:#00f;font-weight:700">+</span> <span style="color:#036a07">}</span>;
    }
}
</pre></div>
                    </div>
                </div>
            </div>
            <div class="Para" id="Par246">In the configuration depicted previously, we make use of the <span class="EmphasisFontCategoryNonProportional">util</span> namespace provided by Spring to declare your beans for storing collection properties: the <span class="EmphasisFontCategoryNonProportional">util</span>                namespace. It greatly simplifies the configuration, as compared to previous versions of Spring. In the class we use to test your configuration, we inject the previous beans and use the JSR-250 <span class="EmphasisFontCategoryNonProportional">@Resource</span>                annotation with the name specified as an argument to properly identify the beans. The <span class="EmphasisFontCategoryNonProportional">displayInfo()</span> method is the same as before so is no longer shown here.</div>
            <div class="Para" id="Par247">
                <div class="ProgramCode" id="PC74">
                    <div class="LineGroup">
                        <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">javax.annotation.Resource</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">java.util.Set</span>;

@Service(<span style="color:#036a07">injectCollection</span>)
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">CollectionInjection</span> {
    <span style="color:#00f;font-weight:700">@Resource</span>(<span style="color:#c5060b;font-weight:700">name</span> <span style="color:#00f;font-weight:700">=</span> <span style="color:#036a07">map</span>)
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">Map&lt;<span style="color:#00f;font-weight:700">String</span>, <span style="color:#00f;font-weight:700">Object</span>&gt;</span> map;
    <span style="color:#00f;font-weight:700">@Resource</span>(<span style="color:#c5060b;font-weight:700">name</span> <span style="color:#00f;font-weight:700">=</span> <span style="color:#036a07">props</span>)
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">Properties</span> props;
    <span style="color:#00f;font-weight:700">@Resource</span>(<span style="color:#c5060b;font-weight:700">name</span> <span style="color:#00f;font-weight:700">=</span> <span style="color:#036a07">set</span>)
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">Set</span> set;
    <span style="color:#00f;font-weight:700">@Resource</span>(<span style="color:#c5060b;font-weight:700">name</span> <span style="color:#00f;font-weight:700">=</span> <span style="color:#036a07">list</span>)
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">List</span> list;

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span>... <span style="font-style:italic">args</span>) {
        <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span> ctx <span style="color:#00f;font-weight:700">=</span>
                <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span>();
        ctx<span style="color:#00f;font-weight:700">.</span>load(<span style="color:#036a07">classpath:spring/app-context-annotation.xml</span>);
        ctx<span style="color:#00f;font-weight:700">.</span>refresh();
        <span style="color:#00f;font-weight:700">CollectionInjection</span> instance <span style="color:#00f;font-weight:700">=</span> (<span style="color:#00f;font-weight:700">CollectionInjection</span>)
                ctx<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#036a07">injectCollection</span>);
        instance<span style="color:#00f;font-weight:700">.</span>displayInfo();
        ctx<span style="color:#00f;font-weight:700">.</span>close();
    }
    .<span style="color:#00f;font-weight:700">.</span>.
}
</pre></div>
                    </div>
                </div>
            </div>
            <div class="Para" id="Par248">Run the test program, and you will get the same result as the sample using XML configuration.</div>
            <div class="Para ParaTypeImportant" id="Par249"> <img alt="A315511_5_En_3_Figa_HTML.jpg" data-mfp-src="/library/view/pro-spring-5/9781484228081/A315511_5_En_3_Figa_HTML.jpg" height="28" src="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_3_Figa_HTML.jpg" width="30"/>                You may wonder why the annotation <span class="EmphasisFontCategoryNonProportional">@Resource</span> is used instead of <span class="EmphasisFontCategoryNonProportional">@Autowired</span>. It’s because the <span class="EmphasisFontCategoryNonProportional">@Autowired</span>                annotation is semantically defined in a way that it always treats arrays, collections, and maps as sets of corresponding beans, with the target bean type derived from the declared collection value type. So, for example, if a class has
                an attribute of type <span class="EmphasisFontCategoryNonProportional">List&lt;ContentHolder&gt;</span> and has the <span class="EmphasisFontCategoryNonProportional">@Autowired</span> annotation defined, Spring will try to inject all beans
                of type <span class="EmphasisFontCategoryNonProportional">ContentHolder</span> within the current <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> into that attribute (instead of the <span class="EmphasisFontCategoryNonProportional">&lt;util:list&gt;</span>                declared in the configuration file), which will result in either the unexpected dependencies being injected or Spring throwing an exception if no bean of type <span class="EmphasisFontCategoryNonProportional">ContentHolder</span> was defined.
                So, for collection type injection, we have to explicitly instruct Spring to perform injection by specifying the bean name, which the <span class="EmphasisFontCategoryNonProportional">@Resource</span> annotation supports.</div>
            <div class="Para ParaTypeImportant" id="Par250"> <img alt="A315511_5_En_3_Figa_HTML.jpg" data-mfp-src="/library/view/pro-spring-5/9781484228081/A315511_5_En_3_Figa_HTML.jpg" height="28" src="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_3_Figa_HTML.jpg" width="30"/>                A combination of <span class="EmphasisFontCategoryNonProportional">@Autowired</span> and <span class="EmphasisFontCategoryNonProportional">@Qualifier</span> can be used to fulfill the same purpose, but it is always preferable to use one
                annotation and not two. In the following code snippet, you can see the equivalent configuration to inject a collection using its bean name by using <span class="EmphasisFontCategoryNonProportional">@Autowired</span> and <span class="EmphasisFontCategoryNonProportional">@Qualifier</span>.
                <span id="ITerm102">                                                    </span> </div>
            <div class="Para" id="Par251">
                <div class="ProgramCode" id="PC75">
                    <div class="LineGroup">
                        <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.annotated</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.beans.factory.annotation.Autowired</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.beans.factory.annotation.Qualifier</span>;

@Service(<span style="color:#036a07">injectCollection</span>)
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">CollectionInjection</span> {
    <span style="color:#00f;font-weight:700">@Autowired</span>
    <span style="color:#00f;font-weight:700">@Qualifier</span>(<span style="color:#036a07">map</span>)
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">Map&lt;<span style="color:#00f;font-weight:700">String</span>, <span style="color:#00f;font-weight:700">Object</span>&gt;</span> map;
.<span style="color:#00f;font-weight:700">.</span>.
}
</pre></div>
                    </div>
                </div>
            </div>
            </div>
            </div>
            <div class="Section2 RenderAsSection2" id="Sec28">
                <h3 class="Heading">Using <span id="ITerm103">Method Injection                      </span> </h3>
                <div class="Para" id="Par252">Besides constructor and setter injection, another less frequently used DI feature that Spring provides is <span class="EmphasisTypeItalic">Method Injection</span>. Spring’s Method Injection capabilities come in two loosely related forms,
                    lookup Method Injection and Method Replacement. Lookup Method Injection provides another mechanism by which a bean can obtain one of its dependencies. Method replacement allows you to replace the implementation of any method on a bean
                    arbitrarily, without having to change the original source code. To provide these two features, Spring uses the dynamic bytecode enhancement capabilities of CGLIB.<a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_3_Chapter.html#Fn3" id="Fn3_source"><sup>3</sup></a> </div>
                <div class="Section3 RenderAsSection3" id="Sec29">
                    <h4 class="Heading">Lookup Method Injection</h4>
                    <div class="Para" id="Par254"> <span id="ITerm104">                  <span class="EmphasisTypeItalic">Lookup Method Injection</span> </span> was added to Spring in version 1.1 to overcome the problems encountered when a bean depends on another bean with a different
                        life cycle, specifically, when a singleton depends on a nonsingleton. In this situation, both setter and constructor injection result in the singleton maintaining a single instance of what should be a nonsingleton bean. In some
                        cases, you will want to have the singleton bean obtain a new instance of the nonsingleton every time it requires the bean in question.</div>
                    <div class="Para" id="Par255">Consider a scenario in which a <span class="EmphasisFontCategoryNonProportional">LockOpener</span> <span id="ITerm105">class                          </span> provides the service of opening any locker. The <span class="EmphasisFontCategoryNonProportional">LockOpener</span>                        class relies on a <span class="EmphasisFontCategoryNonProportional">KeyHelper</span> class for opening the locker, which was injected into <span class="EmphasisFontCategoryNonProportional">LockOpener</span>. However, the design
                        of the <span class="EmphasisFontCategoryNonProportional">KeyHelper</span> class involves some internal states that make it not suitable for reuse. Every time the <span class="EmphasisFontCategoryNonProportional">openLock()</span>                        method is called, a new <span id="ITerm106">              <span class="EmphasisFontCategoryNonProportional">KeyHelper</span> instance </span> is required. In this case, <span class="EmphasisFontCategoryNonProportional">LockOpener</span>                        will be a singleton. However, if we inject the <span class="EmphasisFontCategoryNonProportional">KeyHelper</span> class by using the normal mechanism, the same instance of the <span class="EmphasisFontCategoryNonProportional">KeyHelper</span>                        class (which was instantiated when Spring performed the injection the first time) will be reused. To make sure that a new instance of the <span class="EmphasisFontCategoryNonProportional">KeyHelper</span> instance is passed into
                        the <span class="EmphasisFontCategoryNonProportional">openLock()</span> method every time it is invoked, we need to use Lookup Method Injection.</div>
                    <div class="Para" id="Par256">Typically, you can achieve this by having the singleton bean implement the <span class="EmphasisFontCategoryNonProportional">ApplicationContextAware</span> interface (we discuss this interface in the next chapter). Then, using the
                        <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> instance, the singleton bean can look up a new instance of the nonsingleton dependency every time it needs it. Lookup Method Injection allows the singleton
                        bean to declare that it requires a nonsingleton dependency and that it will receive a new instance of the nonsingleton bean each time it needs to interact with it, without needing to implement any Spring-specific interfaces.</div>
                    <div class="Para" id="Par257">Lookup Method Injection works by having your singleton declare a method, the lookup method, which returns an instance of the nonsingleton bean. When you obtain a reference to the singleton in your application, you are actually receiving
                        a reference to a dynamically created subclass on which Spring has implemented the lookup method. A typical implementation involves defining the lookup method, and thus the bean class, as abstract. This prevents any strange errors
                        from creeping in when you forget to configure the Method Injection and you are working directly against the bean class with the empty method implementation instead of the Spring-enhanced subclass. This topic is quite complex and
                        is best shown by example.</div>
                <div class="Para ParaOneEmphasisChild" id="Par258">In this example, we create one nonsingleton bean and two singleton beans that both implement the same interface. One of the singletons obtains an instance of the nonsingleton bean by using “traditional” setter injection; the other uses
                    Method Injection. The following code sample depicts the <span class="EmphasisFontCategoryNonProportional">Singer</span> class, which in this example is the type of the nonsingleton bean:</div>
                <div class="Para" id="Par259">
                    <div class="ProgramCode" id="PC76">
                        <div class="LineGroup">
                            <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">Singer</span> {
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">String</span> lyric <span style="color:#00f;font-weight:700">=</span> <span style="color:#036a07">I played a quick game of chess with the salt
    and pepper
    shaker</span>;

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">sing</span>() {
        <span style="color:#06f;font-style:italic">//commented because it pollutes the output</span>
        <span style="color:#06f;font-style:italic">//System.out.println(lyric);</span>
    }
}
</pre></div>
                        </div>
                    </div>
                </div>
                <div class="Para ParaOneEmphasisChild" id="Par260">This class is decidedly unexciting, but it serves the purposes of this example perfectly. Next, you can see the <span class="EmphasisFontCategoryNonProportional">DemoBean</span> interface, which is implemented by both of the singleton
                    bean classes.</div>
                <div class="Para" id="Par261">
                    <div class="ProgramCode" id="PC77">
                        <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">interface</span> <span style="text-decoration:underline">DemoBean</span> {
    <span style="color:#00f;font-weight:700">Singer</span> <span style="color:#0000a2;font-weight:700">getMySinger</span>();

    <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">doSomething</span>();
}
</pre></div>
                    </div>
                </div>
                <div class="Para" id="Par262">This bean has two methods: <span class="EmphasisFontCategoryNonProportional">getMySinger()</span> and <span class="EmphasisFontCategoryNonProportional">doSomething()</span> <span id="ITerm107">                                                    </span>.
                    The sample application uses the <span class="EmphasisFontCategoryNonProportional">getMySinger()</span> method to get a reference to the <span class="EmphasisFontCategoryNonProportional">Singer</span> instance and, in the case of the
                    method lookup bean, to perform the actual method lookup. The <span class="EmphasisFontCategoryNonProportional">doSomething()</span>method is a simple method that depends on the <span class="EmphasisFontCategoryNonProportional">Singer</span>                    class to do its processing. The following code snippet shows the <span class="EmphasisFontCategoryNonProportional">StandardLookupDemoBean</span> class, which uses setter injection to obtain an instance of the <span class="EmphasisFontCategoryNonProportional">Singer</span>                    class:</div>
                <div class="Para" id="Par263">
                    <div class="ProgramCode" id="PC78">
                        <div class="LineGroup">
                            <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">StandardLookupDemoBean</span>
        <span style="color:#00f;font-weight:700">implements</span> <span style="font-style:italic">DemoBean</span> {
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">Singer</span> mySinger;

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setMySinger</span>(<span style="color:#00f;font-weight:700">Singer</span> <span style="font-style:italic">mySinger</span>) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>mySinger <span style="color:#00f;font-weight:700">=</span> mySinger;
    }

    <span style="color:#00f;font-weight:700">@Override</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">Singer</span> <span style="color:#0000a2;font-weight:700">getMySinger</span>() {
        <span style="color:#00f;font-weight:700">return</span> <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>mySinger;
    }

    <span style="color:#00f;font-weight:700">@Override</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">doSomething</span>() {
        mySinger<span style="color:#00f;font-weight:700">.</span>sing();
    }
}
</pre></div>
                        </div>
                    </div>
                </div>
                <div class="Para" id="Par264">This code should all look familiar, but notice that the <span id="ITerm108">              <span class="EmphasisFontCategoryNonProportional">doSomething()</span> method </span> uses the stored instance of <span class="EmphasisFontCategoryNonProportional">Singer</span>                    to complete its processing. In the following code snippet, you can see the <span class="EmphasisFontCategoryNonProportional">AbstractLookupDemoBean</span> class, which uses Method Injection to obtain an instance of the <span class="EmphasisFontCategoryNonProportional">Singer</span>                    class.</div>
                <div class="Para" id="Par265">
                    <div class="ProgramCode" id="PC79">
                        <div class="LineGroup">
                            <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">abstract</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">AbstractLookupDemoBean</span>
        <span style="color:#00f;font-weight:700">implements</span> <span style="font-style:italic">DemoBean</span> {
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">abstract</span> <span style="color:#00f;font-weight:700">Singer</span> <span style="color:#0000a2;font-weight:700">getMySinger</span>();

    <span style="color:#00f;font-weight:700">@Override</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">doSomething</span>() {
        getMySinger()<span style="color:#00f;font-weight:700">.</span>sing();
    }
}
</pre></div>
                        </div>
                    </div>
                </div>
                <div class="Para" id="Par266">Notice that the <span id="ITerm109">              <span class="EmphasisFontCategoryNonProportional">getMySinger()</span> method </span> <span id="ITerm110">                                                    </span> is declared as abstract
                    and that this method is called by the <span class="EmphasisFontCategoryNonProportional">doSomething()</span> method to obtain a <span class="EmphasisFontCategoryNonProportional">Singer</span> instance. The Spring XML configuration
                    for this example is contained in a file named <span class="EmphasisFontCategoryNonProportional">app-context-xml.xml</span> and is shown here:</div>
                <div class="Para" id="Par267">
                    <div class="ProgramCode" id="PC80">
                        <div class="LineGroup">
                            <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#1c02ff">&lt;<span style="font-weight:700">beans</span> ...&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">singer</span> <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch3.Singer</span>
          <span style="font-style:italic">scope</span>=<span style="color:#036a07">prototype</span>/&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">abstractLookupBean</span>
        <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch3.AbstractLookupDemoBean</span>&gt;</span>
        <span style="color:#1c02ff">&lt;<span style="font-weight:700">lookup-method</span> <span style="font-style:italic">name</span>=<span style="color:#036a07">getMySinger</span> <span style="font-style:italic">bean</span>=<span style="color:#036a07">singer</span>/&gt;</span>
    <span style="color:#1c02ff">&lt;/<span style="font-weight:700">bean</span>&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">standardLookupBean</span>
        <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch3.StandardLookupDemoBean</span>&gt;</span>
        <span style="color:#1c02ff">&lt;<span style="font-weight:700">property</span> <span style="font-style:italic">name</span>=<span style="color:#036a07">mySinger</span> <span style="font-style:italic">ref</span>=<span style="color:#036a07">singer</span>/&gt;</span>
    <span style="color:#1c02ff">&lt;/<span style="font-weight:700">bean</span>&gt;</span>
<span style="color:#1c02ff">&lt;/<span style="font-weight:700">beans</span>&gt;</span>
</pre></div>
                        </div>
                    </div>
                </div>
                <div class="Para" id="Par268">The configuration for the <span class="EmphasisFontCategoryNonProportional">singer</span> and <span class="EmphasisFontCategoryNonProportional">standardLookupBean</span> beans should look familiar to you by now. For <span class="EmphasisFontCategoryNonProportional">abstract-LookupBean</span>,
                    you need to configure the lookup method by using the <span class="EmphasisFontCategoryNonProportional">&lt;lookup-method&gt;</span> tag. The <span class="EmphasisFontCategoryNonProportional">name</span> attribute of the <span class="EmphasisFontCategoryNonProportional">&lt;lookup-method&gt;</span>                    tag tells Spring the name of the method on the bean that it should override. This method must not accept any arguments, and the return type should be that of the bean you want to return from the method. In this case, the method should
                    return a class of type <span class="EmphasisFontCategoryNonProportional">Singer</span>, or its subclasses. The bean attribute tells Spring which bean the lookup method should return. The following code snippet shows the final piece
                    of code for this example, which is the class containing the <span class="EmphasisFontCategoryNonProportional">main()</span> method used to run the example:</div>
                <div class="Para" id="Par269">
                    <div class="ProgramCode" id="PC81">
                        <div class="LineGroup">
                            <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.support.GenericXmlApplicationContext</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.util.StopWatch</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">LookupDemo</span> {
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span>... <span style="font-style:italic">args</span>) {
        <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span> ctx <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span>();
        ctx<span style="color:#00f;font-weight:700">.</span>load(<span style="color:#036a07">classpath:spring/app-context-xml.xml</span>);
        ctx<span style="color:#00f;font-weight:700">.</span>refresh();
        <span style="color:#00f;font-weight:700">DemoBean</span> abstractBean <span style="color:#00f;font-weight:700">=</span> ctx<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#036a07">abstractLookupBean</span>,
                <span style="color:#00f;font-weight:700">DemoBean</span><span style="color:#00f;font-weight:700">.</span>class);
        <span style="color:#00f;font-weight:700">DemoBean</span> standardBean <span style="color:#00f;font-weight:700">=</span> ctx<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#036a07">standardLookupBean</span>,
                <span style="color:#00f;font-weight:700">DemoBean</span><span style="color:#00f;font-weight:700">.</span>class);
        displayInfo(<span style="color:#036a07">abstractLookupBean</span>, abstractBean);
        displayInfo(<span style="color:#036a07">standardLookupBean</span>, standardBean);
        ctx<span style="color:#00f;font-weight:700">.</span>close();
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">displayInfo</span>(<span style="color:#00f;font-weight:700">String</span> <span style="font-style:italic">beanName</span>, <span style="color:#00f;font-weight:700">DemoBean</span> <span style="font-style:italic">bean</span>) {
        <span style="color:#00f;font-weight:700">Singer</span> singer1 <span style="color:#00f;font-weight:700">=</span> bean<span style="color:#00f;font-weight:700">.</span>getMySinger();
        <span style="color:#00f;font-weight:700">Singer</span> singer2 <span style="color:#00f;font-weight:700">=</span> bean<span style="color:#00f;font-weight:700">.</span>getMySinger();
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07"></span> <span style="color:#00f;font-weight:700">+</span> beanName <span style="color:#00f;font-weight:700">+</span> <span style="color:#036a07">: Singer Instances the Same? </span>
                <span style="color:#00f;font-weight:700">+</span> (singer1 <span style="color:#00f;font-weight:700">==</span> singer2));
        <span style="color:#00f;font-weight:700">StopWatch</span> stopWatch <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">StopWatch</span>();
        stopWatch<span style="color:#00f;font-weight:700">.</span>start(<span style="color:#036a07">lookupDemo</span>);
        <span style="color:#00f;font-weight:700">for</span> (<span style="color:#00f;font-weight:700">int</span> x <span style="color:#00f;font-weight:700">=</span> <span style="color:#0000cd">0</span>; x <span style="color:#00f;font-weight:700">&lt;</span> <span style="color:#0000cd">100000</span>; x<span style="color:#00f;font-weight:700">++</span>) {
            <span style="color:#00f;font-weight:700">Singer</span> singer <span style="color:#00f;font-weight:700">=</span> bean<span style="color:#00f;font-weight:700">.</span>getMySinger();
            singer<span style="color:#00f;font-weight:700">.</span>sing();
        }
        stopWatch<span style="color:#00f;font-weight:700">.</span>stop();
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">100000 gets took </span>
                <span style="color:#00f;font-weight:700">+</span> stopWatch<span style="color:#00f;font-weight:700">.</span>getTotalTimeMillis() <span style="color:#00f;font-weight:700">+</span> <span style="color:#036a07"> ms</span>);
    }
}
</pre></div>
                        </div>
                    </div>
                </div>
                <div class="Para" id="Par270">In this code, you can see that the <span class="EmphasisFontCategoryNonProportional">abstractLookupBean</span> and the <span class="EmphasisFontCategoryNonProportional">standardLookupBean</span> from the <span id="ITerm112">                  <span class="EmphasisFontCategoryNonProportional">GenericXmlApplicationContext</span>                    </span> are retrieved and each reference is passed to the <span class="EmphasisFontCategoryNonProportional">displayInfo()</span> method. The instantiation of the abstract class is supported only when using Lookup Method Injection,
                    in which Spring will use CGLIB to generate a subclass of the AbstractLookupDemoBean class that overrides the method dynamically. The first part of the <span id="ITerm113">              <span class="EmphasisFontCategoryNonProportional">displayInfo()</span>                    method </span> creates two local variables of <span class="EmphasisFontCategoryNonProportional">Singer</span> type and assigns them each a value by calling <span class="EmphasisFontCategoryNonProportional">getMySinger()</span> on the
                    bean passed to it. Using these two variables, it writes a message to the console indicating whether the two references point to the same object.</div>
                <div class="Para" id="Par271">For the <span class="EmphasisFontCategoryNonProportional">abstractLookupBean</span> bean, a new instance of <span class="EmphasisFontCategoryNonProportional">Singer</span> should be retrieved for each call to <span class="EmphasisFontCategoryNonProportional">getMySinger()</span>,
                    so the references should not be the same.</div>
                <div class="Para" id="Par272">For <span class="EmphasisFontCategoryNonProportional">standardLookupBean</span>, a single <span id="ITerm114">instance                          </span> of <span class="EmphasisFontCategoryNonProportional">Singer</span> is passed to the
                    bean by setter injection, and this instance is stored and returned for every call to <span class="EmphasisFontCategoryNonProportional">getMySinger()</span>, so the two references should be the same.</div>
                <div class="Para ParaTypeImportant" id="Par273">
                <img alt="A315511_5_En_3_Figa_HTML.jpg" data-mfp-src="/library/view/pro-spring-5/9781484228081/A315511_5_En_3_Figa_HTML.jpg" height="28" src="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_3_Figa_HTML.jpg" width="30"/>                    The <span class="EmphasisFontCategoryNonProportional">StopWatch</span> class used in the previous example is a utility class available with Spring. You’ll find <span class="EmphasisFontCategoryNonProportional">StopWatch</span> very
                    useful when you need to perform simple performance tests and when you are testing your applications.</div>
                <div class="Para" id="Par274">The final part of the <span id="ITerm115">              <span class="EmphasisFontCategoryNonProportional">displayInfo()</span> method </span> runs a simple performance test to see which bean is faster. Clearly, <span class="EmphasisFontCategoryNonProportional">standardLookupBean</span>                    should be faster because it returns the same instance each time, but it is interesting to see the difference. We can now run the <span class="EmphasisFontCategoryNonProportional">LookupDemo</span> class for testing. Here is the output
                    we received from this example:</div>
                <div class="Para" id="Par275">
                    <div class="ProgramCode" id="PC82">
                        <div class="LineGroup">
                            <div class="FixedLine">[abstractLookupBean]: Singer Instances the Same? false</div>
                            <div class="FixedLine">100000 gets took 431 ms</div>
                        </div>
                        <div class="LineGroup">
                            <div class="FixedLine">[standardLookupBean]: Singer Instances the Same? true</div>
                            <div class="FixedLine">100000 gets took 1 ms</div>
                        </div>
                    </div>
                </div>
                <div class="Para" id="Par276">As you can see, the <span class="EmphasisFontCategoryNonProportional">Singer</span> instances are, as expected, the same when we use <span class="EmphasisFontCategoryNonProportional">standardLookupBean</span> and different when we use
                    <span class="EmphasisFontCategoryNonProportional">abstractLookupBean</span>. There is a noticeable performance difference when you use <span class="EmphasisFontCategoryNonProportional">standardLookupBean</span>, but that is to be expected.</div>
                <div class="Para" id="Par277">Of course, there is an equivalent way to configure the beans presented earlier using annotations. The <span class="EmphasisFontCategoryNonProportional">singer</span> bean must have an extra annotation to specify the <span class="EmphasisFontCategoryNonProportional">prototype</span>                    scope.</div>
            <div class="Para" id="Par278">
                <div class="ProgramCode" id="PC83">
                    <div class="LineGroup">
                        <div class="FixedLine">package com.apress.prospring5.ch3.annotated;</div>
                    </div>
                    <div class="LineGroup">
                        <div class="FixedLine">import org.springframework.context.annotation.Scope;</div>
                        <div class="FixedLine">import org.springframework.stereotype.Component;</div>
                    </div>
                    <div class="LineGroup">
                        <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.annotated</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.annotation.Scope</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.stereotype.Component</span>;

@Component(<span style="color:#036a07">singer)
        @Scope(</span>prototype<span style="color:#036a07">)
        public class Singer{
        private String lyric=</span><span style="color:#00f;font-weight:700">I</span> played a quick game of chess with the salt and pepper shaker<span style="color:#036a07">&quot;;
        public void sing(){
        // commented to avoid console pollution
        //System.out.println(lyric);
        }
        }
</span></pre></div>
                    </div>
                </div>
            </div>
            <div class="Para" id="Par279">The <span class="EmphasisFontCategoryNonProportional">AbstractLookupDemoBean</span> class is no longer an abstract class, and the method <span class="EmphasisFontCategoryNonProportional">getMySinger()</span> has an empty body and is annotated
                with <span class="EmphasisFontCategoryNonProportional">@Lookup</span> that receives as an <span id="ITerm116">argument                           </span>the name of the <span class="EmphasisFontCategoryNonProportional">Singer</span> bean.
                The method body will be overridden, in the dynamically generated subclass.</div>
            <div class="Para" id="Par280">
                <div class="ProgramCode" id="PC84">
                    <div class="LineGroup">
                        <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.annotated</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.beans.factory.annotation.Lookup</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.stereotype.Component</span>;

@Component(<span style="color:#036a07">abstractLookupBean</span>)
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">AbstractLookupDemoBean</span> <span style="color:#00f;font-weight:700">implements</span> <span style="font-style:italic">DemoBean</span> {
    <span style="color:#00f;font-weight:700">@Lookup</span>(<span style="color:#036a07">singer</span>)
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">Singer</span> <span style="color:#0000a2;font-weight:700">getMySinger</span>() {
        <span style="color:#00f;font-weight:700">return</span> <span style="color:#585cf6;font-weight:700">null</span>; <span style="color:#06f;font-style:italic">// overriden dynamically</span>
    }

    <span style="color:#00f;font-weight:700">@Override</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">doSomething</span>() {
        getMySinger()<span style="color:#00f;font-weight:700">.</span>sing();
    }
}
</pre></div>
                    </div>
                </div>
            </div>
            <div class="Para" id="Par281">The <span id="ITerm117">              <span class="EmphasisFontCategoryNonProportional">StandardLookupDemoBean</span> class </span> only must be annotated with <span class="EmphasisFontCategoryNonProportional">@Component</span>, and
                <span class="EmphasisFontCategoryNonProportional">setMySinger</span> must be annotated with <span class="EmphasisFontCategoryNonProportional">@Autowired</span> and <span class="EmphasisFontCategoryNonProportional">@Qualifier</span> to inject the <span class="EmphasisFontCategoryNonProportional">singer</span>                    bean.</div>
            <div class="Para" id="Par282">
                <div class="ProgramCode" id="PC85">
                    <div class="LineGroup">
                        <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.annotated</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.beans.factory.annotation.Autowired</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.beans.factory.annotation.Qualifier</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.stereotype.Component</span>;

@Component(<span style="color:#036a07">standardLookupBean</span>)
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">StandardLookupDemoBean</span> <span style="color:#00f;font-weight:700">implements</span> <span style="font-style:italic">DemoBean</span> {
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">Singer</span> mySinger;

    <span style="color:#00f;font-weight:700">@Autowired</span>
    <span style="color:#00f;font-weight:700">@Qualifier</span>(<span style="color:#036a07">singer</span>)
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setMySinger</span>(<span style="color:#00f;font-weight:700">Singer</span> <span style="font-style:italic">mySinger</span>) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>mySinger <span style="color:#00f;font-weight:700">=</span> mySinger;
    }

    <span style="color:#00f;font-weight:700">@Override</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">Singer</span> <span style="color:#0000a2;font-weight:700">getMySinger</span>() {
        <span style="color:#00f;font-weight:700">return</span> <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>mySinger;
    }

    <span style="color:#00f;font-weight:700">@Override</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">doSomething</span>() {
        mySinger<span style="color:#00f;font-weight:700">.</span>sing();
    }
}
</pre></div>
                    </div>
                </div>
            </div>
            <div class="Para" id="Par283">The configuration file, named <span class="EmphasisFontCategoryNonProportional">app-context-annotated.</span> <span id="ITerm118">                  <span class="EmphasisFontCategoryNonProportional">xml</span> </span>, only must enable component
                scanning for the package containing the annotated classes.</div>
            <div class="Para" id="Par284">
                <div class="ProgramCode" id="PC86">
                    <div class="LineGroup">
                        <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#1c02ff">&lt;<span style="font-weight:700">beans</span> ...&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">context</span><span style="font-weight:700">:</span><span style="font-weight:700">component-scan</span>
            <span style="font-style:italic">base-package</span>=<span style="color:#036a07">com.apress.prospring5.ch3.annotated</span>/&gt;</span>
<span style="color:#1c02ff">&lt;/<span style="font-weight:700">beans</span>&gt;</span>
</pre></div>
                    </div>
                </div>
            </div>
            <div class="Para" id="Par285">The class used to execute the code is identical to class <span class="EmphasisFontCategoryNonProportional">LookupDemo</span>; the only difference is the XML file used as an argument to create the <span class="EmphasisFontCategoryNonProportional">GenericXmlApplicationContext</span>                object.</div>
            <div class="Para ParaOneEmphasisChild" id="Par286">If we want to get rid of XML files totally, this can be done using a configuration class to enable component scanning on the <span class="EmphasisFontCategoryNonProportional">com.apress.prospring5.ch3.annotated</span> package. And this class
                can be declared right where you need it, meaning in this case inside the class being run to test the beans, as shown here:</div>
            <div class="Para" id="Par287">
                <div class="ProgramCode" id="PC87">
                    <div class="LineGroup">
                        <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.config</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.annotated.DemoBean</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.annotated.Singer</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.annotation.AnnotationConfigApplicationContext</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.annotation.ComponentScan</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.annotation.Configuration</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.support.GenericApplicationContext</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.util.StopWatch</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">java.util.Arrays</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">LookupConfigDemo</span> {
    <span style="color:#00f;font-weight:700">@Configuration</span>
    <span style="color:#00f;font-weight:700">@ComponentScan</span>(<span style="color:#c5060b;font-weight:700">basePackages</span> <span style="color:#00f;font-weight:700">=</span> {<span style="color:#036a07">com.apress.prospring5.ch3.annotated</span>})
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">LookupConfig</span> {
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span>... <span style="font-style:italic">args</span>) {
        <span style="color:#00f;font-weight:700">GenericApplicationContext</span> ctx <span style="color:#00f;font-weight:700">=</span>
                <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">AnnotationConfigApplicationContext</span>(<span style="color:#00f;font-weight:700">LookupConfig</span><span style="color:#00f;font-weight:700">.</span>class);
        <span style="color:#00f;font-weight:700">DemoBean</span> abstractBean <span style="color:#00f;font-weight:700">=</span> ctx<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#036a07">abstractLookupBean</span>,
                <span style="color:#00f;font-weight:700">DemoBean</span><span style="color:#00f;font-weight:700">.</span>class);
        <span style="color:#00f;font-weight:700">DemoBean</span> standardBean <span style="color:#00f;font-weight:700">=</span> ctx<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#036a07">standardLookupBean</span>,
                <span style="color:#00f;font-weight:700">DemoBean</span><span style="color:#00f;font-weight:700">.</span>class);
        displayInfo(<span style="color:#036a07">abstractLookupBean</span>, abstractBean);
        displayInfo(<span style="color:#036a07">standardLookupBean</span>, standardBean);
        ctx<span style="color:#00f;font-weight:700">.</span>close();
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">displayInfo</span>(<span style="color:#00f;font-weight:700">String</span> <span style="font-style:italic">beanName</span>, <span style="color:#00f;font-weight:700">DemoBean</span> <span style="font-style:italic">bean</span>) {
        <span style="color:#06f;font-style:italic">// same implementation as before</span>
                .<span style="color:#00f;font-weight:700">.</span>.
    }
}
</pre></div>
                    </div>
                </div>
            </div>
            <div class="Para" id="Par288">Alternative configurations using <span id="ITerm120">annotations                          </span> and Java configuration are covered in more detail in Chapter <span class="ExternalRef"><a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_4_Chapter.html"><span class="RefSource">4</span></a>
                </span>.</div>
            </div>
            <div class="Section3 RenderAsSection3" id="Sec30">
                <h4 class="Heading">Considerations for Lookup Method Injection</h4>
                <div class="Para" id="Par289">Lookup Method Injection is intended for use when you want to work with two beans of different life cycles. Avoid the temptation to use Lookup Method Injection when the beans share the same life cycle, especially if they are singletons.
                    The output of running the previous example shows a noticeable difference in performance between using Method Injection to obtain new instances of a dependency and using standard DI to obtain a single instance of a dependency. Also,
                    make sure you don’t use Lookup Method Injection needlessly, even when you have beans of different life cycles.</div>
                <div class="Para" id="Par290">Consider a situation in which you have three singletons that share a dependency in common. You want each singleton to have its own instance of the dependency, so you create the dependency as a nonsingleton, but you are happy with each
                    singleton using the same instance of the collaborator throughout its life. In this case, setter injection is the ideal solution; Lookup Method Injection just adds unnecessary overhead.</div>
                <div class="Para" id="Par291">When you are using <span id="ITerm121">Lookup Method Injection,                          </span> there are a few design guidelines that you should keep in mind when building your classes. In the earlier examples, we declared the lookup
                    method in an interface. The only reason we did this was we did not have to duplicate the <span class="EmphasisFontCategoryNonProportional">displayInfo()</span> method twice for two different bean types. As mentioned earlier, generally
                    you do not need to pollute a business interface with unnecessary definitions that are used solely for IoC purposes. Another point is that although you don’t have to make your lookup method abstract, doing so prevents you from forgetting
                    to configure the lookup method and then using a blank implementation by accident. Of course, this works only with XML configuration. Annotation-based configuration forces an empty implementation of the method; otherwise, your bean
                    won’t be created.</div>
            </div>
            <div class="Section3 RenderAsSection3" id="Sec31">
                <h4 class="Heading">Method Replacement</h4>
                <div class="Para" id="Par292">Although the Spring documentation classifies <span id="ITerm122">method replacement                          </span> as a form of injection, it is different from what you have seen so far. So far, we have used injection purely to supply
                    beans with their collaborators. Using method replacement, you can replace the implementation of any method on any beans arbitrarily without having to change the source of the bean you are modifying. For example, you have a third-party
                    library that you use in your Spring application, and you need to change the logic of a certain method. However, you are not able to change the source code because it was provided by a third party, so one solution is to use method replacement
                    to just replace the logic for that method with your own implementation.</div>
                <div class="Para" id="Par293">Internally, you achieve this by creating a subclass of the bean class dynamically. You use CGLIB and redirect calls to the method you want to replace to another bean that implements the <span class="EmphasisFontCategoryNonProportional">MethodReplacer</span>                    interface. In the following code sample, you can see a simple bean that declares two overloads of the <span id="ITerm123">              <span class="EmphasisFontCategoryNonProportional">formatMessage()</span> method </span>:</div>
                <div class="Para" id="Par294">
                    <div class="ProgramCode" id="PC88">
                        <div class="LineGroup">
                            <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">ReplacementTarget</span> {
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">String</span> <span style="color:#0000a2;font-weight:700">formatMessage</span>(<span style="color:#00f;font-weight:700">String</span> <span style="font-style:italic">msg</span>) {
        <span style="color:#00f;font-weight:700">return</span> <span style="color:#036a07">&lt;h1&gt;</span> <span style="color:#00f;font-weight:700">+</span> msg <span style="color:#00f;font-weight:700">+</span> <span style="color:#036a07">&lt;/h1&gt;</span>;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">String</span> <span style="color:#0000a2;font-weight:700">formatMessage</span>(<span style="color:#00f;font-weight:700">Object</span> <span style="font-style:italic">msg</span>) {
        <span style="color:#00f;font-weight:700">return</span> <span style="color:#036a07">&lt;h1&gt;</span> <span style="color:#00f;font-weight:700">+</span> msg <span style="color:#00f;font-weight:700">+</span> <span style="color:#036a07">&lt;/h1&gt;</span>;
    }
}
</pre></div>
                        </div>
                    </div>
            </div>
            <div class="Para" id="Par295">You can replace any of the methods on the <span class="EmphasisFontCategoryNonProportional">ReplacementTarget</span> class by using Spring’s method replacement functionality. In this example, we show you how to replace the <span class="EmphasisFontCategoryNonProportional">formatMessage(String)</span>                method, and we also compare the performance of the replaced method with that of the original.</div>
            <div class="Para ParaOneEmphasisChild" id="Par296">To replace a method, you first need to create an implementation of the <span class="EmphasisFontCategoryNonProportional">MethodReplacer</span> interface; this is shown in the following code sample:</div>
            <div class="Para" id="Par297">
                <div class="ProgramCode" id="PC89">
                    <div class="LineGroup">
                        <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.beans.factory.support.MethodReplacer</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">java.lang.reflect.Method</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">FormatMessageReplacer</span>
        <span style="color:#00f;font-weight:700">implements</span> <span style="font-style:italic">MethodReplacer</span> {
    <span style="color:#00f;font-weight:700">@Override</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">Object</span> <span style="color:#0000a2;font-weight:700">reimplement</span>(<span style="color:#00f;font-weight:700">Object</span> <span style="font-style:italic">arg0</span>, <span style="color:#00f;font-weight:700">Method</span> <span style="font-style:italic">method</span>, <span style="color:#00f;font-weight:700">Object</span>... <span style="font-style:italic">args</span>)
            <span style="color:#00f;font-weight:700">throws</span> <span style="color:#00f;font-weight:700">Throwable</span> {
        <span style="color:#00f;font-weight:700">if</span> (isFormatMessageMethod(method)) {
            <span style="color:#00f;font-weight:700">String</span> msg <span style="color:#00f;font-weight:700">=</span> (<span style="color:#00f;font-weight:700">String</span>) args0;
            <span style="color:#00f;font-weight:700">return</span> <span style="color:#036a07">&lt;h2&gt;</span> <span style="color:#00f;font-weight:700">+</span> msg <span style="color:#00f;font-weight:700">+</span> <span style="color:#036a07">&lt;/h2&gt;</span>;
        } <span style="color:#00f;font-weight:700">else</span> {
            <span style="color:#00f;font-weight:700">throw</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">IllegalArgumentException</span>(<span style="color:#036a07">Unable to reimplement method </span>
                    <span style="color:#00f;font-weight:700">+</span> method<span style="color:#00f;font-weight:700">.</span>getName());
        }
    }

    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">boolean</span> <span style="color:#0000a2;font-weight:700">isFormatMessageMethod</span>(<span style="color:#00f;font-weight:700">Method</span> <span style="font-style:italic">method</span>) {
        <span style="color:#00f;font-weight:700">if</span> (method<span style="color:#00f;font-weight:700">.</span>getParameterTypes()<span style="color:#00f;font-weight:700">.</span>length <span style="color:#00f;font-weight:700">!=</span> <span style="color:#0000cd">1</span>) {
            <span style="color:#00f;font-weight:700">return</span> <span style="color:#585cf6;font-weight:700">false</span>;
        }
        <span style="color:#00f;font-weight:700">if</span> (<span style="color:#00f;font-weight:700">!</span>(<span style="color:#036a07">formatMessage</span><span style="color:#00f;font-weight:700">.</span>equals(method<span style="color:#00f;font-weight:700">.</span>getName()))) {
            <span style="color:#00f;font-weight:700">return</span> <span style="color:#585cf6;font-weight:700">false</span>;
        }
        <span style="color:#00f;font-weight:700">if</span> (method<span style="color:#00f;font-weight:700">.</span>getReturnType() <span style="color:#00f;font-weight:700">!=</span> <span style="color:#00f;font-weight:700">String</span><span style="color:#00f;font-weight:700">.</span>class) {
            <span style="color:#00f;font-weight:700">return</span> <span style="color:#585cf6;font-weight:700">false</span>;
        }
        <span style="color:#00f;font-weight:700">if</span> (method<span style="color:#00f;font-weight:700">.</span>getParameterTypes()[<span style="color:#0000cd">0</span>] <span style="color:#00f;font-weight:700">!=</span> <span style="color:#00f;font-weight:700">String</span><span style="color:#00f;font-weight:700">.</span>class) {
            <span style="color:#00f;font-weight:700">return</span> <span style="color:#585cf6;font-weight:700">false</span>;
        }
        <span style="color:#00f;font-weight:700">return</span> <span style="color:#585cf6;font-weight:700">true</span>;
    }
}
</pre></div>
                </div>
            </div>
            </div>
            <div class="Para" id="Par298">The <span class="EmphasisFontCategoryNonProportional">MethodReplacer</span> interface has a single method, <span class="EmphasisFontCategoryNonProportional">reimplement()</span>, that you must implement. Three arguments are passed to
                <span class="EmphasisFontCategoryNonProportional">reimplement()</span>: the bean on which the original method was invoked, a <span class="EmphasisFontCategoryNonProportional">Method</span> instance that represents the method that is being overridden, and the array of arguments passed
                    to the method. The <span class="EmphasisFontCategoryNonProportional">reimplement()</span> method should return the result of your reimplemented logic, and, obviously, the type of the return value should be compatible with the return
                    type of the method you are replacing. In the previous code sample, <span class="EmphasisFontCategoryNonProportional">FormatMessageReplacer</span> first checks to see whether the method that is being overridden is the <span class="EmphasisFontCategoryNonProportional">formatMessage(String)</span>                    method; if so, it executes the replacement logic (in this case, surrounding the message with <span class="EmphasisFontCategoryNonProportional">&lt;h2&gt;</span> and <span class="EmphasisFontCategoryNonProportional">&lt;/h2&gt;</span>)
                    and returns the formatted message to the caller. It is not necessary to check whether the message is correct, but this can be useful if you are using a few <span class="EmphasisFontCategoryNonProportional">MethodReplacer</span>s with
                    similar arguments. Using a check helps prevent a situation in which a different <span id="ITerm125">                  <span class="EmphasisFontCategoryNonProportional">MethodReplacer</span> </span> with compatible arguments and return
                    types is used accidentally.</div>
            <div class="Para" id="Par299">In the configuration sample listed next, you can see an <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> instance that defines two beans of type <span class="EmphasisFontCategoryNonProportional">ReplacementTarget</span>;
                one has the <span class="EmphasisFontCategoryNonProportional">formatMessage(String)</span> method replaced, and the other does not (the file is named <span class="EmphasisFontCategoryNonProportional">app-context-xml.xml</span>):</div>
            <div class="Para" id="Par300">
                <div class="ProgramCode" id="PC90">
                    <div class="LineGroup">
                        <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#1c02ff">&lt;<span style="font-weight:700">beans</span> ...&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">methodReplacer</span>
        <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch3.FormatMessageReplacer</span>/&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">replacementTarget</span>
        <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch3.ReplacementTarget</span>&gt;</span>
        <span style="color:#1c02ff">&lt;<span style="font-weight:700">replaced-method</span> <span style="font-style:italic">name</span>=<span style="color:#036a07">formatMessage</span> <span style="font-style:italic">replacer</span>=<span style="color:#036a07">methodReplacer</span>&gt;</span>
            <span style="color:#1c02ff">&lt;<span style="font-weight:700">arg-type</span>&gt;</span>String<span style="color:#1c02ff">&lt;/<span style="font-weight:700">arg-type</span>&gt;</span>
        <span style="color:#1c02ff">&lt;/<span style="font-weight:700">replaced-method</span>&gt;</span>
    <span style="color:#1c02ff">&lt;/<span style="font-weight:700">bean</span>&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">standardTarget</span>
        <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch3.ReplacementTarget</span>/&gt;</span>
<span style="color:#1c02ff">&lt;/<span style="font-weight:700">beans</span>&gt;</span>
</pre></div>
                    </div>
                </div>
                </div>
                <div class="Para" id="Par301">As you can see, the <span class="EmphasisFontCategoryNonProportional">MethodReplacer</span> implementation is declared as a bean in <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>. You then use the <span class="EmphasisFontCategoryNonProportional">&lt;replaced-method&gt;</span>                    tag to replace the <span class="EmphasisFontCategoryNonProportional">formatMessage(String)</span> method on <span class="EmphasisFontCategoryNonProportional">replacementTargetBean</span>. The name attribute of the <span class="EmphasisFontCategoryNonProportional">&lt;replaced-method&gt;</span>                    tag specifies the name of the method to replace, and the replacer attribute is used to specify the name of the <span class="EmphasisFontCategoryNonProportional">MethodReplacer</span> bean that we want to replace the method implementation.
                    In cases where there are overloaded methods such as in the <span class="EmphasisFontCategoryNonProportional">ReplacementTarget</span> class, you can use the <span class="EmphasisFontCategoryNonProportional">&lt;arg-type&gt;</span>                    tag to specify the method signature to match. The <span class="EmphasisFontCategoryNonProportional">&lt;arg-type&gt;</span> tag supports pattern matching, so <span class="EmphasisFontCategoryNonProportional">String</span> is matched
                    to <span class="EmphasisFontCategoryNonProportional">java.lang.String</span> and also to <span class="EmphasisFontCategoryNonProportional">java.lang.StringBuffer</span>.</div>
                <div class="Para" id="Par302">The following code snippet shows a simple demo application that retrieves both the <span class="EmphasisFontCategoryNonProportional">standardTarget</span> and <span class="EmphasisFontCategoryNonProportional">replacement-Target</span>                    beans from <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>, executes their <span class="EmphasisFontCategoryNonProportional">formatMessage(String)</span> methods, and then runs a simple performance test
                    to see which is faster.</div>
                <div class="Para" id="Par303">
                    <div class="ProgramCode" id="PC91">
                        <div class="LineGroup">
                            <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.support.GenericXmlApplicationContext</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.util.StopWatch</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">MethodReplacementDemo</span> {
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span>... <span style="font-style:italic">args</span>) {
        <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span> ctx <span style="color:#00f;font-weight:700">=</span>
                <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span>();
        ctx<span style="color:#00f;font-weight:700">.</span>load(<span style="color:#036a07">classpath:spring/app-context-xml.xml</span>);
        ctx<span style="color:#00f;font-weight:700">.</span>refresh();
        <span style="color:#00f;font-weight:700">ReplacementTarget</span> replacementTarget <span style="color:#00f;font-weight:700">=</span> (<span style="color:#00f;font-weight:700">ReplacementTarget</span>) ctx
                .getBean(<span style="color:#036a07">replacementTarget</span>);
        <span style="color:#00f;font-weight:700">ReplacementTarget</span> standardTarget <span style="color:#00f;font-weight:700">=</span> (<span style="color:#00f;font-weight:700">ReplacementTarget</span>) ctx
                .getBean(<span style="color:#036a07">standardTarget</span>);
        displayInfo(replacementTarget);
        displayInfo(standardTarget);
        ctx<span style="color:#00f;font-weight:700">.</span>close();
    }

    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">displayInfo</span>(<span style="color:#00f;font-weight:700">ReplacementTarget</span> <span style="font-style:italic">target</span>) {
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(target<span style="color:#00f;font-weight:700">.</span>formatMessage(<span style="color:#036a07">Thanks for playing, try again!</span>));
        <span style="color:#00f;font-weight:700">StopWatch</span> stopWatch <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">StopWatch</span>();
        stopWatch<span style="color:#00f;font-weight:700">.</span>start(<span style="color:#036a07">perfTest</span>);
        <span style="color:#00f;font-weight:700">for</span> (<span style="color:#00f;font-weight:700">int</span> x <span style="color:#00f;font-weight:700">=</span> <span style="color:#0000cd">0</span>; x <span style="color:#00f;font-weight:700">&lt;</span> <span style="color:#0000cd">1000000</span>; x<span style="color:#00f;font-weight:700">++</span>) {
            <span style="color:#00f;font-weight:700">String</span> out <span style="color:#00f;font-weight:700">=</span> target<span style="color:#00f;font-weight:700">.</span>formatMessage(<span style="color:#036a07">No filter in my head</span>);
            <span style="color:#06f;font-style:italic">//commented to not pollute the console</span>
            <span style="color:#06f;font-style:italic">//System.out.println(out);</span>
        }
        stopWatch<span style="color:#00f;font-weight:700">.</span>stop();
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">1000000 invocations took: </span>
                <span style="color:#00f;font-weight:700">+</span> stopWatch<span style="color:#00f;font-weight:700">.</span>getTotalTimeMillis() <span style="color:#00f;font-weight:700">+</span> <span style="color:#036a07"> ms</span>);
    }
}
</pre></div>
                        </div>
                    </div>
                </div>
                <div class="Para" id="Par304">You should be familiar with this code by now, so we won’t go into detail. On our machine, running this example yields the following output: <span id="ITerm127">                                                    </span> </div>
                <div class="Para" id="Par305">
                    <div class="ProgramCode" id="PC92">
                        <div class="LineGroup">
                            <div class="FixedLine">&lt;h2&gt;Thanks for playing, try again!&lt;/h2&gt;</div>
                            <div class="FixedLine">1000000 invocations took: 188 ms</div>
                        </div>
                        <div class="LineGroup">
                            <div class="FixedLine">&lt;h1&gt;Thanks for playing, try again!&lt;/h1&gt;</div>
                            <div class="FixedLine">1000000 invocations took: 24 ms</div>
                        </div>
                    </div>
                </div>
                <div class="Para" id="Par306">As expected, the output from the <span class="EmphasisFontCategoryNonProportional">replacementTarget</span> bean reflects the overridden implementation that the <span class="EmphasisFontCategoryNonProportional">Method-Replacer</span> provides.
                    Interestingly, though, the dynamically replaced method is many times slower than the statically defined method. Removing the check for a valid method in <span class="EmphasisFontCategoryNonProportional">MethodReplacer</span> made a
                    negligible difference across a number of executions, so we can conclude that most of the overhead is in the CGLIB subclass.</div>
                </div>
                <div class="Section3 RenderAsSection3" id="Sec32">
                    <h4 class="Heading">When to Use Method Replacement</h4>
                    <div class="Para" id="Par307">Method replacement can prove quite useful in a variety of circumstances, especially when you want to override only a particular method for a single bean rather than all beans of the same type. With that said, we still prefer using
                        standard Java mechanisms for overriding methods rather than depending on runtime bytecode enhancement.</div>
                    <div class="Para" id="Par308">If you are going to use method replacement as part of your application, we recommend you use one <span class="EmphasisFontCategoryNonProportional">Method-Replacer</span> per method or group of overloaded methods. Avoid the temptation
                        to use a single <span class="EmphasisFontCategoryNonProportional">MethodReplacer</span> for lots of unrelated methods; this results in extra unnecessary String comparisons while your code works out which method it should reimplement.
                        We have found that performing simple checks to ensure that <span class="EmphasisFontCategoryNonProportional">MethodReplacer</span> is working with the correct method is useful and doesn’t add too much overhead to your code. If
                        you are really concerned about performance, you can simply add a Boolean property to your <span class="EmphasisFontCategoryNonProportional">MethodReplacer</span>, which allows you to turn the check on and off using dependency injection.</div>
                </div>
                </div>
                <div class="Section2 RenderAsSection2" id="Sec33">
                    <h3 class="Heading">Understanding Bean Naming</h3>
                    <div class="Para" id="Par309">Spring supports quite a complex <span id="ITerm128">bean-naming structure                      </span> that allows you the flexibility to handle many situations. Every bean must have at least one name that is unique within the containing
                        <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>. Spring follows a simple resolution process to determine what name is used for the bean. If you give the <span class="EmphasisFontCategoryNonProportional">&lt;bean&gt;</span>                        tag an <span class="EmphasisFontCategoryNonProportional">id</span> attribute, the value of that attribute is used as the name. If no <span class="EmphasisFontCategoryNonProportional">id</span> attribute is specified, Spring looks
                        for a <span class="EmphasisFontCategoryNonProportional">name</span> attribute, and if one is defined, it uses the first name defined in the <span class="EmphasisFontCategoryNonProportional">name</span> attribute. (We say the first
                        name because it is possible to define multiple names within the <span class="EmphasisFontCategoryNonProportional">name</span> attribute; this is covered in more detail shortly.) If neither the <span class="EmphasisFontCategoryNonProportional">id</span>                        nor the <span class="EmphasisFontCategoryNonProportional">name</span> attribute is specified, Spring uses the bean’s class name as the name, provided, of course, that no other bean is using the same class name. If multiple beans
                        of the same type without an ID or name are declared, Spring will throw an exception (of type <span class="EmphasisFontCategoryNonProportional">org.springframework.beans.factory.NoSuchBeanDefinitionException</span>) on injection
                        during <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> initialization. The following configuration sample configuration depicts all three naming schemes (<span class="EmphasisFontCategoryNonProportional">app-context-01.xml</span>):</div>
                    <div class="Para" id="Par310">
                        <div class="ProgramCode" id="PC93">
                            <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#1c02ff">&lt;<span style="font-weight:700">beans</span> ...&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">string1</span> <span style="font-style:italic">class</span>=<span style="color:#036a07">java.lang.String</span>/&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">name</span>=<span style="color:#036a07">string2</span> <span style="font-style:italic">class</span>=<span style="color:#036a07">java.lang.String</span>/&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">class</span>=<span style="color:#036a07">java.lang.String</span>/&gt;</span>
<span style="color:#1c02ff">&lt;/<span style="font-weight:700">beans</span>&gt;</span>
</pre></div>
                        </div>
                </div>
                <div class="Para" id="Par311">Each of these approaches is equally valid from a technical point of view, but which is the best choice for your application? To start with, avoid using the automatic name by class behavior. This doesn’t allow you much flexibility to define
                    multiple beans of the same type, and it is much better to define your own names. That way, if Spring changes the default behavior in the future, your application continues to work. If you want to see how Spring is naming the beans,
                    using the previous configuration,<span id="ITerm129">                                              </span> run the following example:</div>
                <div class="Para" id="Par312">
                    <div class="ProgramCode" id="PC94">
                        <div class="LineGroup">
                            <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.xml</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.support.GenericXmlApplicationContext</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">BeanNamingTest</span> {
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span>... <span style="font-style:italic">args</span>) {
        <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span> ctx <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span>();
        ctx<span style="color:#00f;font-weight:700">.</span>load(<span style="color:#036a07">classpath:spring/app-context-01.xml</span>);
        ctx<span style="color:#00f;font-weight:700">.</span>refresh();
        <span style="color:#00f;font-weight:700">Map&lt;<span style="color:#00f;font-weight:700">String</span>, <span style="color:#00f;font-weight:700">String</span>&gt;</span> beans <span style="color:#00f;font-weight:700">=</span> ctx<span style="color:#00f;font-weight:700">.</span>getBeansOfType(<span style="color:#00f;font-weight:700">String</span><span style="color:#00f;font-weight:700">.</span>class);
        beans<span style="color:#00f;font-weight:700">.</span>entrySet()<span style="color:#00f;font-weight:700">.</span>stream()<span style="color:#00f;font-weight:700">.</span>forEach(b <span style="color:#00f;font-weight:700">-</span><span style="color:#00f;font-weight:700">&gt;</span> <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(b<span style="color:#00f;font-weight:700">.</span>getKey()));
        ctx<span style="color:#00f;font-weight:700">.</span>close();
    }
</pre></div>
                            <div class="FixedLine">}</div>
                        </div>
                    </div>
                </div>
                <div class="Para" id="Par313"> <span class="EmphasisFontCategoryNonProportional">ctx.getBeansOfType(String.class)</span> is used to obtain a map with all beans of type <span class="EmphasisFontCategoryNonProportional">String</span> and their IDs that exist within
                    <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>. The keys of the map are the bean IDs that are printed using the lambda expression in the previous code. With the mentioned configuration, this is the output:</div>
                <div class="Para" id="Par314">
                    <div class="ProgramCode" id="PC95">
                        <div class="FixedLine">string1</div>
                        <div class="FixedLine">string2</div>
                        <div class="FixedLine">java.lang.String#0</div>
                    </div>
                </div>
                <div class="Para" id="Par315">The last line in the previous output sample is the ID that Spring gave to the bean of type <span class="EmphasisFontCategoryNonProportional">String</span> that was not named explicitly in the configuration. If the configuration were modified
                    to add another <span class="EmphasisFontCategoryNonProportional">String</span> unnamed bean, it would look like this:</div>
                <div class="Para" id="Par316">
                    <div class="ProgramCode" id="PC96">
                        <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#1c02ff">&lt;<span style="font-weight:700">beans</span> ...&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">string1</span> <span style="font-style:italic">class</span>=<span style="color:#036a07">java.lang.String</span>/&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">name</span>=<span style="color:#036a07">string2</span> <span style="font-style:italic">class</span>=<span style="color:#036a07">java.lang.String</span>/&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">class</span>=<span style="color:#036a07">java.lang.String</span>/&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">class</span>=<span style="color:#036a07">java.lang.String</span>/&gt;</span>
<span style="color:#1c02ff">&lt;/<span style="font-weight:700">beans</span>&gt;</span>
</pre></div>
                    </div>
                </div>
                <div class="Para" id="Par317">The output would change to the following: <span id="ITerm130">                                              </span> </div>
                <div class="Para" id="Par318">
                    <div class="ProgramCode" id="PC97">
                        <div class="FixedLine">string1</div>
                        <div class="FixedLine">string2</div>
                        <div class="FixedLine">java.lang.String#0</div>
                        <div class="FixedLine">java.lang.String#1</div>
                    </div>
                </div>
                <div class="Para" id="Par319">Prior to Spring 3.1, the <span class="EmphasisFontCategoryNonProportional">id</span> attribute is the same as the XML identity (that is, <span class="EmphasisFontCategoryNonProportional">xsd:ID</span>), which places a restriction in the
                    characters you can use. As of Spring 3.1, Spring uses <span class="EmphasisFontCategoryNonProportional">xsd:String</span> for the <span class="EmphasisFontCategoryNonProportional">id</span> attribute, so the previous restriction on
                    the characters that you can use is gone. However, Spring will continue to ensure that the <span class="EmphasisFontCategoryNonProportional">id</span> is unique across the entire <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>.
                    As a general practice, you should give your bean a name by using the <span class="EmphasisFontCategoryNonProportional">id</span> attribute and then associate the bean with other names by using name aliasing, as discussed in the next
                    section.</div>
                <div class="Section3 RenderAsSection3" id="Sec34">
                    <h4 class="Heading">Bean Name Aliasing</h4>
                    <div class="Para" id="Par320">Spring allows a bean to have more than one name. You can achieve this by specifying a space-, comma-, or semicolon-separated list of names in the <span class="EmphasisFontCategoryNonProportional">name</span> attribute of the bean’s
                        <span class="EmphasisFontCategoryNonProportional">&lt;bean&gt;</span> tag. You can do this in place of, or in conjunction with, the <span class="EmphasisFontCategoryNonProportional">id</span> attribute. Besides using the
                        <span class="EmphasisFontCategoryNonProportional">name</span> attribute, you can use the <span class="EmphasisFontCategoryNonProportional">&lt;alias&gt;</span> tag for defining aliases for Spring bean names. The following configuration sample shows a simple <span class="EmphasisFontCategoryNonProportional"><pre style="background:#fff;color:#000"><span style="color:#1c02ff">&lt;<span style="font-weight:700">beans</span> ...&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">john</span> <span style="font-style:italic">name</span>=<span style="color:#036a07">john johnny,jonathan;jim</span> <span style="font-style:italic">class</span>=<span style="color:#036a07">java.lang.String</span>/&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">alias</span> <span style="font-style:italic">name</span>=<span style="color:#036a07">john</span> <span style="font-style:italic">alias</span>=<span style="color:#036a07">ion</span>/&gt;</span>
<span style="color:#1c02ff">&lt;/<span style="font-weight:700">beans</span>&gt;</span>
</pre></div>
                        </div>
                    </div>
                    <div class="Para" id="Par322">As you can see, we have defined six names: one using the <span class="EmphasisFontCategoryNonProportional">id</span> attribute and the other four as a list using all allowed bean name delimiters in the <span class="EmphasisFontCategoryNonProportional">name</span>                        attribute (this is just for demonstration purposes and is not recommended for real-life development). In real-life development, it’s recommended you standardize on the delimiter to use for separating bean names’ declarations within
                        your application. One more alias was defined using the <span class="EmphasisFontCategoryNonProportional">&lt;alias&gt;</span> tag. The following code sample depicts a Java routine that grabs the same bean from the <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>                        instance six times using different names and verifies that they are the same bean. Also, it makes use of the previously introduced <span class="EmphasisFontCategoryNonProportional">ctx.getBeansOfType(..)</span> method to make sure
                        there is only one <span class="EmphasisFontCategoryNonProportional">String</span> bean in the context.</div>
                    <div class="Para" id="Par323">
                        <div class="ProgramCode" id="PC99">
                            <div class="LineGroup">
                                <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.xml</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.support.GenericXmlApplicationContext</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">java.util.Map</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">BeanNameAliasing</span> {
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span>... <span style="font-style:italic">args</span>) {
        <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span> ctx <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span>();
        ctx<span style="color:#00f;font-weight:700">.</span>load(<span style="color:#036a07">classpath:spring/app-context-02.xml</span>);
        ctx<span style="color:#00f;font-weight:700">.</span>refresh();
        <span style="color:#00f;font-weight:700">String</span> s1 <span style="color:#00f;font-weight:700">=</span> (<span style="color:#00f;font-weight:700">String</span>) ctx<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#036a07">john</span>);
        <span style="color:#00f;font-weight:700">String</span> s2 <span style="color:#00f;font-weight:700">=</span> (<span style="color:#00f;font-weight:700">String</span>) ctx<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#036a07">jon</span>);
        <span style="color:#00f;font-weight:700">String</span> s3 <span style="color:#00f;font-weight:700">=</span> (<span style="color:#00f;font-weight:700">String</span>) ctx<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#036a07">johnny</span>);
        <span style="color:#00f;font-weight:700">String</span> s4 <span style="color:#00f;font-weight:700">=</span> (<span style="color:#00f;font-weight:700">String</span>) ctx<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#036a07">jonathan</span>);
        <span style="color:#00f;font-weight:700">String</span> s5 <span style="color:#00f;font-weight:700">=</span> (<span style="color:#00f;font-weight:700">String</span>) ctx<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#036a07">jim</span>);
        <span style="color:#00f;font-weight:700">String</span> s6 <span style="color:#00f;font-weight:700">=</span> (<span style="color:#00f;font-weight:700">String</span>) ctx<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#036a07">ion</span>);
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println((s1 <span style="color:#00f;font-weight:700">==</span> s2));
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println((s2 <span style="color:#00f;font-weight:700">==</span> s3));
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println((s3 <span style="color:#00f;font-weight:700">==</span> s4));
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println((s4 <span style="color:#00f;font-weight:700">==</span> s5));
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println((s5 <span style="color:#00f;font-weight:700">==</span> s6));
        <span style="color:#00f;font-weight:700">Map&lt;<span style="color:#00f;font-weight:700">String</span>, <span style="color:#00f;font-weight:700">String</span>&gt;</span> beans <span style="color:#00f;font-weight:700">=</span> ctx<span style="color:#00f;font-weight:700">.</span>getBeansOfType(<span style="color:#00f;font-weight:700">String</span><span style="color:#00f;font-weight:700">.</span>class);
        <span style="color:#00f;font-weight:700">if</span> (beans<span style="color:#00f;font-weight:700">.</span>size() <span style="color:#00f;font-weight:700">==</span> <span style="color:#0000cd">1</span>) {
            <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">There is only one String bean.</span>);
        }
        ctx<span style="color:#00f;font-weight:700">.</span>close();
    }
}
</pre></div>
                            </div>
                        </div>
                    </div>
                    <div class="Para ParaOneEmphasisChild" id="Par324">Executing the previous code will print <span class="EmphasisFontCategoryNonProportional">true</span> five times and the “There is only one String bean” text, verifying that the beans accessed using different names are, in fact, the
                        same bean.</div>
                    <div class="Para" id="Par325">You can retrieve a list of the bean aliases by calling <span class="EmphasisFontCategoryNonProportional">ApplicationContext.getAliases(String)</span> and passing in any of the beans’ names or IDs. The list of aliases, other than the
                        one you specified, will then be returned as a <span class="EmphasisFontCategoryNonProportional">String</span> array.</div>
                    <div class="Para" id="Par326">It was mentioned before that prior to Spring 3.1 the <span class="EmphasisFontCategoryNonProportional">id</span> attribute is the same as the XML identity (that is, <span class="EmphasisFontCategoryNonProportional">xsd:ID</span>),
                        which means bean IDs could not contain special characters like space-, comma-, or semicolon. Starting with Spring 3.1, <span class="EmphasisFontCategoryNonProportional">xsd:String</span> is used for the <span class="EmphasisFontCategoryNonProportional">id</span>                        attribute, so the previous restriction on the characters that you can use is gone. However, this does not mean you can use the following:</div>
                    <div class="Para" id="Par327">
                        <div class="ProgramCode" id="PC100">
                            <div class="FixedLine">&lt;bean name=&quot;jon johnny,jonathan;jim&quot; class=&quot;java.lang.String&quot;/&gt;</div>
                        </div>
                    </div>
                    <div class="Para" id="Par328">instead of this:</div>
                    <div class="Para" id="Par329">
                        <div class="ProgramCode" id="PC101">
                            <div class="FixedLine">&lt;bean id=&quot;jon johnny,jonathan;jim&quot; class=&quot;java.lang.String&quot;/&gt;</div>
                        </div>
                    </div>
                    <div class="Para" id="Par330">The <span class="EmphasisFontCategoryNonProportional">name</span> and <span class="EmphasisFontCategoryNonProportional">id</span> attribute values are treated differently by the Spring IoC. You can retrieve a list of the bean aliases
                        by calling <span class="EmphasisFontCategoryNonProportional">ApplicationContext.getAliases(String)</span> and passing in any one of the beans’ names or IDs. The list of aliases, other than the one you specified, will then be returned
                        as a <span class="EmphasisFontCategoryNonProportional">String</span> array. This means, in the first case, <span class="EmphasisFontCategoryNonProportional">jon</span> will become the id, and the rest of values will become
                        <span id="ITerm132">aliases </span>.</div>
                    <div class="Para" id="Par331">In the second case, when the same string is used as a value for the <span class="EmphasisFontCategoryNonProportional">id</span> attribute, the full string becomes a unique identifier for the bean. This can be easily tested with a configuration
                        like the one shown here (found in file <span class="EmphasisFontCategoryNonProportional">app-context-03.xml</span>):</div>
                    <div class="Para" id="Par332">
                        <div class="ProgramCode" id="PC102">
                            <div class="LineGroup">
                                <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#1c02ff">&lt;<span style="font-weight:700">beans</span> ...&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">name</span>=<span style="color:#036a07">jon johnny,jonathan;jim</span> <span style="font-style:italic">class</span>=<span style="color:#036a07">java.lang.String</span>/&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">jon johnny,jonathan;jim</span> <span style="font-style:italic">class</span>=<span style="color:#036a07">java.lang.String</span>/&gt;</span>
<span style="color:#1c02ff">&lt;/<span style="font-weight:700">beans</span>&gt;</span>
</pre></div>
                            </div>
                        </div>
                    </div>
                    <div class="Para" id="Par333">and a main class like the one shown in the following code sample:</div>
                    <div class="Para" id="Par334">
                        <div class="ProgramCode" id="PC103">
                            <div class="LineGroup">
                                <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.xml</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.support.GenericXmlApplicationContext</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">java.util.Arrays</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">java.util.Map</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">BeanCrazyNaming</span> {
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span>... <span style="font-style:italic">args</span>) {
        <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span> ctx <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span>();
        ctx<span style="color:#00f;font-weight:700">.</span>load(<span style="color:#036a07">classpath:spring/app-context-03.xml</span>);
        ctx<span style="color:#00f;font-weight:700">.</span>refresh();
        <span style="color:#00f;font-weight:700">Map&lt;<span style="color:#00f;font-weight:700">String</span>, <span style="color:#00f;font-weight:700">String</span>&gt;</span> beans <span style="color:#00f;font-weight:700">=</span> ctx<span style="color:#00f;font-weight:700">.</span>getBeansOfType(<span style="color:#00f;font-weight:700">String</span><span style="color:#00f;font-weight:700">.</span>class);
        beans<span style="color:#00f;font-weight:700">.</span>entrySet()<span style="color:#00f;font-weight:700">.</span>stream()<span style="color:#00f;font-weight:700">.</span>forEach(b <span style="color:#00f;font-weight:700">-</span><span style="color:#00f;font-weight:700">&gt;</span>
        {
            <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">id: </span> <span style="color:#00f;font-weight:700">+</span> b<span style="color:#00f;font-weight:700">.</span>getKey() <span style="color:#00f;font-weight:700">+</span>
                    <span style="color:#036a07">&quot;<span style="color:#26b31a">\n</span> aliases: &quot;</span> <span style="color:#00f;font-weight:700">+</span> <span style="color:#00f;font-weight:700">Arrays</span><span style="color:#00f;font-weight:700">.</span>toString(ctx<span style="color:#00f;font-weight:700">.</span>getAliases(b<span style="color:#00f;font-weight:700">.</span>getKey())) <span style="color:#00f;font-weight:700">+</span> <span style="color:#036a07">&quot;<span style="color:#26b31a">\n</span>&quot;</span>);
        });
        ctx<span style="color:#00f;font-weight:700">.</span>close();
    }
}
</pre></div>
                            </div>
                        </div>
                    </div>
                    <div class="Para" id="Par335">When run, this will produce the following output:</div>
                    <div class="Para" id="Par336">
                        <div class="ProgramCode" id="PC104">
                            <div class="LineGroup">
                                <div class="FixedLine">id: jon</div>
                                <div class="FixedLine"> aliases: jonathan, jim, johnny</div>
                            </div>
                            <div class="LineGroup">
                                <div class="FixedLine">id: jon johnny,jonathan;jim</div>
                                <div class="FixedLine"> aliases:</div>
                            </div>
                        </div>
                    </div>
                    <div class="Para" id="Par337">As you can see, the map with <span class="EmphasisFontCategoryNonProportional">String</span> beans contains two beans, one with the <span class="EmphasisFontCategoryNonProportional">jon</span> unique identifier and three aliases and
                        one with the <span class="EmphasisFontCategoryNonProportional">jon johnny,jonathan;jim</span> unique identifier and no aliases.</div>
                    <div class="Para" id="Par338">Bean name aliasing is a strange beast because it is not something you tend to use when you are building a new application. If you are going to have many other beans inject another bean, they may as well use the same name to access
                        that bean. However, as your application goes into production and maintenance work gets carried out, modifications are made, and so on, bean name aliasing becomes more useful.</div>
                    <div class="Para" id="Par339">Consider the following scenario: you have an application in which 50 beans, configured using Spring, all require an implementation of the <span class="EmphasisFontCategoryNonProportional">Foo</span> interface. Twenty-five of the beans
                        use the <span class="EmphasisFontCategoryNonProportional">StandardFoo</span> implementation with the bean name <span class="EmphasisFontCategoryNonProportional">standardFoo</span>, and the other 25 use the <span class="EmphasisFontCategoryNonProportional">SuperFoo</span>                        implementation with the <span class="EmphasisFontCategoryNonProportional">superFoo</span> bean name. Six months after you put the application into production, you decide to move the first 25 beans to the <span class="EmphasisFontCategoryNonProportional">SuperFoo</span>                        implementation. To do this, you have three options.
                        <div class="UnorderedList">
                            <ul class="UnorderedListMarkBullet">
                                <li>
                                    <div class="Para" id="Par340">The first is to change the implementation class of the <span class="EmphasisFontCategoryNonProportional">standardFoo</span> bean to <span class="EmphasisFontCategoryNonProportional">SuperFoo</span>. The drawback of
                                        this approach is that you have two instances of the <span class="EmphasisFontCategoryNonProportional">SuperFoo</span> class lying around when you really need only one. In addition, you now have two beans to make
                                        changes to when the configuration changes.</div>
                                </li>
                                <li>
                                    <div class="Para" id="Par341">The second option is to update the injection configuration for the 25 beans that are changing, which changes the beans’ names from <span class="EmphasisFontCategoryNonProportional">standardFoo</span> to <span class="EmphasisFontCategoryNonProportional">superFoo</span>.
                                        This approach is not the most elegant way to proceed. You could perform a find and replace, but then rolling back your changes when management isn’t happy means retrieving an old version of your configuration from
                                        your version control system.</div>
                                </li>
                                <li>
                                    <div class="Para" id="Par342">The third, and most ideal, approach is to remove (or comment out) the definition for the <span class="EmphasisFontCategoryNonProportional">standardFoo</span> bean and make <span class="EmphasisFontCategoryNonProportional">standardFoo</span>                                        an alias to <span class="EmphasisFontCategoryNonProportional">superFoo</span>. This change requires minimal effort, and restoring the system to its previous configuration is just as <span id="ITerm134">simple                                      </span>.</div>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="Section3 RenderAsSection3" id="Sec35">
                    <h4 class="Heading">Bean Naming with Annotation Configurations</h4>
                    <div class="Para" id="Par343">When bean definitions are declared using <span id="ITerm135">annotations, bean naming                          </span> is a little different than XML, and there are more interesting things you can do. Let’s start with the basics, though:
                        declaring bean definitions using stereotype annotations (<span class="EmphasisFontCategoryNonProportional">@Component</span> and all its specializations such as <span class="EmphasisFontCategoryNonProportional">Service</span>,
                        <span class="EmphasisFontCategoryNonProportional">Repository</span>, and <span class="EmphasisFontCategoryNonProportional">Controller</span>).</div>
                    <div class="Para ParaOneEmphasisChild" id="Par344">Consider the following <span class="EmphasisFontCategoryNonProportional">Singer</span> class:</div>
                    <div class="Para" id="Par345">
                        <div class="ProgramCode" id="PC105">
                            <div class="LineGroup">
                                <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.annotated</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.stereotype.Component</span>;

@<span style="color:#00f;font-weight:700">Component</span>
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">Singer</span> {
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">String</span> lyric <span style="color:#00f;font-weight:700">=</span> <span style="color:#036a07">We found a message in a bottle we were drinking</span>;

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">sing</span>() {
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(lyric);
    }
}
</pre></div>
                            </div>
                        </div>
                    </div>
                    <div class="Para" id="Par346">This class contains the declaration of a singleton bean of type <span class="EmphasisFontCategoryNonProportional">Singer</span> written using the <span class="EmphasisFontCategoryNonProportional">@Component</span> annotation. The
                        <span class="EmphasisFontCategoryNonProportional">@Component</span> annotation does not have any arguments, so the Spring IoC container decides a unique identifier for the bean. The convention followed in this case is to name the bean, as the class itself, but downcasing the first
                            letter. This means that the bean will be named <span class="EmphasisFontCategoryNonProportional">singer</span>. This convention is respected by other stereotype annotations as well. To test this, the following class can be
                            used:</div>
                    <div class="Para" id="Par347">
                        <div class="ProgramCode" id="PC106">
                            <div class="LineGroup">
                                <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.annotated</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.support.GenericXmlApplicationContext</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">java.util.Arrays</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">java.util.Map</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">AnnotatedBeanNaming</span> {
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span>... <span style="font-style:italic">args</span>) {
        <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span> ctx <span style="color:#00f;font-weight:700">=</span>
                <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span>();
        ctx<span style="color:#00f;font-weight:700">.</span>load(<span style="color:#036a07">classpath:spring/app-context-annotated.xml</span>);
        ctx<span style="color:#00f;font-weight:700">.</span>refresh();
        <span style="color:#00f;font-weight:700">Map&lt;<span style="color:#00f;font-weight:700">String</span>, <span style="color:#00f;font-weight:700">Singer</span>&gt;</span> beans <span style="color:#00f;font-weight:700">=</span>
                ctx<span style="color:#00f;font-weight:700">.</span>getBeansOfType(<span style="color:#00f;font-weight:700">Singer</span><span style="color:#00f;font-weight:700">.</span>class);
        beans<span style="color:#00f;font-weight:700">.</span>entrySet()<span style="color:#00f;font-weight:700">.</span>stream()<span style="color:#00f;font-weight:700">.</span>forEach(b <span style="color:#00f;font-weight:700">-</span><span style="color:#00f;font-weight:700">&gt;</span>
                <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">id: </span> <span style="color:#00f;font-weight:700">+</span> b<span style="color:#00f;font-weight:700">.</span>getKey()));
        ctx<span style="color:#00f;font-weight:700">.</span>close();
    }
}
</pre></div>
                            </div>
                        </div>
                    </div>
                    <div class="Para" id="Par348">The <span class="EmphasisFontCategoryNonProportional">app-context-annotated.xml</span> configuration file contains only a component scanning declaration for <span class="EmphasisFontCategoryNonProportional">com.apress.prospring5.ch3.annotated</span>                        so it won’t be shown again. When the previous class is run, the following output is printed in the console:</div>
                    <div class="Para" id="Par349">
                        <div class="ProgramCode" id="PC107">
                            <div class="FixedLine">id: singer</div>
                        </div>
                    </div>
                    <div class="Para" id="Par350">Thus, using <span class="EmphasisFontCategoryNonProportional">@Component(&quot;singer&quot;)</span> is equivalent to annotating the <span class="EmphasisFontCategoryNonProportional">Singer</span> class with <span class="EmphasisFontCategoryNonProportional">@Component</span>.
                        If you want to name the bean differently, the <span class="EmphasisFontCategoryNonProportional">@Component</span> annotation must receive the bean name as an argument.</div>
                    <div class="Para" id="Par351">
                        <div class="ProgramCode" id="PC108">
                            <div class="LineGroup">
                                <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.annotated</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.stereotype.Component</span>;

@Component(<span style="color:#036a07">johnMayer</span>)
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">Singer</span> {
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">String</span> lyric <span style="color:#00f;font-weight:700">=</span> <span style="color:#036a07">Down there below us, under the clouds</span>;

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">sing</span>() {
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(lyric);
    }
}
</pre></div>
                            </div>
                        </div>
                    </div>
                    <div class="Para ParaOneEmphasisChild" id="Par352">As expected, if <span class="EmphasisFontCategoryNonProportional">AnnotatedBeanNaming</span> is run, the following output is produced:</div>
                    <div class="Para" id="Par353">
                        <div class="ProgramCode" id="PC109">
                            <div class="FixedLine">id: johnMayer</div>
                        </div>
                    </div>
                    <div class="Para" id="Par354">But, what about aliases? <span id="ITerm137">                                                    </span>As the argument for the <span class="EmphasisFontCategoryNonProportional">@Component</span> annotation becomes the unique identifier
                        for the bean, bean aliasing is not possible when declaring the bean in this way. This is where Java configuration comes to the rescue. Let’s consider the following class, which contains a static configuration class defined within
                        it (yes, Spring allows this, and we are being practical here, keeping all the logic in the same file):</div>
                    <div class="Para" id="Par355">
                        <div class="ProgramCode" id="PC110">
                            <div class="LineGroup">
                                <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.config</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.annotated.Singer</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.annotation.AnnotationConfigApplicationContext</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.annotation.Bean</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.annotation.Configuration</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.support.GenericApplicationContext</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.support.GenericXmlApplicationContext</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">java.util.Arrays</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">java.util.Map</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">AliasConfigDemo</span> {
    <span style="color:#00f;font-weight:700">@Configuration</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">AliasBeanConfig</span> {
        <span style="color:#00f;font-weight:700">@Bean</span>
        <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">Singer</span> <span style="color:#0000a2;font-weight:700">singer</span>() {
            <span style="color:#00f;font-weight:700">return</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">Singer</span>();
        }
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span>... <span style="font-style:italic">args</span>) {
        <span style="color:#00f;font-weight:700">GenericApplicationContext</span> ctx <span style="color:#00f;font-weight:700">=</span>
                <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">AnnotationConfigApplicationContext</span>(<span style="color:#00f;font-weight:700">AliasBeanConfig</span><span style="color:#00f;font-weight:700">.</span>class);
        <span style="color:#00f;font-weight:700">Map&lt;<span style="color:#00f;font-weight:700">String</span>, <span style="color:#00f;font-weight:700">Singer</span>&gt;</span> beans <span style="color:#00f;font-weight:700">=</span> ctx<span style="color:#00f;font-weight:700">.</span>getBeansOfType(<span style="color:#00f;font-weight:700">Singer</span><span style="color:#00f;font-weight:700">.</span>class);
        beans<span style="color:#00f;font-weight:700">.</span>entrySet()<span style="color:#00f;font-weight:700">.</span>stream()<span style="color:#00f;font-weight:700">.</span>forEach(b <span style="color:#00f;font-weight:700">-</span><span style="color:#00f;font-weight:700">&gt;</span>
                <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">id: </span> <span style="color:#00f;font-weight:700">+</span> b<span style="color:#00f;font-weight:700">.</span>getKey()
                        <span style="color:#00f;font-weight:700">+</span> <span style="color:#036a07">&quot;<span style="color:#26b31a">\n</span> aliases: &quot;</span>
                        <span style="color:#00f;font-weight:700">+</span> <span style="color:#00f;font-weight:700">Arrays</span><span style="color:#00f;font-weight:700">.</span>toString(ctx<span style="color:#00f;font-weight:700">.</span>getAliases(b<span style="color:#00f;font-weight:700">.</span>getKey())) <span style="color:#00f;font-weight:700">+</span> <span style="color:#036a07">&quot;<span style="color:#26b31a">\n</span>&quot;</span>)
        );
        ctx<span style="color:#00f;font-weight:700">.</span>close();
    }
}
</pre></div>
                        </div>
                    </div>
                </div>
                <div class="Para" id="Par356">This class contains a bean <span id="ITerm138">definition                           </span>for a bean of type <span class="EmphasisFontCategoryNonProportional">Singer</span> declared by annotating the <span class="EmphasisFontCategoryNonProportional">singer()</span>                    method with the <span class="EmphasisFontCategoryNonProportional">@Bean</span> annotation. When no argument is provided for this annotation, the bean unique identifier, its <span class="EmphasisFontCategoryNonProportional">id</span>,
                    becomes the method name. Thus, when the previous class is run, we get the following output:</div>
                <div class="Para" id="Par357">
                    <div class="ProgramCode" id="PC111">
                        <div class="FixedLine">id: singer</div>
                        <div class="FixedLine"> aliases:</div>
                    </div>
                </div>
                <div class="Para" id="Par358">To declare aliases, we make use of the <span class="EmphasisFontCategoryNonProportional">name</span> attribute of the <span class="EmphasisFontCategoryNonProportional">@Bean</span> annotation. This attribute is the default one for this
                    annotation, which means in this case declaring the bean by annotating the <span class="EmphasisFontCategoryNonProportional">singer()</span> method with <span class="EmphasisFontCategoryNonProportional">@Bean</span>, <span class="EmphasisFontCategoryNonProportional">@Bean(&quot;singer&quot;)</span>,
                    or <span class="EmphasisFontCategoryNonProportional">@Bean(name=&quot;singer&quot;)</span> will lead to the same result. The Spring IoC container will create a bean of type <span class="EmphasisFontCategoryNonProportional">Singer</span> and
                    with the <span class="EmphasisFontCategoryNonProportional">singer</span> ID.</div>
                <div class="Para ParaOneEmphasisChild" id="Par359">If the value for this attribute is a string containing an alias-specific separator (space, comma, semicolon), the string will become the ID of the bean. But, if the value for it is an array of strings, the first one becomes the <span class="EmphasisFontCategoryNonProportional">id</span>                    and the others become aliases. Modify the bean configuration as shown here:</div>
                <div class="Para" id="Par360">
                    <div class="ProgramCode" id="PC112">
                        <div class="FixedLine"> <span class="EmphasisTypeUnderline"><pre style="background:#fff;color:#000">@<span style="color:#00f;font-weight:700">Configuration</span>
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">AliasBeanConfig</span> {
    <span style="color:#00f;font-weight:700">@Bean</span>(<span style="color:#c5060b;font-weight:700">name</span> <span style="color:#00f;font-weight:700">=</span> {<span style="color:#036a07">johnMayer</span>, <span style="color:#036a07">john</span>, <span style="color:#036a07">jonathan</span>, <span style="color:#036a07">johnny</span>})
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">Singer</span> <span style="color:#0000a2;font-weight:700">singer</span>() {
        <span style="color:#00f;font-weight:700">return</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">Singer</span>();
    }
}
</pre></div>
                    </div>
                </div>
                <div class="Para ParaOneEmphasisChild" id="Par361">When running the <span class="EmphasisFontCategoryNonProportional">AliasConfigDemo</span> class, the output will change to the following:</div>
                <div class="Para" id="Par362">
                    <div class="ProgramCode" id="PC113">
                        <div class="FixedLine">id: johnMayer</div>
                        <div class="FixedLine"> aliases: jonathan, johnny, john</div>
                    </div>
                </div>
                <div class="Para" id="Par363">When it comes to aliases, in Spring 4.2 the <span class="EmphasisFontCategoryNonProportional">@AliasFor</span> annotation was introduced. This annotation is used to declare aliases for annotation attributes, and most Spring annotations
                    make use of it. For example, the <span class="EmphasisFontCategoryNonProportional">@Bean</span> annotation has two attributes, <span class="EmphasisFontCategoryNonProportional">name</span> and <span class="EmphasisFontCategoryNonProportional">value</span>,
                    which are declared as aliases for each other. Using this annotation, they are explicit aliases. The following code snippet is a snapshot of the <span class="EmphasisFontCategoryNonProportional">@Bean</span> annotation code and is taken
                    from the official Spring GitHub repository. The code and documentation that are not relevant at the moment were skipped:<a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_3_Chapter.html#Fn4" id="Fn4_source"><sup>4</sup></a> </div>
                <div class="Para" id="Par365">
                    <div class="ProgramCode" id="PC114">
                        <div class="LineGroup">
                            <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">org.springframework.context.annotation</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">java.lang.annotation.Documented</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">java.lang.annotation.ElementType</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">java.lang.annotation.Retention</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">java.lang.annotation.RetentionPolicy</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">java.lang.annotation.Target</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.core.annotation.AliasFor</span>;
.<span style="color:#00f;font-weight:700">.</span>.

@Target({<span style="color:#00f;font-weight:700">ElementType</span><span style="color:#c5060b;font-weight:700"><span style="color:#00f;font-weight:700">.</span>METHOD</span>, <span style="color:#00f;font-weight:700">ElementType</span><span style="color:#c5060b;font-weight:700"><span style="color:#00f;font-weight:700">.</span>ANNOTATION_TYPE</span>})
@Retention(<span style="color:#00f;font-weight:700">RetentionPolicy</span><span style="color:#c5060b;font-weight:700"><span style="color:#00f;font-weight:700">.</span>RUNTIME</span>)
@<span style="color:#00f;font-weight:700">Documented</span>
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">@interface</span> <span style="text-decoration:underline">Bean</span> {
    <span style="color:#00f;font-weight:700">@AliasFor</span>(<span style="color:#036a07">name</span>)
    <span style="color:#00f;font-weight:700">String</span> <span style="color:#0000a2;font-weight:700">value</span>() default {};

    <span style="color:#00f;font-weight:700">@AliasFor</span>(<span style="color:#036a07">value</span>)
    <span style="color:#00f;font-weight:700">String</span> <span style="color:#0000a2;font-weight:700">name</span>() default {};
        .<span style="color:#00f;font-weight:700">.</span>.
}
</pre></div>
                        </div>
                    </div>
                </div>
                <div class="Para" id="Par366">Here’s an example. Declare an annotation called <span class="EmphasisFontCategoryNonProportional">@Award</span> that can be used on <span class="EmphasisFontCategoryNonProportional">Singer</span> instances, of course.</div>
                <div class="Para" id="Par367">
                    <div class="ProgramCode" id="PC115">
                        <div class="LineGroup">
                            <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.annotated</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.core.annotation.AliasFor</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">@interface</span> <span style="text-decoration:underline">Award</span> {
    <span style="color:#00f;font-weight:700">@AliasFor</span>(<span style="color:#036a07">prize</span>)
    <span style="color:#00f;font-weight:700">String</span> <span style="color:#0000a2;font-weight:700">value</span>() default {};

    <span style="color:#00f;font-weight:700">@AliasFor</span>(<span style="color:#036a07">value</span>)
    <span style="color:#00f;font-weight:700">String</span> <span style="color:#0000a2;font-weight:700">prize</span>() default {};
}
</pre></div>
                        </div>
                    </div>
                </div>
                <div class="Para" id="Par368">Using this annotation, you can modify the <span class="EmphasisFontCategoryNonProportional">Singer</span> class like <span id="ITerm140">this                          </span>:</div>
                <div class="Para" id="Par369">
                    <div class="ProgramCode" id="PC116">
                        <div class="LineGroup">
                            <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.annotated</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.beans.factory.annotation.Qualifier</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.stereotype.Component</span>;

@Component(<span style="color:#036a07">johnMayer</span>)
@Award(prize <span style="color:#00f;font-weight:700">=</span> {<span style="color:#036a07">grammy</span>, <span style="color:#036a07">platinum disk</span>})
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">Singer</span> {
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">String</span> lyric <span style="color:#00f;font-weight:700">=</span> <span style="color:#036a07">We found a message in a bottle we were drinking</span>;

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">sing</span>() {
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(lyric);
    }
}
</pre></div>
                        </div>
                    </div>
                </div>
                <div class="Para" id="Par370">The previous annotation is equivalent to <span class="EmphasisFontCategoryNonProportional">@Award(value={&quot;grammy&quot;, &quot;platinum disk&quot;})</span> and to <span class="EmphasisFontCategoryNonProportional">@Award({&quot;grammy&quot;, &quot;platinum disk&quot;})</span>.</div>
                <div class="Para" id="Par371">But something more interesting can be done with the <span class="EmphasisFontCategoryNonProportional">@AliasFor</span> annotation: aliases for meta-annotation attributes can be declared. In the following code snippet, we declare a specialization
                    for the <span class="EmphasisFontCategoryNonProportional">@Award</span> annotation that declares an attribute named <span class="EmphasisFontCategoryNonProportional">name</span>, which is an alias for the <span class="EmphasisFontCategoryNonProportional">value</span>                    attribute of the <span class="EmphasisFontCategoryNonProportional">@Award</span> annotation. And we do this because we want to make it obvious that the argument is a unique bean identifier.</div>
                    <div class="Para" id="Par372">
                        <div class="ProgramCode" id="PC117">
                            <div class="LineGroup">
                                <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.annotated</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.core.annotation.AliasFor</span>;

@<span style="color:#00f;font-weight:700">Award</span>
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">@interface</span> <span style="text-decoration:underline">Trophy</span> {
    <span style="color:#00f;font-weight:700">@AliasFor</span>(<span style="color:#c5060b;font-weight:700">annotation</span> <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">Award</span><span style="color:#00f;font-weight:700">.</span>class, <span style="color:#c5060b;font-weight:700">attribute</span> <span style="color:#00f;font-weight:700">=</span> <span style="color:#036a07">value</span>)
    <span style="color:#00f;font-weight:700">String</span> <span style="color:#0000a2;font-weight:700">name</span>() default {};
}
</pre></div>
                            </div>
                        </div>
                    </div>
                    <div class="Para ParaOneEmphasisChild" id="Par373">Thus, instead of writing the <span class="EmphasisFontCategoryNonProportional">Singer</span> class like this:</div>
                    <div class="Para" id="Par374">
                        <div class="ProgramCode" id="PC118">
                            <div class="LineGroup">
                                <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.annotated</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.stereotype.Component</span>;

@Component(<span style="color:#036a07">johnMayer</span>)
@Award(value <span style="color:#00f;font-weight:700">=</span> {<span style="color:#036a07">grammy</span>, <span style="color:#036a07">platinum disk</span>})
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">Singer</span> {
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">String</span> lyric <span style="color:#00f;font-weight:700">=</span> <span style="color:#036a07">We found a message in a bottle we were drinking</span>;

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">sing</span>() {
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(lyric);
    }
}
</pre></div>
                            </div>
                        </div>
                    </div>
                    <div class="Para" id="Par375">we can write it like this: <span id="ITerm141">                                                    </span> </div>
                    <div class="Para" id="Par376">
                        <div class="ProgramCode" id="PC119">
                            <div class="LineGroup">
                                <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.annotated</span>;

@Component(<span style="color:#036a07">johnMayer</span>)
@Trophy(name <span style="color:#00f;font-weight:700">=</span> {<span style="color:#036a07">grammy</span>, <span style="color:#036a07">platinum disk</span>})
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">Singer</span> {
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">String</span> lyric <span style="color:#00f;font-weight:700">=</span> <span style="color:#036a07">We found a message in a bottle we were drinking</span>;

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">sing</span>() {
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(lyric);
    }
}
</pre></div>
                            </div>
                        </div>
                    </div>
                    <div class="Para ParaTypeImportant" id="Par377"> <img alt="A315511_5_En_3_Figa_HTML.jpg" data-mfp-src="/library/view/pro-spring-5/9781484228081/A315511_5_En_3_Figa_HTML.jpg" height="28" src="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_3_Figa_HTML.jpg" width="30"/>                        Creating aliases for attributes of annotations using yet another annotation <span class="EmphasisFontCategoryNonProportional">@AliasFor</span> does have limitations. <span class="EmphasisFontCategoryNonProportional">@AliasFor</span>                        cannot be used on any stereotype annotations (<span class="EmphasisFontCategoryNonProportional">@Component</span> and its specializations). The reason is that the special handling of these <span class="EmphasisFontCategoryNonProportional">value</span>                        attributes was in place years before <span class="EmphasisFontCategoryNonProportional">@AliasFor</span> was invented. Consequently, because of backward compatibility issues, it is simply not possible to use <span class="EmphasisFontCategoryNonProportional">@AliasFor</span>                        with such value attributes. When writing code to do just so (aliasing <span class="EmphasisFontCategoryNonProportional">value</span> attributes in stereotype annotations), no compile errors will be shown to you, and the code might
                        even run, but any argument provided for the alias will be ignored. The same goes for the <span class="EmphasisFontCategoryNonProportional">@Qualifier</span> annotation as well.</div>
                    </div>
                    </div>
                    <div class="Section2 RenderAsSection2" id="Sec36">
                        <h3 class="Heading">Understanding <span id="ITerm142">Bean Instantiation Mode                      </span> </h3>
                        <div class="Para" id="Par378">By default, all beans in Spring are singletons. This means Spring maintains a single instance of the bean, all dependent objects use the same instance, and all calls to <span class="EmphasisFontCategoryNonProportional">ApplicationContext.getBean()</span>                            return the same instance. We demonstrated this in the previous section, where we were able to use identity comparison <span class="EmphasisFontCategoryNonProportional">(==)</span> rather than the <span class="EmphasisFontCategoryNonProportional">equals()</span>                            comparison to check whether the beans were the same.</div>
                        <div class="Para" id="Par379">The term <span class="EmphasisTypeItalic">singleton</span> is used interchangeably in Java to refer to two distinct concepts: an object that has a single instance within the application and the Singleton design pattern. We refer
                            to the first concept as a <span class="EmphasisTypeItalic">singleton</span> and to the Singleton pattern as Singleton. The Singleton design pattern was popularized in the seminal <span class="EmphasisTypeItalic">Design Patterns: Elements of Reusable Object-Oriented</span>                            <span id="ITerm143">                <span class="EmphasisTypeItalic">Software</span> </span> by Erich Gamma et al. (Addison-Wesley, 1994). The problem arises when people confuse the need for singleton instances with the need
                            to apply the Singleton pattern. The following code snippet shows a typical implementation of the Singleton pattern in Java:</div>
                        <div class="Para" id="Par380">
                            <div class="ProgramCode" id="PC120">
                                <div class="LineGroup">
                                    <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">Singleton</span> {
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">Singleton</span> instance;

    <span style="color:#00f;font-weight:700">static</span> {
        instance <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">Singleton</span>();
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">Singleton</span> <span style="color:#0000a2;font-weight:700">getInstance</span>() {
        <span style="color:#00f;font-weight:700">return</span> instance;
    }
}
</pre></div>
                                </div>
                            </div>
                        </div>
                        <div class="Para" id="Par381">This pattern achieves its goal of allowing you to maintain and access a single instance of a class throughout your application, but it does so at the expense of increased coupling. Your application code must always have explicit
                            knowledge of the Singleton class in order to obtain the instance—completely removing the ability to code to interfaces.</div>
                        <div class="Para" id="Par382">In reality, the Singleton pattern is actually two patterns in one. The first, and desired, pattern involves maintenance of a single instance of an object. The second, and less desirable, is a pattern for object lookup that completely
                            removes the possibility of using interfaces. Using the Singleton pattern also makes it difficult to swap out implementations arbitrarily because most objects that require the Singleton instance access the Singleton object directly.
                            This can cause all kinds of headaches when you are trying to unit test your application because you are unable to replace the Singleton with a mock for testing purposes.</div>
                        <div class="Para ParaOneEmphasisChild" id="Par383">Fortunately, with Spring you can take advantage of the singleton instantiation model without having to work around the Singleton design pattern. All beans in Spring are, by default, created as Singleton instances, and Spring uses
                            the same instances to fulfill all requests for that bean. Of course, Spring is not just limited to the use of the Singleton instance; it can still create a new instance of the bean to satisfy every dependency and every call
                            to <span class="EmphasisFontCategoryNonProportional">getBean()</span>. It does all of this without any impact on your application code, and for this reason, we like to refer to Spring as being instantiation mode agnostic. This
                            is a powerful concept. If you start off with an object that is a singleton but then discover it is not really suited to multithread access, you can change it to a nonsingleton (prototype) without affecting any of your application
                            code.</div>
                        <div class="Para ParaTypeImportant" id="Par384"> <img alt="A315511_5_En_3_Figa_HTML.jpg" data-mfp-src="/library/view/pro-spring-5/9781484228081/A315511_5_En_3_Figa_HTML.jpg" height="28" src="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_3_Figa_HTML.jpg" width="30"/>                            Although changing the instantiation mode of your bean won’t affect your application code, it does cause some problems if you rely on Spring’s life-cycle interfaces. We cover this in more detail in Chapter <span class="ExternalRef"><a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_4_Chapter.html"><span class="RefSource">4</span></a>
                            </span>.</div>
                        <div class="Para" id="Par385">Changing the instantiation <span id="ITerm144">mode                      </span> from singleton to nonsingleton is simple. The following configuration snippets present how this is done in XML and using annotations:</div>
                        <div class="Para" id="Par386">
                            <div class="ProgramCode" id="PC121">
                                <div class="LineGroup">
                                    <div class="FixedLine">&lt;!-- app-context-xml.xml --&gt;</div>
                                    <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#1c02ff">&lt;<span style="font-weight:700">beans</span> ...&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">nonSingleton</span> <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch3.annotated.Singer</span>
scope=<span style="color:#036a07">prototype</span> <span style="font-style:italic">c</span>:_0=<span style="color:#036a07">John Mayer</span>/&gt;</span>
<span style="color:#1c02ff">&lt;/<span style="font-weight:700">beans</span>&gt;</span>
</pre></div>
                                </div>
                                <div class="LineGroup">
                                    <div class="FixedLine">\\Singer.java</div>
                                    <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.annotated</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.beans.factory.annotation.Value</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.annotation.Scope</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.stereotype.Component</span>;

@Component(<span style="color:#036a07">nonSingleton</span>)
@Scope(<span style="color:#036a07">prototype</span>)
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">Singer</span> {
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">String</span> name <span style="color:#00f;font-weight:700">=</span> <span style="color:#036a07">unknown</span>;

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#0000a2;font-weight:700">Singer</span>(@<span style="color:#00f;font-weight:700">Value</span>(&quot;<span style="color:#00f;font-weight:700">John</span> <span style="color:#00f;font-weight:700">Mayer</span>&quot;) String name) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>name <span style="color:#00f;font-weight:700">=</span> name;
    }
}
</pre></div>
                                </div>
                            </div>
                        </div>
                        <div class="Para ParaOneEmphasisChild" id="Par387">In the XML configuration, the <span class="EmphasisFontCategoryNonProportional">Singer</span> class can be used as a type for a bean declared in XML. If component scanning is not enabled, the annotations in the class will simply
                            be ignored.</div>
                        <div class="Para" id="Par388">As you can see, the only difference between this bean declaration and any of the declarations you have seen so far is that we add the <span class="EmphasisFontCategoryNonProportional">scope</span> attribute and set the value to
                            <span class="EmphasisFontCategoryNonProportional">prototype</span>. Spring defaults the scope to the value <span class="EmphasisFontCategoryNonProportional">singleton</span>. The prototype scope instructs Spring to instantiate
                            a new instance of the bean every time a bean instance is requested by the application. The following code snippet shows the effect this setting has on your application:</div>
                        <div class="Para" id="Par389">
                            <div class="ProgramCode" id="PC122">
                                <div class="LineGroup">
                                    <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.annotated.Singer</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.support.GenericXmlApplicationContext</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">NonSingletonDemo</span> {
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span>... <span style="font-style:italic">args</span>) {
        <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span> ctx <span style="color:#00f;font-weight:700">=</span>
                <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span>();
        ctx<span style="color:#00f;font-weight:700">.</span>load(<span style="color:#036a07">classpath:spring/app-context-xml.xml</span>);
        ctx<span style="color:#00f;font-weight:700">.</span>refresh();
        <span style="color:#00f;font-weight:700">Singer</span> singer1 <span style="color:#00f;font-weight:700">=</span> ctx<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#036a07">nonSingleton</span>, <span style="color:#00f;font-weight:700">Singer</span><span style="color:#00f;font-weight:700">.</span>class);
        <span style="color:#00f;font-weight:700">Singer</span> singer2 <span style="color:#00f;font-weight:700">=</span> ctx<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#036a07">nonSingleton</span>, <span style="color:#00f;font-weight:700">Singer</span><span style="color:#00f;font-weight:700">.</span>class);
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">Identity Equal?: </span> <span style="color:#00f;font-weight:700">+</span> (singer1 <span style="color:#00f;font-weight:700">==</span> singer2));
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">Value Equal:? </span> <span style="color:#00f;font-weight:700">+</span> singer1<span style="color:#00f;font-weight:700">.</span>equals(singer2));
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(singer1);
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(singer2);
        ctx<span style="color:#00f;font-weight:700">.</span>close();
    }
}
</pre></div>
                                </div>
                            </div>
                        </div>
                        <div class="Para" id="Par390">Running this example gives you the following output:</div>
                        <div class="Para" id="Par391">
                            <div class="ProgramCode" id="PC123">
                                <div class="FixedLine">Identity Equal?: false</div>
                                <div class="FixedLine">Value Equal:? false</div>
                                <div class="FixedLine">John Mayer</div>
                                <div class="FixedLine">John Mayer</div>
                            </div>
                        </div>
                        <div class="Para ParaOneEmphasisChild" id="Par392">You can see from this that although the values of the two <span class="EmphasisFontCategoryNonProportional">String</span> objects are clearly equal, the identities are not, even though both instances were retrieved using the same
                            bean name.</div>
                        <div class="Section3 RenderAsSection3" id="Sec37">
                            <h4 class="Heading">Choosing an Instantiation Mode</h4>
                            <div class="Para" id="Par393">In most scenarios, it is quite easy to see which instantiation mode is suitable. Typically, you will find that singleton is the default mode for your beans. In general, singletons should be used in the following scenarios:
                                <div class="UnorderedList">
                                    <ul class="UnorderedListMarkBullet">
                                        <li>
                                            <div class="Para ParaOneEmphasisChild" id="Par394"> <span class="EmphasisTypeItalic">Shared object with no state</span>: You have an object that maintains no state and has many dependent objects. Because you do not need synchronization if there is no state, you
                                                do not need to create a new instance of the bean each time a dependent object needs to use it for some processing.</div>
                                        </li>
                                        <li>
                                            <div class="Para ParaOneEmphasisChild" id="Par395"> <span class="EmphasisTypeItalic">Shared object with read-only state</span>: This is similar to the previous point, but you have some read-only state. In this case, you still do not need synchronization, so creating
                                                an instance to satisfy each request for the bean is just adding overhead.</div>
                                        </li>
                                        <li>
                                            <div class="Para" id="Par396"> <span class="EmphasisTypeItalic">Shared object with shared</span> <span id="ITerm146">                        <span class="EmphasisTypeItalic">state</span> </span>: If you have a bean that has state that must
                                                be shared, singleton is the ideal choice. In this case, ensure that your synchronization for state writes is as granular as possible.</div>
                                        </li>
                                        <li>
                                            <div class="Para ParaOneEmphasisChild" id="Par397"> <span class="EmphasisTypeItalic">High-throughput objects with writable state</span>: If you have a bean that is used a great deal in your application, you may find that keeping a singleton and synchronizing
                                                all write access to the bean state allows for better performance than constantly creating hundreds of instances of the bean. When using this approach, try to keep the synchronization as granular as possible
                                                without sacrificing consistency. You will find that this approach is particularly useful when your application creates a large number of instances over a long period of time, when your shared object has
                                                only a small amount of writable state, or when the instantiation of a new instance is expensive.</div>
                                        </li>
                                    </ul>
                            </div>
                        </div>
                        <div class="Para" id="Par398">You should consider using nonsingletons in the following scenarios:
                            <div class="UnorderedList">
                                <ul class="UnorderedListMarkBullet">
                                    <li>
                                        <div class="Para ParaOneEmphasisChild" id="Par399"> <span class="EmphasisTypeItalic">Objects with writable state</span>: If you have a bean that has a lot of writable state, you may find that the cost of synchronization is greater than the cost of creating a new
                                            instance to handle each request from a dependent object.</div>
                                    </li>
                                    <li>
                                        <div class="Para ParaOneEmphasisChild" id="Par400"> <span class="EmphasisTypeItalic">Objects with private state</span>: Some dependent objects need a bean that has private state so that they can conduct their processing separately from other objects that depend on
                                            that bean. In this case, singleton is clearly not suitable, and you should use nonsingleton.</div>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div class="Para" id="Par401">The main positive you gain from Spring’s instantiation management is that your applications can immediately benefit from the lower memory usage associated with singletons, with very little effort on your part. Then, if you find
                            that singleton mode does not meet the needs of your application, it is a trivial task to modify your configuration to use non-singleton <span id="ITerm147">mode                          </span>.</div>
                    </div>
                    <div class="Section3 RenderAsSection3" id="Sec38">
                        <h4 class="Heading">Implementing Bean <span id="ITerm148">Scopes                          </span> </h4>
                        <div class="Para" id="Par402">In addition to the singleton and prototype scopes, other scopes exist when defining a Spring bean for more specific purposes. You can also implement your own custom scope and register it in Spring’s <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>.
                            The following bean scopes are supported as of version 4:
                            <div class="UnorderedList">
                                <ul class="UnorderedListMarkBullet">
                                    <li>
                                        <div class="Para ParaOneEmphasisChild" id="Par403"> <span class="EmphasisTypeItalic">Singleton</span>: The default singleton scope. Only one object will be created per Spring IoC container.</div>
                                    </li>
                                    <li>
                                        <div class="Para ParaOneEmphasisChild" id="Par404"> <span class="EmphasisTypeItalic">Prototype</span>: A new instance will be created by Spring when requested by the application.</div>
                                    </li>
                                    <li>
                                        <div class="Para ParaOneEmphasisChild" id="Par405"> <span class="EmphasisTypeItalic">Request</span>: For web application use. When using Spring MVC for web applications, beans with request scope will be instantiated for every HTTP request and then destroyed when
                                            the request is completed.</div>
                                    </li>
                                    <li>
                                        <div class="Para ParaOneEmphasisChild" id="Par406"> <span class="EmphasisTypeItalic">Session</span>: For web application use. When using Spring MVC for web applications, beans with session scope will be instantiated for every HTTP session and then destroyed when
                                            the session is over.</div>
                                    </li>
                                    <li>
                                        <div class="Para ParaOneEmphasisChild" id="Par407"> <span class="EmphasisTypeItalic">Global session</span>: For portlet-based web applications. The global session scope beans can be shared among all portlets within the same Spring MVC–powered portal application.</div>
                                    </li>
                                    <li>
                                        <div class="Para ParaOneEmphasisChild" id="Par408"> <span class="EmphasisTypeItalic">Thread</span>: A new bean instance will be created by Spring when requested by a new thread, while for the same thread, the same bean instance will be returned. Note that this scope
                                            is not registered by default.</div>
                                    </li>
                                    <li>
                                        <div class="Para" id="Par409"> <span class="EmphasisTypeItalic">Custom</span>: Custom bean scope that can be created by implementing the interface <span class="EmphasisFontCategoryNonProportional">org.springframework.beans.factory.config.Scope</span>                                            and registering the custom scope in Spring’s configuration (for XML, use the class <span class="EmphasisFontCategoryNonProportional">org.springframework.beans.factory.config.CustomScopeConfigurer</span>).</div>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    </div>
                    </div>
                    <div class="Section1 RenderAsSection1" id="Sec39">
                        <h2 class="Heading">Resolving Dependencies</h2>
                        <div class="Para" id="Par410">During normal operation, Spring is able to <span id="ITerm149">resolve dependencies                  </span> by simply looking at your configuration file or annotations in your classes. In this way, Spring can ensure that each
                            bean is configured in the correct order so that each bean has its dependencies correctly configured. If Spring did not perform this and just created the beans and configured them in any order, a bean could be created and configured
                            before its dependencies. This is obviously not what you want and would cause all sorts of problems within your application.</div>
                        <div class="Para" id="Par411">Unfortunately, Spring is not aware of any dependencies that exist between beans in your code that are not specified in the configuration. For instance, take one bean, called <span id="ITerm150">              <span class="EmphasisFontCategoryNonProportional">johnMayer</span>                            </span>, of type <span class="EmphasisFontCategoryNonProportional">Singer</span>, which obtains an instance of another bean, called <span class="EmphasisFontCategoryNonProportional">gopher</span>, of type <span class="EmphasisFontCategoryNonProportional">Guitar</span>                            using <span class="EmphasisFontCategoryNonProportional">ctx.getBean()</span> and uses it when the <span class="EmphasisFontCategoryNonProportional">johnMayer.sing()</span> method is called. In this method, you get an instance
                            of type <span class="EmphasisFontCategoryNonProportional">Guitar</span> by calling <span class="EmphasisFontCategoryNonProportional">ctx.getBean(&quot;gopher&quot;)</span>, without asking Spring to inject the dependency for you. In this
                            case, Spring is unaware that <span class="EmphasisFontCategoryNonProportional">johnMayer</span> depends on <span class="EmphasisFontCategoryNonProportional">gopher</span>, and, as a result, it may instantiate <span class="EmphasisFontCategoryNonProportional">johnMayer</span>                            before <span class="EmphasisFontCategoryNonProportional">gopher</span>. You can provide Spring with additional information about your bean dependencies using the <span class="EmphasisFontCategoryNonProportional">depends-on</span>                            attribute of the <span class="EmphasisFontCategoryNonProportional">&lt;bean&gt;</span> tag. The following configuration snippet (contained in a file named <span class="EmphasisFontCategoryNonProportional">app-context-01.xml</span>)
                            shows how the scenario for <span class="EmphasisFontCategoryNonProportional">johnMayer</span> and <span class="EmphasisFontCategoryNonProportional">gopher</span> would be configured:</div>
                        <div class="Para" id="Par412">
                            <div class="ProgramCode" id="PC124">
                                <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#1c02ff">&lt;<span style="font-weight:700">beans</span> ...<span style="color:#036a07">&gt;

&lt;bean id=</span>johnMayer<span style="color:#036a07"> class=</span>com.apress.prospring5.ch3.xml.Singer<span style="color:#036a07">

depends-on=</span>gopher<span style="color:#036a07">/&gt;

&lt;bean id=</span>gopher<span style="color:#036a07"> class=</span>com.apress.prospring5.ch3.xml.Guitar<span style="color:#036a07">&quot;/&gt;

&lt;/beans&gt;
</span></span></pre></div>
                            </div>
                        </div>
                        <div class="Para" id="Par413">In this configuration, we are asserting that bean <span class="EmphasisFontCategoryNonProportional">johnMayer</span> depends on bean <span class="EmphasisFontCategoryNonProportional">gopher</span>. Spring should take this into
                            consideration when instantiating the beans and ensure that <span class="EmphasisFontCategoryNonProportional">gopher</span> is created before <span class="EmphasisFontCategoryNonProportional">johnMayer</span>. To do this, though,
                            <span class="EmphasisFontCategoryNonProportional">johnMayer</span> needs to access <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>. Thus, we also have to tell Spring to inject this reference, so
                            when the <span class="EmphasisFontCategoryNonProportional">johnMayer.sing()</span> method will be called, it can be used to procure the <span class="EmphasisFontCategoryNonProportional">gopher</span> bean. This is done by making
                            the <span class="EmphasisFontCategoryNonProportional">Singer</span> bean implement the <span class="EmphasisFontCategoryNonProportional">ApplicationContextAware</span> interface. This is a Spring-specific interface that forces
                            an implementation of a setter for an <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> object. It is automatically detected by the Spring IoC container, and the <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>                            that the bean is created in is injected into it. This is done after the constructor of the bean is called, so obviously using <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> in the constructor will
                            lead to a <span id="ITerm151">              <span class="EmphasisFontCategoryNonProportional">NullPointerException</span> </span>. You can see the code of the <span class="EmphasisFontCategoryNonProportional">Singer</span>                            class here:</div>
                        <div class="Para" id="Par414">
                            <div class="ProgramCode" id="PC125">
                                <div class="LineGroup">
                                    <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.xml</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.beans.BeansException</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.ApplicationContext</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.ApplicationContextAware</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">Singer</span> <span style="color:#00f;font-weight:700">implements</span> <span style="font-style:italic">ApplicationContextAware</span> {
    <span style="color:#00f;font-weight:700">ApplicationContext</span> ctx;

    <span style="color:#00f;font-weight:700">@Override</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setApplicationContext</span>(
            <span style="color:#00f;font-weight:700">ApplicationContext</span> <span style="font-style:italic">applicationContext</span>) <span style="color:#00f;font-weight:700">throws</span> <span style="color:#00f;font-weight:700">BeansException</span> {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>ctx <span style="color:#00f;font-weight:700">=</span> applicationContext;
    }

    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">Guitar</span> guitar;

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#0000a2;font-weight:700">Singer</span>() {
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">sing</span>() {
        guitar <span style="color:#00f;font-weight:700">=</span> ctx<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#036a07">gopher</span>, <span style="color:#00f;font-weight:700">Guitar</span><span style="color:#00f;font-weight:700">.</span>class);
        guitar<span style="color:#00f;font-weight:700">.</span>sing();
    }
}
</pre></div>
                                </div>
                            </div>
                        </div>
                        <div class="Para" id="Par415">The <span class="EmphasisFontCategoryNonProportional">Guitar</span> class is quite simple; it contains only the <span class="EmphasisFontCategoryNonProportional">sing</span> method and is shown here:</div>
                        <div class="Para" id="Par416">
                            <div class="ProgramCode" id="PC126">
                                <div class="LineGroup">
                                    <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.xml</span>;
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">Guitar</span> {
        <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">sing</span>(){
                <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">Cm Eb Fm Ab Bb</span>);
        }
}
</pre></div>
                                </div>
                            </div>
                        </div>
                        <div class="Para" id="Par417">To test this example, you can use the following class:</div>
                        <div class="Para" id="Par418">
                            <div class="ProgramCode" id="PC127">
                                <div class="LineGroup">
                                    <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.xml</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.support.GenericXmlApplicationContext</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">DependsOnDemo</span> {
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span>... <span style="font-style:italic">args</span>) {
        <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span>
                ctx <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span>();
        ctx<span style="color:#00f;font-weight:700">.</span>load(<span style="color:#036a07">classpath:spring/app-context-01.xml</span>);
        ctx<span style="color:#00f;font-weight:700">.</span>refresh();
        <span style="color:#00f;font-weight:700">Singer</span> johnMayer <span style="color:#00f;font-weight:700">=</span> ctx<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#036a07">johnMayer</span>, <span style="color:#00f;font-weight:700">Singer</span><span style="color:#00f;font-weight:700">.</span>class);
        johnMayer<span style="color:#00f;font-weight:700">.</span>sing();
        ctx<span style="color:#00f;font-weight:700">.</span>close();
    }
}
</pre></div>
                                </div>
                            </div>
                        </div>
                        <div class="Para" id="Par419">Of course, there is an annotation <span id="ITerm153">configuration                  </span> equivalent to the previous XML configuration. <span class="EmphasisFontCategoryNonProportional">Singer</span> and <span class="EmphasisFontCategoryNonProportional">Guitar</span>                            must be declared as beans using one of the stereotype annotations (in this case <span class="EmphasisFontCategoryNonProportional">@Component</span> will be used). The novelty here is the <span class="EmphasisFontCategoryNonProportional">@DependsOn</span>                            annotation, which is placed on the <span class="EmphasisFontCategoryNonProportional">Singer</span> class. This is the equivalent of the <span class="EmphasisFontCategoryNonProportional">depends-on</span> attribute from the
                            XML configuration.</div>
                        <div class="Para" id="Par420">
                            <div class="ProgramCode" id="PC128">
                                <div class="LineGroup">
                                    <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.annotated</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.beans.BeansException</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.ApplicationContext</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.ApplicationContextAware</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.annotation.DependsOn</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.stereotype.Component</span>;

@Component(<span style="color:#036a07">johnMayer</span>)
@DependsOn(<span style="color:#036a07">gopher</span>)
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">Singer</span> <span style="color:#00f;font-weight:700">implements</span> <span style="font-style:italic">ApplicationContextAware</span> {
    <span style="color:#00f;font-weight:700">ApplicationContext</span> applicationContext;

    <span style="color:#00f;font-weight:700">@Override</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setApplicationContext</span>(<span style="color:#00f;font-weight:700">ApplicationContext</span>
                                              <span style="font-style:italic">applicationContext</span>) <span style="color:#00f;font-weight:700">throws</span> <span style="color:#00f;font-weight:700">BeansException</span> {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>applicationContext <span style="color:#00f;font-weight:700">=</span> applicationContext;
    }

    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">Guitar</span> guitar;

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#0000a2;font-weight:700">Singer</span>() {
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">sing</span>() {
        guitar <span style="color:#00f;font-weight:700">=</span> applicationContext<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#036a07">gopher</span>, <span style="color:#00f;font-weight:700">Guitar</span><span style="color:#00f;font-weight:700">.</span>class);
        guitar<span style="color:#00f;font-weight:700">.</span>sing();
    }
}
</pre></div>
                                </div>
                            </div>
                        </div>
                        <div class="Para" id="Par421">All you have to do now is enable component <span id="ITerm154">scanning                   </span>and then use, in the <span class="EmphasisFontCategoryNonProportional">DependsOnDemo</span> class, <span class="EmphasisFontCategoryNonProportional">application- context-02.xml</span>,
                            to create <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>.</div>
                        <div class="Para" id="Par422">
                            <div class="ProgramCode" id="PC129">
                                <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#06f;font-style:italic">&lt;!-- application-context-02.xml --&gt;</span>
<span style="color:#1c02ff">&lt;<span style="font-weight:700">beans</span>...&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">context</span><span style="font-weight:700">:</span><span style="font-weight:700">component-scan</span>
            <span style="font-style:italic">base-package</span>=<span style="color:#036a07">com.apress.prospring5.ch3.annotated</span>/&gt;</span>
<span style="color:#1c02ff">&lt;/<span style="font-weight:700">beans</span>&gt;</span>
</pre></div>
                            </div>
                        </div>
                        <div class="Para" id="Par423">The example will run, and the output will be “Cm Eb Fm Ab Bb.”</div>
                        <div class="Para" id="Par424">When developing your applications, avoid designing them to use this feature; instead, define your dependencies by means of setter and constructor injection contracts. However, if you are integrating Spring with legacy code, you
                            may find that the dependencies defined in the code require you to provide extra information to the Spring Framework.</div>
                    </div>
                    <div class="Section1 RenderAsSection1" id="Sec40">
                        <h2 class="Heading">Autowiring Your Bean</h2>
                        <div class="Para" id="Par425">Spring supports five modes for <span id="ITerm155">autowiring                  </span>.
                            <div class="UnorderedList">
                                <ul class="UnorderedListMarkBullet">
                                    <li>
                                        <div class="Para" id="Par426"> <span class="EmphasisFontCategoryNonProportional">byName</span>: When using <span class="EmphasisFontCategoryNonProportional">byName</span> autowiring, Spring attempts to wire each property to a bean of the same
                                            name. So, if the target bean has a property named <span class="EmphasisFontCategoryNonProportional">foo</span> and a <span class="EmphasisFontCategoryNonProportional">foo</span> bean is defined in <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>,
                                            the <span class="EmphasisFontCategoryNonProportional">foo</span> bean is assigned to the <span class="EmphasisFontCategoryNonProportional">foo</span> property of the target.</div>
                                    </li>
                                    <li>
                                        <div class="Para" id="Par427"> <span class="EmphasisFontCategoryNonProportional">byType</span>: When using <span class="EmphasisFontCategoryNonProportional">byType</span> autowiring, Spring attempts to wire each of the properties on the target
                                            bean by automatically using a bean of the same type in <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>.</div>
                                    </li>
                                    <li>
                                        <div class="Para" id="Par428"> <span class="EmphasisFontCategoryNonProportional">constructor</span>: This functions just like <span class="EmphasisFontCategoryNonProportional">byType</span> wiring, except that it uses constructors rather than
                                            setters to perform the injection. Spring attempts to match the greatest numbers of arguments it can in the constructor. So, if your bean has two constructors, one that accepts a <span class="EmphasisFontCategoryNonProportional">String</span>                                            and one that accepts <span class="EmphasisFontCategoryNonProportional">String</span> and an <span class="EmphasisFontCategoryNonProportional">Integer</span>, and you have both a <span class="EmphasisFontCategoryNonProportional">String</span>                                            and an <span class="EmphasisFontCategoryNonProportional">Integer</span> bean in your <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>, Spring uses the two-argument constructor.</div>
                                    </li>
                                    <li>
                                        <div class="Para" id="Par429"> <span class="EmphasisFontCategoryNonProportional">default</span>: Spring will choose between the <span class="EmphasisFontCategoryNonProportional">constructor</span> and <span class="EmphasisFontCategoryNonProportional">byType</span>                                            modes automatically. If your bean has a default (no-arguments) constructor, Spring uses <span class="EmphasisFontCategoryNonProportional">byType</span>; otherwise, it uses <span class="EmphasisFontCategoryNonProportional">constructor</span>.</div>
                                    </li>
                                    <li>
                                        <div class="Para ParaOneEmphasisChild" id="Par430"> <span class="EmphasisFontCategoryNonProportional">no</span>: This is the default.</div>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div class="Para" id="Par431">So, if you have a <span id="ITerm156">property                  </span> of type <span class="EmphasisFontCategoryNonProportional">String</span> on the target bean and a bean of type <span class="EmphasisFontCategoryNonProportional">String</span>                            in <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>, then Spring wires the <span class="EmphasisFontCategoryNonProportional">String</span> bean to the target bean’s <span class="EmphasisFontCategoryNonProportional">String</span>                            property. If you have more than one bean of the same type, in this case <span class="EmphasisFontCategoryNonProportional">String</span>, in the same <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>                            instance, then Spring is unable to decide which one to use for the autowiring and throws an exception (of type <span class="EmphasisFontCategoryNonProportional">org.springframework.beans.factory.NoSuchBeanDefinitionException</span>).</div>
                        <div class="Para ParaOneEmphasisChild" id="Par432">The following configuration snippet shows a simple configuration that autowires three beans of the same type by using each of the modes (<span class="EmphasisFontCategoryNonProportional">app-context-03.xml</span>):</div>
                    <div class="Para" id="Par433">
                        <div class="ProgramCode" id="PC130">
                            <div class="LineGroup">
                                <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#1c02ff">&lt;<span style="font-weight:700">beans</span> ...&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">fooOne</span> <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch3.xml.Foo</span>/&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">barOne</span> <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch3.xml.Bar</span>/&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">targetByName</span> <span style="font-style:italic">autowire</span>=<span style="color:#036a07">byName</span>
            <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch3.xml.Target</span> <span style="font-style:italic">lazy-init</span>=<span style="color:#036a07">true</span>/&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">targetByType</span> <span style="font-style:italic">autowire</span>=<span style="color:#036a07">byType</span>
            <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch3.xml.Target</span> <span style="font-style:italic">lazy-init</span>=<span style="color:#036a07">true</span>/&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">targetConstructor</span> <span style="font-style:italic">autowire</span>=<span style="color:#036a07">constructor</span>
            <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch3.xml.Target</span> <span style="font-style:italic">lazy-init</span>=<span style="color:#036a07">true</span>/&gt;</span>
<span style="color:#1c02ff">&lt;/<span style="font-weight:700">beans</span>&gt;</span>
</pre></div>
                            </div>
                        </div>
                    </div>
                    <div class="Para" id="Par434">This configuration should look familiar to you now. <span class="EmphasisFontCategoryNonProportional">Foo</span> and <span class="EmphasisFontCategoryNonProportional">Bar</span> are empty classes. Notice that each of the <span class="EmphasisFontCategoryNonProportional">Target</span>                        beans has a different value for the <span class="EmphasisFontCategoryNonProportional">autowire</span> attribute. Moreover, the <span class="EmphasisFontCategoryNonProportional">lazy-init</span> attribute is set to <span class="EmphasisFontCategoryNonProportional">true</span>                        to inform Spring to instantiate the bean only when it is first requested, rather than at startup, so that we can output the result in the correct place in the testing program. The following code sample shows a simple Java application
                        that retrieves each of the <span class="EmphasisFontCategoryNonProportional">Target</span> beans from <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>:</div>
                    <div class="Para" id="Par435">
                        <div class="ProgramCode" id="PC131">
                            <div class="LineGroup">
                                <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.xml</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.support.GenericXmlApplicationContext</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">Target</span> {
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">Foo</span> fooOne;
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">Foo</span> fooTwo;
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">Bar</span> bar;

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#0000a2;font-weight:700">Target</span>() {
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#0000a2;font-weight:700">Target</span>(<span style="color:#00f;font-weight:700">Foo</span> <span style="font-style:italic">foo</span>) {
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">Target(Foo) called</span>);
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#0000a2;font-weight:700">Target</span>(<span style="color:#00f;font-weight:700">Foo</span> <span style="font-style:italic">foo</span>, <span style="color:#00f;font-weight:700">Bar</span> <span style="font-style:italic">bar</span>) {
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">Target(Foo, Bar) called</span>);
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setFooOne</span>(<span style="color:#00f;font-weight:700">Foo</span> <span style="font-style:italic">fooOne</span>) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>fooOne <span style="color:#00f;font-weight:700">=</span> fooOne;
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">Property fooOne set</span>);
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setFooTwo</span>(<span style="color:#00f;font-weight:700">Foo</span> <span style="font-style:italic">foo</span>) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>fooTwo <span style="color:#00f;font-weight:700">=</span> foo;
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">Property fooTwo set</span>);
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setBar</span>(<span style="color:#00f;font-weight:700">Bar</span> <span style="font-style:italic">bar</span>) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>bar <span style="color:#00f;font-weight:700">=</span> bar;
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">Property bar set</span>);
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span>... <span style="font-style:italic">args</span>) {
        <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span> ctx <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span>();
        ctx<span style="color:#00f;font-weight:700">.</span>load(<span style="color:#036a07">classpath:spring/app-context-03.xml</span>);
        ctx<span style="color:#00f;font-weight:700">.</span>refresh();
        <span style="color:#00f;font-weight:700">Target</span> t <span style="color:#00f;font-weight:700">=</span> <span style="color:#585cf6;font-weight:700">null</span>;
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">&quot;Using byName:<span style="color:#26b31a">\n</span>&quot;</span>);
        t <span style="color:#00f;font-weight:700">=</span> (<span style="color:#00f;font-weight:700">Target</span>) ctx<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#036a07">targetByName</span>);
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">&quot;<span style="color:#26b31a">\n</span>Using byType:<span style="color:#26b31a">\n</span>&quot;</span>);
        t <span style="color:#00f;font-weight:700">=</span> (<span style="color:#00f;font-weight:700">Target</span>) ctx<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#036a07">targetByType</span>);
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">&quot;<span style="color:#26b31a">\n</span>Using constructor:<span style="color:#26b31a">\n</span>&quot;</span>);
        t <span style="color:#00f;font-weight:700">=</span> (<span style="color:#00f;font-weight:700">Target</span>) ctx<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#036a07">targetConstructor</span>);
        ctx<span style="color:#00f;font-weight:700">.</span>close();
    }
}
</pre></div>
                            </div>
                        </div>
                    </div>
                    <div class="Para" id="Par436">In this code, you can see that the <span class="EmphasisFontCategoryNonProportional">Target</span> class has three constructors: a no-argument constructor, a constructor that accepts a <span class="EmphasisFontCategoryNonProportional">Foo</span>                        instance, and a constructor that accepts a <span class="EmphasisFontCategoryNonProportional">Foo</span> and a <span class="EmphasisFontCategoryNonProportional">Bar</span> instance. In addition to these constructors, the <span class="EmphasisFontCategoryNonProportional">Target</span>                        bean has three properties: two of type <span class="EmphasisFontCategoryNonProportional">Foo</span> and one of type <span class="EmphasisFontCategoryNonProportional">Bar</span>. Each of these properties and constructors writes
                        a message to console output when it is called. The <span class="EmphasisFontCategoryNonProportional">main()</span> method simply retrieves each of the <span class="EmphasisFontCategoryNonProportional">Target</span> beans declared
                        in <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>, triggering the autowire process. Here is the output from running this example:</div>
                    <div class="Para" id="Par437">
                        <div class="ProgramCode" id="PC132">
                            <div class="LineGroup">
                                <div class="FixedLine">Using byName:</div>
                            </div>
                            <div class="LineGroup">
                                <div class="FixedLine">Property fooOne set</div>
                            </div>
                            <div class="LineGroup">
                                <div class="FixedLine">Using byType:</div>
                            </div>
                            <div class="LineGroup">
                                <div class="FixedLine">Property bar set</div>
                                <div class="FixedLine">Property fooOne set</div>
                                <div class="FixedLine">Property fooTwo set</div>
                            </div>
                            <div class="LineGroup">
                                <div class="FixedLine">Using constructor:</div>
                            </div>
                            <div class="LineGroup">
                                <div class="FixedLine">Target(Foo, Bar) called</div>
                            </div>
                        </div>
                    </div>
                    <div class="Para" id="Par438">From the output, you can see that when Spring uses <span class="EmphasisFontCategoryNonProportional">byName</span>, the only property that is set is <span class="EmphasisFontCategoryNonProportional">foo</span> because this is the only
                        property with a corresponding bean entry in the configuration file. When using <span class="EmphasisFontCategoryNonProportional">byType</span>, Spring sets the value of all three properties. The <span class="EmphasisFontCategoryNonProportional">fooOne</span>                        and <span class="EmphasisFontCategoryNonProportional">fooTwo</span> properties are set by the <span class="EmphasisFontCategoryNonProportional">fooOne</span> bean, and the <span class="EmphasisFontCategoryNonProportional">bar</span>                        property is set by the <span class="EmphasisFontCategoryNonProportional">barOne</span> bean. When using a constructor, Spring uses the two-argument constructor, because Spring can provide beans for both arguments and does not need
                        to fall back to another constructor.</div>
                    <div class="Para ParaOneEmphasisChild" id="Par439">When autowiring by type, things gets complicated when bean types are related, and exceptions are thrown when you have more classes that implement the same interface and the property requiring to be autowired specifies the interface
                        as the type, because Spring does not know which bean to inject. To create such a scenario, we’ll transform <span class="EmphasisFontCategoryNonProportional">Foo</span> into an interface and declare two bean type implementing it,
                        each with its bean declaration. Let’s keep the default configuration as well, no extra naming.</div>
                    <div class="Para" id="Par440">
                        <div class="ProgramCode" id="PC133">
                            <div class="LineGroup">
                                <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.xml.complicated</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">interface</span> <span style="text-decoration:underline">Foo</span> {
    <span style="color:#06f;font-style:italic">// empty interface, used as a marker interface</span>
}

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">FooImplOne</span> <span style="color:#00f;font-weight:700">implements</span> <span style="font-style:italic">Foo</span> {
}

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">FooImplOne</span> <span style="color:#00f;font-weight:700">implements</span> <span style="font-style:italic">Foo</span> {
}
</pre></div>
                            </div>
                        </div>
                    </div>
                    <div class="Para ParaOneEmphasisChild" id="Par441">If we were to add a new configuration file, named <span class="EmphasisFontCategoryNonProportional">app-context-04.xml</span>, it would contain the following configuration:</div>
                    <div class="Para" id="Par442">
                        <div class="ProgramCode" id="PC134">
                            <div class="LineGroup">
                                <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#1c02ff">&lt;<span style="font-weight:700">beans</span> ...&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">fooOne</span>
        <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch3.xml.complicated.FooImplOne</span>/&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">fooTwo</span>
        <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch3.xml.complicated.FooImplOne</span>/&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">bar</span> <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch3.xml.Bar</span>/&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">targetByType</span> <span style="font-style:italic">autowire</span>=<span style="color:#036a07">byType</span>
        <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch3.xml.complicated.CTarget</span>
        <span style="font-style:italic">lazy-init</span>=<span style="color:#036a07">true</span>/&gt;</span>
<span style="color:#1c02ff">&lt;/<span style="font-weight:700">beans</span>&gt;</span>
</pre></div>
                            </div>
                        </div>
                    </div>
                    <div class="Para" id="Par443">For this more simple example, we also introduce the <span class="EmphasisFontCategoryNonProportional">CTarget</span> class. This is identical with the recently introduced <span class="EmphasisFontCategoryNonProportional">Target</span>                        class; only the <span class="EmphasisFontCategoryNonProportional">main()</span> method differs. The code snippet is depicted here:</div>
                    <div class="Para" id="Par444">
                        <div class="ProgramCode" id="PC135">
                            <div class="LineGroup">
                                <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.xml.complicated</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.xml.*</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.support.GenericXmlApplicationContext</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">CTarget</span> {
        .<span style="color:#00f;font-weight:700">.</span>.

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span>... <span style="font-style:italic">args</span>) {
        <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span>
                ctx <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span>();
        ctx<span style="color:#00f;font-weight:700">.</span>load(<span style="color:#036a07">classpath:spring/app-context-04.xml</span>);
        ctx<span style="color:#00f;font-weight:700">.</span>refresh();
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">&quot;<span style="color:#26b31a">\n</span>Using byType:<span style="color:#26b31a">\n</span>&quot;</span>);
        <span style="color:#00f;font-weight:700">CTarget</span> t <span style="color:#00f;font-weight:700">=</span> (<span style="color:#00f;font-weight:700">CTarget</span>) ctx<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#036a07">targetByType</span>);
        ctx<span style="color:#00f;font-weight:700">.</span>close();
    }
</pre></div>
                            </div>
                        </div>
                    </div>
                    <div class="Para" id="Par445">Running the previous class produces the following output:</div>
                    <div class="Para" id="Par446">
                        <div class="ProgramCode" id="PC136">
                            <div class="LineGroup">
                                <div class="FixedLine">Using byType: <span id="ITerm160">                                                          </span> </div>
                            </div>
                            <div class="LineGroup">
                                <div class="FixedLine">Exception in thread &quot;main&quot;</div>
                                <div class="FixedLine">   org.springframework.beans.factory.UnsatisfiedDependencyException:</div>
                                <div class="FixedLine">   Error creating bean with name &apos;targetByType&apos; defined in class path</div>
                                <div class="FixedLine">      resource spring/app-context-04.xml:</div>
                                <div class="FixedLine">      Unsatisfied dependency expressed through bean property &apos;foo&apos;;</div>
                                <div class="FixedLine">      nested exception is</div>
                                <div class="FixedLine">      org.springframework.beans.factory.NoUniqueBeanDefinitionException:</div>
                                <div class="FixedLine">   No qualifying bean of type</div>
                                <div class="FixedLine">      &apos;com.apress.prospring5.ch3.xml.complicated.Foo&apos; available:</div>
                                <div class="FixedLine">       <span class="EmphasisTypeUnderline">expected single matching bean but found 2: fooOne,fooTwo</span> </div>
                                <div class="FixedLine">       ...</div>
                            </div>
                        </div>
                    </div>
                    <div class="Para" id="Par447">The console output is way bigger, but the first lines in the previous output reveal the problem in quite a readable manner. When Spring does not know what bean to autowire, it throws an <span id="ITerm161">              <span class="EmphasisFontCategoryNonProportional">UnsatisfiedDependencyException</span>                        </span> with an explicit message. It tells you what beans were found but that it cannot choose which to use where. There are two ways to fix this problem. The first way is to use the <span class="EmphasisFontCategoryNonProportional">primary</span>                        attribute in the bean definition that you want Spring to consider first for autowiring and set <span class="EmphasisFontCategoryNonProportional">true</span> as its value.</div>
                    <div class="Para" id="Par448">
                        <div class="ProgramCode" id="PC137">
                            <div class="LineGroup">
                                <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#1c02ff">&lt;<span style="font-weight:700">beans</span> ...&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">fooOne</span>
       <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch3.xml.complicated.FooImpl1</span>
       <span style="font-style:italic">primary</span>=<span style="color:#036a07">true</span>/&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">fooTwo</span>
       <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch3.xml.complicated.FooImpl2</span>/&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">bar</span> <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch3.xml.Bar</span>/&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">targetByType</span> <span style="font-style:italic">autowire</span>=<span style="color:#036a07">byType</span>
        <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch3.xml.complicated.CTarget</span>
        <span style="font-style:italic">lazy-init</span>=<span style="color:#036a07">true</span>/&gt;</span>
<span style="color:#1c02ff">&lt;/<span style="font-weight:700">beans</span>&gt;</span>
</pre></div>
                            </div>
                        </div>
                    </div>
                    <div class="Para" id="Par449">So, if the configuration is modified as presented before, when running the example, the following output will be printed:</div>
                    <div class="Para" id="Par450">
                        <div class="ProgramCode" id="PC138">
                            <div class="LineGroup">
                                <div class="FixedLine">Using byType:</div>
                            </div>
                            <div class="LineGroup">
                                <div class="FixedLine">Property bar set</div>
                                <div class="FixedLine">Property fooOne set</div>
                                <div class="FixedLine">Property fooTwo set</div>
                            </div>
                        </div>
                    </div>
                    <div class="Para" id="Par451">So, it’s all back to normal. But still, the <span class="EmphasisFontCategoryNonProportional">primary</span> attribute is a solution only when there are just two bean-related types. If there are more, using it will not get rid of the
                        <span class="EmphasisFontCategoryNonProportional">UnsatisfiedDependencyException</span>. What will do the job is the second way, which will give you full control over which bean gets injected where, and this is to name your beans
                        and configure them where to be injected via XML. The previous example is quite a complex and dirty implementation and was conceived just to prove how each of the autowiring types can be configured in XML. When switching to annotation,
                        things change a bit. There is an annotation equivalent to the <span class="EmphasisFontCategoryNonProportional">lazy-init</span> attribute; the <span class="EmphasisFontCategoryNonProportional">@Lazy</span> annotation is used at
                        the class level to declare beans that will be instantiated the first time they are accessed. Using stereotype annotations, we can create only one configuration for a bean, so it seems pretty logical that the name of the beans does
                        not really matter, as there will be only one bean of each type. Thus, the default autowiring when using configuration via annotation is <span class="EmphasisFontCategoryNonProportional">byType</span>. When there are bean-related
                        types, it is useful to be able to specify that autowiring should be done by name. This is done using the <span class="EmphasisFontCategoryNonProportional">@Qualifier</span> annotation, together with the <span class="EmphasisFontCategoryNonProportional">@Autowired</span>                        annotation, and providing the name of the bean being injected as an argument for it.</div>
                    <div class="Para" id="Par452">Consider the following code:</div>
                    <div class="Para" id="Par453">
                        <div class="ProgramCode" id="PC139">
                            <div class="LineGroup">
                                <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.sandbox</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.beans.factory.annotation.Autowired</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.beans.factory.annotation.Qualifier</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.annotation.Lazy</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.support.GenericXmlApplicationContext</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.stereotype.Component</span>;

@<span style="color:#00f;font-weight:700">Component</span>
@<span style="color:#00f;font-weight:700">Lazy</span>
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">TrickyTarget</span> {
    <span style="color:#00f;font-weight:700">Foo</span> fooOne;
    <span style="color:#00f;font-weight:700">Foo</span> fooTwo;
    <span style="color:#00f;font-weight:700">Bar</span> bar;

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#0000a2;font-weight:700">TrickyTarget</span>() {
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">Target.constructor()</span>);
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#0000a2;font-weight:700">TrickyTarget</span>(<span style="color:#00f;font-weight:700">Foo</span> <span style="font-style:italic">fooOne</span>) {
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">Target(Foo) called</span>);
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#0000a2;font-weight:700">TrickyTarget</span>(<span style="color:#00f;font-weight:700">Foo</span> <span style="font-style:italic">fooOne</span>, <span style="color:#00f;font-weight:700">Bar</span> <span style="font-style:italic">bar</span>) {
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">Target(Foo, Bar) called</span>);
    }

    <span style="color:#00f;font-weight:700">@Autowired</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setFooOne</span>(<span style="color:#00f;font-weight:700">Foo</span> <span style="font-style:italic">fooOne</span>) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>fooOne <span style="color:#00f;font-weight:700">=</span> fooOne;
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">Property fooOne set</span>);
    }

    <span style="color:#00f;font-weight:700">@Autowired</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setFooTwo</span>(<span style="color:#00f;font-weight:700">Foo</span> <span style="font-style:italic">foo</span>) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>fooTwo <span style="color:#00f;font-weight:700">=</span> foo;
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">Property fooTwo set</span>);
    }

    <span style="color:#00f;font-weight:700">@Autowired</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setBar</span>(<span style="color:#00f;font-weight:700">Bar</span> <span style="font-style:italic">bar</span>) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>bar <span style="color:#00f;font-weight:700">=</span> bar;
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">Property bar set</span>);
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span>... <span style="font-style:italic">args</span>) {
        <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span> ctx <span style="color:#00f;font-weight:700">=</span>
                <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span>();
        ctx<span style="color:#00f;font-weight:700">.</span>load(<span style="color:#036a07">classpath:spring/app-context-04.xml</span>);
        ctx<span style="color:#00f;font-weight:700">.</span>refresh();
        <span style="color:#00f;font-weight:700">TrickyTarget</span> t <span style="color:#00f;font-weight:700">=</span> ctx<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#00f;font-weight:700">TrickyTarget</span><span style="color:#00f;font-weight:700">.</span>class);
        ctx<span style="color:#00f;font-weight:700">.</span>close();
    }
}
</pre></div>
                            </div>
                        </div>
                    </div>
                    <div class="Para ParaOneEmphasisChild" id="Par454">If <span class="EmphasisFontCategoryNonProportional">Foo</span> is a class as depicted here:</div>
                    <div class="Para" id="Par455">
                        <div class="ProgramCode" id="PC140">
                            <div class="LineGroup">
                                <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.sandbox</span>;
@<span style="color:#00f;font-weight:700">Component</span>
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">Foo</span> {
}
</pre></div>
                            </div>
                        </div>
                    </div>
                    <div class="Para ParaOneEmphasisChild" id="Par456">then when the <span class="EmphasisFontCategoryNonProportional">TrickyTarget</span> class is run, the following output is produced:</div>
                    <div class="Para" id="Par457">
                        <div class="ProgramCode" id="PC141">
                            <div class="FixedLine">Property fooOne set</div>
                            <div class="FixedLine">Property fooTwo set</div>
                            <div class="FixedLine">Property bar set</div>
                        </div>
                    </div>
                    <div class="Para ParaOneEmphasisChild" id="Par458">The <span class="EmphasisFontCategoryNonProportional">Bar</span> class is just as simple.</div>
                    <div class="Para" id="Par459">
                        <div class="ProgramCode" id="PC142">
                            <div class="LineGroup">
                                <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.sandbox</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.stereotype.Component</span>;
@<span style="color:#00f;font-weight:700">Component</span>
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">Bar</span> {
}
</pre></div>
                            </div>
                        </div>
                    </div>
                    <div class="Para ParaOneEmphasisChild" id="Par460">If we were to modify the <span class="EmphasisFontCategoryNonProportional">TrickyTarget</span> class and give a name to the bean, as shown here:</div>
                    <div class="Para" id="Par461">
                        <div class="ProgramCode" id="PC143">
                            <div class="FixedLine"><pre style="background:#fff;color:#000">@Component(<span style="color:#036a07">gigi</span>)
@<span style="color:#00f;font-weight:700">Lazy</span>
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">TrickyTarget</span> {
.<span style="color:#00f;font-weight:700">.</span>.
}
</pre></div>
                        </div>
                    </div>
                    <div class="Para" id="Par462">then when running the class, the same output will be produced, as there is only one bean of type <span class="EmphasisFontCategoryNonProportional">Target</span>, and when requested from the context using <span class="EmphasisFontCategoryNonProportional">ctx.getBean(TrickyTarget.class)</span>,
                        the context returns the only bean of this type, regardless of its name. Also, if we were to provide a name for the bean of type <span class="EmphasisFontCategoryNonProportional">Bar</span>:</div>
                    <div class="Para" id="Par463">
                        <div class="ProgramCode" id="PC144">
                            <div class="LineGroup">
                                <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.sandbox</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.stereotype.Component</span>;
@Component(<span style="color:#036a07">kitchen</span>)
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">Bar</span> {
}
</pre></div>
                            </div>
                        </div>
                    </div>
                    <div class="Para ParaOneEmphasisChild" id="Par464">then when running the example again, we would see the same output. This means that the default autowiring type is <span class="EmphasisFontCategoryNonProportional">byType</span>.</div>
                    <div class="Para ParaOneEmphasisChild" id="Par465">As mentioned, things get complicated when bean types are related. Let’s transform <span class="EmphasisFontCategoryNonProportional">Foo</span> into an interface and declare two bean types implementing it, each one with its bean declaration.
                        Let’s keep the default configuration as well, with no extra naming.</div>
                    <div class="Para" id="Par466">
                        <div class="ProgramCode" id="PC145">
                            <div class="LineGroup">
                                <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.sandbox</span>;

<span style="color:#06f;font-style:italic">//Foo.java</span>
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">interface</span> <span style="text-decoration:underline">Foo</span> {
    <span style="color:#06f;font-style:italic">// empty interface, used as a marker interface</span>
}

<span style="color:#06f;font-style:italic">//FooImplOne.java</span>
@<span style="color:#00f;font-weight:700">Component</span>
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">FooImplOne</span> <span style="color:#00f;font-weight:700">implements</span> <span style="font-style:italic">Foo</span> {
}

<span style="color:#06f;font-style:italic">//FooImplTwo.java</span>
@<span style="color:#00f;font-weight:700">Component</span>
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">FooImplTwo</span> <span style="color:#00f;font-weight:700">implements</span> <span style="font-style:italic">Foo</span> {
}
</pre></div>
                            </div>
                        </div>
                    </div>
                    <div class="Para ParaOneEmphasisChild" id="Par467">The <span class="EmphasisFontCategoryNonProportional">TrickyTarget</span> class remains unchanged, and when it’s run, we’ll see that the output changes to something that looks probably a lot like this:</div>
                    <div class="Para" id="Par468">
                        <div class="ProgramCode" id="PC146">
                            <div class="FixedLine">Property bar set</div>
                            <div class="FixedLine">Exception in thread &quot;main&quot;</div>
                            <div class="FixedLine">     org.springframework.beans.factory.<span class="EmphasisTypeUnderline">UnsatisfiedDependencyException</span>:</div>
                            <div class="FixedLine"> Error creating bean with name &apos;gigi&apos;:</div>
                            <div class="FixedLine">     Unsatisfied dependency expressed through method &apos;setFoo&apos; parameter 0;</div>
                            <div class="FixedLine"> nested exception is</div>
                            <div class="FixedLine">     org.springframework.beans.factory.NoUniqueBeanDefinitionException:</div>
                            <div class="FixedLine"> No qualifying bean of type &apos;com.apress.prospring5.ch3.sandbox.Foo&apos; available:</div>
                            <div class="FixedLine">       <span class="EmphasisTypeUnderline">expected single matching bean but found 2: fooImplOne,</span> <span id="ITerm166">                  <span class="EmphasisTypeUnderline">fooImplTwo</span>                                </span>
                            </div>
                            <div class="FixedLine">...</div>
                        </div>
                    </div>
                    <div class="Para" id="Par469">There is a lot more output, but those are the first lines, and as you can see, Spring is really explicit. It tells you that it does not know which bean to autowire through the method <span class="EmphasisFontCategoryNonProportional">setFoo</span>,
                        and it also tells you which selection of beans it has. The names of the beans are decided by Spring based on the class name, by downcasing the first letter of the class name. Using this information, <span class="EmphasisFontCategoryNonProportional">TrickyTarget</span>                        can be fixed. There are two ways to do this. The first way is to use the <span class="EmphasisFontCategoryNonProportional">@Primary</span> annotation (which is the equivalent of the <span class="EmphasisFontCategoryNonProportional">primary</span>                        attribute introduced before) on the class defining a bean, which will tell Spring to prioritize this bean when autowiring by type. We will annotate <span class="EmphasisFontCategoryNonProportional">FooImplOne</span>.</div>
                    <div class="Para" id="Par470">
                        <div class="ProgramCode" id="PC147">
                            <div class="LineGroup">
                                <div class="FixedLine">package com.apress.prospring5.ch3.sandbox;</div>
                            </div>
                            <div class="LineGroup">
                                <div class="FixedLine">import org.springframework.context.annotation.Primary;</div>
                                <div class="FixedLine">import org.springframework.stereotype.Component;</div>
                            </div>
                            <div class="LineGroup">
                                <div class="FixedLine">@Component</div>
                                <div class="FixedLine">@Primary</div>
                                <div class="FixedLine">public class FooImplOne implements Foo {</div>
                                <div class="FixedLine">}</div>
                            </div>
                        </div>
                        </div>
                        <div class="Para" id="Par471">The <span class="EmphasisFontCategoryNonProportional">@Primary</span> annotation is a marker interface; it has no attributes. Its presence on a bean configuration marks the bean as having priority when a bean of this type is needed
                            to be autowired using <span class="EmphasisFontCategoryNonProportional">byType</span>. If you run the <span class="EmphasisFontCategoryNonProportional">TrickyTarget</span> class, the expected output will be printed again.</div>
                        <div class="Para" id="Par472">
                            <div class="ProgramCode" id="PC148">
                                <div class="FixedLine">Property fooOne set</div>
                                <div class="FixedLine">Property fooTwo set</div>
                                <div class="FixedLine">Property bar set</div>
                            </div>
                            </div>
                            <div class="Para" id="Par473">As in the case of the <span class="EmphasisFontCategoryNonProportional">primary</span> attribute, the <span class="EmphasisFontCategoryNonProportional">@Primary</span> annotation is useful only when you have exactly two related
                                bean types. For handling more related bean types, the <span class="EmphasisFontCategoryNonProportional">Qualifier</span> annotation is more suitable. This is placed next to the <span class="EmphasisFontCategoryNonProportional">@Autowired</span>                                on the setters that are ambiguous: <span class="EmphasisFontCategoryNonProportional">setFooOne()</span> and <span class="EmphasisFontCategoryNonProportional">setFooTwo()</span>. (The code left unchanged is not shown anymore.)</div>
                            <div class="Para" id="Par474">
                                <div class="ProgramCode" id="PC149">
                                    <div class="LineGroup">
                                        <div class="FixedLine"><pre style="background:#fff;color:#000">@Component(<span style="color:#036a07">gigi</span>)
@<span style="color:#00f;font-weight:700">Lazy</span>
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">TrickyTarget</span> {
        .<span style="color:#00f;font-weight:700">.</span>.
        <span style="color:#00f;font-weight:700">@Autowired</span>
        <span style="color:#00f;font-weight:700">@Qualifier</span>(<span style="color:#036a07">fooImplOne</span>)
        <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setFoo</span>(<span style="color:#00f;font-weight:700">Foo</span> <span style="font-style:italic">foo</span>) {
                <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>foo <span style="color:#00f;font-weight:700">=</span> foo;
                <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">Property fooOne set</span>);
        }
        <span style="color:#00f;font-weight:700">@Autowired</span>
        <span style="color:#00f;font-weight:700">@Qualifier</span>(<span style="color:#036a07">fooImplTwo</span>)
        <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setFooTwo</span>(<span style="color:#00f;font-weight:700">Foo</span> <span style="font-style:italic">fooTwo</span>) {
                <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>fooTwo <span style="color:#00f;font-weight:700">=</span> fooTwo;
                <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">Property fooTeo set</span>);
        }
        .<span style="color:#00f;font-weight:700">.</span>.
}
</pre></div>
                                    </div>
                                </div>
                                </div>
                                <div class="Para" id="Par475">Now, if you run the example, the expected output will be printed again.</div>
                                <div class="Para" id="Par476">
                                    <div class="ProgramCode" id="PC150">
                                        <div class="FixedLine">Property fooOne set</div>
                                        <div class="FixedLine">Property fooTwo set</div>
                                        <div class="FixedLine">Property bar set</div>
                                    </div>
                                </div>
                                <div class="Para" id="Par477">When using Java configuration, the only thing that changes is the way the beans are defined. Because instead of <span class="EmphasisFontCategoryNonProportional">@Component</span> on bean classes, <span class="EmphasisFontCategoryNonProportional">@Bean</span>                                    annotations will be used on bean declaration methods in the configuration class. Such an example is shown here:</div>
                                <div class="Para" id="Par478">
                                    <div class="ProgramCode" id="PC151">
                                        <div class="LineGroup">
                                            <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.config</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.sandbox.*</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.annotation.AnnotationConfigApplicationContext</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.annotation.Bean</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.annotation.Configuration</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.support.GenericApplicationContext</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">TargetDemo</span> {
    <span style="color:#00f;font-weight:700">@Configuration</span>
    <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">TargetConfig</span> {
        <span style="color:#00f;font-weight:700">@Bean</span>
        <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">Foo</span> <span style="color:#0000a2;font-weight:700">fooImplOne</span>() {
            <span style="color:#00f;font-weight:700">return</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">FooImplOne</span>();
        }

        <span style="color:#00f;font-weight:700">@Bean</span>
        <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">Foo</span> <span style="color:#0000a2;font-weight:700">fooImplTwo</span>() {
            <span style="color:#00f;font-weight:700">return</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">FooImplTwo</span>();
        }

        <span style="color:#00f;font-weight:700">@Bean</span>
        <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">Bar</span> <span style="color:#0000a2;font-weight:700">bar</span>() {
            <span style="color:#00f;font-weight:700">return</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">Bar</span>();
        }

        <span style="color:#00f;font-weight:700">@Bean</span>
        <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">TrickyTarget</span> <span style="color:#0000a2;font-weight:700">trickyTarget</span>() {
            <span style="color:#00f;font-weight:700">return</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">TrickyTarget</span>();
        }
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span> <span style="font-style:italic">args</span>) {
        <span style="color:#00f;font-weight:700">GenericApplicationContext</span> ctx <span style="color:#00f;font-weight:700">=</span>
                <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">AnnotationConfigApplicationContext</span>(<span style="color:#00f;font-weight:700">TargetConfig</span><span style="color:#00f;font-weight:700">.</span>class);
        <span style="color:#00f;font-weight:700">TrickyTarget</span> t <span style="color:#00f;font-weight:700">=</span> ctx<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#00f;font-weight:700">TrickyTarget</span><span style="color:#00f;font-weight:700">.</span>class);
        ctx<span style="color:#00f;font-weight:700">.</span>close();
    }
}
</pre></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="Para" id="Par479">The existing classes from the <span class="EmphasisFontCategoryNonProportional">com.apress.prospring5.ch3.sandbox</span> package were reused here too, to avoid code duplication, because as component scanning is not enabled,
                                    any bean declaration using stereotype annotation will be ignored. If you run the previous class, you will notice that the same output from the previous example is printed. If you remember, as mentioned earlier, the
                                    convention when using bean declarations with <span class="EmphasisFontCategoryNonProportional">@Bean</span> is that the name of the method becomes the name of the bean, so <span class="EmphasisFontCategoryNonProportional">TrickyTarget</span>                                    configured with the <span class="EmphasisFontCategoryNonProportional">@Qualifier</span> annotation will still work as expected.</div>
                                <div class="Section2 RenderAsSection2" id="Sec41">
                                    <h3 class="Heading">When to Use Autowiring</h3>
                                    <div class="Para" id="Par480">In most cases, the answer to the question of whether you should use autowiring is definitely no! Autowiring can save you time in small applications, but in many cases, it leads to bad practices and is inflexible in
                                        large applications. Using <span class="EmphasisFontCategoryNonProportional">byName</span> seems like a good idea, but it may lead you to give your classes artificial property names so that you can take advantage
                                        of the autowiring functionality. The whole idea behind Spring is that you can create your classes as you like and have Spring work for you, not the other way around. You may be tempted to use <span class="EmphasisFontCategoryNonProportional">byType</span>                                        until you realize that you can have only one bean for each type in your <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>—a restriction that is problematic when you need to maintain beans
                                        with different configurations of the same type. The same argument applies to the use of constructor autowiring.</div>
                                    <div class="Para" id="Par481">In some cases, autowiring can save you time, but it does not really take that much extra effort to define your wiring explicitly, and you benefit from explicit semantics and full flexibility on property naming and on
                                        how many instances of the same type you <span id="ITerm169">manage                      </span>. For any nontrivial application, steer clear of autowiring at all costs.</div>
                                </div>
                                </div>
                                <div class="Section1 RenderAsSection1" id="Sec42">
                                    <h2 class="Heading">Setting <span id="ITerm170">Bean Inheritance                  </span> </h2>
                                    <div class="Para" id="Par482">In some cases, you many need multiple definitions of beans that are the same type or implement a shared interface. This can become problematic if you want these beans to share some configuration settings but not others.
                                        The process of keeping the shared configuration settings in sync is quite error-prone, and on large projects, doing so can be quite time-consuming. To get around this, Spring allows you to provide a <span class="EmphasisFontCategoryNonProportional">&lt;bean&gt;</span>                                        definition that inherits its property settings from another bean in the same <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> instance. You can override the values of any properties on
                                        the child bean as required, which allows you to have full control, but the parent bean can provide each of your beans with a base configuration. The following code sample shows a simple configuration with two beans,
                                        one of which is the child of the other (<span class="EmphasisFontCategoryNonProportional">app-context-xml.xml</span>):</div>
                                    <div class="Para" id="Par483">
                                        <div class="ProgramCode" id="PC152">
                                            <div class="LineGroup">
                                                <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#1c02ff">&lt;<span style="font-weight:700">beans</span> ...&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">parent</span> <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch3.xml.Singer</span>
        <span style="font-style:italic">p</span>:name=<span style="color:#036a07">John Mayer</span> <span style="font-style:italic">p</span>:age=<span style="color:#036a07">39</span>/&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">child</span> <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch3.xml.Singer</span>
        <span style="font-style:italic">parent</span>=<span style="color:#036a07">parent</span> <span style="font-style:italic">p</span>:age=<span style="color:#036a07">0</span>/&gt;</span>
<span style="color:#1c02ff">&lt;/<span style="font-weight:700">beans</span>&gt;</span>
</pre></div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="Para" id="Par484">In this code, you can see that the <span class="EmphasisFontCategoryNonProportional">&lt;bean&gt;</span> tag for the <span class="EmphasisFontCategoryNonProportional">child</span> bean has an extra attribute,
                                        <span class="EmphasisFontCategoryNonProportional">parent</span>, which indicates that Spring should consider the <span class="EmphasisFontCategoryNonProportional">parent</span> bean the parent of the bean and inherit its configuration. In case you don’t want a
                                            parent bean definition to become available for lookup from <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>, you can add the attribute <span class="EmphasisFontCategoryNonProportional">abstract=&quot;true&quot;</span>                                            in the <span class="EmphasisFontCategoryNonProportional">&lt;bean&gt;</span> tag when declaring the parent bean. Because the <span class="EmphasisFontCategoryNonProportional">child</span> bean has its own value
                                            for the <span class="EmphasisFontCategoryNonProportional">age</span> property, Spring passes this value to the bean. However, <span class="EmphasisFontCategoryNonProportional">child</span> has no value for the
                                            <span class="EmphasisFontCategoryNonProportional">name</span> property, so Spring uses the value given to the <span class="EmphasisFontCategoryNonProportional">inheritParent</span> bean.</div>
                                    <div class="Para ParaOneEmphasisChild" id="Par485">The <span class="EmphasisFontCategoryNonProportional">Singer</span> bean is quite simple.</div>
                                    <div class="Para" id="Par486">
                                        <div class="ProgramCode" id="PC153">
                                            <div class="LineGroup">
                                                <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.xml</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">Singer</span> {
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">String</span> name;
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">int</span> age;

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setName</span>(<span style="color:#00f;font-weight:700">String</span> <span style="font-style:italic">name</span>) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>name <span style="color:#00f;font-weight:700">=</span> name;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setAge</span>(<span style="color:#00f;font-weight:700">int</span> <span style="font-style:italic">age</span>) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>age <span style="color:#00f;font-weight:700">=</span> age;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">String</span> <span style="color:#0000a2;font-weight:700">toString</span>() {
        <span style="color:#00f;font-weight:700">return</span> <span style="color:#036a07">&quot;<span style="color:#26b31a">\t</span>Name: &quot;</span> <span style="color:#00f;font-weight:700">+</span> name <span style="color:#00f;font-weight:700">+</span> <span style="color:#036a07">&quot;<span style="color:#26b31a">\n</span><span style="color:#26b31a">\t</span>&quot;</span> <span style="color:#00f;font-weight:700">+</span> <span style="color:#036a07">Age: </span> <span style="color:#00f;font-weight:700">+</span> age;
    }
}
</pre></div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="Para" id="Par487">To test it, you could write a simple class like this:</div>
                                    <div class="Para" id="Par488">
                                        <div class="ProgramCode" id="PC154">
                                            <div class="LineGroup">
                                                <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.xml</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.support.GenericXmlApplicationContext</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">InheritanceDemo</span> {
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span>... <span style="font-style:italic">args</span>) {
        <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span> ctx <span style="color:#00f;font-weight:700">=</span>
                <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span>();
        ctx<span style="color:#00f;font-weight:700">.</span>load(<span style="color:#036a07">classpath:spring/app-context-xml.xml</span>);
        ctx<span style="color:#00f;font-weight:700">.</span>refresh();
        <span style="color:#00f;font-weight:700">Singer</span> parent <span style="color:#00f;font-weight:700">=</span> (<span style="color:#00f;font-weight:700">Singer</span>) ctx<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#036a07">parent</span>);
        <span style="color:#00f;font-weight:700">Singer</span> child <span style="color:#00f;font-weight:700">=</span> (<span style="color:#00f;font-weight:700">Singer</span>) ctx<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#036a07">child</span>);
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">&quot;Parent:<span style="color:#26b31a">\n</span>&quot;</span> <span style="color:#00f;font-weight:700">+</span> parent);
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">&quot;Child:<span style="color:#26b31a">\n</span>&quot;</span> <span style="color:#00f;font-weight:700">+</span> child);
    }
}
</pre></div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="Para" id="Par489">As you can see, the <span class="EmphasisFontCategoryNonProportional">main()</span> method of the <span class="EmphasisFontCategoryNonProportional">Singer</span> class grabs both the <span class="EmphasisFontCategoryNonProportional">child</span>                                        and <span class="EmphasisFontCategoryNonProportional">parent</span> beans from <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> and writes the contents of their properties to <span class="EmphasisFontCategoryNonProportional">stdout</span>.
                                        Here is the output from this example:</div>
                                    <div class="Para" id="Par490">
                                        <div class="ProgramCode" id="PC155">
                                            <div class="FixedLine">Parent:</div>
                                            <div class="FixedLine">        Name: John Mayer</div>
                                            <div class="FixedLine">        Age: 39</div>
                                            <div class="FixedLine">Child:</div>
                                            <div class="FixedLine">        Name: John Mayer</div>
                                            <div class="FixedLine">        Age: 0</div>
                                        </div>
                                    </div>
                                    <div class="Para" id="Par491">As expected, the <span class="EmphasisFontCategoryNonProportional">inheritChild</span> bean inherited the value for its <span class="EmphasisFontCategoryNonProportional">name</span> property from the <span class="EmphasisFontCategoryNonProportional">inheritParent</span>                                        bean but was able to provide its own value for the <span class="EmphasisFontCategoryNonProportional">age</span> property.</div>
                                    <div class="Para" id="Par492">Child beans inherit both constructor arguments and property values from the parent beans, so you can use both styles of injection with bean inheritance. This level of flexibility makes bean inheritance a powerful tool
                                        for building applications with more than a handful of bean definitions. If you are declaring a lot of beans of the same value with shared property values, avoid the temptation to use copy and paste to share the
                                        values; instead, set up an inheritance hierarchy in your configuration.</div>
                                    <div class="Para" id="Par493">When you are using <span id="ITerm172">inheritance                  </span>, remember that bean inheritance does not have to match a Java inheritance hierarchy. It is perfectly acceptable to use bean inheritance on
                                        five beans of the same type. Think of bean inheritance as more like a templating feature than an inheritance feature. Be aware, however, that if you are changing the type of the child bean, that type must extend
                                        the parent bean type.</div>
                                </div>
                                <div class="Section1 RenderAsSection1" id="Sec43">
                                    <h2 class="Heading">Summary</h2>
                                    <div class="Para" id="Par494">In this chapter, we covered a lot of ground with both Spring Core and IoC in general. We showed you examples of the types of IoC and presented the pros and cons of using each mechanism in your applications. We looked
                                        at which IoC mechanisms Spring provides and when (and when not) to use each within your applications. While exploring IoC, we introduced the Spring <span class="EmphasisFontCategoryNonProportional">BeanFactory</span>,
                                        which is the core component for Spring’s IoC capabilities, and then <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>, which extends <span class="EmphasisFontCategoryNonProportional">BeanFactory</span>                                        and provides additional functionalities. For <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>, we focused on <span class="EmphasisFontCategoryNonProportional">GenericXmlApplicationContext</span>,
                                        which allows external configuration of Spring by using XML. Another method to declare DI requirements for <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>, that is, using Java annotations,
                                        was also discussed. Some examples with <span class="EmphasisFontCategoryNonProportional">AnnotationConfigApplicationContext</span> and Java configuration were also included, just to slowly introduce this way of
                                        configuring beans.</div>
                                    <div class="Para ParaOneEmphasisChild" id="Par495">This chapter also introduced you to the basics of Spring’s IoC feature set including setter injection, constructor injection, Method Injection, autowiring, and bean inheritance. In the discussion of configuration, we
                                        demonstrated how you can configure your bean properties with a wide variety of values, including other beans, using both XML and annotation type configurations and <span class="EmphasisFontCategoryNonProportional">GenericXmlApplicationContext</span>.</div>
                                    <div class="Para" id="Par496">This chapter only scratched the surface of Spring and Spring’s IoC container. In the next chapter, you’ll look at some IoC-related features specific to Spring, and you’ll take a more detailed look at other functionality
                                        available in Spring Core.</div>
                                </div>
                                <div class="FootnoteSection">
                                    <div class="Heading">Footnotes</div>
                                    <div class="Footnote" id="Fn1"><span class="FootnoteNumber"><a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_3_Chapter.html#Fn1_source">1</a></span>
                                        <div class="FootnoteParas">
                                            <div class="Para" id="Par78">For example, try the Spring community forums at <span class="ExternalRef"><a href="http://forum.spring.io/"><span class="RefSource">                      <span class="EmphasisFontCategoryNonProportional">http://forum.spring.io</span>                                                </span>
                                                </a>
                                                </span>.</div>
                                        </div>
                                        <div class="ClearBoth"> </div>
                                    </div>
                                    <div class="Footnote" id="Fn2"><span class="FootnoteNumber"><a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_3_Chapter.html#Fn2_source">2</a></span>
                                        <div class="FootnoteParas">
                                            <div class="Para" id="Par96">These annotations are called <span class="EmphasisTypeItalic">stereotype</span> because they are part of a package named <span class="EmphasisFontCategoryNonProportional">org.springframework.stereotype</span>.
                                                This package groups together all annotations used to define beans. These annotations are also relevant to the role of a bean. For example, <span class="EmphasisFontCategoryNonProportional">@Service</span>                                                is used to define a service bean, which is a more complex functional bean that provides services that other beans may require, and <span class="EmphasisFontCategoryNonProportional">@Repository</span> is
                                                used to define a bean that is used to retrieve/save data from/to a database, etc.</div>
                                        </div>
                                        <div class="ClearBoth"> </div>
                                    </div>
                                    <div class="Footnote" id="Fn3"><span class="FootnoteNumber"><a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_3_Chapter.html#Fn3_source">3</a></span>
                                        <div class="FootnoteParas">
                                            <div class="Para" id="Par253"> <span class="EmphasisFontCategoryNonProportional">cglib</span> is a powerful, high-performance, and high-quality code generation library. It can extend Java classes and implement interfaces at runtime. It is
                                                open source, and you can find the official repository at <span class="ExternalRef"><a href="https://github.com/cglib"><span class="RefSource">                      <span class="EmphasisFontCategoryNonProportional">https://github.com/cglib</span>                                                </span>
                                                </a>
                                                </span>.</div>
                                        </div>
                                        <div class="ClearBoth"> </div>
                                    </div>
                                    <div class="Footnote" id="Fn4"><span class="FootnoteNumber"><a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_3_Chapter.html#Fn4_source">4</a></span>
                                        <div class="FootnoteParas">
                                            <div class="Para" id="Par364">You can look at the full implementation here: <span class="ExternalRef"><a href="https://github.com/spring-projects/spring-framework/blob/master/spring-core/src/main/java/org/springframework/core/annotation/AliasFor.java"><span class="RefSource">                        <span class="EmphasisFontCategoryNonProportional">https://github.com/spring-projects/spring-framework/blob/master/spring-core/src/main/java/org/springframework/core/annotation/AliasFor.java</span>                                                </span>
                                                </a>
                                                </span>.</div>
                                        </div>
                                        <div class="ClearBoth"> </div>
                                    </div>
                                </div>
                    </div>
            </div>
          </div>
        </section>
      </div>
    </div>
    <div class="font-flyout" style="top: 200.531px; left: 1280px;"> </div>



<hr/>
<!--if IE]><![endif]-->

<!--if IE 8]><html class="no-js ie8 oldie" lang="en" prefix="og: http://ogp.me/ns/# og:book: http://ogp.me/ns/book# og:video: http://ogp.me/ns/video#"            itemscope itemtype="http://schema.org/Book http://schema.org/ItemPage" data-login-url="/accounts/login/"data-offline-url="/"data-url="/library/view/pro-spring-5/9781484228081/A315511_5_En_4_Chapter.html"data-csrf-cookie="csrfsafari"data-highlight-privacy=""  data-user-id="3866890"  data-user-uuid="72b95c3c-5b13-4319-82fa-5c73754754ca"  data-username="levinxccai"  data-account-type="B2B"    data-activated-trial-date="11/06/2017"  data-archive="9781484228081"  data-publishers="Apress"  data-htmlfile-name="A315511_5_En_4_Chapter.html"  data-epub-title="Pro Spring 5: An In-Depth Guide to the Spring Framework and Its Tools" data-debug=0 data-testing=0><![endif]-->
<!--if gt IE 8]><!-->

<!--![endif]-->




<a name="4_"></a>

    <div class="application" id="container" style="height: auto;">
        <div class="js-toc">
            <section role="document">
                <div id="sbo-rt-content" style="max-width:72.5em; transform: none;">
                    <div class="annotator-wrapper">
                        <!--egin Abstract-->
                        <div class="MainTitleSection">
                            <h1 class="ChapterTitle" xml:lang="en">4. Spring Configuration in Detail and Spring Boot</h1>
                        </div>
                        <div class="AuthorGroup">
                            <div class="AuthorNames"><span class="Author"><span class="AuthorName">Iuliana Cosmina</span><sup>1 <span class="ContactIcon"></span></sup>, </span><span class="Author"><span class="AuthorName">Rob Harrop</span><sup>2</sup>, </span>
                                <span class="Author"><span class="AuthorName">Chris Schaefer</span><sup>3</sup> and </span><span class="Author"><span class="AuthorName">Clarence Ho</span><sup>4</sup></span>
                            </div>
                            <div class="Affiliations">
                                <div class="Affiliation" id="Aff5"><span class="AffiliationNumber">(1)</span>
                                    <div class="AffiliationText">Sibiu, Sibiu, Romania</div>
                                </div>
                                <div class="Affiliation" id="Aff6"><span class="AffiliationNumber">(2)</span>
                                    <div class="AffiliationText">Reddish, UK</div>
                                </div>
                                <div class="Affiliation" id="Aff7"><span class="AffiliationNumber">(3)</span>
                                    <div class="AffiliationText">Venice, Florida, USA</div>
                                </div>
                                <div class="Affiliation" id="Aff8"><span class="AffiliationNumber">(4)</span>
                                    <div class="AffiliationText">Hong Kong, China</div>
                                </div>
                                <div class="ClearBoth"> </div>
                            </div>
                        </div>
                        <!--nd Abstract-->
                        <div class="Fulltext">
                            <div class="Para" id="Par1">In the previous chapter, we presented a detailed look at the concept of inversion of control (IoC) and how it fits into the Spring Framework. However, we have really only scratched the surface of what Spring Core can do. Spring
                                provides a wide array of services that supplement and extend its basic IoC capabilities. In this chapter, you are going to explore these in detail. Specifically, you will be looking at the following:
                                <div class="UnorderedList">
                                    <ul class="UnorderedListMarkBullet">
                                        <li>
                                            <div class="Para" id="Par2"> <span class="EmphasisTypeItalic">Managing the</span> <span id="ITerm1">                  <span class="EmphasisTypeItalic">bean life cycle</span> </span>: So far, all the beans you have seen have been fairly
                                                simple and completely decoupled from the Spring container. In this chapter, we present some strategies you can employ to enable your beans to receive notifications from the Spring container at various points
                                                throughout their life cycles. You can do this either by implementing specific interfaces laid out by Spring, by specifying methods that Spring can call via reflection, or by using JSR-250 JavaBeans life-cycle
                                                annotations.</div>
                                        </li>
                                        <li>
                                            <div class="Para" id="Par3"> <span class="EmphasisTypeItalic">Making your beans “</span> <span id="ITerm2">                  <span class="EmphasisTypeItalic">Spring aware</span> </span> <span class="EmphasisTypeItalic">”</span>: In some
                                                cases, you want a bean to be able to interact with the <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> instance that configured it. For this reason, Spring offers two interfaces,
                                                <span class="EmphasisFontCategoryNonProportional">BeanNameAware</span> and <span class="EmphasisFontCategoryNonProportional">ApplicationContextAware</span> (introduced at the end of Chapter <span class="ExternalRef"><a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_3_Chapter.html"><span class="RefSource">3</span></a>
                                                </span>), that allow your bean to obtain its assigned name and reference its <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>, respectively. This section of the chapter covers implementing
                                                these interfaces and gives some practical considerations for using them in your application.</div>
                                        </li>
                                        <li>
                                            <div class="Para" id="Par4"> <span class="EmphasisTypeItalic">Using</span> <span id="ITerm3">                  <span class="EmphasisTypeItalic">FactoryBeans</span> </span>: As its name implies, the <span class="EmphasisFontCategoryNonProportional">FactoryBean</span>                                                interface is meant to be implemented by any bean that acts as a factory for other beans. The <span class="EmphasisFontCategoryNonProportional">FactoryBean</span> interface provides a mechanism by which you
                                                can easily integrate your own factories with the Spring <span class="EmphasisFontCategoryNonProportional">BeanFactory</span> interface.</div>
                                        </li>
                                        <li>
                                            <div class="Para" id="Par5"> <span class="EmphasisTypeItalic">Working with</span> <span id="ITerm4">                  <span class="EmphasisTypeItalic">JavaBeans PropertyEditors</span> </span>: The <span class="EmphasisFontCategoryNonProportional">PropertyEditor</span>                                                interface is a standard interface provided in the <span class="EmphasisFontCategoryNonProportional">java.beans</span> package. <span class="EmphasisFontCategoryNonProportional">PropertyEditor</span>s are
                                                used to convert property values to and from <span class="EmphasisFontCategoryNonProportional">String</span> representations. Spring uses <span class="EmphasisFontCategoryNonProportional">PropertyEditor</span>s
                                                extensively, mainly to read values specified in the <span class="EmphasisFontCategoryNonProportional">BeanFactory</span> configuration and convert them into the correct types. In this chapter, we discuss
                                                the set of <span class="EmphasisFontCategoryNonProportional">PropertyEditor</span>s supplied with Spring and how you can use them within your application. We also take a look at implementing custom
                                                <span class="EmphasisFontCategoryNonProportional">PropertyEditor</span>s.</div>
                                        </li>
                                        <li>
                                            <div class="Para" id="Par6"> <span class="EmphasisTypeItalic">Learning more about the</span> <span id="ITerm5">                  <span class="EmphasisTypeItalic">Spring ApplicationContext</span> </span>: As we know, <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>                                                is an extension of <span class="EmphasisFontCategoryNonProportional">BeanFactory</span> intended for use in full applications. The <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>                                                interface provides a useful set of additional functionality, including internationalized message support, resource loading, and event publishing. In this chapter, we present a detailed look at the features
                                                in addition to IoC that <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> offers. We also jump ahead of ourselves a little to show you how <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>                                                simplifies the use of Spring when you are building web applications.</div>
                                        </li>
                                        <li>
                                            <div class="Para" id="Par7"> <span class="EmphasisTypeItalic">Using</span> <span id="ITerm6">                  <span class="EmphasisTypeItalic">Java classes</span> </span> <span class="EmphasisTypeItalic">for configuration</span>: Prior
                                                to 3.0, Spring supported only the XML base configuration with annotations for beans and dependency configuration. Starting with 3.0, Spring offers another option for developers to configure the Spring
                                                <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> interface using Java classes. We take a look at this new option in Spring application configuration.</div>
                                        </li>
                                        <li>
                                            <div class="Para" id="Par8"> <span class="EmphasisTypeItalic">Using</span> <span id="ITerm7">                  <span class="EmphasisTypeItalic">Spring Boot</span> </span> <span class="EmphasisTypeBold">:</span> Spring application configuration
                                                is made even more practical by using Spring Boot. This Spring project makes it easy to create stand-alone, production-grade, Spring-based applications that you can “just run.”</div>
                                        </li>
                                        <li>
                                            <div class="Para" id="Par9"> <span class="EmphasisTypeItalic">Using</span> <span id="ITerm8">                  <span class="EmphasisTypeItalic">configuration enhancements</span> </span>: We present features that make application configuration
                                                easier, such as profile management, environment and property source abstraction, and so on. In this section, we cover those features and show how to use them to address specific configuration needs.</div>
                                        </li>
                                        <li>
                                            <div class="Para" id="Par10"> <span class="EmphasisTypeItalic">Using</span> <span id="ITerm9">                  <span class="EmphasisTypeItalic">Groovy</span> </span> <span class="EmphasisTypeItalic">for configuration</span>: New to Spring
                                                4.0 is the ability to configure bean definitions in the Groovy language, which can be used as an alternative or supplement to the existing XML and Java configuration methods.</div>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                            <div class="Section1 RenderAsSection1" id="Sec1">
                                <h2 class="Heading">Spring’s Impact on Application Portability</h2>
                                <div class="Para" id="Par11">Most of the features discussed in this chapter are specific to Spring and, in many cases, are not available in other IoC containers. Although many IoC containers offer life-cycle management functionality, they probably
                                    do so through a different set of interfaces than Spring. If the portability of your application between different IoC containers is truly important, you might want to avoid using some of the features that couple your
                                    application to Spring.</div>
                                <div class="Para" id="Par12">Remember, however, that by setting a constraint—meaning that your application is portable between IoC containers—you are losing out on the wealth of functionality Spring offers. Because you are likely to be making a strategic
                                    choice to use Spring, it makes sense that you use it to the best of its ability.</div>
                                <div class="Para" id="Par13">Be careful not to create a requirement for <span id="ITerm10">portability                  </span> out of thin air. In many cases, the end users of your application do not care whether the application can run on three different
                                    IoC containers; they just want it to run. In our experience, it is often a mistake to try to build an application on the lowest common denominator of features available in your chosen technology. Doing so often sets
                                    your application at a disadvantage right from the get-go. However, if your application requires IoC container portability, do not see this as a drawback—it is a true requirement and, therefore, one your application
                                    should fulfill. In <span class="EmphasisTypeItalic">Expert One-on-One: J2EE Development without EJB</span> (Wrox, 2004), Rod Johnson and Jürgen Höller describe these types of requirements as phantom requirements and
                                    provide a much more detailed discussion of them and how they can affect your project.</div>
                                <div class="Para" id="Par14">Although using these features may couple your application to the Spring Framework, in reality you are increasing the portability of your application in the wider scope. Consider that you are using a freely available, open
                                    source framework that has no particular vendor affiliation. An application built using Spring’s IoC container runs anywhere Java runs. For Java enterprise applications, Spring opens up new possibilities for portability.
                                    Spring provides many of the same capabilities as JEE and also provides classes to abstract and simplify many other aspects of JEE. In many cases, it is possible to build a web application using Spring that runs in a
                                    simple servlet container but with the same level of sophistication as an application targeted at a full-blown JEE application server. By coupling to Spring, you can increase your application’s portability by replacing
                                    many features that either are vendor-specific or rely on vendor-specific configuration with equivalent features in <span id="ITerm11">Spring                  </span>.</div>
                            </div>
                            <div class="Section1 RenderAsSection1" id="Sec2">
                                <h2 class="Heading">Bean Life-Cycle Management</h2>
                                <div class="Para" id="Par15">An important part of any IoC container, Spring included, is that beans can be constructed in such a way that they receive notifications at certain points in their life cycle. This enables your beans to perform relevant
                                    processing at certain points throughout their life. In general, two life-cycle events are particularly relevant to a bean: <span id="ITerm12">post-initialization and pre-destruction                  </span>.</div>
                                <div class="Para" id="Par16">In the context of Spring, the post-initialization event is raised as soon as Spring finishes setting all the property values on the bean and finishes any dependency checks that you configured it to perform. The pre-destruction
                                    event is fired just before Spring destroys the bean instance. However, for beans with prototype scope, the pre-destruction event will not be fired by Spring. The design of Spring is that the initialization life-cycle
                                    callback methods will be called on objects regardless of bean scope, while for beans with prototype scope, the destruction life-cycle callback methods will not be called. Spring provides three mechanisms a bean can
                                    use to hook into each of these events and perform some additional processing: interface-based, method-based, and annotation-based mechanisms.</div>
                            <div class="Para ParaOneEmphasisChild" id="Par17">Using the interface-based mechanism, your bean implements an interface specific to the type of notification it wants to receive, and Spring notifies the bean via a callback method defined in the interface. For the method-based
                                mechanism, Spring allows you to specify, in your <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> configuration, the name of a method to call when the bean is initialized and the name of a method
                                to call when the bean is destroyed. For the annotation mechanism, you can use JSR-250 annotations to specify the method that Spring should call after construction or before destruction.</div>
                            <div class="Para" id="Par18">In the case of both events, the mechanisms achieve exactly the same goal. The <span id="ITerm13">interface mechanism                  </span> is used extensively throughout Spring so that you don’t have to remember to specify
                                the initialization or destruction each time you use one of Spring’s components. However, in your own beans, you may be better served using the method-based or annotation mechanism because your beans do not need to implement
                                any Spring-specific interfaces. Although we stated that portability often isn’t as important a requirement as many books lead you to believe, this does not mean you should sacrifice portability when a perfectly good alternative
                                exists. That said, if you are coupling your application to Spring in other ways, using the interface method allows you to specify the callback once and then forget about it. If you are defining a lot of beans of the same
                                type that need to take advantage of the life-cycle notifications, then using the interface mechanism can avoid the need for specifying the life-cycle callback methods for every bean in the XML configuration file. Using
                                JSR-250 annotations is also another viable option, since it’s a standard defined by the JCP and you are also not coupled to Spring’s specific annotations. Just make sure that the IoC container you are running your application
                                on supports the JSR-250 standard.</div>
                            <div class="Para" id="Par19">Overall, the choice of which mechanism you use for receiving life-cycle notifications depends on your application requirements. If you are concerned about portability or you are just defining one or two beans of a particular
                                type that need the callbacks, use the method-based mechanism. If you use annotation-type configuration and are certain that you are using an IoC container that supports JSR-250, use the annotation mechanism. If you are
                                not too concerned about portability or you are defining many beans of the same type that need the life-cycle notifications, using the interface-based mechanism is the best way to ensure that your beans always receive the
                                notifications they are expecting. If you plan to use a bean across many different Spring projects, you almost certainly want the functionality of that bean to be as self-contained as possible, so you should definitely use
                                the interface-based mechanism.</div>
                            <div class="Para" id="Par20">Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_4_Chapter.html#Fig1">4-1</a></span> shows a high-level overview of how Spring manages the life cycle
                                of the beans within its container.
                                <div class="Figure" id="Fig1">
                                    <div class="MediaObject" id="MO1"><img alt="A315511_5_En_4_Fig1_HTML.jpg" data-mfp-src="/library/view/pro-spring-5/9781484228081/A315511_5_En_4_Fig1_HTML.jpg" height="259" src="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_4_Fig1_HTML.jpg" width="690"/></div>
                                    <div class="Caption" xml:lang="en">
                                        <div class="CaptionContent"><span class="CaptionNumber">Figure 4-1.</span>
                                            <div class="SimplePara">Spring beans life cycle</div>
                                        </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="Section1 RenderAsSection1" id="Sec3">
                        <h2 class="Heading">Hooking into Bean Creation</h2>
                        <div class="Para" id="Par21">By being aware of when it is initialized, a bean can check whether all its required dependencies are satisfied. Although Spring can check dependencies for you, it is pretty much an all-or-nothing approach, and it doesn’t offer
                            any opportunities for applying additional logic to the dependency resolution procedure. Consider a bean that has four dependencies declared as setters, two of which are required and one of which has a suitable default in the
                            event that no dependency is provided. Using an initialization callback, your bean can check for the dependencies it requires, throwing an exception or providing a default as needed.</div>
                        <div class="Para" id="Par22">A bean cannot perform these checks in its constructor because at this point, Spring has not had an opportunity to provide values for the dependencies it can satisfy. The initialization callback in Spring is called after Spring
                            finishes providing the dependencies that it can and performs any dependency checks that you ask of it.</div>
                        <div class="Para" id="Par23">You are not limited to using the <span id="ITerm14">initialization callback                  </span> just to check dependencies; you can do anything you want in the callback, but it is most useful for the purpose we have described.
                            In many cases, the initialization callback is also the place to trigger any actions that your bean must take automatically in response to its configuration. For instance, if you build a bean to run scheduled tasks, the initialization
                            callback provides the ideal place to start the scheduler—after all, the configuration data is set on the bean.</div>
                        <div class="Para ParaTypeImportant" id="Par24"><img alt="A315511_5_En_4_Figa_HTML.jpg" data-mfp-src="/library/view/pro-spring-5/9781484228081/A315511_5_En_4_Figa_HTML.jpg" height="28" src="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_4_Figa_HTML.jpg" width="30"/>                            You will not have to write a bean to run scheduled tasks because this is something Spring can do automatically through its built-in scheduling feature or via integration with the Quartz scheduler. We cover this in more detail
                            in Chapter <span class="ExternalRef"><a href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_11_Chapter.html"><span class="RefSource">11</span></a>
                            </span>.</div>
                        <div class="Section2 RenderAsSection2" id="Sec4">
                            <h3 class="Heading">Executing a Method When a Bean Is Created</h3>
                            <div class="Para" id="Par25">As we mentioned previously, one way to receive the initialization callback is to designate a method on your bean as an initialization method and tell Spring to use this method as an initialization method. As discussed, this
                                callback mechanism is useful when you have only a few beans of the same type or when you want to keep your application decoupled from Spring. Another reason for using this mechanism is to enable your Spring application
                                to work with beans that were built previously or were provided by third-party vendors. Specifying a callback method is simply a case of specifying the name in the <span id="ITerm15">                <span class="EmphasisFontCategoryNonProportional">init-method</span>                                </span> attribute of a bean’s <span class="EmphasisFontCategoryNonProportional">&lt;bean&gt;</span> tag. The following code sample shows a basic bean with two dependencies:</div>
                            <pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.beans.factory.BeanCreationException</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.ApplicationContext</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.support.GenericXmlApplicationContext</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">Singer</span> {
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">final</span> <span style="color:#00f;font-weight:700">String</span> <span style="color:#c5060b;font-weight:700">DEFAULT_NAME</span> <span style="color:#00f;font-weight:700">=</span> <span style="color:#036a07">Eric Clapton</span>;
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">String</span> name;
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">int</span> age <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">Integer</span><span style="color:#c5060b;font-weight:700"><span style="color:#00f;font-weight:700">.</span>MIN_VALUE</span>;

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setName</span>(<span style="color:#00f;font-weight:700">String</span> <span style="font-style:italic">name</span>) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>name <span style="color:#00f;font-weight:700">=</span> name;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setAge</span>(<span style="color:#00f;font-weight:700">int</span> <span style="font-style:italic">age</span>) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>age <span style="color:#00f;font-weight:700">=</span> age;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">init</span>() {
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">Initializing bean</span>);
        <span style="color:#00f;font-weight:700">if</span> (name <span style="color:#00f;font-weight:700">==</span> <span style="color:#585cf6;font-weight:700">null</span>) {
            <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">Using default name</span>);
            name <span style="color:#00f;font-weight:700">=</span> <span style="color:#c5060b;font-weight:700">DEFAULT_NAME</span>;
        }
        <span style="color:#00f;font-weight:700">if</span> (age <span style="color:#00f;font-weight:700">==</span> <span style="color:#00f;font-weight:700">Integer</span><span style="color:#c5060b;font-weight:700"><span style="color:#00f;font-weight:700">.</span>MIN_VALUE</span>) {
            <span style="color:#00f;font-weight:700">throw</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">IllegalArgumentException</span>(
                    <span style="color:#036a07">You must set the age property of any beans of type </span> <span style="color:#00f;font-weight:700">+</span> <span style="color:#00f;font-weight:700">Singer</span><span style="color:#00f;font-weight:700">.</span>class);
        }
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">String</span> <span style="color:#0000a2;font-weight:700">toString</span>() {
        <span style="color:#00f;font-weight:700">return</span> <span style="color:#036a07">&quot;<span style="color:#26b31a">\t</span>Name: &quot;</span> <span style="color:#00f;font-weight:700">+</span> name <span style="color:#00f;font-weight:700">+</span> <span style="color:#036a07">&quot;<span style="color:#26b31a">\n</span><span style="color:#26b31a">\t</span>Age: &quot;</span> <span style="color:#00f;font-weight:700">+</span> age;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span>... <span style="font-style:italic">args</span>) {
        <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span> ctx <span style="color:#00f;font-weight:700">=</span>
                <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span>();
        ctx<span style="color:#00f;font-weight:700">.</span>load(<span style="color:#036a07">classpath:spring/app-context-xml.xml</span>);
        ctx<span style="color:#00f;font-weight:700">.</span>refresh();
        getBean(<span style="color:#036a07">singerOne</span>, ctx);
        getBean(<span style="color:#036a07">singerTwo</span>, ctx);
        getBean(<span style="color:#036a07">singerThree</span>, ctx);
        ctx<span style="color:#00f;font-weight:700">.</span>close();
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">Singer</span> <span style="color:#0000a2;font-weight:700">getBean</span>(<span style="color:#00f;font-weight:700">String</span> <span style="font-style:italic">beanName</span>,
                                 <span style="color:#00f;font-weight:700">ApplicationContext</span> <span style="font-style:italic">ctx</span>) {
        <span style="color:#00f;font-weight:700">try</span> {
            <span style="color:#00f;font-weight:700">Singer</span> bean <span style="color:#00f;font-weight:700">=</span> (<span style="color:#00f;font-weight:700">Singer</span>) ctx<span style="color:#00f;font-weight:700">.</span>getBean(beanName);
            <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(bean);
            <span style="color:#00f;font-weight:700">return</span> bean;
        } <span style="color:#00f;font-weight:700">catch</span> (<span style="color:#00f;font-weight:700">BeanCreationException</span> ex) {
            <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">An error occured in bean configuration: </span>
                    <span style="color:#00f;font-weight:700">+</span> ex<span style="color:#00f;font-weight:700">.</span>getMessage());
            <span style="color:#00f;font-weight:700">return</span> <span style="color:#585cf6;font-weight:700">null</span>;
        }
    }
}
</pre>
                            <div class="Para" id="Par27">Notice that we have defined a method, <span class="EmphasisFontCategoryNonProportional">init()</span>, to act as the initialization callback. The <span class="EmphasisFontCategoryNonProportional">init()</span> method checks
                                whether the name property has been set, and if it has not, it uses the default value stored in the <span class="EmphasisFontCategoryNonProportional">DEFAULT_NAME</span> constant. <span class="EmphasisFontCategoryNonProportional">The init()</span>                                method also checks whether the <span class="EmphasisFontCategoryNonProportional">age</span> property is set and throws <span class="EmphasisFontCategoryNonProportional">IllegalArgumentException</span> if it is not.</div>
                            <div class="Para" id="Par28">The <span class="EmphasisFontCategoryNonProportional">main()</span> method of the <span class="EmphasisFontCategoryNonProportional">SimpleBean</span> class attempts to obtain three beans from <span class="EmphasisFontCategoryNonProportional">GenericXmlApplicationContext</span>,
                                all of type <span class="EmphasisFontCategoryNonProportional">Singer</span>, using its own <span class="EmphasisFontCategoryNonProportional">getBean()</span> method. Notice that in the <span class="EmphasisFontCategoryNonProportional">getBean()</span>                                method, if the bean is obtained successfully, its details are written to console output. If an exception is thrown in the <span class="EmphasisFontCategoryNonProportional">init()</span> method, as will occur in this case
                                if the <span class="EmphasisFontCategoryNonProportional">age</span> property is not set, then Spring wraps that exception in <span class="EmphasisFontCategoryNonProportional">BeanCreationException. The getBean()</span>                                method catches these exceptions and writes a message to the console output informing us of the error, as well as returns a <span class="EmphasisFontCategoryNonProportional">null</span> value.</div>
                        <div class="Para" id="Par29">The following configuration snippet shows an <span id="ITerm17">                <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> </span> configuration that defines the beans used in the previous code
                            snippet (<span class="EmphasisFontCategoryNonProportional">app-context-xml.xml</span>):</div>
                        <pre style="background:#fff;color:#000"><span style="color:#68685b">&lt;?<span style="color:#888">xml</span><span style="color:#888"> version</span>=<span style="color:#888">1.0</span><span style="color:#888"> encoding</span>=<span style="color:#888">UTF-8</span>?&gt;</span>
<span style="color:#1c02ff">&lt;<span style="font-weight:700">beans</span> <span style="font-style:italic">xmlns</span>=<span style="color:#036a07">http://www.springframework.org/schema/beans</span>
    <span style="font-style:italic">xmlns</span>:xsi=<span style="color:#036a07">http://www.w3.org/2001/XMLSchema-instance</span>
    <span style="font-style:italic">xmlns</span>:p=<span style="color:#036a07">http://www.springframework.org/schema/p</span>
    <span style="font-style:italic">xsi</span>:schemaLocation=<span style="color:#036a07">http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans.xsd</span>
    <span style="font-style:italic">default-lazy-init</span>=<span style="color:#036a07">true</span>&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">singerOne</span>
        <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch4.Singer</span>
        <span style="font-style:italic">init-method</span>=<span style="color:#036a07">init</span> <span style="font-style:italic">p</span>:name=<span style="color:#036a07">John Mayer</span>  <span style="font-style:italic">p</span>:age=<span style="color:#036a07">39</span>/&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">singerTwo</span>
        <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch4.Singer</span>
        <span style="font-style:italic">init-method</span>=<span style="color:#036a07">init</span> <span style="font-style:italic">p</span>:age=<span style="color:#036a07">72</span>/&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">singerThree</span>
        <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch4.Singer</span>
        <span style="font-style:italic">init-method</span>=<span style="color:#036a07">init</span> <span style="font-style:italic">p</span>:name=<span style="color:#036a07">John Butler</span>/&gt;</span>
<span style="color:#1c02ff">&lt;/<span style="font-weight:700">beans</span>&gt;</span>
</pre>
                        <div class="Para" id="Par31">As you can see, the <span class="EmphasisFontCategoryNonProportional">&lt;bean&gt;</span> tag for each of the three beans has an <span class="EmphasisFontCategoryNonProportional">init-method</span> attribute that tells Spring that
                            it should invoke the <span class="EmphasisFontCategoryNonProportional">init()</span> method as soon as it finishes configuring the bean. The <span class="EmphasisFontCategoryNonProportional">singerOne</span> bean has values
                            for both the <span class="EmphasisFontCategoryNonProportional">name</span> and <span class="EmphasisFontCategoryNonProportional">age</span> properties, so it passes through the <span class="EmphasisFontCategoryNonProportional">init()</span>                            method with absolutely no changes. The <span class="EmphasisFontCategoryNonProportional">singerTwo</span> bean has no value for the <span class="EmphasisFontCategoryNonProportional">name</span> property, meaning that in the
                            <span class="EmphasisFontCategoryNonProportional">init()</span> method, the <span class="EmphasisFontCategoryNonProportional">name</span> property is given the default value. Finally, the <span class="EmphasisFontCategoryNonProportional">singerThree</span>                            bean has no value for the <span class="EmphasisFontCategoryNonProportional">age</span> property. The logic defined in the <span class="EmphasisFontCategoryNonProportional">init()</span> method treats this as an error, so
                            <span class="EmphasisFontCategoryNonProportional">IllegalArgumentException</span> is thrown. Also note that in the <span class="EmphasisFontCategoryNonProportional">&lt;beans&gt;</span> tag, we added the attribute <span class="EmphasisFontCategoryNonProportional">default-lazy-init=&quot;true&quot;</span>                                to instruct Spring to instantiate the beans defined in the configuration file only when the bean was requested from the application. If we do not specify it, Spring will try to initialize all the beans during the bootstrapping
                                of <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>, and it will fail during the initialization of <span class="EmphasisFontCategoryNonProportional">singerThree</span>.</div>
                        <div class="Para" id="Par32">When all the beans in a configuration file have the same <span class="EmphasisFontCategoryNonProportional">init-method</span> configuration, the file can be simplified, by setting the <span id="ITerm19">                <span class="EmphasisFontCategoryNonProportional">default-init-method</span>                            </span> attribute on the <span class="EmphasisFontCategoryNonProportional">&lt;beans&gt;</span> element. The beans can be of different types; the only condition for them is to have a method named as the <span class="EmphasisFontCategoryNonProportional">default-init-method</span>                            attribute value. So, the previous configuration can be written like this as well:</div>
                        <pre style="background:#fff;color:#000"><span style="color:#1c02ff">&lt;<span style="font-weight:700">beans</span> ...
    <span style="font-style:italic">default-lazy-init</span>=<span style="color:#036a07">true</span> <span style="font-style:italic">default-init-method</span>=<span style="color:#036a07">init</span>&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">singerOne</span>
        <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch4.Singer</span>
          <span style="font-style:italic">p</span>:name=<span style="color:#036a07">John Mayer</span> <span style="font-style:italic">p</span>:age=<span style="color:#036a07">39</span>/&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">singerTwo</span>
        <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch4.Singer</span>
         <span style="font-style:italic">p</span>:age=<span style="color:#036a07">72</span>/&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">singerThree</span>
        <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch4.Singer</span>
         <span style="font-style:italic">p</span>:name=<span style="color:#036a07">John Butler</span>/&gt;</span>
<span style="color:#1c02ff">&lt;/<span style="font-weight:700">beans</span>&gt;</span>
</pre>
                        <div class="Para" id="Par34">Running the previous example yields the following output:</div>
                        <div class="Para" id="Par35">
                            <div class="ProgramCode" id="PC4">
                                <div class="FixedLine">Initializing bean</div>
                                <div class="FixedLine">        Name: John Mayer</div>
                                <div class="FixedLine">        Age: 39</div>
                                <div class="FixedLine">Initializing bean</div>
                                <div class="FixedLine">Using default name</div>
                                <div class="FixedLine">        Name: Eric Clapton</div>
                                <div class="FixedLine">        Age: 72</div>
                                <div class="FixedLine">Initializing bean</div>
                                <div class="FixedLine">An error occured in bean configuration: Error creating bean</div>
                                <div class="FixedLine">with name <span class="EmphasisTypeUnderline">singerThree</span> defined in class path</div>
                                <div class="FixedLine">resource spring/app-context-xml.xml: Invocation of init method failed;</div>
                                <div class="FixedLine">nested exception is java.lang.IllegalArgumentException:</div>
                                <div class="FixedLine">You must set the age property of any beans of type class</div>
                                <div class="FixedLine"> com.apress.prospring5.ch4.Singer</div>
                            </div>
                        </div>
                        <div class="Para" id="Par36">From this output, you can see that <span class="EmphasisFontCategoryNonProportional">singerOne</span> was configured correctly with the values that we specified in the configuration file. For <span class="EmphasisFontCategoryNonProportional">singerTwo</span>,
                            the default value for the <span class="EmphasisFontCategoryNonProportional">name</span> property was used because no value was specified in the configuration. Finally, for <span class="EmphasisFontCategoryNonProportional">singerThree</span>,
                            no bean instance was created because the <span class="EmphasisFontCategoryNonProportional">init()</span> method raised an error because of the lack of a value for the <span class="EmphasisFontCategoryNonProportional">age</span>                            property.</div>
                        <div class="Para" id="Par37">As you can see, using the initialization method is an ideal way to ensure that your beans are configured correctly. By using this mechanism, you can take full advantage of the benefits of IoC without losing any of the control you
                            get from manually defining dependencies. The only constraint on your initialization method is that it cannot accept any arguments. You can define any return type, although it is ignored by Spring, and you can even use a static
                            method, but the method must accept no arguments.</div>
                        <div class="Para" id="Par38">The benefits of this mechanism are negated when using a static initialization method, because you cannot access any of the bean’s state to validate it. If your bean is using static state as a mechanism for saving memory and you
                            are using a static initialization method to validate this state, then you should consider moving the static state to instance state and using a nonstatic initialization method. If you use Spring’s singleton management capabilities,
                            the end effect is the same, but you have a bean that is much simpler to test, and you also have the increased effect of being able to create multiple instances of the bean with their own state when necessary. Of course, in
                            some instances, you need to use static state shared across multiple instances of a bean, in which case you can always use a static initialization method.</div>
                    </div>
                    <div class="Section2 RenderAsSection2" id="Sec5">
                        <h3 class="Heading">Implementing the InitializingBean Interface</h3>
                        <div class="Para" id="Par39">The <span id="ITerm20">                <span class="EmphasisFontCategoryNonProportional">InitializingBean</span> </span> interface defined in Spring allows you to define inside your bean code that you want the bean to receive notification
                            that Spring has finished configuring it. In the same way as when you are using an initialization method, this gives you the opportunity to check the bean configuration to ensure that it is valid, providing any default values
                            along the way. The <span class="EmphasisFontCategoryNonProportional">InitializingBean</span> interface defines a single method, <span class="EmphasisFontCategoryNonProportional">afterPropertiesSet()</span>, that serves the
                            same purpose as the <span class="EmphasisFontCategoryNonProportional">init()</span> method introduced in the previous section. The following code snippet shows a reimplementation of the previous example using the <span class="EmphasisFontCategoryNonProportional">InitializingBean</span>                            interface in place of the initialization method:</div>
                        <pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.beans.factory.BeanCreationException</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.beans.factory.InitializingBean</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.ApplicationContext</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.support.GenericXmlApplicationContext</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">SingerWithInterface</span> <span style="color:#00f;font-weight:700">implements</span> <span style="font-style:italic">InitializingBean</span> {
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">final</span> <span style="color:#00f;font-weight:700">String</span> <span style="color:#c5060b;font-weight:700">DEFAULT_NAME</span> <span style="color:#00f;font-weight:700">=</span> <span style="color:#036a07">Eric Clapton</span>;
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">String</span> name;
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">int</span> age <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">Integer</span><span style="color:#c5060b;font-weight:700"><span style="color:#00f;font-weight:700">.</span>MIN_VALUE</span>;

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setName</span>(<span style="color:#00f;font-weight:700">String</span> <span style="font-style:italic">name</span>) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>name <span style="color:#00f;font-weight:700">=</span> name;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setAge</span>(<span style="color:#00f;font-weight:700">int</span> <span style="font-style:italic">age</span>) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>age <span style="color:#00f;font-weight:700">=</span> age;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">afterPropertiesSet</span>() <span style="color:#00f;font-weight:700">throws</span> <span style="color:#00f;font-weight:700">Exception</span> {
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">Initializing bean</span>);
        <span style="color:#00f;font-weight:700">if</span> (name <span style="color:#00f;font-weight:700">==</span> <span style="color:#585cf6;font-weight:700">null</span>) {
            <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">Using  default  name</span>);
            name <span style="color:#00f;font-weight:700">=</span> <span style="color:#c5060b;font-weight:700">DEFAULT_NAME</span>;
        }
        <span style="color:#00f;font-weight:700">if</span> (age <span style="color:#00f;font-weight:700">==</span> <span style="color:#00f;font-weight:700">Integer</span><span style="color:#c5060b;font-weight:700"><span style="color:#00f;font-weight:700">.</span>MIN_VALUE</span>) {
            <span style="color:#00f;font-weight:700">throw</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">IllegalArgumentException</span>(
                    <span style="color:#036a07">You must set the age property of any beans of type </span>
                            <span style="color:#00f;font-weight:700">+</span> <span style="color:#00f;font-weight:700">SingerWithInterface</span><span style="color:#00f;font-weight:700">.</span>class);
        }
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">String</span> <span style="color:#0000a2;font-weight:700">toString</span>() {
        <span style="color:#00f;font-weight:700">return</span> <span style="color:#036a07">&quot;<span style="color:#26b31a">\t</span>Name: &quot;</span> <span style="color:#00f;font-weight:700">+</span> name <span style="color:#00f;font-weight:700">+</span> <span style="color:#036a07">&quot;<span style="color:#26b31a">\n</span><span style="color:#26b31a">\t</span>Age: &quot;</span> <span style="color:#00f;font-weight:700">+</span> age;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span>... <span style="font-style:italic">args</span>) {
        <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span> ctx <span style="color:#00f;font-weight:700">=</span>
                <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span>();
        ctx<span style="color:#00f;font-weight:700">.</span>load(<span style="color:#036a07">classpath:spring/app-context-xml.xml</span>);
        ctx<span style="color:#00f;font-weight:700">.</span>refresh();
        getBean(<span style="color:#036a07">singerOne</span>, ctx);
        getBean(<span style="color:#036a07">singerTwo</span>, ctx);
        getBean(<span style="color:#036a07">singerThree</span>, ctx);
        ctx<span style="color:#00f;font-weight:700">.</span>close();
    }

    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">SingerWithInterface</span> <span style="color:#0000a2;font-weight:700">getBean</span>(<span style="color:#00f;font-weight:700">String</span> <span style="font-style:italic">beanName</span>,
                                               <span style="color:#00f;font-weight:700">ApplicationContext</span> <span style="font-style:italic">ctx</span>) {
        <span style="color:#00f;font-weight:700">try</span> {
            <span style="color:#00f;font-weight:700">SingerWithInterface</span> bean <span style="color:#00f;font-weight:700">=</span>
                    (<span style="color:#00f;font-weight:700">SingerWithInterface</span>) ctx<span style="color:#00f;font-weight:700">.</span>getBean(beanName);
            <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(bean);
            <span style="color:#00f;font-weight:700">return</span> bean;
        } <span style="color:#00f;font-weight:700">catch</span> (<span style="color:#00f;font-weight:700">BeanCreationException</span> ex) {
            <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">An error occured in bean configuration: </span>
                    <span style="color:#00f;font-weight:700">+</span> ex<span style="color:#00f;font-weight:700">.</span>getMessage());
            <span style="color:#00f;font-weight:700">return</span> <span style="color:#585cf6;font-weight:700">null</span>;
        }
    }
}
</pre>
                        <div class="Para" id="Par41">As you can see, not much in this example has changed. Aside from the obvious class name change, the only differences are that this class implements <span class="EmphasisFontCategoryNonProportional">InitializingBean</span> and that
                            the initialization logic has moved into the <span class="EmphasisFontCategoryNonProportional">afterPropertiesSet()</span> method. In the following snippet, you can see the configuration for this example (<span class="EmphasisFontCategoryNonProportional">app-context- xml.xml</span>):</div>
                        <pre style="background:#fff;color:#000"><span style="color:#1c02ff">&lt;<span style="font-weight:700">beans</span> ... <span style="font-style:italic">default-lazy-init</span>=<span style="color:#036a07">true</span>&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">singerOne</span>
          <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch4.SingerWithInterface</span>
          <span style="font-style:italic">p</span>:name=<span style="color:#036a07">John Mayer</span> <span style="font-style:italic">p</span>:age=<span style="color:#036a07">39</span>/&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">singerTwo</span>
          <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch4.SingerWithInterface</span>
          <span style="font-style:italic">p</span>:age=<span style="color:#036a07">72</span>/&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">singerThree</span>
          <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch4.SingerWithInterface</span>
          <span style="font-style:italic">p</span>:name=<span style="color:#036a07">John Butler</span>/&gt;</span>
<span style="color:#1c02ff">&lt;/<span style="font-weight:700">beans</span>&gt;</span>
</pre>
                    <div class="Para" id="Par43">Again, there’s not much difference between the configuration code introduced here and the configuration code in the previous section. The noticeable difference is the omission of the <span class="EmphasisFontCategoryNonProportional">init-method</span>                        attribute. Because the <span class="EmphasisFontCategoryNonProportional">SimpleBeanWithInterface</span> class implements the <span class="EmphasisFontCategoryNonProportional">InitializingBean</span> interface, Spring knows which
                        method to call as the initialization callback, thus removing the need for any additional configuration. The output from this example is shown here:</div>
                    <div class="Para" id="Par44">
                        <div class="ProgramCode" id="PC7">
                            <div class="FixedLine">Initializing bean</div>
                            <div class="FixedLine">        Name: John Mayer</div>
                            <div class="FixedLine">        Age: 39</div>
                            <div class="FixedLine">Initializing bean</div>
                            <div class="FixedLine">Using default  name</div>
                            <div class="FixedLine">        Name: Eric Clapton</div>
                            <div class="FixedLine">        Age: 72</div>
                            <div class="FixedLine">Initializing bean</div>
                            <div class="FixedLine">An error occured in bean configuration: Error creating bean with name &apos;singerThree&apos;<span id="ITerm22">                                                          </span> </div>
                            <div class="FixedLine"> defined in  class path resource spring/app-context-xml.xml: Invocation of</div>
                            <div class="FixedLine"> init method failed; nested exception is java.lang.IllegalArgumentException:</div>
                            <div class="FixedLine"> You must set the age property of any beans of type class</div>
                            <div class="FixedLine"> com.apress.prospring5.ch4.SingerWithInterface</div>
                        </div>
                    </div>
                </div>
                <div class="Section2 RenderAsSection2" id="Sec6">
                    <h3 class="Heading">Using the JSR-250 @PostConstruct Annotation</h3>
                    <div class="Para" id="Par45">Another method that can achieve the same purpose is to use the <span id="ITerm23">JSR-250                      </span> life-cycle annotation, <span class="EmphasisFontCategoryNonProportional">@PostConstruct</span>. Starting from Spring
                        2.5, JSR-250 annotations are also supported to specify the method that Spring should call if the corresponding annotation relating to the bean’s life cycle exists in the class. The following code sample shows the program with the
                        <span class="EmphasisFontCategoryNonProportional">@PostConstruct</span> annotation applied:</div>
                    <pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">javax.annotation.PostConstruct</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.beans.factory.BeanCreationException</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.ApplicationContext</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.support.GenericXmlApplicationContext</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">SingerWithJSR250</span> {
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">final</span> <span style="color:#00f;font-weight:700">String</span> <span style="color:#c5060b;font-weight:700">DEFAULT_NAME</span> <span style="color:#00f;font-weight:700">=</span> <span style="color:#036a07">Eric Clapton</span>;
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">String</span> name;
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">int</span> age <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">Integer</span><span style="color:#c5060b;font-weight:700"><span style="color:#00f;font-weight:700">.</span>MIN_VALUE</span>;

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setName</span>(<span style="color:#00f;font-weight:700">String</span> <span style="font-style:italic">name</span>) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>name <span style="color:#00f;font-weight:700">=</span> name;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setAge</span>(<span style="color:#00f;font-weight:700">int</span> <span style="font-style:italic">age</span>) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>age <span style="color:#00f;font-weight:700">=</span> age;
    }

    <span style="color:#00f;font-weight:700">@PostConstruct</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">init</span>() <span style="color:#00f;font-weight:700">throws</span> <span style="color:#00f;font-weight:700">Exception</span> {
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">Initializing bean</span>);
        <span style="color:#00f;font-weight:700">if</span> (name <span style="color:#00f;font-weight:700">==</span> <span style="color:#585cf6;font-weight:700">null</span>) {
            <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">Using default name</span>);
            name <span style="color:#00f;font-weight:700">=</span> <span style="color:#c5060b;font-weight:700">DEFAULT_NAME</span>;
        }
        <span style="color:#00f;font-weight:700">if</span> (age <span style="color:#00f;font-weight:700">==</span> <span style="color:#00f;font-weight:700">Integer</span><span style="color:#c5060b;font-weight:700"><span style="color:#00f;font-weight:700">.</span>MIN_VALUE</span>) {
            <span style="color:#00f;font-weight:700">throw</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">IllegalArgumentException</span>(
                    <span style="color:#036a07">You must set the age property of any beans of type </span> <span style="color:#00f;font-weight:700">+</span>
                            <span style="color:#00f;font-weight:700">SingerWithJSR250</span><span style="color:#00f;font-weight:700">.</span>class);
        }
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">String</span> <span style="color:#0000a2;font-weight:700">toString</span>() {
        <span style="color:#00f;font-weight:700">return</span> <span style="color:#036a07">&quot;<span style="color:#26b31a">\t</span>Name: &quot;</span> <span style="color:#00f;font-weight:700">+</span> name <span style="color:#00f;font-weight:700">+</span> <span style="color:#036a07">&quot;<span style="color:#26b31a">\n</span><span style="color:#26b31a">\t</span>Age: &quot;</span> <span style="color:#00f;font-weight:700">+</span> age;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span>... <span style="font-style:italic">args</span>) {
        <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span> ctx <span style="color:#00f;font-weight:700">=</span>
                <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span>();
        ctx<span style="color:#00f;font-weight:700">.</span>load(<span style="color:#036a07">classpath:spring/app-context-annotation.xml</span>);
        ctx<span style="color:#00f;font-weight:700">.</span>refresh();
        getBean(<span style="color:#036a07">singerOne</span>, ctx);
        getBean(<span style="color:#036a07">singerTwo</span>, ctx);
        getBean(<span style="color:#036a07">singerThree</span>, ctx);
        ctx<span style="color:#00f;font-weight:700">.</span>close();
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">SingerWithJSR250</span> <span style="color:#0000a2;font-weight:700">getBean</span>(<span style="color:#00f;font-weight:700">String</span> <span style="font-style:italic">beanName</span>,
                                           <span style="color:#00f;font-weight:700">ApplicationContext</span> <span style="font-style:italic">ctx</span>) {
        <span style="color:#00f;font-weight:700">try</span> {
            <span style="color:#00f;font-weight:700">SingerWithJSR250</span> bean <span style="color:#00f;font-weight:700">=</span>
                    (<span style="color:#00f;font-weight:700">SingerWithJSR250</span>) ctx<span style="color:#00f;font-weight:700">.</span>getBean(beanName);
            <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(bean);
            <span style="color:#00f;font-weight:700">return</span> bean;
        } <span style="color:#00f;font-weight:700">catch</span> (<span style="color:#00f;font-weight:700">BeanCreationException</span> ex) {
            <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">An error occured in bean configuration: </span>
                    <span style="color:#00f;font-weight:700">+</span> ex<span style="color:#00f;font-weight:700">.</span>getMessage());
            <span style="color:#00f;font-weight:700">return</span> <span style="color:#585cf6;font-weight:700">null</span>;
        }
    }
}
</pre>
                    <div class="Para" id="Par47">The program is the same as using the <span class="EmphasisFontCategoryNonProportional">init-method</span> approach; just apply the <span class="EmphasisFontCategoryNonProportional">@PostConstruct</span> annotation before the
                        <span class="EmphasisFontCategoryNonProportional">init()</span> method. Note that you can assign any name to the method. In terms of configuration, since we are using annotations, we need to add the <span class="EmphasisFontCategoryNonProportional">&lt;context:annotation-driven&gt;</span>                            tag from the context namespace into the configuration file.</div>
                    <pre style="background:#fff;color:#000"><span style="color:#68685b">&lt;?<span style="color:#888">xml</span><span style="color:#888"> version</span>=<span style="color:#888">1.0</span><span style="color:#888"> encoding</span>=<span style="color:#888">UTF-8</span>?&gt;</span>
<span style="color:#1c02ff">&lt;<span style="font-weight:700">beans</span> <span style="font-style:italic">xmlns</span>=<span style="color:#036a07">http://www.springframework.org/schema/beans</span>
       <span style="font-style:italic">xmlns</span>:xsi=<span style="color:#036a07">http://www.w3.org/2001/XMLSchema-instance</span>
       <span style="font-style:italic">xmlns</span>:context=<span style="color:#036a07">http://www.springframework.org/schema/context</span>
       <span style="font-style:italic">xmlns</span>:p=<span style="color:#036a07">http://www.springframework.org/schema/p</span>
       <span style="font-style:italic">xsi</span>:schemaLocation=<span style="color:#036a07">http://www.springframework.org/schema/beans
          http://www.springframework.org/schema/beans/spring-beans.xsd
          http://www.springframework.org/schema/context
          http://www.springframework.org/schema/context/spring-context.xsd</span>
       <span style="font-style:italic">default-lazy-init</span>=<span style="color:#036a07">true</span>&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">context</span><span style="font-weight:700">:</span><span style="font-weight:700">annotation-config</span>/&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">singerOne</span>
        <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch4.SingerWithJSR250</span>
        <span style="font-style:italic">p</span>:name=<span style="color:#036a07">John Mayer</span>  <span style="font-style:italic">p</span>:age=<span style="color:#036a07">39</span>/&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">singerTwo</span>
        <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch4.SingerWithJSR250</span>
        <span style="font-style:italic">p</span>:age=<span style="color:#036a07">72</span>/&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">singerThree</span>
        <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch4.SingerWithJSR250</span>
            <span style="font-style:italic">p</span>:name=<span style="color:#036a07">John Butler</span>/&gt;</span>
<span style="color:#1c02ff">&lt;/<span style="font-weight:700">beans</span>&gt;</span>
</pre>
                    <div class="Para" id="Par49">Run the program and you will see the same output as other mechanisms.</div>
                    <div class="Para" id="Par50">
                        <div class="ProgramCode" id="PC10">
                            <div class="FixedLine">Initializing bean</div>
                            <div class="FixedLine">        Name: John Mayer</div>
                            <div class="FixedLine">        Age: 39</div>
                            <div class="FixedLine">Initializing bean</div>
                            <div class="FixedLine">Using default name</div>
                            <div class="FixedLine">        Name: Eric Clapton</div>
                            <div class="FixedLine">        Age: 72</div>
                            <div class="FixedLine">Initializing bean</div>
                            <div class="FixedLine">An error occurred in bean configuration: Error creating bean with name &apos;singerThree&apos;:</div>
                            <div class="FixedLine"> Invocation of init method failed; nested exception is</div>
                            <div class="FixedLine"> java.lang.IllegalArgumentException: You must set the age property of any beans</div>
                            <div class="FixedLine"> of type class com.apress.prospring5.ch4.SingerWithJSR250</div>
                        </div>
                    </div>
                    <div class="Para" id="Par51">All three approaches have their benefits and drawbacks. Using an initialization method, you have the benefit of keeping your application decoupled from Spring, but you have to remember to configure the initialization method for every
                        bean that needs it. Using the <span class="EmphasisFontCategoryNonProportional">InitializingBean</span> interface, you have the benefit of being able to specify the initialization callback once for all instances of your bean class,
                        but you have to couple your application to do so. Using annotations, you need to apply the annotation to the method and make sure that the IoC container supports JSR-250. In the end, you should let the requirements of your application
                        drive the decision about which approach to use. If portability is an issue, use the initialization or annotation method; otherwise, use the <span class="EmphasisFontCategoryNonProportional">InitializingBean</span> interface to
                        reduce the amount of configuration your application needs and the chance of errors creeping into your application because of <span id="ITerm26">misconfiguration                      </span>.</div>
                    <div class="Para ParaTypeImportant" id="Par52">
                    <img alt="A315511_5_En_4_Figa_HTML.jpg" data-mfp-src="/library/view/pro-spring-5/9781484228081/A315511_5_En_4_Figa_HTML.jpg" height="28" src="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_4_Figa_HTML.jpg" width="30"/>                        When configuring initialization with <span class="EmphasisFontCategoryNonProportional">init-method</span> or <span class="EmphasisFontCategoryNonProportional">@PostConstruct</span>, there is the advantage of declaring the initialization
                        method with a different access right. Initialization methods should be called only once by the Spring IoC, at bean creation time. Subsequent calls will lead to unexpected results or even failures. External additional calls can
                        be prohibited by making the initialization method <span class="EmphasisFontCategoryNonProportional">private</span>. The Spring IoC will be able to call it via reflection, but any additional calls in the code won’t be permitted.</div>
                </div>
        </div>
        <div class="Section1 RenderAsSection1" id="Sec7">
            <h2 class="Heading">Declaring an Initialization Method Using @Bean</h2>
            <div class="Para" id="Par53">Another way to declare the initialization method for a bean is to specify the <span class="EmphasisFontCategoryNonProportional">initMethod</span> attribute for the <span class="EmphasisFontCategoryNonProportional">@Bean</span> annotation and
                set the initialization method name as its value. This annotation is used to declare beans in Java configuration classes. Although Java configuration is covered a bit later in this chapter, the bean initialization part belongs here. For
                this example, the initial <span class="EmphasisFontCategoryNonProportional">Singer</span> class is used because the configuration is external, just like using the <span id="ITerm27">              <span class="EmphasisFontCategoryNonProportional">init-method</span>                </span> attribute. We’ll just write a configuration class and a new <span class="EmphasisFontCategoryNonProportional">main()</span> method to test it. Also, <span class="EmphasisFontCategoryNonProportional">default-lazy-init=&quot;true&quot;</span>                will be replaced by the <span class="EmphasisFontCategoryNonProportional">@Lazy</span> annotation on each bean declaration.</div>
            <pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4.config</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4.Singer</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.annotation.AnnotationConfigApplicationContext</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.annotation.Bean</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.annotation.Configuration</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.annotation.Lazy</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.support.GenericApplicationContext</span>;

<span style="color:#00f;font-weight:700">import static</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4.Singer.getBean</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">SingerConfigDemo</span> {
    <span style="color:#00f;font-weight:700">@Configuration</span>
    <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">SingerConfig</span> {
        <span style="color:#00f;font-weight:700">@Lazy</span>
        <span style="color:#00f;font-weight:700">@Bean</span>(<span style="color:#c5060b;font-weight:700">initMethod</span> <span style="color:#00f;font-weight:700">=</span> <span style="color:#036a07">init</span>)
        <span style="color:#00f;font-weight:700">Singer</span> <span style="color:#0000a2;font-weight:700">singerOne</span>() {
            <span style="color:#00f;font-weight:700">Singer</span> singerOne <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">Singer</span>();
            singerOne<span style="color:#00f;font-weight:700">.</span>setName(<span style="color:#036a07">John Mayer</span>);
            singerOne<span style="color:#00f;font-weight:700">.</span>setAge(<span style="color:#0000cd">39</span>);
            <span style="color:#00f;font-weight:700">return</span> singerOne;
        }

        <span style="color:#00f;font-weight:700">@Lazy</span>
        <span style="color:#00f;font-weight:700">@Bean</span>(<span style="color:#c5060b;font-weight:700">initMethod</span> <span style="color:#00f;font-weight:700">=</span> <span style="color:#036a07">init</span>)
        <span style="color:#00f;font-weight:700">Singer</span> <span style="color:#0000a2;font-weight:700">singerTwo</span>() {
            <span style="color:#00f;font-weight:700">Singer</span> singerTwo <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">Singer</span>();
            singerTwo<span style="color:#00f;font-weight:700">.</span>setAge(<span style="color:#0000cd">72</span>);
            <span style="color:#00f;font-weight:700">return</span> singerTwo;
        }

        <span style="color:#00f;font-weight:700">@Lazy</span>
        <span style="color:#00f;font-weight:700">@Bean</span>(<span style="color:#c5060b;font-weight:700">initMethod</span> <span style="color:#00f;font-weight:700">=</span> <span style="color:#036a07">init</span>)
        <span style="color:#00f;font-weight:700">Singer</span> <span style="color:#0000a2;font-weight:700">singerThree</span>() {
            <span style="color:#00f;font-weight:700">Singer</span> singerThree <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">Singer</span>();
            singerThree<span style="color:#00f;font-weight:700">.</span>setName(<span style="color:#036a07">John Butler</span>);
            <span style="color:#00f;font-weight:700">return</span> singerThree;
        }
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span> <span style="font-style:italic">args</span>) {
        <span style="color:#00f;font-weight:700">GenericApplicationContext</span> ctx <span style="color:#00f;font-weight:700">=</span>
                <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">AnnotationConfigApplicationContext</span>(<span style="color:#00f;font-weight:700">SingerConfig</span><span style="color:#00f;font-weight:700">.</span>class);
        getBean(<span style="color:#036a07">singerOne</span>, ctx);
        getBean(<span style="color:#036a07">singerTwo</span>, ctx);
        getBean(<span style="color:#036a07">singerThree</span>, ctx);
        ctx<span style="color:#00f;font-weight:700">.</span>close();
    }
}
</pre>
            <div class="Para" id="Par55">Running this code will produce the same result observed so far, shown here:</div>
            <div class="Para" id="Par56">
                <div class="ProgramCode" id="PC12">
                    <div class="FixedLine">Initializing bean</div>
                    <div class="FixedLine">        Name: John Mayer</div>
                    <div class="FixedLine">        Age: 39</div>
                    <div class="FixedLine">Initializing bean</div>
                    <div class="FixedLine">Using default name</div>
                    <div class="FixedLine">        Name: Eric Clapton</div>
                    <div class="FixedLine">        Age: 72</div>
                    <div class="FixedLine">Initializing bean</div>
                    <div class="FixedLine">An error occurred in bean configuration: Error creating bean with name <span class="EmphasisTypeUnderline">singerThree</span> </div>
                    <div class="FixedLine"> defined in com.apress.prospring5.ch4.config.SingerConfigDemo$SingerConfig:</div>
                    <div class="FixedLine"> Invocation of init method failed; nested exception is</div>
                    <div class="FixedLine"> java.lang.IllegalArgumentException: You must set the age  property of any beans</div>
                    <div class="FixedLine">  of type class com.apress.prospring5.ch4.Singer</div>
                </div>
            </div>
            <div class="Section2 RenderAsSection2" id="Sec8">
                <h3 class="Heading">Understanding Order of Resolution</h3>
                <div class="Para" id="Par57">All initialization mechanisms can be used on the same bean instance. In this case, Spring invokes the method annotated with <span id="ITerm29">                <span class="EmphasisFontCategoryNonProportional">@PostConstruct</span> </span>
                    first and then <span id="ITerm30">                <span class="EmphasisFontCategoryNonProportional">afterPropertiesSet()</span> </span>, followed by the initialization method specified in the configuration file. There is a technical
                    reason for this order, and by following the path in Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_4_Chapter.html#Fig1">4-1</a></span>, we can notice the
                    following steps in the bean creation process:
                    <div class="OrderedList">
                        <ol>
                            <li class="ListItem"><span class="ItemNumber">1.</span>
                                <div class="ItemContent">
                                    <div>
                                        <div class="Para" id="Par58">The constructor is called first to create the bean.</div>
                                    </div>
                                </div>
                                <div class="ClearBoth"> </div>
                            </li>
                            <li class="ListItem"><span class="ItemNumber">2.</span>
                                <div class="ItemContent">
                                    <div>
                                        <div class="Para" id="Par59">The dependencies are injected (setters are called).</div>
                                    </div>
                                </div>
                                <div class="ClearBoth"> </div>
                            </li>
                            <li class="ListItem"><span class="ItemNumber">3.</span>
                                <div class="ItemContent">
                                    <div>
                                        <div class="Para" id="Par60">Now that the beans exist and the dependencies were provided, the pre-initialization <span class="EmphasisFontCategoryNonProportional">BeanPostProcessor</span> infrastructure beans are consulted to see whether they
                                            want to call anything from this bean. These are Spring-specific infrastructure beans that perform bean modifications after they are created. The <span class="EmphasisFontCategoryNonProportional">@PostConstruct</span>                                            annotation is registered by <span class="EmphasisFontCategoryNonProportional">CommonAnnotationBeanPostProcessor</span>, so this bean will call the method found annotated with <span class="EmphasisFontCategoryNonProportional">@PostConstruct</span>.
                                            This method is executed right after the bean has been constructed and before the class is put into service,<a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_4_Chapter.html#Fn1" id="Fn1_source"><sup>1</sup></a> before the actual initialization of the bean (before <span class="EmphasisFontCategoryNonProportional">afterPropertiesSet</span> and <span class="EmphasisFontCategoryNonProportional">init-method</span>).</div>
                                    </div>
                                </div>
                                <div class="ClearBoth"> </div>
                            </li>
                            <li class="ListItem"><span class="ItemNumber">4.</span>
                                <div class="ItemContent">
                                    <div>
                                        <div class="Para" id="Par62">The <span class="EmphasisFontCategoryNonProportional">InitializingBean</span>’s <span class="EmphasisFontCategoryNonProportional">afterPropertiesSet</span> is executed right after the dependencies are injected.
                                            The <span class="EmphasisFontCategoryNonProportional">afterPropertiesSet()</span> method is invoked by a <span class="EmphasisFontCategoryNonProportional">BeanFactory</span> after it has set all the bean properties
                                            supplied and has satisfied <span class="EmphasisFontCategoryNonProportional">BeanFactoryAware</span> and <span class="EmphasisFontCategoryNonProportional">ApplicationContextAware</span>.</div>
                                    </div>
                                </div>
                                <div class="ClearBoth"> </div>
                            </li>
                            <li class="ListItem"><span class="ItemNumber">5.</span>
                                <div class="ItemContent">
                                    <div>
                                        <div class="Para ParaOneEmphasisChild" id="Par63">The <span class="EmphasisFontCategoryNonProportional">init-method</span> attribute is executed last because this is the actual initialization method of the bean.</div>
                                    </div>
                                </div>
                                <div class="ClearBoth"> </div>
                            </li>
                        </ol>
                    </div>
                </div>
                <div class="Para" id="Par64">Understanding the order of different types of bean initialization can be useful if you have an existing bean that performs some initialization in a specific method but you need to add some more initialization code when you use Spring.</div>
            </div>
        </div>
        <div class="Section1 RenderAsSection1" id="Sec9">
            <h2 class="Heading">Hooking into Bean <span id="ITerm31">Destruction                  </span> </h2>
            <div class="Para" id="Par65">When using an <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> implementation that wraps the <span class="EmphasisFontCategoryNonProportional">DefaultListableBeanFactory</span> interface (such as <span class="EmphasisFontCategoryNonProportional">GenericXmlApplicationContext</span>,
                via the <span class="EmphasisFontCategoryNonProportional">getDefaultListableBeanFactory()</span> method), you can signal to <span class="EmphasisFontCategoryNonProportional">BeanFactory</span> that you want to destroy all singleton instances
                with a call to <span class="EmphasisFontCategoryNonProportional">ConfigurableBeanFactory.destroySingletons()</span>. Typically, you do this when your application shuts down, and it allows you to clean up any resources that your beans might
                be holding open, thus allowing your application to shut down gracefully. This callback also provides the perfect place to flush any data you are storing in memory to persistent storage and to allow your beans to end any long-running processes
                they may have started.</div>
            <div class="Para" id="Par66">To allow your beans to receive notification that <span class="EmphasisFontCategoryNonProportional">destroySingletons()</span> has been called, you have three options, all similar to the mechanisms available for receiving an initialization
                callback. The destruction callback is often used in conjunction with the initialization callback. In many cases, you create and configure a resource in the initialization callback and then release the resource in the <span id="ITerm32">destruction callback                  </span>.</div>
            <div class="Section2 RenderAsSection2" id="Sec10">
                <h3 class="Heading">Executing a Method When a Bean Is Destroyed</h3>
                <div class="Para" id="Par67">To designate a method to be called when a bean is destroyed, you simply specify the name of the method in the <span class="EmphasisFontCategoryNonProportional">destroy-method</span> attribute of the bean’s <span class="EmphasisFontCategoryNonProportional">&lt;bean&gt;</span>                    tag. Spring calls it just before it destroys the singleton instance of the bean (Spring will not call this method for those beans with prototype scope). The following code snippet provides an example of using a <span class="EmphasisFontCategoryNonProportional">destroy-method</span>                    callback:</div>
                <pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">java.io.File</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.beans.factory.InitializingBean</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.support.GenericXmlApplicationContext</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">DestructiveBean</span> <span style="color:#00f;font-weight:700">implements</span> <span style="font-style:italic">InitializingBean</span> {
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">File</span> file;
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">String</span> filePath;

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">afterPropertiesSet</span>() <span style="color:#00f;font-weight:700">throws</span> <span style="color:#00f;font-weight:700">Exception</span> {
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">Initializing  Bean</span>);
        <span style="color:#00f;font-weight:700">if</span> (filePath <span style="color:#00f;font-weight:700">==</span> <span style="color:#585cf6;font-weight:700">null</span>) {
            <span style="color:#00f;font-weight:700">throw</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">IllegalArgumentException</span>(
                    <span style="color:#036a07">You must specify the filePath property of</span>
                            <span style="color:#00f;font-weight:700">+</span> <span style="color:#00f;font-weight:700">DestructiveBean</span><span style="color:#00f;font-weight:700">.</span>class);
        }
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>file <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">File</span>(filePath);
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>file<span style="color:#00f;font-weight:700">.</span>createNewFile();
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">File exists: </span> <span style="color:#00f;font-weight:700">+</span> file<span style="color:#00f;font-weight:700">.</span>exists());
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">destroy</span>() {
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">Destroying  Bean</span>);
        <span style="color:#00f;font-weight:700">if</span> (<span style="color:#00f;font-weight:700">!</span>file<span style="color:#00f;font-weight:700">.</span>delete()) {
            <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>err<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">ERROR: failed  to delete file.</span>);
        }
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">File exists: </span> <span style="color:#00f;font-weight:700">+</span> file<span style="color:#00f;font-weight:700">.</span>exists());
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setFilePath</span>(<span style="color:#00f;font-weight:700">String</span> <span style="font-style:italic">filePath</span>) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>filePath <span style="color:#00f;font-weight:700">=</span> filePath;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span>... <span style="font-style:italic">args</span>) <span style="color:#00f;font-weight:700">throws</span> <span style="color:#00f;font-weight:700">Exception</span> {
        <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span> ctx <span style="color:#00f;font-weight:700">=</span>
                <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span>();
        ctx<span style="color:#00f;font-weight:700">.</span>load(<span style="color:#036a07">classpath:spring/app-context-xml.xml</span>);
        ctx<span style="color:#00f;font-weight:700">.</span>refresh();
        <span style="color:#00f;font-weight:700">DestructiveBean</span> bean <span style="color:#00f;font-weight:700">=</span> (<span style="color:#00f;font-weight:700">DestructiveBean</span>) ctx<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#036a07">destructiveBean</span>);
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">Calling destroy()</span>);
        ctx<span style="color:#00f;font-weight:700">.</span>destroy();
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">Called destroy()</span>);
    }
}
</pre>
                <div class="Para" id="Par69">This code defines a <span class="EmphasisFontCategoryNonProportional">destroy()</span> method, in which the file that was created gets deleted. The <span class="EmphasisFontCategoryNonProportional">main()</span> method retrieves a bean
                    of type <span class="EmphasisFontCategoryNonProportional">DestructiveBean</span> from <span id="ITerm35">                <span class="EmphasisFontCategoryNonProportional">GenericXmlApplicationContext</span> </span> and then invokes
                    its <span class="EmphasisFontCategoryNonProportional">destroy()</span> method (which will, in turn, invoke the <span class="EmphasisFontCategoryNonProportional">ConfigurableBeanFactory.destroySingletons()</span> that was wrapped by
                    the <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>), instructing Spring to destroy all the singletons managed by it. Both the initialization and destruction callbacks write a message to console output informing
                    us that they have been called. In the following snippet, you can see the configuration for the <span id="ITerm36">                <span class="EmphasisFontCategoryNonProportional">destructiveBean</span> </span> bean (<span class="EmphasisFontCategoryNonProportional">app-context-xml.xml</span>):</div>
                <pre style="background:#fff;color:#000"><span style="color:#68685b">&lt;?<span style="color:#888">xml</span><span style="color:#888"> version</span>=<span style="color:#888">1.0</span><span style="color:#888"> encoding</span>=<span style="color:#888">UTF-8</span>?&gt;</span>
<span style="color:#1c02ff">&lt;<span style="font-weight:700">beans</span> <span style="font-style:italic">xmlns</span>=<span style="color:#036a07">http://www.springframework.org/schema/beans</span>
    <span style="font-style:italic">xmlns</span>:xsi=<span style="color:#036a07">http://www.w3.org/2001/XMLSchema-instance</span>
    <span style="font-style:italic">xmlns</span>:p=<span style="color:#036a07">http://www.springframework.org/schema/p</span>
    <span style="font-style:italic">xsi</span>:schemaLocation=<span style="color:#036a07">http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans.xsd</span>&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">destructiveBean</span>
        <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch4.DestructiveBean</span>
        <span style="font-style:italic">destroy-method</span>=<span style="color:#036a07">destroy</span>
        <span style="font-style:italic">p</span>:filePath=
   <span style="color:#036a07">#{systemProperties&apos;java.io.tmpdir&apos;}#{systemProperties&apos;file.separator&apos;}test.txt</span>/&gt;</span>
<span style="color:#1c02ff">&lt;/<span style="font-weight:700">beans</span>&gt;</span>
</pre>
        <div class="Para" id="Par71">Notice that we have specified the <span class="EmphasisFontCategoryNonProportional">destroy()</span> method as the destruction callback by using the <span class="EmphasisFontCategoryNonProportional">destroy-method</span> attribute. The filePath
            attribute value is built by using an SpEL expression, concatenating the system properties <span class="EmphasisFontCategoryNonProportional">java.io.tmpdir</span> and <span class="EmphasisFontCategoryNonProportional">file.separator</span> before
            the file name <span class="EmphasisFontCategoryNonProportional">test.txt</span> to ensure cross-platform compatibility. Running this example yields the following output:</div>
        <div class="Para" id="Par72">
            <div class="ProgramCode" id="PC15">
                <div class="FixedLine">Initializing Bean</div>
                <div class="FixedLine">File exists: true</div>
                <div class="FixedLine">Calling destroy()</div>
                <div class="FixedLine">Destroying Bean</div>
                <div class="FixedLine">File exists: false</div>
                <div class="FixedLine">Called destroy()</div>
            </div>
        </div>
        <div class="Para" id="Par73">As you can see, Spring first invokes the initialization callback, and the <span class="EmphasisFontCategoryNonProportional">DestructiveBean</span> instance creates the <span class="EmphasisFontCategoryNonProportional">File</span> instance and
            stores it. Next, during the call to <span class="EmphasisFontCategoryNonProportional">destroy()</span>, Spring iterates over the set of singletons it is managing, in this case just one, and invokes any destruction callbacks that are specified.
            This is where the <span class="EmphasisFontCategoryNonProportional">DestructiveBean</span> instance deletes the created file and logs messages to the screen indicating it no longer exists.</div>
    </div>
    <div class="Section2 RenderAsSection2" id="Sec11">
        <h3 class="Heading">Implementing the DisposableBean Interface</h3>
        <div class="Para" id="Par74">As with initialization callbacks, Spring provides an interface, in this case <span id="ITerm37">                <span class="EmphasisFontCategoryNonProportional">DisposableBean</span> </span>, that can be implemented by your beans as a mechanism
            for receiving destruction callbacks. The <span class="EmphasisFontCategoryNonProportional">DisposableBean</span> interface defines a single method, <span class="EmphasisFontCategoryNonProportional">destroy()</span>, which is called just before
            the bean is destroyed. Using this mechanism is orthogonal to using the <span class="EmphasisFontCategoryNonProportional">InitializingBean</span> interface to receive initialization callbacks. The following code snippet shows a modified implementation
            of the <span class="EmphasisFontCategoryNonProportional">DestructiveBean</span> class that implements the <span class="EmphasisFontCategoryNonProportional">DisposableBean</span> interface:</div>
        <pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">java.io.File</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.beans.factory.DisposableBean</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.beans.factory.InitializingBean</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.support.GenericXmlApplicationContext</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">DestructiveBeanWithInterface</span> <span style="color:#00f;font-weight:700">implements</span> <span style="font-style:italic">InitializingBean</span>, <span style="font-style:italic">DisposableBean</span> {
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">File</span> file;
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">String</span> filePath;

    <span style="color:#00f;font-weight:700">@Override</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">afterPropertiesSet</span>() <span style="color:#00f;font-weight:700">throws</span> <span style="color:#00f;font-weight:700">Exception</span> {
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">Initializing  Bean</span>);
        <span style="color:#00f;font-weight:700">if</span> (filePath <span style="color:#00f;font-weight:700">==</span> <span style="color:#585cf6;font-weight:700">null</span>) {
            <span style="color:#00f;font-weight:700">throw</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">IllegalArgumentException</span>(
                    <span style="color:#036a07">You must  specify the filePath property of </span> <span style="color:#00f;font-weight:700">+</span>
                            <span style="color:#00f;font-weight:700">DestructiveBeanWithInterface</span><span style="color:#00f;font-weight:700">.</span>class);
        }
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>file <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">File</span>(filePath);
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>file<span style="color:#00f;font-weight:700">.</span>createNewFile();
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">File exists: </span> <span style="color:#00f;font-weight:700">+</span> file<span style="color:#00f;font-weight:700">.</span>exists());
    }

    <span style="color:#00f;font-weight:700">@Override</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">destroy</span>() {
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">Destroying  Bean</span>);
        <span style="color:#00f;font-weight:700">if</span> (<span style="color:#00f;font-weight:700">!</span>file<span style="color:#00f;font-weight:700">.</span>delete()) {
            <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>err<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">ERROR: failed  to delete file.</span>);
        }
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">File exists: </span> <span style="color:#00f;font-weight:700">+</span> file<span style="color:#00f;font-weight:700">.</span>exists());
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setFilePath</span>(<span style="color:#00f;font-weight:700">String</span> <span style="font-style:italic">filePath</span>) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>filePath <span style="color:#00f;font-weight:700">=</span> filePath;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span>... <span style="font-style:italic">args</span>) <span style="color:#00f;font-weight:700">throws</span> <span style="color:#00f;font-weight:700">Exception</span> {
        <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span> ctx <span style="color:#00f;font-weight:700">=</span>
                <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span>();
        ctx<span style="color:#00f;font-weight:700">.</span>load(<span style="color:#036a07">classpath:spring/app-context-xml.xml</span>);
        ctx<span style="color:#00f;font-weight:700">.</span>refresh();
        <span style="color:#00f;font-weight:700">DestructiveBeanWithInterface</span> bean <span style="color:#00f;font-weight:700">=</span>
                (<span style="color:#00f;font-weight:700">DestructiveBeanWithInterface</span>) ctx<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#036a07">destructiveBean</span>);
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">Calling destroy()</span>);
        ctx<span style="color:#00f;font-weight:700">.</span>destroy();
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">Called destroy()</span>);
    }
}
</pre>
        <div class="Para ParaOneEmphasisChild" id="Par76">There is not much difference between the code that uses the callback method mechanism and the code that uses the callback interface mechanism. In this case, we even used the same method names. The configuration for this example is depicted here
            (<span class="EmphasisFontCategoryNonProportional">app-context-xml.xml</span>):</div>
        <pre style="background:#fff;color:#000"><span style="color:#1c02ff">&lt;<span style="font-weight:700">beans</span> ...&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">destructiveBean</span>
        <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch4.DestructiveBeanWithInterface</span>
        <span style="font-style:italic">p</span>:filePath=
   <span style="color:#036a07">#{systemProperties&apos;java.io.tmpdir&apos;}#{systemProperties&apos;file.separator&apos;}test.txt</span>/&gt;</span>
<span style="color:#1c02ff">&lt;/<span style="font-weight:700">beans</span>&gt;</span>
</pre>
        <div class="Para ParaOneEmphasisChild" id="Par78">Aside from the different class name, the only difference is the omission of the <span class="EmphasisFontCategoryNonProportional">destroy-method</span> attribute. Running this example yields the following output:</div>
        <div class="Para" id="Par79">
            <div class="ProgramCode" id="PC18">
                <div class="FixedLine">Initializing Bean</div>
                <div class="FixedLine">File exists: true</div>
                <div class="FixedLine">Calling destroy()</div>
                <div class="FixedLine">Destroying Bean</div>
                <div class="FixedLine">File exists: false</div>
                <div class="FixedLine">Called destroy()</div>
            </div>
        </div>
    </div>
    <div class="Section2 RenderAsSection2" id="Sec12">
        <h3 class="Heading">Using the JSR-250 @PreDestroy Annotation</h3>
        <div class="Para" id="Par80">The third way to define a method to be called before a bean is destroyed is to use the JSR-250 life-cycle <span class="EmphasisFontCategoryNonProportional">@PreDestroy</span> annotation, which is the inverse of the <span class="EmphasisFontCategoryNonProportional">@PostConstruct</span>            annotation. The following code snippet is a version of <span class="EmphasisFontCategoryNonProportional">DestructiveBean</span> that uses both <span id="ITerm39">                <span class="EmphasisFontCategoryNonProportional">@PostConstruct</span>            </span> <span id="ITerm40">                                              </span> and <span class="EmphasisFontCategoryNonProportional">@PreDestroy</span> in the same class to perform program initialization and destroy actions:</div>
        <pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">java.io.File</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">javax.annotation.PostConstruct</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">javax.annotation.PreDestroy</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.support.GenericXmlApplicationContext</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">DestructiveBeanWithJSR250</span> {
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">File</span> file;
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">String</span> filePath;

    <span style="color:#00f;font-weight:700">@PostConstruct</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">afterPropertiesSet</span>() <span style="color:#00f;font-weight:700">throws</span> <span style="color:#00f;font-weight:700">Exception</span> {
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">Initializing  Bean</span>);
        <span style="color:#00f;font-weight:700">if</span> (filePath <span style="color:#00f;font-weight:700">==</span> <span style="color:#585cf6;font-weight:700">null</span>) {
            <span style="color:#00f;font-weight:700">throw</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">IllegalArgumentException</span>(
                    <span style="color:#036a07">You must specify the filePath property of </span> <span style="color:#00f;font-weight:700">+</span>
                            <span style="color:#00f;font-weight:700">DestructiveBeanWithJSR250</span><span style="color:#00f;font-weight:700">.</span>class);
        }
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>file <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">File</span>(filePath);
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>file<span style="color:#00f;font-weight:700">.</span>createNewFile();
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">File exists: </span> <span style="color:#00f;font-weight:700">+</span> file<span style="color:#00f;font-weight:700">.</span>exists());
    }

    <span style="color:#00f;font-weight:700">@PreDestroy</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">destroy</span>() {
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">Destroying  Bean</span>);
        <span style="color:#00f;font-weight:700">if</span> (<span style="color:#00f;font-weight:700">!</span>file<span style="color:#00f;font-weight:700">.</span>delete()) {
            <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>err<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">ERROR: failed  to delete file.</span>);
        }
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">File exists: </span> <span style="color:#00f;font-weight:700">+</span> file<span style="color:#00f;font-weight:700">.</span>exists());
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setFilePath</span>(<span style="color:#00f;font-weight:700">String</span> <span style="font-style:italic">filePath</span>) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>filePath <span style="color:#00f;font-weight:700">=</span> filePath;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span>... <span style="font-style:italic">args</span>) <span style="color:#00f;font-weight:700">throws</span> <span style="color:#00f;font-weight:700">Exception</span> {
        <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span> ctx <span style="color:#00f;font-weight:700">=</span>
                <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span>();
        ctx<span style="color:#00f;font-weight:700">.</span>load(<span style="color:#036a07">classpath:spring/app-context-annotation.xml</span>);
        ctx<span style="color:#00f;font-weight:700">.</span>refresh();
        <span style="color:#00f;font-weight:700">DestructiveBeanWithJSR250</span> bean <span style="color:#00f;font-weight:700">=</span>
                (<span style="color:#00f;font-weight:700">DestructiveBeanWithJSR250</span>) ctx<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#036a07">destructiveBean</span>);
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">Calling destroy()</span>);
        ctx<span style="color:#00f;font-weight:700">.</span>destroy();
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">Called destroy()</span>);
    }
}
</pre>
        <div class="Para" id="Par82">In the following snippet, you can see the configuration file for this bean, which makes use of the <span class="EmphasisFontCategoryNonProportional">&lt;context:annotation-config&gt;</span> tag (<span class="EmphasisFontCategoryNonProportional">app-context-annotation.xml</span>).</div>
        <div class="Para" id="Par83">
            <div class="ProgramCode" id="PC20">
                <div class="LineGroup">
                    <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#1c02ff">&lt;<span style="font-weight:700">beans</span> ...&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">context</span><span style="font-weight:700">:</span><span style="font-weight:700">annotation-config</span>/&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">destructiveBean</span>
        <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch4.DestructiveBeanWithJSR250</span>
        <span style="font-style:italic">p</span>:filePath=
    <span style="color:#036a07">#{systemProperties&apos;java.io.tmpdir&apos;}#{systemProperties&apos;file.separator&apos;}test.txt</span>/&gt;</span>
<span style="color:#1c02ff">&lt;/<span style="font-weight:700">beans</span>&gt;</span>
</pre></div>
                </div>
            </div>
    </div>
    </div>
    </div>
    <div class="Section1 RenderAsSection1" id="Sec13">
        <h2 class="Heading">Declaring a Destroy Method Using @Bean</h2>
        <div class="Para" id="Par84">Another way to declare the destroy method for a bean is to specify the <span class="EmphasisFontCategoryNonProportional">destroyMethod</span> attribute for the <span class="EmphasisFontCategoryNonProportional">@Bean</span> annotation and set the
            destroy method name as its value. This annotation is used to declare beans in Java configuration classes. Although Java configuration is covered a bit later in this chapter, the bean destruction part belongs here. For this example, the initial
            <span class="EmphasisFontCategoryNonProportional">DestructiveBeanWithJSR250</span> class is used, as the configuration is external, just like using the <span class="EmphasisFontCategoryNonProportional">destroy-method</span> attribute. We’ll
            just write a configuration class and a new <span class="EmphasisFontCategoryNonProportional">main()</span> method to test it. Also, <span class="EmphasisFontCategoryNonProportional">default-lazy-init=&quot;true&quot;</span> will be replaced by the
            <span class="EmphasisFontCategoryNonProportional">@Lazy</span> annotation on each bean declaration.</div>
        <pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4.config</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4.DestructiveBeanWithJSR250</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.annotation.AnnotationConfigApplicationContext</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.annotation.Bean</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.annotation.Configuration</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.annotation.Lazy</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.support.GenericApplicationContext</span>;

<span style="color:#06f;font-style:italic">/**
 * Created by  iuliana.cosmina on  2/27/17.
 */</span>
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">DestructiveBeanConfigDemo</span> {
    <span style="color:#00f;font-weight:700">@Configuration</span>
    <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">DestructiveBeanConfig</span> {
        <span style="color:#00f;font-weight:700">@Lazy</span>
        <span style="color:#00f;font-weight:700">@Bean</span>(<span style="color:#c5060b;font-weight:700">initMethod</span> <span style="color:#00f;font-weight:700">=</span> <span style="color:#036a07">afterPropertiesSet</span>, <span style="color:#c5060b;font-weight:700">destroyMethod</span> <span style="color:#00f;font-weight:700">=</span> <span style="color:#036a07">destroy</span>)
        <span style="color:#00f;font-weight:700">DestructiveBeanWithJSR250</span> <span style="color:#0000a2;font-weight:700">destructiveBean</span>() {
            <span style="color:#00f;font-weight:700">DestructiveBeanWithJSR250</span> destructiveBean <span style="color:#00f;font-weight:700">=</span>
                    <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">DestructiveBeanWithJSR250</span>();
            destructiveBean<span style="color:#00f;font-weight:700">.</span>setFilePath(<span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>getProperty(<span style="color:#036a07">java.io.tmpdir</span>) <span style="color:#00f;font-weight:700">+</span>
                    <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>getProperty(<span style="color:#036a07">file.separator</span>) <span style="color:#00f;font-weight:700">+</span> <span style="color:#036a07">test.txt</span>);
            <span style="color:#00f;font-weight:700">return</span> destructiveBean;
        }
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span>... <span style="font-style:italic">args</span>) {
        <span style="color:#00f;font-weight:700">GenericApplicationContext</span> ctx <span style="color:#00f;font-weight:700">=</span>
                <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">AnnotationConfigApplicationContext</span>(<span style="color:#00f;font-weight:700">DestructiveBeanConfig</span><span style="color:#00f;font-weight:700">.</span>class);
        ctx<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#00f;font-weight:700">DestructiveBeanWithJSR250</span><span style="color:#00f;font-weight:700">.</span>class);
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">Calling destroy()</span>);
        ctx<span style="color:#00f;font-weight:700">.</span>destroy();
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">Called destroy()</span>);
    }
}
</pre>
        <div class="Para" id="Par86">The <span id="ITerm45">              <span class="EmphasisFontCategoryNonProportional">@PostConstruct</span> </span> annotation is used as well in the bean configuration; thus, running this code will produce the same result observed so far.</div>
        <div class="Para" id="Par87">
            <div class="ProgramCode" id="PC22">
                <div class="FixedLine">Initializing Bean</div>
                <div class="FixedLine">File exists: true</div>
                <div class="FixedLine">Calling destroy()</div>
                <div class="FixedLine">Destroying Bean</div>
                <div class="FixedLine">File exists: false</div>
                <div class="FixedLine">Called destroy()</div>
            </div>
    </div>
    <div class="Para" id="Par88">The destruction callback is an ideal mechanism for ensuring that your applications shut down gracefully and do not leave resources open or in an inconsistent state. However, you still have to decide whether to use the destruction method callback,
        the <span class="EmphasisFontCategoryNonProportional">DisposableBean</span> interface, the <span class="EmphasisFontCategoryNonProportional">@PreDestroy</span> annotation, the XML <span class="EmphasisFontCategoryNonProportional">destroy-attribute</span>        attribute, or the <span class="EmphasisFontCategoryNonProportional">destroyMethod</span>. Again, let the requirements of your application drive your decision in this respect; use the method callback where portability is an issue, and use the
        <span class="EmphasisFontCategoryNonProportional">DisposableBean</span> interface or a JSR-250 annotation to reduce the amount of configuration required.</div>
    </div>
    <div class="Section1 RenderAsSection1" id="Sec14">
        <h2 class="Heading">Understanding Order of Resolution</h2>
        <div class="Para" id="Par89">As with the case of bean creation, you can use all mechanisms on the same bean instance for bean destruction. In this case, Spring invokes the method annotated with <span class="EmphasisFontCategoryNonProportional">@PreDestroy</span> first and
            then <span class="EmphasisFontCategoryNonProportional">DisposableBean.destroy()</span>, followed by your destroy method configured in your XML definition.</div>
        <div class="Section2 RenderAsSection2" id="Sec15">
            <h3 class="Heading">Using a Shutdown Hook</h3>
            <div class="Para" id="Par90">The only drawback of the destruction callbacks in Spring is that they are not fired automatically; you need to remember to call <span class="EmphasisFontCategoryNonProportional">AbstractApplicationContext.destroy()</span> before your application
                is closed. When your application runs as a servlet, you can simply call <span class="EmphasisFontCategoryNonProportional">destroy()</span> in the servlet’s <span class="EmphasisFontCategoryNonProportional">destroy()</span> method. However,
                in a stand-alone application, things are not quite so simple, especially if you have multiple exit points out of your application. Fortunately, there is a solution. Java allows you to create a <span id="ITerm46">                <span class="EmphasisTypeItalic">shutdown hook</span>                </span>, which is a thread that is executed just before the application shuts down. This is the perfect way to invoke the <span class="EmphasisFontCategoryNonProportional">destroy()</span> method of your <span class="EmphasisFontCategoryNonProportional">AbstractApplicationContext</span>                (which was being extended by all concrete <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> implementations). The easiest way to take advantage of this mechanism is to use <span class="EmphasisFontCategoryNonProportional">AbstractApplicationContext</span>’s
                <span class="EmphasisFontCategoryNonProportional">registerShutdownHook()</span> method. The method automatically instructs Spring to register a shutdown hook of the underlying JVM runtime. The bean declaration and configuration stay the
                same as before; the only thing that changes is the main method: the call of <span class="EmphasisFontCategoryNonProportional">ctx.registerShutdownHook</span> is added, and calls to <span class="EmphasisFontCategoryNonProportional">ctx.destroy()</span>                or <span class="EmphasisFontCategoryNonProportional">close()</span> will be removed.</div>
            <div class="Para" id="Par91">
                <div class="ProgramCode" id="PC23">
                    <div class="LineGroup">
                        <div class="FixedLine"><pre style="background:#fff;color:#000">.<span style="color:#00f;font-weight:700">.</span>.
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">DestructiveBeanWithHook</span> {
   <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span>... <span style="font-style:italic">args</span>) {
        <span style="color:#00f;font-weight:700">GenericApplicationContext</span> ctx <span style="color:#00f;font-weight:700">=</span>
           <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">AnnotationConfigApplicationContext</span>(
               <span style="color:#00f;font-weight:700">DestructiveBeanConfig</span><span style="color:#00f;font-weight:700">.</span>class);
           ctx<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#00f;font-weight:700">DestructiveBeanWithJSR250</span><span style="color:#00f;font-weight:700">.</span>class);
           ctx<span style="color:#00f;font-weight:700">.</span>registerShutdownHook();
   }
}
</pre></div>
                    </div>
                </div>
            </div>
            <div class="Para" id="Par92">Running this code will produce the same result observed so far.</div>
            <div class="Para" id="Par93">
                <div class="ProgramCode" id="PC24">
                    <div class="FixedLine">Initializing Bean</div>
                    <div class="FixedLine">File exists: true</div>
                    <div class="FixedLine">Destroying Bean</div>
                    <div class="FixedLine">File exists: false</div>
                </div>
            </div>
            <div class="Para ParaOneEmphasisChild" id="Par94">As you can see, the <span class="EmphasisFontCategoryNonProportional">destroy()</span> method is invoked, even though we didn’t write any code to invoke it explicitly as the application was shutting down.</div>
        </div>
    </div>
    <div class="Section1 RenderAsSection1" id="Sec16">
        <h2 class="Heading">Making Your Beans “Spring Aware”</h2>
        <div class="Para" id="Par95">One of the biggest selling points of dependency injection over dependency lookup as a mechanism for achieving inversion of control is that your beans do not need to be aware of the implementation of the container that is managing them. To a bean
            that uses constructor or setter injection, the Spring container is the same as the container provided by Google Guice or PicoContainer. However, in certain circumstances, you may need a bean that is using dependency injection to obtain its
            dependencies so it can interact with the container for some other reason. An example of this may be a bean that automatically configures a shutdown hook for you, and thus it needs access to <span id="ITerm48">              <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>            </span>. In other cases, a bean may want to know what its name is (that is, the bean name that was assigned within the current <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>) so it can perform some additional processing
            based on this name.</div>
        <div class="Para" id="Par96">That said, this feature is really intended for internal Spring use. Giving the bean name some kind of business meaning is generally a bad idea and can lead to configuration problems as bean names have to be artificially manipulated to support
            their business meaning. However, we have found that being able to have a bean find out its name at runtime is really useful for logging. Say you have many beans of the same type running under different configurations. The bean name can be
            included in log messages to help you differentiate between the one that is generating errors and the ones that are working fine when something goes wrong.</div>
        <div class="Section2 RenderAsSection2" id="Sec17">
            <h3 class="Heading">Using the <span id="ITerm49">BeanNameAware                      </span> Interface</h3>
            <div class="Para" id="Par97">The <span class="EmphasisFontCategoryNonProportional">BeanNameAware</span> interface, which can be implemented by a bean that wants to obtain its own name, has a single method: <span class="EmphasisFontCategoryNonProportional">setBeanName(String)</span>.
                Spring calls the <span class="EmphasisFontCategoryNonProportional">setBeanName()</span> method after it has finished configuring your bean but before any life-cycle callbacks (initialization or destroy) are called (refer to Figure
                <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_4_Chapter.html#Fig1">4-1</a></span>). In most cases, the implementation of the <span class="EmphasisFontCategoryNonProportional">setBeanName()</span>                    interface is just a single line that stores the value passed in by the container in a field for use later. The following code snippet shows a simple bean that obtains its name by using <span class="EmphasisFontCategoryNonProportional">BeanNameAware</span>                    and then later uses this bean name to print to the console:</div>
            <pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.beans.factory.BeanNameAware</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">NamedSinger</span> <span style="color:#00f;font-weight:700">implements</span> <span style="font-style:italic">BeanNameAware</span> {
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">String</span> name;

    <span style="color:#06f;font-style:italic">/**
     * <span style="color:#00f;font-weight:700">@Implements</span> <span style="color:#1c02ff">{@link BeanNameAware#setBeanName(String)}</span>
     */</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setBeanName</span>(<span style="color:#00f;font-weight:700">String</span> <span style="font-style:italic">beanName</span>) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>name <span style="color:#00f;font-weight:700">=</span> beanName;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">sing</span>() {
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">Singer </span> <span style="color:#00f;font-weight:700">+</span> name <span style="color:#00f;font-weight:700">+</span> <span style="color:#036a07"> - sing()</span>);
    }
}
</pre>
            <div class="Para" id="Par99">This implementation is fairly trivial. Remember that <span class="EmphasisFontCategoryNonProportional">BeanNameAware.setBeanName()</span> is called before the first instance of the bean is returned to your application via a call to <span class="EmphasisFontCategoryNonProportional">ApplicationContext.getBean()</span>,
                so there is no need to check whether the bean name is available in the <span class="EmphasisFontCategoryNonProportional">sing()</span> method. Here you can see the configuration contained in the <span class="EmphasisFontCategoryNonProportional">app-context-xml.xml</span>                file used in this example:</div>
            <pre style="background:#fff;color:#000"><span style="color:#1c02ff">&lt;<span style="font-weight:700">beans</span> ...&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">johnMayer</span>
           <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch4.NamedSinger</span>/&gt;</span>
<span style="color:#1c02ff">&lt;/<span style="font-weight:700">beans</span>&gt;</span>
</pre>
            <div class="Para" id="Par101">As you can see, no special configuration is required to take advantage of the <span class="EmphasisFontCategoryNonProportional">BeanNameAware</span> interface. In the following code snippet, you can see a simple example application that retrieves
                the <span class="EmphasisFontCategoryNonProportional">Singer</span> instance from <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> and then calls the <span class="EmphasisFontCategoryNonProportional">sing()</span>                method:</div>
            <div class="Para" id="Par102">
                <div class="ProgramCode" id="PC27">
                    <div class="LineGroup">
                        <div class="FixedLine"><pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.support.GenericXmlApplicationContext</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">NamedSingerDemo</span> {
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span>... <span style="font-style:italic">args</span>) {
        <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span> ctx <span style="color:#00f;font-weight:700">=</span>
                <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span>();
        ctx<span style="color:#00f;font-weight:700">.</span>load(<span style="color:#036a07">classpath:spring/app-context-xml.xml</span>);
        ctx<span style="color:#00f;font-weight:700">.</span>refresh();
        <span style="color:#00f;font-weight:700">NamedSinger</span> bean <span style="color:#00f;font-weight:700">=</span> (<span style="color:#00f;font-weight:700">NamedSinger</span>) ctx<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#036a07">johnMayer</span>);
        bean<span style="color:#00f;font-weight:700">.</span>sing();
        ctx<span style="color:#00f;font-weight:700">.</span>close();
    }
}
</pre></div>
                    </div>
                </div>
            </div>
            <div class="Para ParaOneEmphasisChild" id="Par103">This example generates the following log output; notice the inclusion of the bean name in the log message for the call to <span class="EmphasisFontCategoryNonProportional">sing()</span>:</div>
            <div class="Para" id="Par104">
                <div class="ProgramCode" id="PC28">
                    <div class="FixedLine">Singer johnMayer - sing()</div>
                </div>
            </div>
            <div class="Para" id="Par105">Using the <span class="EmphasisFontCategoryNonProportional">BeanNameAware</span> interface is really quite simple, and it is put to good use when you are improving the quality of your log messages. Avoid being tempted to give your bean names
                business meaning just because you can access them; by doing so, you are coupling your classes to Spring for a feature that brings negligible benefit. If your beans need some kind of name internally, have them implement an interface such
                as <span class="EmphasisFontCategoryNonProportional">Nameable</span> (which is specific to your application) with a method <span class="EmphasisFontCategoryNonProportional">setName()</span> and then give each bean a name by using dependency
                injection. This way, you can keep the names you use for configuration concise, and you won’t need to manipulate your configuration unnecessarily to give your beans names with business <span id="ITerm50">meaning                      </span>.</div>
        </div>
        <div class="Section2 RenderAsSection2" id="Sec18">
            <h3 class="Heading">Using the <span id="ITerm51">ApplicationContextAware          </span> Interface</h3>
            <div class="Para" id="Par106"> <span class="EmphasisFontCategoryNonProportional">ApplicationContextAware</span> was introduced at the end of Chapter <span class="ExternalRef"><a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_3_Chapter.html"><span class="RefSource">3</span></a>
                </span>
                to show how Spring can be used to deal with beans that require other beans to function that are not injected using constructors or setters in the configuration (the <span class="EmphasisFontCategoryNonProportional">depends-on</span> example).</div>
            <div class="Para" id="Par107">Using the <span class="EmphasisFontCategoryNonProportional">ApplicationContextAware</span> interface, it is possible for your beans to get a reference to the <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> instance
                that configured them. The main reason this interface was created is to allow a bean to access Spring’s <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> in your application, for example, to acquire other Spring
                beans programmatically, using <span class="EmphasisFontCategoryNonProportional">getBean()</span>. You should, however, avoid this practice and use dependency injection to provide your beans with their collaborators. If you use the lookup-based
                <span class="EmphasisFontCategoryNonProportional">getBean()</span> approach to obtain dependencies when you can use dependency injection, you are adding unnecessary complexity to your beans and coupling them to the Spring Framework without
                good reason.</div>
        <div class="Para" id="Par108">Of course, <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> isn’t used just to look up beans; it performs a great many other tasks. As you saw previously, one of these tasks is to destroy all singletons, notifying each
            of them in turn before doing so. In the previous section, you saw how to create a shutdown hook to ensure that <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> is instructed to destroy all singletons before the application
            shuts down. By using the <span class="EmphasisFontCategoryNonProportional">ApplicationContextAware</span> interface, you can build a bean that can be configured in <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>            to create and configure a shutdown hook bean automatically. The following configuration shows the code for this bean:</div>
        <pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.beans.BeansException</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.ApplicationContext</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.ApplicationContextAware</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.support.GenericApplicationContext</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">ShutdownHookBean</span> <span style="color:#00f;font-weight:700">implements</span> <span style="font-style:italic">ApplicationContextAware</span> {
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">ApplicationContext</span> ctx;

    <span style="color:#06f;font-style:italic">/**
     * <span style="color:#00f;font-weight:700">@Implements</span> <span style="background:rgba(0,0,0,0.05)">{@link ApplicationContextAware#s
     * etApplicationContext(ApplicationContext)}</span>    }
     */</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setApplicationContext</span>(<span style="color:#00f;font-weight:700">ApplicationContext</span> <span style="font-style:italic">ctx</span>)
            <span style="color:#00f;font-weight:700">throws</span> <span style="color:#00f;font-weight:700">BeansException</span> {
        <span style="color:#00f;font-weight:700">if</span> (ctx <span style="color:#00f;font-weight:700">instanceof</span> <span style="color:#00f;font-weight:700">GenericApplicationContext</span>) {
            ((<span style="color:#00f;font-weight:700">GenericApplicationContext</span>) ctx)<span style="color:#00f;font-weight:700">.</span>registerShutdownHook();
        }
    }
}
</pre>
        <div class="Para" id="Par110">Most of this code should seem familiar to you by now. The <span class="EmphasisFontCategoryNonProportional">ApplicationContextAware</span> interface defines a single method, <span class="EmphasisFontCategoryNonProportional">setApplicationContext(ApplicationContext)</span>,
            that Spring calls to pass your bean a reference to its <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>. In the previous code snippet, the <span class="EmphasisFontCategoryNonProportional">ShutdownHookBean</span>            class checks whether <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> is of type <span class="EmphasisFontCategoryNonProportional">GenericApplicationContext</span>, meaning it supports the <span class="EmphasisFontCategoryNonProportional">registerShutdownHook()</span>            method; if it does, it will register a shutdown hook to <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>. The following configuration snippet shows how to configure this bean to work with the <span class="EmphasisFontCategoryNonProportional">DestructiveBeanWithInterface</span>            bean (<span class="EmphasisFontCategoryNonProportional">app-context-annotation.xml</span>):</div>
        <pre style="background:#fff;color:#000"><span style="color:#1c02ff">&lt;<span style="font-weight:700">beans</span> ...<span style="color:#036a07">&gt;
    &lt;context:annotation-config/&gt;
    &lt;bean id=</span>destructiveBean<span style="color:#036a07">
        class=</span>com.apress.prospring5.ch4.DestructiveBeanWithInterface<span style="color:#036a07">
        p:filePath=
 </span>#{systemProperties<span style="color:#036a07">java.io.tmpdir</span>}#{systemProperties<span style="color:#036a07">file.separator</span>}test.txt<span style="color:#036a07">/&gt;
    &lt;bean id=</span>shutdownHook<span style="color:#036a07">
        class=</span>com.apress.prospring5.ch4.ShutdownHookBean<span style="color:#036a07">&quot;/&gt;
&lt;/beans&gt;
</span></span></pre>
        <div class="Para ParaOneEmphasisChild" id="Par112">Notice that no special configuration is required. The following code snippet shows a simple example application that uses <span class="EmphasisFontCategoryNonProportional">ShutdownHookBean</span> to manage the destruction of singleton beans:</div>
        <pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">javax.annotation.PostConstruct</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">javax.annotation.PreDestroy</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">java.io.File</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.support.GenericXmlApplicationContext</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">DestructiveBeanWithInterface</span> {
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">File</span> file;
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">String</span> filePath;

    <span style="color:#00f;font-weight:700">@PostConstruct</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">afterPropertiesSet</span>() <span style="color:#00f;font-weight:700">throws</span> <span style="color:#00f;font-weight:700">Exception</span> {
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">Initializing  Bean</span>);
        <span style="color:#00f;font-weight:700">if</span> (filePath <span style="color:#00f;font-weight:700">==</span> <span style="color:#585cf6;font-weight:700">null</span>) {
            <span style="color:#00f;font-weight:700">throw</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">IllegalArgumentException</span>(
                    <span style="color:#036a07">You must specify the filePath property of </span> <span style="color:#00f;font-weight:700">+</span>
                            <span style="color:#00f;font-weight:700">DestructiveBeanWithInterface</span><span style="color:#00f;font-weight:700">.</span>class);
        }
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>file <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">File</span>(filePath);
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>file<span style="color:#00f;font-weight:700">.</span>createNewFile();
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">File exists: </span> <span style="color:#00f;font-weight:700">+</span> file<span style="color:#00f;font-weight:700">.</span>exists());
    }

    <span style="color:#00f;font-weight:700">@PreDestroy</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">destroy</span>() {
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">Destroying Bean</span>);
        <span style="color:#00f;font-weight:700">if</span> (<span style="color:#00f;font-weight:700">!</span>file<span style="color:#00f;font-weight:700">.</span>delete()) {
            <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>err<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">ERROR: failed to delete file.</span>);
        }
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">File exists: </span> <span style="color:#00f;font-weight:700">+</span> file<span style="color:#00f;font-weight:700">.</span>exists());
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setFilePath</span>(<span style="color:#00f;font-weight:700">String</span> <span style="font-style:italic">filePath</span>) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>filePath <span style="color:#00f;font-weight:700">=</span> filePath;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span>... <span style="font-style:italic">args</span>) <span style="color:#00f;font-weight:700">throws</span> <span style="color:#00f;font-weight:700">Exception</span> {
        <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span> ctx <span style="color:#00f;font-weight:700">=</span>
                <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span>();
        ctx<span style="color:#00f;font-weight:700">.</span>load(<span style="color:#036a07">classpath:spring/app-context-annotation.xml</span>);
        ctx<span style="color:#00f;font-weight:700">.</span>registerShutdownHook();
        ctx<span style="color:#00f;font-weight:700">.</span>refresh();
        ctx<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#036a07">destructiveBean</span>,
                <span style="color:#00f;font-weight:700">DestructiveBeanWithInterface</span><span style="color:#00f;font-weight:700">.</span>class);
    }
}
</pre>
    <div class="Para" id="Par114">This code should seem quite familiar to you. When Spring bootstraps <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> and <span class="EmphasisFontCategoryNonProportional">destructiveBean</span> is defined in the configuration,
        Spring passes the reference of <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> to the <span class="EmphasisFontCategoryNonProportional">shutdownHook</span> bean for registering the shutdown hook. Running this example
        yields the following output, as expected:</div>
    <div class="Para" id="Par115">
        <div class="ProgramCode" id="PC32">
            <div class="FixedLine">Initializing Bean</div>
            <div class="FixedLine">File exists: true</div>
            <div class="FixedLine">Destroying Bean</div>
            <div class="FixedLine">File exists: false</div>
        </div>
    </div>
    <div class="Para" id="Par116">As you can see, even though no calls to <span class="EmphasisFontCategoryNonProportional">destroy()</span> are in the main application, <span class="EmphasisFontCategoryNonProportional">ShutdownHookBean</span> is registered as a shutdown hook, and
        it calls <span class="EmphasisFontCategoryNonProportional">destroy()</span> just before the application shuts down.</div>
    </div>
    </div>
    <div class="Section1 RenderAsSection1" id="Sec19">
        <h2 class="Heading">Use of FactoryBeans</h2>
        <div class="Para" id="Par117">One of the problems that you will face when using Spring is how to create and then inject dependencies that cannot be created simply by using the <span class="EmphasisFontCategoryNonProportional">new</span> operator. To overcome this problem,
            Spring provides the <span class="EmphasisFontCategoryNonProportional">FactoryBean</span> interface that acts as an adapter for objects that cannot be created and managed using the standard Spring semantics. Typically, you use <span class="EmphasisFontCategoryNonProportional">FactoryBean</span>s
            to create beans that you cannot create by using the <span class="EmphasisFontCategoryNonProportional">new</span> operator, such as those you access through static factory methods, although this is not always the case. Simply put, a <span class="EmphasisFontCategoryNonProportional">FactoryBean</span>            is a bean that acts as a factory for other beans. <span class="EmphasisFontCategoryNonProportional">FactoryBean</span>s are configured within your <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> like any normal
            bean, but when Spring uses the <span class="EmphasisFontCategoryNonProportional">FactoryBean</span> interface to satisfy a dependency or lookup request, it does not return <span class="EmphasisFontCategoryNonProportional">FactoryBean</span>;
            instead, it invokes the <span class="EmphasisFontCategoryNonProportional">FactoryBean.getObject()</span> method and returns the result of that invocation.</div>
        <div class="Para" id="Par118"> <span class="EmphasisFontCategoryNonProportional">FactoryBean</span>s are used to great effect in Spring; the most noticeable uses are the creation of transactional proxies, which we cover in Chapter <span class="ExternalRef"><a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_9_Chapter.html"><span class="RefSource">9</span></a>
            </span>, and the automatic retrieval of resources from a JNDI context. However, <span class="EmphasisFontCategoryNonProportional">FactoryBean</span>s are useful not just for building the internals of Spring; you’ll find them really useful when you
            build your own applications because they allow you to manage many more resources by using IoC than would otherwise be available.</div>
        <div class="Section2 RenderAsSection2" id="Sec20">
            <h3 class="Heading">FactoryBean Example: The MessageDigestFactoryBean</h3>
            <div class="Para" id="Par119">Often the projects that we work on require some kind of cryptographic processing; typically, this involves generating a message digest or hash of a user’s password to be stored in a database. In Java, the <span class="EmphasisFontCategoryNonProportional">MessageDigest</span>                class provides functionality for creating a digest of any arbitrary data. <span class="EmphasisFontCategoryNonProportional">MessageDigest</span> itself is abstract, and you obtain concrete implementations by calling <span class="EmphasisFontCategoryNonProportional">MessageDigest.getInstance()</span>                and passing in the name of the digest algorithm you want to use. For instance, if we want to use the MD5 algorithm to create a digest, we use the following code to create the <span class="EmphasisFontCategoryNonProportional">MessageDigest</span>                instance:</div>
            <div class="Para" id="Par120">
                <div class="ProgramCode" id="PC33">
                    <div class="FixedLine">MessageDigest md5 = MessageDigest.getInstance(&quot;MD5&quot;);</div>
                </div>
            </div>
            <div class="Para" id="Par121">If we want to use Spring to manage the creation of the <span class="EmphasisFontCategoryNonProportional">MessageDigest</span> object, the best we can do without a <span class="EmphasisFontCategoryNonProportional">FactoryBean</span> is have
                a property, <span class="EmphasisFontCategoryNonProportional">algorithmName</span>, on your bean and then use an initialization callback to call <span class="EmphasisFontCategoryNonProportional">MessageDigest.getInstance()</span>. Using
                a <span class="EmphasisFontCategoryNonProportional">FactoryBean</span>, we can encapsulate this logic inside a bean. Then any beans that require a <span class="EmphasisFontCategoryNonProportional">MessageDigest</span> instance can simply
                declare a property, <span class="EmphasisFontCategoryNonProportional">messageDigest</span>, and use the <span class="EmphasisFontCategoryNonProportional">FactoryBean</span> to obtain the instance. The following code snippet shows an
                <span id="ITerm54">implementation </span> of <span class="EmphasisFontCategoryNonProportional">FactoryBean</span> that does just this:</div>
            <pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">java.security.MessageDigest</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.beans.factory.FactoryBean</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.beans.factory.InitializingBean</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">MessageDigestFactoryBean</span> implements
        FactoryBean&lt;MessageDigest&gt;, InitializingBean {
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">String</span> algorithmName <span style="color:#00f;font-weight:700">=</span> <span style="color:#036a07">MD5</span>;
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">MessageDigest</span> messageDigest <span style="color:#00f;font-weight:700">=</span> <span style="color:#585cf6;font-weight:700">null</span>;

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">MessageDigest</span> <span style="color:#0000a2;font-weight:700">getObject</span>() <span style="color:#00f;font-weight:700">throws</span> <span style="color:#00f;font-weight:700">Exception</span> {
        <span style="color:#00f;font-weight:700">return</span> messageDigest;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">Class&lt;<span style="color:#00f;font-weight:700">MessageDigest</span>&gt;</span> <span style="color:#0000a2;font-weight:700">getObjectType</span>() {
        <span style="color:#00f;font-weight:700">return</span> <span style="color:#00f;font-weight:700">MessageDigest</span><span style="color:#00f;font-weight:700">.</span>class;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">boolean</span> <span style="color:#0000a2;font-weight:700">isSingleton</span>() {
        <span style="color:#00f;font-weight:700">return</span> <span style="color:#585cf6;font-weight:700">true</span>;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">afterPropertiesSet</span>() <span style="color:#00f;font-weight:700">throws</span> <span style="color:#00f;font-weight:700">Exception</span> {
        messageDigest <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">MessageDigest</span><span style="color:#00f;font-weight:700">.</span>getInstance(algorithmName);
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setAlgorithmName</span>(<span style="color:#00f;font-weight:700">String</span> <span style="font-style:italic">algorithmName</span>) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>algorithmName <span style="color:#00f;font-weight:700">=</span> algorithmName;
    }
}
</pre>
            <div class="Para" id="Par123">Spring calls the <span class="EmphasisFontCategoryNonProportional">getObject</span>() method to retrieve the object created by the <span class="EmphasisFontCategoryNonProportional">FactoryBean</span>. This is the actual object that is passed
                to other beans that use the <span class="EmphasisFontCategoryNonProportional">FactoryBean</span> as a collaborator. In the code snippet, you can see that <span class="EmphasisFontCategoryNonProportional">MessageDigestFactoryBean</span>                passes a clone of the stored <span class="EmphasisFontCategoryNonProportional">MessageDigest</span> instance that is created in the <span class="EmphasisFontCategoryNonProportional">InitializingBean.afterPropertiesSet()</span> callback.</div>
            <div class="Para" id="Par124">The <span class="EmphasisFontCategoryNonProportional">getObjectType()</span> method allows you to tell Spring what type of object your <span class="EmphasisFontCategoryNonProportional">FactoryBean</span> will return. This can be <span class="EmphasisFontCategoryNonProportional">null</span>                if the return type is unknown in advance (for example, the <span class="EmphasisFontCategoryNonProportional">FactoryBean</span> creates different types of objects depending on the configuration, which will be determined only after the
                <span class="EmphasisFontCategoryNonProportional">FactoryBean</span> is initialized), but if you specify a type, Spring can use it for autowiring purposes. We return <span class="EmphasisFontCategoryNonProportional">MessageDigest</span>                as our type (in this case, a class, but try to return an interface type and have the <span class="EmphasisFontCategoryNonProportional">FactoryBean</span> instantiate the concrete implementation class, unless necessary). The reason is that
                we do not know what concrete type will be returned (not that it matters, because all beans will define their dependencies by using <span class="EmphasisFontCategoryNonProportional">MessageDigest</span> anyway).</div>
        <div class="Para" id="Par125">The <span id="ITerm56">            <span class="EmphasisFontCategoryNonProportional">isSingleton</span>() property </span> allows you to inform Spring whether the <span class="EmphasisFontCategoryNonProportional">FactoryBean</span> is managing
            a singleton instance. Remember that by setting the singleton attribute of the <span class="EmphasisFontCategoryNonProportional">FactoryBean</span>’s <span class="EmphasisFontCategoryNonProportional">&lt;bean&gt;</span> tag, you tell Spring
            about the singleton status of the <span class="EmphasisFontCategoryNonProportional">FactoryBean</span> itself, not the objects it is returning. Now let’s see how the <span class="EmphasisFontCategoryNonProportional">FactoryBean</span> is employed
            in an application. In the following code snippet, you can see a simple bean that maintains two <span class="EmphasisFontCategoryNonProportional">MessageDigest</span> instances and then displays the digests of a message passed to its
            <span class="EmphasisFontCategoryNonProportional">digest()</span> method:</div>
        <pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">java.security.MessageDigest</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">MessageDigester</span> {
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">MessageDigest</span> digest1;
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">MessageDigest</span> digest2;

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setDigest1</span>(<span style="color:#00f;font-weight:700">MessageDigest</span> <span style="font-style:italic">digest1</span>) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>digest1 <span style="color:#00f;font-weight:700">=</span> digest1;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setDigest2</span>(<span style="color:#00f;font-weight:700">MessageDigest</span> <span style="font-style:italic">digest2</span>) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>digest2 <span style="color:#00f;font-weight:700">=</span> digest2;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">digest</span>(<span style="color:#00f;font-weight:700">String</span> <span style="font-style:italic">msg</span>) {
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">Using digest1</span>);
        digest(msg, digest1);
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">Using digest2</span>);
        digest(msg, digest2);
    }

    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">digest</span>(<span style="color:#00f;font-weight:700">String</span> <span style="font-style:italic">msg</span>, <span style="color:#00f;font-weight:700">MessageDigest</span> <span style="font-style:italic">digest</span>) {
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">Using alogrithm: </span> <span style="color:#00f;font-weight:700">+</span> digest<span style="color:#00f;font-weight:700">.</span>getAlgorithm());
        digest<span style="color:#00f;font-weight:700">.</span>reset();
        <span style="color:#00f;font-weight:700">byte</span>[] bytes <span style="color:#00f;font-weight:700">=</span> msg<span style="color:#00f;font-weight:700">.</span>getBytes();
        <span style="color:#00f;font-weight:700">byte</span>[] out <span style="color:#00f;font-weight:700">=</span> digest<span style="color:#00f;font-weight:700">.</span>digest(bytes);
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(out);
    }
}
</pre>
        <div class="Para" id="Par127">The following configuration snippet shows an example <span id="ITerm58">configuration                                  </span> for two <span class="EmphasisFontCategoryNonProportional">MessageDigestFactoryBean</span> classes, one for the SHA1
            algorithm and the other using the default (MD5) algorithm (<span class="EmphasisFontCategoryNonProportional">app-context-xml.xml</span>):</div>
        <pre style="background:#fff;color:#000"><span style="color:#1c02ff">&lt;<span style="font-weight:700">beans</span> ...&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">shaDigest</span>
        <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch4.MessageDigestFactoryBean</span>
        <span style="font-style:italic">p</span>:algorithmName=<span style="color:#036a07">SHA1</span>/&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">defaultDigest</span>
        <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch4.MessageDigestFactoryBean</span>/&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">digester</span>
        <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch4.MessageDigester</span>
        <span style="font-style:italic">p</span>:digest1-ref=<span style="color:#036a07">shaDigest</span>
        <span style="font-style:italic">p</span>:digest2-ref=<span style="color:#036a07">defaultDigest</span>/&gt;</span>
<span style="color:#1c02ff">&lt;/<span style="font-weight:700">beans</span>&gt;</span>
</pre>
        <div class="Para" id="Par129">As you can see, not only we have configured the two <span class="EmphasisFontCategoryNonProportional">MessageDigestFactoryBean</span> classes, but we have also configured a <span class="EmphasisFontCategoryNonProportional">MessageDigester</span>,
            using the two <span class="EmphasisFontCategoryNonProportional">MessageDigestFactoryBean</span> classes, to provide values for the <span class="EmphasisFontCategoryNonProportional">digest1</span> and <span class="EmphasisFontCategoryNonProportional">digest2</span>            properties. For the <span class="EmphasisFontCategoryNonProportional">defaultDigest</span> bean, since the <span class="EmphasisFontCategoryNonProportional">algorithmName</span> property was not specified, no injection will happen, and the
            default algorithm (MD5) that was coded in the class will be used. In the following code sample, you see a basic example class that retrieves the <span class="EmphasisFontCategoryNonProportional">MessageDigester</span> bean from the <span class="EmphasisFontCategoryNonProportional">BeanFactory</span>            and creates the digest of a simple message:</div>
        <pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.support.GenericXmlApplicationContext</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">MessageDigestDemo</span> {
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span>... <span style="font-style:italic">args</span>) {
        <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span> ctx <span style="color:#00f;font-weight:700">=</span>
                <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span>();
        ctx<span style="color:#00f;font-weight:700">.</span>load(<span style="color:#036a07">classpath:spring/app-context-xml.xml</span>);
        ctx<span style="color:#00f;font-weight:700">.</span>refresh();
        <span style="color:#00f;font-weight:700">MessageDigester</span> digester <span style="color:#00f;font-weight:700">=</span> ctx<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#036a07">digester</span>,
                <span style="color:#00f;font-weight:700">MessageDigester</span><span style="color:#00f;font-weight:700">.</span>class);
        digester<span style="color:#00f;font-weight:700">.</span>digest(<span style="color:#036a07">Hello World!</span>);
        ctx<span style="color:#00f;font-weight:700">.</span>close();
    }
}
</pre>
        <div class="Para" id="Par131">Running this example gives the following output:</div>
        <div class="Para" id="Par132">
            <div class="ProgramCode" id="PC38">
                <div class="FixedLine">Using digest1</div>
                <div class="FixedLine">Using alogrithm: SHA1</div>
                <div class="FixedLine">[B@<span id="ITerm59">130f889                                              </span> </div>
                <div class="FixedLine">Using digest2</div>
                <div class="FixedLine">Using alogrithm: MD5</div>
                <div class="FixedLine">[B@1188e820</div>
            </div>
        </div>
        <div class="Para" id="Par133">As you can see, the <span class="EmphasisFontCategoryNonProportional">MessageDigest</span> bean is provided with two <span class="EmphasisFontCategoryNonProportional">MessageDigest</span> implementations, <span class="EmphasisFontCategoryNonProportional">SHA1</span>            and <span class="EmphasisFontCategoryNonProportional">MD5</span>, even though no <span class="EmphasisFontCategoryNonProportional">MessageDigest</span> beans are configured in the <span class="EmphasisFontCategoryNonProportional">BeanFactory</span>.
            This is the <span class="EmphasisFontCategoryNonProportional">FactoryBean</span> at work.</div>
        <div class="Para" id="Par134"> <span class="EmphasisFontCategoryNonProportional">FactoryBean</span>s are the perfect solution when you are working with classes that cannot be created by using the <span class="EmphasisFontCategoryNonProportional">new</span> operator. If you
            work with objects that are created by using a factory method and you want to use these classes in a Spring application, create a <span class="EmphasisFontCategoryNonProportional">FactoryBean</span> to act as an adapter, allowing your classes
            to take full advantage of Spring’s IoC capabilities.</div>
        <div class="Para" id="Par135">Using <span class="EmphasisFontCategoryNonProportional">FactoryBean</span>s is different when configuration via Java configuration is used, because in this case there is a restriction from the compiler to set the property with the proper type;
            thus, the <span class="EmphasisFontCategoryNonProportional">getObject()</span> method must be called explicitly. In the following code snippet, you can see an example of configuring the same beans as in the previous example, but using
            <span id="ITerm60">Java configuration </span>:</div>
        <pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4.config</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4.MessageDigestFactoryBean</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4.MessageDigester</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.annotation.AnnotationConfigApplicationContext</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.annotation.Bean</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.annotation.Configuration</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.support.GenericApplicationContext</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">MessageDigesterConfigDemo</span> {
    <span style="color:#00f;font-weight:700">@Configuration</span>
    <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">MessageDigesterConfig</span> {
        <span style="color:#00f;font-weight:700">@Bean</span>
        <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">MessageDigestFactoryBean</span> <span style="color:#0000a2;font-weight:700">shaDigest</span>() {
            <span style="color:#00f;font-weight:700">MessageDigestFactoryBean</span> factoryOne <span style="color:#00f;font-weight:700">=</span>
                    <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">MessageDigestFactoryBean</span>();
            factoryOne<span style="color:#00f;font-weight:700">.</span>setAlgorithmName(<span style="color:#036a07">SHA1</span>);
            <span style="color:#00f;font-weight:700">return</span> factoryOne;
        }

        <span style="color:#00f;font-weight:700">@Bean</span>
        <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">MessageDigestFactoryBean</span> <span style="color:#0000a2;font-weight:700">defaultDigest</span>() {
            <span style="color:#00f;font-weight:700">return</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">MessageDigestFactoryBean</span>();
        }

        <span style="color:#00f;font-weight:700">@Bean</span>
        <span style="color:#00f;font-weight:700">MessageDigester</span> <span style="color:#0000a2;font-weight:700">digester</span>() <span style="color:#00f;font-weight:700">throws</span> <span style="color:#00f;font-weight:700">Exception</span> {
            <span style="color:#00f;font-weight:700">MessageDigester</span> messageDigester <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">MessageDigester</span>();
            messageDigester<span style="color:#00f;font-weight:700">.</span>setDigest1(shaDigest()<span style="color:#00f;font-weight:700">.</span>getObject());
            messageDigester<span style="color:#00f;font-weight:700">.</span>setDigest2(defaultDigest()<span style="color:#00f;font-weight:700">.</span>getObject());
            <span style="color:#00f;font-weight:700">return</span> messageDigester;
        }
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span>... <span style="font-style:italic">args</span>) {
        <span style="color:#00f;font-weight:700">GenericApplicationContext</span> ctx <span style="color:#00f;font-weight:700">=</span>
                <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">AnnotationConfigApplicationContext</span>(<span style="color:#00f;font-weight:700">MessageDigesterConfig</span><span style="color:#00f;font-weight:700">.</span>class);
        <span style="color:#00f;font-weight:700">MessageDigester</span> digester <span style="color:#00f;font-weight:700">=</span> (<span style="color:#00f;font-weight:700">MessageDigester</span>) ctx<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#036a07">digester</span>);
        digester<span style="color:#00f;font-weight:700">.</span>digest(<span style="color:#036a07">Hello World!</span>);
        ctx<span style="color:#00f;font-weight:700">.</span>close();
    }
}
</pre>
        <div class="Para" id="Par137">If you run this class, the same output as before is printed.</div>
    </div>
    </div>
    <div class="Section1 RenderAsSection1" id="Sec21">
        <h2 class="Heading"> <span id="ITerm62">Accessing                  </span> a FactoryBean Directly</h2>
        <div class="Para" id="Par138">Given that Spring automatically satisfies any references to a <span class="EmphasisFontCategoryNonProportional">FactoryBean</span> by the objects produced by that <span class="EmphasisFontCategoryNonProportional">FactoryBean</span>, you may be
            wondering whether you can actually access the <span class="EmphasisFontCategoryNonProportional">FactoryBean</span> directly. The answer is yes.</div>
        <div class="Para" id="Par139">Accessing <span class="EmphasisFontCategoryNonProportional">FactoryBean</span> is simple: you prefix the bean name with an ampersand in the call to <span class="EmphasisFontCategoryNonProportional">getBean()</span>, as shown in the following code
            sample:</div>
        <pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.support.GenericXmlApplicationContext</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">java.security.MessageDigest</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">AccessingFactoryBeans</span> {
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span>... <span style="font-style:italic">args</span>) {
        <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span> ctx <span style="color:#00f;font-weight:700">=</span>
                <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span>();
        ctx<span style="color:#00f;font-weight:700">.</span>load(<span style="color:#036a07">classpath:spring/app-context-xml.xml</span>);
        ctx<span style="color:#00f;font-weight:700">.</span>refresh();
        ctx<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#036a07">shaDigest</span>, <span style="color:#00f;font-weight:700">MessageDigest</span><span style="color:#00f;font-weight:700">.</span>class);
        <span style="color:#00f;font-weight:700">MessageDigestFactoryBean</span> factoryBean <span style="color:#00f;font-weight:700">=</span>
                (<span style="color:#00f;font-weight:700">MessageDigestFactoryBean</span>) ctx<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#036a07">&amp;shaDigest</span>);
        <span style="color:#00f;font-weight:700">try</span> {
            <span style="color:#00f;font-weight:700">MessageDigest</span> shaDigest <span style="color:#00f;font-weight:700">=</span> factoryBean<span style="color:#00f;font-weight:700">.</span>getObject();
            <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(shaDigest<span style="color:#00f;font-weight:700">.</span>digest(<span style="color:#036a07">Hello world</span><span style="color:#00f;font-weight:700">.</span>getBytes()));
        } <span style="color:#00f;font-weight:700">catch</span> (<span style="color:#00f;font-weight:700">Exception</span> ex) {
            ex<span style="color:#00f;font-weight:700">.</span>printStackTrace();
        }
        ctx<span style="color:#00f;font-weight:700">.</span>close();
    }
}
</pre>
    <div class="Para" id="Par141">Running this program generates the following output:</div>
    <div class="Para" id="Par142">
        <div class="ProgramCode" id="PC41">
            <div class="FixedLine">[B@130f889</div>
        </div>
    </div>
    <div class="Para" id="Par143">This feature is used in a few places in the Spring code, but your application should really have no reason to use it. The intention of <span class="EmphasisFontCategoryNonProportional">FactoryBean</span> is to be used as a piece of supporting infrastructure
        to allow you to use more of your application’s classes in an IoC setting. Avoid accessing <span class="EmphasisFontCategoryNonProportional">FactoryBean</span> directly and invoking its <span class="EmphasisFontCategoryNonProportional">getObject()</span>        manually, and let Spring do it for you; if you do this manually, you are making extra work for yourself and are unnecessarily coupling your application to a specific implementation detail that could quite easily change in the <span id="ITerm63">future                  </span>.</div>
    </div>
    <div class="Section1 RenderAsSection1 SectionTypeMaterialsAndMethods" id="Sec22">
        <h2 class="Heading">Using the factory-bean and factory-method Attributes</h2>
        <div class="Para" id="Par144">Sometimes you need to instantiate JavaBeans that were provided by a non-Spring-powered third-party application. You don’t know how to instantiate that class, but you know that the third-party application provides a class that can be used to get
            an instance of the JavaBean that your Spring application needs. In this case, Spring bean’s <span class="EmphasisFontCategoryNonProportional">factory-bean</span> and <span id="ITerm64">          <span class="EmphasisFontCategoryNonProportional">factory-method</span>            attributes </span> <span id="ITerm65">                                        </span> in the <span class="EmphasisFontCategoryNonProportional">&lt;bean&gt;</span> tag can be used.</div>
        <div class="Para" id="Par145">To take a look at how it works, the following code snippet shows another version of the <span class="EmphasisFontCategoryNonProportional">MessageDigestFactory</span> that provides a method to return a <span class="EmphasisFontCategoryNonProportional">MessageDigest</span>            bean:</div>
        <pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">java.security.MessageDigest</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">MessageDigestFactory</span> {
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">String</span> algorithmName <span style="color:#00f;font-weight:700">=</span> <span style="color:#036a07">MD5</span>;

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">MessageDigest</span> <span style="color:#0000a2;font-weight:700">createInstance</span>() <span style="color:#00f;font-weight:700">throws</span> <span style="color:#00f;font-weight:700">Exception</span> {
        <span style="color:#00f;font-weight:700">return</span> <span style="color:#00f;font-weight:700">MessageDigest</span><span style="color:#00f;font-weight:700">.</span>getInstance(algorithmName);
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setAlgorithmName</span>(<span style="color:#00f;font-weight:700">String</span> <span style="font-style:italic">algorithmName</span>) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>algorithmName <span style="color:#00f;font-weight:700">=</span> algorithmName;
    }
}
</pre>
        <div class="Para" id="Par147">The following configuration snippet shows how to configure the factory method for getting the corresponding <span class="EmphasisFontCategoryNonProportional">MessageDigest</span> bean instance (<span class="EmphasisFontCategoryNonProportional">app-context-xml.xml</span>):</div>
        <pre style="background:#fff;color:#000"><span style="color:#1c02ff">&lt;<span style="font-weight:700">beans</span>...&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">shaDigestFactory</span>
        <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch4.MessageDigestFactory</span>
        <span style="font-style:italic">p</span>:algorithmName=<span style="color:#036a07">SHA1</span>/&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">defaultDigestFactory</span>
        <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch4.MessageDigestFactory</span>/&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">shaDigest</span>
          <span style="font-style:italic">factory-bean</span>=<span style="color:#036a07">shaDigestFactory</span>
          <span style="font-style:italic">factory-method</span>=<span style="color:#036a07">createInstance</span>&gt;</span>
    <span style="color:#1c02ff">&lt;/<span style="font-weight:700">bean</span>&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">defaultDigest</span>
          <span style="font-style:italic">factory-bean</span>=<span style="color:#036a07">defaultDigestFactory</span>
          <span style="font-style:italic">factory-method</span>=<span style="color:#036a07">createInstance</span>/&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">digester</span>
        <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch4.MessageDigester</span>
        <span style="font-style:italic">p</span>:digest1-ref=<span style="color:#036a07">shaDigest</span>
        <span style="font-style:italic">p</span>:digest2-ref=<span style="color:#036a07">defaultDigest</span>/&gt;</span>
<span style="color:#1c02ff">&lt;/<span style="font-weight:700">beans</span>&gt;</span>
</pre>
    <div class="Para" id="Par149">Notice that two digest factory beans were defined, one using SHA1 and the other using the default algorithm. Then for the beans <span class="EmphasisFontCategoryNonProportional">shaDigest</span> and <span class="EmphasisFontCategoryNonProportional">defaultDigest</span>,
        we instructed Spring to instantiate the beans by using the corresponding message digest factory bean via the <span class="EmphasisFontCategoryNonProportional">factory-bean</span> attribute, and we specified the method to use to obtain the bean
        instance via the <span class="EmphasisFontCategoryNonProportional">factory-method</span> attribute. The following code snippet depicts the testing class:</div>
    <pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.support.GenericXmlApplicationContext</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">MessageDigestFactoryDemo</span> {
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span>... <span style="font-style:italic">args</span>) {
        <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span> ctx <span style="color:#00f;font-weight:700">=</span>
                <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span>();
        ctx<span style="color:#00f;font-weight:700">.</span>load(<span style="color:#036a07">classpath:spring/app-context-xml.xml</span>);
        ctx<span style="color:#00f;font-weight:700">.</span>refresh();
        <span style="color:#00f;font-weight:700">MessageDigester</span> digester <span style="color:#00f;font-weight:700">=</span> ctx<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#036a07">digester</span>,
                <span style="color:#00f;font-weight:700">MessageDigester</span><span style="color:#00f;font-weight:700">.</span>class);
        digester<span style="color:#00f;font-weight:700">.</span>digest(<span style="color:#036a07">Hello World!</span>);
        ctx<span style="color:#00f;font-weight:700">.</span>close();
    }
}
</pre>
    <div class="Para" id="Par151">Running the program generates the following output:</div>
    <div class="Para" id="Par152">
        <div class="ProgramCode" id="PC45">
            <div class="FixedLine">Using digest1</div>
            <div class="FixedLine">Using alogrithm: SHA1 [B@77a57272</div>
            <div class="FixedLine">Using digest2</div>
            <div class="FixedLine">Using alogrithm: MD5 [B@<span id="ITerm68">7181ae3f            </span> <span id="ITerm69">                                                    </span> </div>
        </div>
    </div>
    </div>
    <div class="Section1 RenderAsSection1" id="Sec23">
        <h2 class="Heading">JavaBeans PropertyEditors</h2>
        <div class="Para" id="Par153">If you are not entirely familiar with JavaBeans concepts, a <span class="EmphasisFontCategoryNonProportional">PropertyEditor</span> is an interface that converts a property’s value to and from its native type representation into a <span class="EmphasisFontCategoryNonProportional">String</span>.
            Originally, this was conceived as a way to allow property values to be entered, as <span class="EmphasisFontCategoryNonProportional">String</span> values, into an editor and have them transformed into the correct type. However, because
            <span class="EmphasisFontCategoryNonProportional">PropertyEditor</span>s are inherently lightweight classes, they have found uses in many settings, including Spring.</div>
        <div class="Para" id="Par154">Because a good portion of property values in a Spring-based application start life in the <span class="EmphasisFontCategoryNonProportional">BeanFactory</span> configuration file, they are essentially <span class="EmphasisFontCategoryNonProportional">String</span>s.
            However, the property that these values are set on may not be <span class="EmphasisFontCategoryNonProportional">String</span>-typed. So, to save you from having to create a load of <span class="EmphasisFontCategoryNonProportional">String</span>-typed
            properties artificially, Spring allows you to define <span class="EmphasisFontCategoryNonProportional">PropertyEditor</span>s to manage the conversion of <span class="EmphasisFontCategoryNonProportional">String</span>-based property values
            into the correct types. Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_4_Chapter.html#Fig2">4-2</a></span> shows the full list of <span class="EmphasisFontCategoryNonProportional">PropertyEditor</span>s
            that are part of the <span id="ITerm70">              <span class="EmphasisFontCategoryNonProportional">spring-beans</span> </span> package; you can see this list with any smart Java editor.
            <div class="Figure" id="Fig2">
                <div class="MediaObject" id="MO2"><img alt="A315511_5_En_4_Fig2_HTML.jpg" data-mfp-src="/library/view/pro-spring-5/9781484228081/A315511_5_En_4_Fig2_HTML.jpg" height="550" src="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_4_Fig2_HTML.jpg" width="360"/></div>
                <div class="Caption" xml:lang="en">
                    <div class="CaptionContent"><span class="CaptionNumber">Figure 4-2.</span>
                        <div class="SimplePara">Spring <span id="ITerm71">PropertyEditors                                  </span> </div>
                    </div>
            </div>
        </div>
    </div>
    <div class="Para" id="Par155">They all extend <span class="EmphasisFontCategoryNonProportional">java.beans.PropertyEditorSupport</span> and can be used for implicit conversion of <span class="EmphasisFontCategoryNonProportional">String</span> literals into property values to be
        injected in beans; thus, they are preregistered with <span class="EmphasisFontCategoryNonProportional">BeanFactory</span>.</div>
    <div class="Section2 RenderAsSection2" id="Sec24">
        <h3 class="Heading">Using the Built-in PropertyEditors</h3>
        <div class="Para" id="Par156">The following code snippet shows a simple bean that declares 14 properties, one for each of the types supported by the built-in <span class="EmphasisFontCategoryNonProportional">PropertyEditor</span> <span id="ITerm72">implementations                      </span>:</div>
        <pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">java.io.File</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">java.io.InputStream</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">java.net.URL</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">java.util.*</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">java.util.regex.Pattern</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">java.text.SimpleDateFormat</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.beans.PropertyEditorRegistrar</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.beans.PropertyEditorRegistry</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.beans.propertyeditors.CustomDateEditor</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.beans.propertyeditors.StringTrimmerEditor</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.support.GenericXmlApplicationContext</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">PropertyEditorBean</span> {
)
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">byte</span>[] bytes;                <span style="color:#06f;font-style:italic">// ByteArrayPropertyEditor</span>
)
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">Character</span> character;         <span style="color:#06f;font-style:italic">//CharacterEditor</span>
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">Class</span> cls;                   <span style="color:#06f;font-style:italic">// ClassEditor</span>
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">Boolean</span> trueOrFalse;         <span style="color:#06f;font-style:italic">// CustomBooleanEditor</span>
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">List&lt;<span style="color:#00f;font-weight:700">String</span>&gt;</span> stringList;     <span style="color:#06f;font-style:italic">// CustomCollectionEditor</span>
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">Date</span> date;                   <span style="color:#06f;font-style:italic">// CustomDateEditor</span>
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">Float</span> floatValue;            <span style="color:#06f;font-style:italic">// CustomNumberEditor</span>
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">File</span> file;                   <span style="color:#06f;font-style:italic">// FileEditor</span>
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">InputStream</span> stream;          <span style="color:#06f;font-style:italic">// InputStreamEditor</span>
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">Locale</span> locale;               <span style="color:#06f;font-style:italic">// LocaleEditor</span>
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">Pattern</span> pattern;             <span style="color:#06f;font-style:italic">// PatternEditor</span>
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">Properties</span> properties;       <span style="color:#06f;font-style:italic">// PropertiesEditor</span>
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">String</span> trimString;           <span style="color:#06f;font-style:italic">// StringTrimmerEditor</span>
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#c5060b;font-weight:700">URL</span> url;                     <span style="color:#06f;font-style:italic">// URLEditor</span>

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setCharacter</span>(<span style="color:#00f;font-weight:700">Character</span> <span style="font-style:italic">character</span>) {
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">Setting character: </span> <span style="color:#00f;font-weight:700">+</span> character);
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>character <span style="color:#00f;font-weight:700">=</span> character;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setCls</span>(<span style="color:#00f;font-weight:700">Class</span> <span style="font-style:italic">cls</span>) {
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">Setting class: </span> <span style="color:#00f;font-weight:700">+</span> cls<span style="color:#00f;font-weight:700">.</span>getName());
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>cls <span style="color:#00f;font-weight:700">=</span> cls;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setFile</span>(<span style="color:#00f;font-weight:700">File</span> <span style="font-style:italic">file</span>) {
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">Setting file: </span> <span style="color:#00f;font-weight:700">+</span> file<span style="color:#00f;font-weight:700">.</span>getName());
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>file <span style="color:#00f;font-weight:700">=</span> file;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setLocale</span>(<span style="color:#00f;font-weight:700">Locale</span> <span style="font-style:italic">locale</span>) {
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">Setting locale: </span> <span style="color:#00f;font-weight:700">+</span> locale<span style="color:#00f;font-weight:700">.</span>getDisplayName());
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>locale <span style="color:#00f;font-weight:700">=</span> locale;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setProperties</span>(<span style="color:#00f;font-weight:700">Properties</span> <span style="font-style:italic">properties</span>) {
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">Loaded </span> <span style="color:#00f;font-weight:700">+</span> properties<span style="color:#00f;font-weight:700">.</span>size() <span style="color:#00f;font-weight:700">+</span> <span style="color:#036a07"> properties</span>);
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>properties <span style="color:#00f;font-weight:700">=</span> properties;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setUrl</span>(<span style="color:#00f;font-weight:700">URL</span> <span style="font-style:italic">url</span>) {
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">Setting URL: </span> <span style="color:#00f;font-weight:700">+</span> url<span style="color:#00f;font-weight:700">.</span>toExternalForm());
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>url <span style="color:#00f;font-weight:700">=</span> url;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setBytes</span>(<span style="color:#00f;font-weight:700">byte</span>... <span style="font-style:italic">bytes</span>) {
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">Setting bytes: </span> <span style="color:#00f;font-weight:700">+</span> <span style="color:#00f;font-weight:700">Arrays</span><span style="color:#00f;font-weight:700">.</span>toString(bytes));
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>bytes <span style="color:#00f;font-weight:700">=</span> bytes;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setTrueOrFalse</span>(<span style="color:#00f;font-weight:700">Boolean</span> <span style="font-style:italic">trueOrFalse</span>) {
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">Setting Boolean: </span> <span style="color:#00f;font-weight:700">+</span> trueOrFalse);
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>trueOrFalse <span style="color:#00f;font-weight:700">=</span> trueOrFalse;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setStringList</span>(<span style="color:#00f;font-weight:700">List&lt;<span style="color:#00f;font-weight:700">String</span>&gt;</span> <span style="font-style:italic">stringList</span>) {
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">Setting string list with size: </span>
                <span style="color:#00f;font-weight:700">+</span> stringList<span style="color:#00f;font-weight:700">.</span>size());
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>stringList <span style="color:#00f;font-weight:700">=</span> stringList;
        <span style="color:#00f;font-weight:700">for</span> (<span style="color:#00f;font-weight:700">String</span> string <span style="color:#00f;font-weight:700">:</span> stringList) {
            <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">String member: </span> <span style="color:#00f;font-weight:700">+</span> string);
        }
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setDate</span>(<span style="color:#00f;font-weight:700">Date</span> <span style="font-style:italic">date</span>) {
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">Setting date: </span> <span style="color:#00f;font-weight:700">+</span> date);
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>date <span style="color:#00f;font-weight:700">=</span> date;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setFloatValue</span>(<span style="color:#00f;font-weight:700">Float</span> <span style="font-style:italic">floatValue</span>) {
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">Setting float value: </span> <span style="color:#00f;font-weight:700">+</span> floatValue);
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>floatValue <span style="color:#00f;font-weight:700">=</span> floatValue;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setStream</span>(<span style="color:#00f;font-weight:700">InputStream</span> <span style="font-style:italic">stream</span>) {
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">Setting stream: </span> <span style="color:#00f;font-weight:700">+</span> stream);
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>stream <span style="color:#00f;font-weight:700">=</span> stream;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setPattern</span>(<span style="color:#00f;font-weight:700">Pattern</span> <span style="font-style:italic">pattern</span>) {
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">Setting pattern: </span> <span style="color:#00f;font-weight:700">+</span> pattern);
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>pattern <span style="color:#00f;font-weight:700">=</span> pattern;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setTrimString</span>(<span style="color:#00f;font-weight:700">String</span> <span style="font-style:italic">trimString</span>) {
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">Setting trim string: </span> <span style="color:#00f;font-weight:700">+</span> trimString);
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>trimString <span style="color:#00f;font-weight:700">=</span> trimString;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">CustomPropertyEditorRegistrar</span>
            <span style="color:#00f;font-weight:700">implements</span> <span style="font-style:italic">PropertyEditorRegistrar</span> {
        <span style="color:#00f;font-weight:700">@Override</span>
        <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">registerCustomEditors</span>(<span style="color:#00f;font-weight:700">PropertyEditorRegistry</span> <span style="font-style:italic">registry</span>) {
            <span style="color:#00f;font-weight:700">SimpleDateFormat</span> dateFormatter <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">SimpleDateFormat</span>(<span style="color:#036a07">MM/dd/yyyy</span>);
            registry<span style="color:#00f;font-weight:700">.</span>registerCustomEditor(<span style="color:#00f;font-weight:700">Date</span><span style="color:#00f;font-weight:700">.</span>class,
                    <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">CustomDateEditor</span>(dateFormatter, <span style="color:#585cf6;font-weight:700">true</span>));
            registry<span style="color:#00f;font-weight:700">.</span>registerCustomEditor(<span style="color:#00f;font-weight:700">String</span><span style="color:#00f;font-weight:700">.</span>class, <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">StringTrimmerEditor</span>(<span style="color:#585cf6;font-weight:700">true</span>));
        }
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span>... <span style="font-style:italic">args</span>) <span style="color:#00f;font-weight:700">throws</span> <span style="color:#00f;font-weight:700">Exception</span> {
        <span style="color:#00f;font-weight:700">File</span> file <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">File</span><span style="color:#00f;font-weight:700">.</span>createTempFile(<span style="color:#036a07">test</span>, <span style="color:#036a07">txt</span>);
        file<span style="color:#00f;font-weight:700">.</span>deleteOnExit();
        <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span> ctx <span style="color:#00f;font-weight:700">=</span>
                <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span>();
        ctx<span style="color:#00f;font-weight:700">.</span>load(<span style="color:#036a07">classpath:spring/app-context-01.xml</span>);
        ctx<span style="color:#00f;font-weight:700">.</span>refresh();
        <span style="color:#00f;font-weight:700">PropertyEditorBean</span> bean <span style="color:#00f;font-weight:700">=</span>
                (<span style="color:#00f;font-weight:700">PropertyEditorBean</span>) ctx<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#036a07">builtInSample</span>);
        ctx<span style="color:#00f;font-weight:700">.</span>close();
    }
}
</pre>
    <div class="Para" id="Par158">In the following <span id="ITerm76">configuration                      </span> sample, you can see the configuration used to declare a bean of type <span class="EmphasisFontCategoryNonProportional">PropertyEditorBean</span> with values being specified
        for all the previous properties (<span class="EmphasisFontCategoryNonProportional">app-config-01.xml</span>):</div>
    <pre style="background:#fff;color:#000"><span style="color:#68685b">&lt;?<span style="color:#888">xml</span><span style="color:#888"> version</span>=<span style="color:#888">1.0</span><span style="color:#888"> encoding</span>=<span style="color:#888">UTF-8</span>?&gt;</span>
<span style="color:#1c02ff">&lt;<span style="font-weight:700">beans</span> <span style="font-style:italic">xmlns</span>=<span style="color:#036a07">http://www.springframework.org/schema/beans</span>
    <span style="font-style:italic">xmlns</span>:xsi=<span style="color:#036a07">http://www.w3.org/2001/XMLSchema-instance</span>
    <span style="font-style:italic">xmlns</span>:util=<span style="color:#036a07">http://www.springframework.org/schema/util</span>
    <span style="font-style:italic">xmlns</span>:p=<span style="color:#036a07">http://www.springframework.org/schema/p</span>
    <span style="font-style:italic">xsi</span>:schemaLocation=<span style="color:#036a07">http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans.xsd
        http://www.springframework.org/schema/util
        http://www.springframework.org/schema/util/spring-util.xsd</span>&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">customEditorConfigurer</span>
        <span style="font-style:italic">class</span>=<span style="color:#036a07">org.springframework.beans.factory.config.CustomEditorConfigurer</span>
        <span style="font-style:italic">p</span>:propertyEditorRegistrars-ref=<span style="color:#036a07">propertyEditorRegistrarsList</span>/&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">util</span><span style="font-weight:700">:</span><span style="font-weight:700">list</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">propertyEditorRegistrarsList</span>&gt;</span>
        <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch4.PropertyEditorBean$
              CustomPropertyEditorRegistrar</span>/&gt;</span>
    <span style="color:#1c02ff">&lt;/<span style="font-weight:700">util</span><span style="font-weight:700">:</span><span style="font-weight:700">list</span>&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">builtInSample</span>
          <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch4.PropertyEditorBean</span>
        <span style="font-style:italic">p</span>:character=<span style="color:#036a07">A</span>
        <span style="font-style:italic">p</span>:bytes=<span style="color:#036a07">John Mayer</span>
        <span style="font-style:italic">p</span>:cls=<span style="color:#036a07">java.lang.String</span>
        <span style="font-style:italic">p</span>:trueOrFalse=<span style="color:#036a07">true</span>
        <span style="font-style:italic">p</span>:stringList-ref=<span style="color:#036a07">stringList</span>
        <span style="font-style:italic">p</span>:stream=<span style="color:#036a07">test.txt</span>
        <span style="font-style:italic">p</span>:floatValue=<span style="color:#036a07">123.45678</span>
        <span style="font-style:italic">p</span>:date=<span style="color:#036a07">05/03/13</span>
          <span style="font-style:italic">p</span>:file=<span style="color:#036a07">#{systemProperties&apos;java.io.tmpdir&apos;}
                      #{systemProperties&apos;file.separator&apos;}test.txt</span>
        <span style="font-style:italic">p</span>:locale=<span style="color:#036a07">en_US</span>
        <span style="font-style:italic">p</span>:pattern=<span style="color:#036a07">a*b</span>
        <span style="font-style:italic">p</span>:properties=<span style="color:#036a07">name=Chris age=32</span>
        <span style="font-style:italic">p</span>:trimString=<span style="color:#036a07">   String need trimming   </span>
        <span style="font-style:italic">p</span>:url=<span style="color:#036a07">https://spring.io/</span>
    /&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">util</span><span style="font-weight:700">:</span><span style="font-weight:700">list</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">stringList</span>&gt;</span>
        <span style="color:#1c02ff">&lt;<span style="font-weight:700">value</span>&gt;</span>String member 1<span style="color:#1c02ff">&lt;/<span style="font-weight:700">value</span>&gt;</span>
        <span style="color:#1c02ff">&lt;<span style="font-weight:700">value</span>&gt;</span>String member 2<span style="color:#1c02ff">&lt;/<span style="font-weight:700">value</span>&gt;</span>
    <span style="color:#1c02ff">&lt;/<span style="font-weight:700">util</span><span style="font-weight:700">:</span><span style="font-weight:700">list</span>&gt;</span>
<span style="color:#1c02ff">&lt;/<span style="font-weight:700">beans</span>&gt;</span>
</pre>
    <div class="Para" id="Par160">As you can see, although all the properties on the <span class="EmphasisFontCategoryNonProportional">PropertyEditorBean</span> are not <span class="EmphasisFontCategoryNonProportional">String</span>s, the values for the properties are specified as
        simple <span class="EmphasisFontCategoryNonProportional">String</span>s. Also note that we registered the <span class="EmphasisFontCategoryNonProportional">CustomDateEditor</span> and <span class="EmphasisFontCategoryNonProportional">StringTrimmerEditor</span>,
        since those two editors were not registered by default in Spring. Running this example yields the following output:</div>
    <div class="Para" id="Par161">
        <div class="ProgramCode" id="PC48">
            <div class="FixedLine">Setting bytes: [74, 111, 104, 110, 32, 77, 97, 121, 101, 114]</div>
            <div class="FixedLine">Setting character: A</div>
            <div class="FixedLine">Setting class: java.lang.String</div>
            <div class="FixedLine">Setting date: Wed May 03  00:00:00 EET 13</div>
            <div class="FixedLine">Setting file: test.txt</div>
            <div class="FixedLine">Setting float value: 123.45678</div>
            <div class="FixedLine">Setting locale: English (United States)</div>
            <div class="FixedLine">Setting pattern: a*b</div>
            <div class="FixedLine">Loaded 1 properties</div>
            <div class="FixedLine">Setting stream: java.io.BufferedInputStream@42e25b0b</div>
            <div class="FixedLine">Setting string list with size: 2</div>
            <div class="FixedLine">String member: String member 1</div>
            <div class="FixedLine">String member: String member 2</div>
            <div class="FixedLine">Setting trim string: String need trimming</div>
            <div class="FixedLine">Setting Boolean: true</div>
            <div class="FixedLine">Setting URL: https://spring.io/</div>
        </div>
    </div>
    <div class="Para" id="Par162">As you can see, Spring has, using the built-in <span class="EmphasisFontCategoryNonProportional">PropertyEditor</span>s, converted the <span id="ITerm78">                <span class="EmphasisFontCategoryNonProportional">String</span> </span> representations
        of the various properties to the correct types. Table <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_4_Chapter.html#Tab1">4-1</a></span> lists the most important built-in
        <span class="EmphasisFontCategoryNonProportional">PropertyEditor</span>s available in Spring.
            <div class="Table" id="Tab1">
                <div class="Caption" xml:lang="en">
                    <div class="CaptionContent"><span class="CaptionNumber">Table 4-1.</span>
                        <div class="SimplePara">Spring PropertyEditors</div>
                    </div>
                </div>
                <table border="1">
                    <colgroup>
                        <col>
                        <col>
                    </colgroup>
                    <thead>
                        <tr class="header">
                            <th>
                                <div class="SimplePara">PropertyEditor</div>
                            </th>
                            <th>
                                <div class="SimplePara">Description</div>
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="noclass">
                            <td>
                                <div class="SimplePara"> <span class="EmphasisFontCategoryNonProportional">ByteArrayPropertyEditor</span> </div>
                            </td>
                            <td>
                                <div class="SimplePara">Converts <span class="EmphasisFontCategoryNonProportional">String</span> values to their corresponding byte representations.</div>
                            </td>
                        </tr>
                        <tr class="noclass">
                            <td>
                                <div class="SimplePara"> <span class="EmphasisFontCategoryNonProportional">CharacterEditor</span> </div>
                            </td>
                            <td>
                                <div class="SimplePara">Populates a property of type <span class="EmphasisFontCategoryNonProportional">Character</span> or <span class="EmphasisFontCategoryNonProportional">char</span> from a <span class="EmphasisFontCategoryNonProportional">String</span>                                    value.</div>
                            </td>
                        </tr>
                        <tr class="noclass">
                            <td>
                                <div class="SimplePara"> <span class="EmphasisFontCategoryNonProportional">ClassEditor</span> </div>
                            </td>
                            <td>
                                <div class="SimplePara">Converts from a fully qualified class name into a <span class="EmphasisFontCategoryNonProportional">Class</span> instance. When using this <span class="EmphasisFontCategoryNonProportional">PropertyEditor</span>, be careful
                                    not to include any extraneous spaces on either side of the class name when using <span class="EmphasisFontCategoryNonProportional">GenericXmlApplicationContext</span> because this results in a <span class="EmphasisFontCategoryNonProportional">ClassNotFoundException</span>.</div>
                            </td>
                        </tr>
                        <tr class="noclass">
                            <td>
                                <div class="SimplePara"> <span class="EmphasisFontCategoryNonProportional">CustomBooleanEditor</span> </div>
                            </td>
                            <td>
                                <div class="SimplePara">Converts a string into a Java Boolean type.</div>
                            </td>
                        </tr>
                        <tr class="noclass">
                            <td>
                                <div class="SimplePara"> <span class="EmphasisFontCategoryNonProportional">CustomCollectionEditor</span> </div>
                            </td>
                            <td>
                                <div class="SimplePara">Converts a source collection (e.g., represented by the <span class="EmphasisFontCategoryNonProportional">util</span> namespace in <span class="EmphasisFontCategoryNonProportional">Spring</span>) into the target <span class="EmphasisFontCategoryNonProportional">Collection</span>                                    type.</div>
                            </td>
                        </tr>
                        <tr class="noclass">
                            <td>
                                <div class="SimplePara"> <span class="EmphasisFontCategoryNonProportional">CustomDateEditor</span> </div>
                            </td>
                            <td>
                                <div class="SimplePara">Converts a string representation of a date into a <span class="EmphasisFontCategoryNonProportional">java.util.Date</span> value. You need to register the <span class="EmphasisFontCategoryNonProportional">CustomDateEditor</span>                                    implementation in Spring’s <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> with the desired date format.</div>
                            </td>
                        </tr>
                        <tr class="noclass">
                            <td>
                                <div class="SimplePara"> <span class="EmphasisFontCategoryNonProportional">FileEditor</span> </div>
                            </td>
                            <td>
                                <div class="SimplePara">Converts a <span class="EmphasisFontCategoryNonProportional">String</span> file path into a <span class="EmphasisFontCategoryNonProportional">File</span> instance. Spring does not check whether the file exists.</div>
                            </td>
                        </tr>
                        <tr class="noclass">
                            <td>
                                <div class="SimplePara"> <span class="EmphasisFontCategoryNonProportional">InputStreamEditor</span> </div>
                            </td>
                            <td>
                                <div class="SimplePara">Converts a string representation of a resource (e.g., file resource using <span class="EmphasisFontCategoryNonProportional">file:D:/temp/test.txt or classpath:test.txt</span>) into an input stream property.</div>
                            </td>
                        </tr>
                        <tr class="noclass">
                            <td>
                                <div class="SimplePara"> <span id="ITerm79">                            <span class="EmphasisFontCategoryNonProportional">LocaleEditor</span> </span>
                                </div>
                            </td>
                            <td>
                                <div class="SimplePara">Converts the <span class="EmphasisFontCategoryNonProportional">String</span> representation of a locale, such as <span class="EmphasisFontCategoryNonProportional">en-GB</span>, into a <span class="EmphasisFontCategoryNonProportional">java.util.Locale</span>                                    instance.</div>
                            </td>
                        </tr>
                        <tr class="noclass">
                            <td>
                                <div class="SimplePara"> <span class="EmphasisFontCategoryNonProportional">PatternEditor</span> </div>
                            </td>
                            <td>
                                <div class="SimplePara">Converts a string into the JDK <span class="EmphasisFontCategoryNonProportional">Pattern</span> object or the other way around.</div>
                            </td>
                        </tr>
                        <tr class="noclass">
                            <td>
                                <div class="SimplePara"> <span class="EmphasisFontCategoryNonProportional">PropertiesEditor</span> </div>
                            </td>
                            <td>
                                <div class="SimplePara">Converts a <span class="EmphasisFontCategoryNonProportional">String</span> in the format <span class="EmphasisFontCategoryNonProportional">key1=value1 key2=value2 keyn=valuen</span> into an instance of <span class="EmphasisFontCategoryNonProportional">java.util.Properties</span>                                    with the corresponding properties configured.</div>
                            </td>
                        </tr>
                        <tr class="noclass">
                            <td>
                                <div class="SimplePara"> <span class="EmphasisFontCategoryNonProportional">StringTrimmerEditor</span> </div>
                            </td>
                            <td>
                                <div class="SimplePara">Performs trimming on the string values before injection. You need to explicitly register this editor.</div>
                            </td>
                        </tr>
                        <tr class="noclass">
                            <td>
                                <div class="SimplePara"> <span class="EmphasisFontCategoryNonProportional">URLEditor</span> </div>
                            </td>
                            <td>
                                <div class="SimplePara">Converts a <span class="EmphasisFontCategoryNonProportional">String</span> representation of a URL into an instance of <span class="EmphasisFontCategoryNonProportional">java.net.URL</span>.</div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
    </div>
    <div class="Para ParaOneEmphasisChild" id="Par163">This set of <span class="EmphasisFontCategoryNonProportional">PropertyEditor</span>s provides a good base for working with Spring and makes configuring your application with common components such as files and URLs much simpler.</div>
    </div>
    <div class="Section2 RenderAsSection2" id="Sec25">
        <h3 class="Heading">Creating a <span id="ITerm80">Custom PropertyEditor                      </span> </h3>
        <div class="Para" id="Par164">Although the built-in <span class="EmphasisFontCategoryNonProportional">PropertyEditor</span>s cover some of the standard cases of property type conversion, there may come a time when you need to create your own <span class="EmphasisFontCategoryNonProportional">PropertyEditor</span>            to support a class or a set of classes you are using in your application. Spring has full support for registering custom <span class="EmphasisFontCategoryNonProportional">PropertyEditor</span>s; the only downside is that the <span class="EmphasisFontCategoryNonProportional">java.beans.PropertyEditor</span>            interface has a lot of methods, many of which are irrelevant to the task at hand, which is converting property types. Thankfully, JDK 5 or newer provides the <span class="EmphasisFontCategoryNonProportional">PropertyEditorSupport</span> class,
            which your own <span class="EmphasisFontCategoryNonProportional">PropertyEditor</span>s can extend, leaving you to implement only a single method: <span class="EmphasisFontCategoryNonProportional">setAsText()</span>. Let’s consider a simple
            example to see implementing a custom property editor in action. Suppose we have a <span class="EmphasisFontCategoryNonProportional">FullName</span> class with just two properties, <span class="EmphasisFontCategoryNonProportional">firstName</span>            and <span class="EmphasisFontCategoryNonProportional">lastName</span>, defined as shown here:</div>
        <pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4.custom</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">FullName</span> {
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">String</span> firstName;
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">String</span> lastName;

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#0000a2;font-weight:700">FullName</span>(<span style="color:#00f;font-weight:700">String</span> <span style="font-style:italic">firstName</span>, <span style="color:#00f;font-weight:700">String</span> <span style="font-style:italic">lastName</span>) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>firstName <span style="color:#00f;font-weight:700">=</span> firstName;
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>lastName <span style="color:#00f;font-weight:700">=</span> lastName;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">String</span> <span style="color:#0000a2;font-weight:700">getFirstName</span>() {
        <span style="color:#00f;font-weight:700">return</span> firstName;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setFirstName</span>(<span style="color:#00f;font-weight:700">String</span> <span style="font-style:italic">firstName</span>) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>firstName <span style="color:#00f;font-weight:700">=</span> firstName;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">String</span> <span style="color:#0000a2;font-weight:700">getLastName</span>() {
        <span style="color:#00f;font-weight:700">return</span> lastName;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setLastName</span>(<span style="color:#00f;font-weight:700">String</span> <span style="font-style:italic">lastName</span>) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>lastName <span style="color:#00f;font-weight:700">=</span> lastName;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">String</span> <span style="color:#0000a2;font-weight:700">toString</span>() {
        <span style="color:#00f;font-weight:700">return</span> <span style="color:#036a07">First name: </span> <span style="color:#00f;font-weight:700">+</span> firstName <span style="color:#00f;font-weight:700">+</span> <span style="color:#036a07"> - Last name: </span> <span style="color:#00f;font-weight:700">+</span> lastName;
    }
}
</pre>
        <div class="Para ParaOneEmphasisChild" id="Par166">To simplify the application configuration, let’s develop a custom editor that converts a string with a space separator into the <span class="EmphasisFontCategoryNonProportional">FullName</span> class’s first name and last name, respectively. The
            following code snippet depicts the custom property editor implementation:</div>
        <pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4.custom</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">java.beans.PropertyEditorSupport</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">NamePropertyEditor</span> <span style="color:#00f;font-weight:700">extends</span> <span style="font-style:italic">PropertyEditorSupport</span> {
    <span style="color:#00f;font-weight:700">@Override</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setAsText</span>(<span style="color:#00f;font-weight:700">String</span> <span style="font-style:italic">text</span>) <span style="color:#00f;font-weight:700">throws</span> <span style="color:#00f;font-weight:700">IllegalArgumentException</span> {
        <span style="color:#00f;font-weight:700">String</span>[] name <span style="color:#00f;font-weight:700">=</span> text<span style="color:#00f;font-weight:700">.</span>split(<span style="color:#036a07">&quot;<span style="color:#26b31a">\\</span>s&quot;</span>);
        setValue(<span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">FullName</span>(name[<span style="color:#0000cd">0</span>], name[<span style="color:#0000cd">1</span>]));
    }
}
</pre>
        <div class="Para" id="Par168">The editor is simple. It extends JDK’s <span class="EmphasisFontCategoryNonProportional">PropertyEditorSupport</span> class and implements the <span class="EmphasisFontCategoryNonProportional">setAsText()</span> method. In the method, we simply
            split the <span class="EmphasisFontCategoryNonProportional">String</span> into a string array with a space as the delimiter. Afterward, an instance of the <span class="EmphasisFontCategoryNonProportional">FullName</span> class is instantiated,
            passing in the <span class="EmphasisFontCategoryNonProportional">String</span> before the space character as the first name and passing the <span class="EmphasisFontCategoryNonProportional">String</span> after the space character as the last
            name. Finally, the converted value is returned by calling the <span class="EmphasisFontCategoryNonProportional">setValue()</span> method with the result. To use <span class="EmphasisFontCategoryNonProportional">NamePropertyEditor</span> in
            your application, we need to register the editor in Spring’s <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>. The following configuration sample shows an <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>            configuration of a <span class="EmphasisFontCategoryNonProportional">CustomEditorConfigurer</span> and the <span class="EmphasisFontCategoryNonProportional">NamePropertyEditor</span> (<span class="EmphasisFontCategoryNonProportional">app-context-02.xml</span>)
            <span id="ITerm81"> </span>:</div>
        <pre style="background:#fff;color:#000"><span style="color:#1c02ff">&lt;<span style="font-weight:700">beans</span> ...&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">name</span>=<span style="color:#036a07">customEditorConfigurer</span>
  <span style="font-style:italic">class</span>=<span style="color:#036a07">org.springframework.beans.factory.config.CustomEditorConfigurer</span>&gt;</span>
        <span style="color:#1c02ff">&lt;<span style="font-weight:700">property</span> <span style="font-style:italic">name</span>=<span style="color:#036a07">customEditors</span>&gt;</span>
            <span style="color:#1c02ff">&lt;<span style="font-weight:700">map</span>&gt;</span>
                <span style="color:#1c02ff">&lt;<span style="font-weight:700">entry</span> <span style="font-style:italic">key</span>=<span style="color:#036a07">com.apress.prospring5.ch4.custom.FullName</span>
                  <span style="font-style:italic">value</span>=<span style="color:#036a07">com.apress.prospring5.ch4.custom.NamePropertyEditor</span>/&gt;</span>
            <span style="color:#1c02ff">&lt;/<span style="font-weight:700">map</span>&gt;</span>
        <span style="color:#1c02ff">&lt;/<span style="font-weight:700">property</span>&gt;</span>
    <span style="color:#1c02ff">&lt;/<span style="font-weight:700">bean</span>&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">exampleBean</span>
      <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch4.custom.CustomEditorExample</span>
      <span style="font-style:italic">p</span>:name=<span style="color:#036a07">John Mayer</span>/&gt;</span>
<span style="color:#1c02ff">&lt;/<span style="font-weight:700">beans</span>&gt;</span>
</pre>
        <div class="Para" id="Par170">You should notice two things in this configuration. First, custom <span class="EmphasisFontCategoryNonProportional">PropertyEditor</span>s get injected into the <span class="EmphasisFontCategoryNonProportional">CustomEditorConfigurer</span> class
            by using the <span class="EmphasisFontCategoryNonProportional">Map</span>-typed <span class="EmphasisFontCategoryNonProportional">customEditors</span> property. Second, each entry in the <span class="EmphasisFontCategoryNonProportional">Map</span>            represents a single <span class="EmphasisFontCategoryNonProportional">PropertyEditor</span>, with the key of the entry being the name of the class for which the <span class="EmphasisFontCategoryNonProportional">PropertyEditor</span> is used.
            As you can see, the key for <span class="EmphasisFontCategoryNonProportional">NamePropertyEditor</span> is <span class="EmphasisFontCategoryNonProportional">com.apress.prospring4.ch4.FullName</span>, which signifies that this is the class
            for which the editor should be used. The following code snippet shows the code for the <span class="EmphasisFontCategoryNonProportional">CustomEditorExample</span> class that is registered as a bean in the previous configuration:</div>
        <pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4.custom</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.support.GenericXmlApplicationContext</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">CustomEditorExample</span> {
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">FullName</span> name;

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">FullName</span> <span style="color:#0000a2;font-weight:700">getName</span>() {
        <span style="color:#00f;font-weight:700">return</span> name;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setName</span>(<span style="color:#00f;font-weight:700">FullName</span> <span style="font-style:italic">name</span>) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>name <span style="color:#00f;font-weight:700">=</span> name;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span>... <span style="font-style:italic">args</span>) {
        <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span> ctx <span style="color:#00f;font-weight:700">=</span>
                <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span>();
        ctx<span style="color:#00f;font-weight:700">.</span>load(<span style="color:#036a07">classpath:spring/app-context-02.xml</span>);
        ctx<span style="color:#00f;font-weight:700">.</span>refresh();
        <span style="color:#00f;font-weight:700">CustomEditorExample</span> bean <span style="color:#00f;font-weight:700">=</span>
                (<span style="color:#00f;font-weight:700">CustomEditorExample</span>) ctx<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#036a07">exampleBean</span>);
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(bean<span style="color:#00f;font-weight:700">.</span>getName());
        ctx<span style="color:#00f;font-weight:700">.</span>close();
    }
}
</pre>
    <div class="Para" id="Par172">The previous code is nothing special. Run the example, and you will see the following output:</div>
    <div class="Para" id="Par173">
        <div class="ProgramCode" id="PC53">
            <div class="FixedLine">First name: John - Last name: Mayer</div>
        </div>
    </div>
    <div class="Para" id="Par174">This is the output from the <span class="EmphasisFontCategoryNonProportional">toString()</span> method we implemented in the <span class="EmphasisFontCategoryNonProportional">FullName</span> class, and you can see that the first name and last name
        of the <span class="EmphasisFontCategoryNonProportional">FullName</span> object were correctly populated by Spring by using the configured <span class="EmphasisFontCategoryNonProportional">NamePropertyEditor</span>. Starting from version 3, Spring
        introduced the Type Conversion API and the Field Formatting Service Provider Interface (SPI), which provide a simpler and well-structured API to perform type conversion and field formatting. It’s especially useful for web application development.
        Both the Type Conversion API and the Field Formatting SPI are discussed in detail in Chapter <span class="ExternalRef"><a href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_10_Chapter.html"><span class="RefSource">10</span></a>
        </span>.</div>
    </div>
    </div>
    <div class="Section1 RenderAsSection1" id="Sec26">
        <h2 class="Heading">More Spring ApplicationContext Configuration</h2>
        <div class="Para" id="Par175">So far, although we are discussing Spring’s <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>, most of the <span id="ITerm83">features                  </span> that we have covered mainly surround the <span class="EmphasisFontCategoryNonProportional">BeanFactory</span>            interface wrapped by <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>. In Spring, various implementations of the <span class="EmphasisFontCategoryNonProportional">BeanFactory</span> interface are responsible for
            bean instantiation, providing dependency injection and life-cycle support for beans managed by Spring. However, as stated earlier, being an extension of the <span class="EmphasisFontCategoryNonProportional">BeanFactory</span> interface,
            <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> provides other useful functionalities as well. The main function of <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> is to provide a much richer framework on which to build your applications.
                <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> is much more aware of the beans (compared to <span class="EmphasisFontCategoryNonProportional">BeanFactory</span>) that you configure within it, and in the case
                of many of the Spring infrastructure classes and interfaces, such as <span class="EmphasisFontCategoryNonProportional">BeanFactoryPostProcessor</span>, it interacts with them on your behalf, reducing the amount of code you need to write
                in order to use Spring.</div>
        <div class="Para" id="Par176">The biggest benefit of using <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> is that it allows you to configure and manage Spring and Spring-managed resources in a completely declarative way. This means that wherever
            possible, Spring provides support classes to load <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> into your application automatically, thus removing the need for you to write any code to access <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>.
            In practice, this feature is currently available only when you are building web applications with Spring, which allows you to initialize Spring’s <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> in the web application
            deployment descriptor. When using a stand-alone application, you can also initialize Spring’s <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> by simple coding.</div>
        <div class="Para" id="Par177">In addition to providing a model that is focused more on declarative configuration, <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> supports the following <span id="ITerm84">features                  </span>:
            <div class="UnorderedList">
                <ul class="UnorderedListMarkBullet">
                    <li>
                        <div class="Para" id="Par178">Internationalization</div>
                    </li>
                    <li>
                        <div class="Para" id="Par179">Event publication</div>
                    </li>
                    <li>
                        <div class="Para" id="Par180">Resource management and access</div>
                    </li>
                    <li>
                        <div class="Para" id="Par181">Additional life-cycle interfaces</div>
                    </li>
                    <li>
                        <div class="Para" id="Par182">Improved automatic configuration of infrastructure components</div>
                    </li>
                </ul>
            </div>
        </div>
        <div class="Para ParaOneEmphasisChild" id="Par183">In the following sections, we discuss some of the most important features in <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> besides DI.</div>
        <div class="Section2 RenderAsSection2" id="Sec27">
            <h3 class="Heading">Internationalization with the <span id="ITerm85">MessageSource                      </span> </h3>
            <div class="Para" id="Par184">One area where Spring really excels is in support for internationalization (i18n). Using the <span class="EmphasisFontCategoryNonProportional">MessageSource</span> interface, your application can access <span class="EmphasisFontCategoryNonProportional">String</span>                resources, called <span class="EmphasisTypeItalic">messages</span>, stored in a variety of languages. For each language you want to support in your application, you maintain a list of messages that are keyed to correspond to messages in
                other languages. For instance, if you wanted to display “The quick brown fox jumped over the lazy dog” in English and in Czech, you would create two messages, both keyed as <span class="EmphasisFontCategoryNonProportional">msg</span>;
                the one for English would read “The quick brown fox jumped over the lazy dog,” and the one for German would read “Der schnelle braune Fuchs sprang über den faulen Hund.”</div>
            <div class="Para" id="Par185">Although you don’t need to use <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> to use <span class="EmphasisFontCategoryNonProportional">MessageSource</span>, the <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>                interface extends <span class="EmphasisFontCategoryNonProportional">MessageSource</span> and provides special support for loading messages and for making them available in your environment. The automatic loading of messages is available
                in any environment, but automatic access is provided only in certain Spring-managed scenarios, such as when you are using Spring’s MVC framework to build a web application. Although any class can implement <span class="EmphasisFontCategoryNonProportional">ApplicationContextAware</span>                and thus access the automatically loaded messages, we suggest a better solution later in this chapter, in the section “Using MessageSource in Stand-Alone Applications.”</div>
            <div class="Para" id="Par186">Before continuing, if you are unfamiliar with i18n support in Java, we suggest you at least check out the Javadocs (<span class="ExternalRef"><a href="http://download.java.net/jdk8/docs/api/index.html"><span class="RefSource">                  <span class="EmphasisFontCategoryNonProportional">http://download.java.net/jdk8/docs/api/index.html</span>                </span>
                </a>
                </span>).</div>
            <div class="Section3 RenderAsSection3" id="Sec28">
                <h4 class="Heading">Internationalization with the MessageSource</h4>
                <div class="Para" id="Par187">Aside from <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>, Spring provides three <span class="EmphasisFontCategoryNonProportional">MessageSource</span> implementations.
                    <div class="UnorderedList">
                        <ul class="UnorderedListMarkBullet">
                            <li>
                                <div class="Para ParaOneEmphasisChild" id="Par188"> <span class="EmphasisFontCategoryNonProportional">ResourceBundleMessageSource</span> </div>
                            </li>
                            <li>
                                <div class="Para ParaOneEmphasisChild" id="Par189"> <span class="EmphasisFontCategoryNonProportional">ReloadableResourceBundleMessageSource</span> </div>
                            </li>
                            <li>
                                <div class="Para ParaOneEmphasisChild" id="Par190"> <span class="EmphasisFontCategoryNonProportional">StaticMessageSource</span> </div>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="Para ParaOneEmphasisChild" id="Par191">The <span class="EmphasisFontCategoryNonProportional">StaticMessageSource</span> implementation should not be used in a production application because you can’t configure it externally, and this is generally one of the main requirements
                    when you are adding i18n capabilities to your application.</div>
                <div class="Para" id="Par192"> <span class="EmphasisFontCategoryNonProportional">ResourceBundleMessageSource</span> loads messages by using a Java <span class="EmphasisFontCategoryNonProportional">ResourceBundle</span>. <span class="EmphasisFontCategoryNonProportional">ReloadableResourceBundleMessageSource</span>                    is essentially the same, except it supports scheduled reloading of the underlying source files.</div>
                <div class="Para" id="Par194">All three MessageSource implementations also implement another interface called <span class="EmphasisFontCategoryNonProportional">HierarchicalMessageSource</span>, which allows for many <span class="EmphasisFontCategoryNonProportional">MessageSource</span>                    instances to be nested. This is key to the way <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> works with <span class="EmphasisFontCategoryNonProportional">MessageSource</span> instances.</div>
                <div class="Para" id="Par195">To take advantage of <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>’s support for <span class="EmphasisFontCategoryNonProportional">MessageSource</span>, you must define a bean in your configuration of type
                    <span class="EmphasisFontCategoryNonProportional">MessageSource</span> and with the name <span class="EmphasisFontCategoryNonProportional">messageSource. ApplicationContext</span> takes this <span class="EmphasisFontCategoryNonProportional">MessageSource</span>                    and nests it within itself, allowing you to access the messages by using <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>. This can be hard to visualize, so take a look at the following example. The following
                    code sample shows a simple application that accesses a set of messages for both the English and German <span id="ITerm86">locales                          </span>:</div>
                <pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">java.util.Locale</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.support.GenericXmlApplicationContext</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">MessageSourceDemo</span> {
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span>... <span style="font-style:italic">args</span>) {
        <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span> ctx <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span>();
        ctx<span style="color:#00f;font-weight:700">.</span>load(<span style="color:#036a07">classpath:spring/app-context-xml.xml</span>);
        ctx<span style="color:#00f;font-weight:700">.</span>refresh();
        <span style="color:#00f;font-weight:700">Locale</span> english <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">Locale</span><span style="color:#c5060b;font-weight:700"><span style="color:#00f;font-weight:700">.</span>ENGLISH</span>;
        <span style="color:#00f;font-weight:700">Locale</span> german <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">Locale</span>(<span style="color:#036a07">de</span>, <span style="color:#036a07">DE</span>);
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(ctx<span style="color:#00f;font-weight:700">.</span>getMessage(<span style="color:#036a07">msg</span>, <span style="color:#585cf6;font-weight:700">null</span>, english));
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(ctx<span style="color:#00f;font-weight:700">.</span>getMessage(<span style="color:#036a07">msg</span>, <span style="color:#585cf6;font-weight:700">null</span>, german));
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(ctx<span style="color:#00f;font-weight:700">.</span>getMessage(<span style="color:#036a07">nameMsg</span>, <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">Object</span>[]
                {<span style="color:#036a07">John</span>, <span style="color:#036a07">Mayer</span>}, english));
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(ctx<span style="color:#00f;font-weight:700">.</span>getMessage(<span style="color:#036a07">nameMsg</span>, <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">Object</span>[]
                {<span style="color:#036a07">John</span>, <span style="color:#036a07">Mayer</span>}, german));
        ctx<span style="color:#00f;font-weight:700">.</span>close();
    }
}
</pre>
                <div class="Para" id="Par197">Don’t worry about the calls to <span class="EmphasisFontCategoryNonProportional">getMessage()</span> just yet; we will return to those shortly. For now, just know that they retrieve a keyed message for the locale specified. In the following
                    configuration snippet, you can see the configuration used by this application (<span class="EmphasisFontCategoryNonProportional">app-context-xml.xml</span>):</div>
                <pre style="background:#fff;color:#000"><span style="color:#1c02ff">&lt;<span style="font-weight:700">beans</span> ...&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">messageSource</span>
   <span style="font-style:italic">class</span>=<span style="color:#036a07">org.springframework.context.support.ResourceBundleMessageSource</span>
      <span style="font-style:italic">p</span>:basenames-ref=<span style="color:#036a07">basenames</span>/&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">util</span><span style="font-weight:700">:</span><span style="font-weight:700">list</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">basenames</span>&gt;</span>
        <span style="color:#1c02ff">&lt;<span style="font-weight:700">value</span>&gt;</span>buttons<span style="color:#1c02ff">&lt;/<span style="font-weight:700">value</span>&gt;</span>
        <span style="color:#1c02ff">&lt;<span style="font-weight:700">value</span>&gt;</span>labels<span style="color:#1c02ff">&lt;/<span style="font-weight:700">value</span>&gt;</span>
    <span style="color:#1c02ff">&lt;/<span style="font-weight:700">util</span><span style="font-weight:700">:</span><span style="font-weight:700">list</span>&gt;</span>
<span style="color:#1c02ff">&lt;/<span style="font-weight:700">beans</span>&gt;</span>
</pre>
                <div class="Para" id="Par199">Here we define a <span class="EmphasisFontCategoryNonProportional">ResourceBundleMessageSource</span> bean with the name <span class="EmphasisFontCategoryNonProportional">messageSource</span> as required and configure it with a set of
                    names to form the base of its file set. A Java <span class="EmphasisFontCategoryNonProportional">ResourceBundle</span>, which is used by <span class="EmphasisFontCategoryNonProportional">ResourceBundleMessageSource</span>, works on
                    a set of properties files that are identified by base names. When looking for a message for a particular <span class="EmphasisFontCategoryNonProportional">Locale</span>, the <span class="EmphasisFontCategoryNonProportional">ResourceBundle</span>                    looks for a file that is named as a combination of the base name and the locale name. For instance, if the base name is <span class="EmphasisFontCategoryNonProportional">foo</span> and we are looking for a message in the <span class="EmphasisFontCategoryNonProportional">en-GB</span>                    (British English) locale, <span class="EmphasisFontCategoryNonProportional">ResourceBundle</span> looks for a file called <span class="EmphasisFontCategoryNonProportional">foo_en_GB.properties</span>.</div>
                <div class="Para" id="Par200">For the previous example, the content of the properties files for English (<span class="EmphasisFontCategoryNonProportional">labels_en.properties</span>) and German (<span class="EmphasisFontCategoryNonProportional">labels_de_DE.properties</span>)
                    is shown here:</div>
                <div class="Para" id="Par201">
                    <div class="ProgramCode" id="PC56">
                        <div class="FixedLine">#labels_en.properties</div>
                        <div class="FixedLine">msg=My stupid mouth has got me in trouble</div>
                        <div class="FixedLine">nameMsg=My name is {0} {1}</div>
                        <div class="FixedLine">#labels_de_DE.properties</div>
                        <div class="FixedLine">msg=Mein dummer Mund hat mich in Schwierigkeiten gebracht</div>
                        <div class="FixedLine">nameMsg=Mein Name ist {0} {1}</div>
                    </div>
                </div>
                <div class="Para" id="Par202">Now this example just raises even more questions. What do those calls to <span class="EmphasisFontCategoryNonProportional">getMessage()</span> mean? Why did we use <span class="EmphasisFontCategoryNonProportional">ApplicationContext.getMessage()</span>                    rather than access the <span class="EmphasisFontCategoryNonProportional">ResourceBundleMessageSource</span> bean directly? We’ll answer each of these questions in <span id="ITerm87">turn                          </span>.</div>
            </div>
            <div class="Section3 RenderAsSection3" id="Sec29">
                <h4 class="Heading">Using the <span id="ITerm88">getMessage()                          </span> Method</h4>
                <div class="Para" id="Par203">The <span class="EmphasisFontCategoryNonProportional">MessageSource</span> interface defines three overloads for the <span class="EmphasisFontCategoryNonProportional">getMessage()</span> method. These are described in Table <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_4_Chapter.html#Tab2">4-2</a></span>.
                    <div class="Table" id="Tab2">
                        <div class="Caption" xml:lang="en">
                            <div class="CaptionContent"><span class="CaptionNumber">Table 4-2.</span>
                                <div class="SimplePara">Overloads for MessageSource.getMessage()</div>
                            </div>
                        </div>
                        <table border="1">
                            <colgroup>
                                <col>
                                <col>
                            </colgroup>
                            <thead>
                                <tr class="header">
                                    <th>
                                        <div class="SimplePara">Method signature</div>
                                    </th>
                                    <th>
                                        <div class="SimplePara">Description</div>
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="noclass">
                                    <td>
                                        <div class="SimplePara"> <span class="EmphasisFontCategoryNonProportional">getMessage (String,  Object[], Locale)</span> </div>
                                    </td>
                                    <td>
                                        <div class="SimplePara">This is the standard <span class="EmphasisFontCategoryNonProportional">getMessage()</span> method. The <span class="EmphasisFontCategoryNonProportional">String</span> argument is the key of the message corresponding
                                            to the key in the properties file. In the previous code sample, the first call to <span class="EmphasisFontCategoryNonProportional">getMessage()</span> used <span class="EmphasisFontCategoryNonProportional">msg</span>                                            as the key, and this corresponded to the following entry in the properties file for the <span class="EmphasisFontCategoryNonProportional">en</span> locale: <span class="EmphasisFontCategoryNonProportional">msg=The quick brown fox jumped over the lazy dog</span>.
                                            The <span class="EmphasisFontCategoryNonProportional">Object[]</span> array argument is used for replacements in the message. In the third call to <span class="EmphasisFontCategoryNonProportional">getMessage()</span>,
                                            we passed in an array of two <span class="EmphasisFontCategoryNonProportional">String</span>s. The message keyed as <span class="EmphasisFontCategoryNonProportional">nameMsg</span> was <span class="EmphasisFontCategoryNonProportional">My name is {0} {1}</span>.
                                            The numbers in braces are placeholders, and each one is replaced with the corresponding entry in the argument array. The final argument, <span class="EmphasisFontCategoryNonProportional">Locale</span>, tells
                                            <span class="EmphasisFontCategoryNonProportional">ResourceBundleMessageSource</span> which properties file to look in. Even though the first and second calls to <span class="EmphasisFontCategoryNonProportional">getMessage()</span>                                            in the example used the same key, they returned different messages that correspond to the <span class="EmphasisFontCategoryNonProportional">Locale</span> setting that was passed in to <span class="EmphasisFontCategoryNonProportional">getMessage()</span>.</div>
                                    </td>
                                </tr>
                                <tr class="noclass">
                                    <td>
                                        <div class="SimplePara"> <span class="EmphasisFontCategoryNonProportional">getMessage (String, Object[], String, Locale)</span> </div>
                                    </td>
                                    <td>
                                        <div class="SimplePara">This overload works in the same way as <span class="EmphasisFontCategoryNonProportional">getMessage(String, Object[], Locale)</span>, other than the second <span class="EmphasisFontCategoryNonProportional">String</span>                                            argument, which allows we to pass in a default value in case a message for the supplied key is not available for the supplied <span id="ITerm89">                              <span class="EmphasisFontCategoryNonProportional">Locale</span>                                            </span>.</div>
                                    </td>
                                </tr>
                                <tr class="noclass">
                                    <td>
                                        <div class="SimplePara"> <span class="EmphasisFontCategoryNonProportional">getMessage (MessageSourceResolvable, Locale)</span> </div>
                                    </td>
                                    <td>
                                        <div class="SimplePara">This overload is a special case. We discuss it in further detail in the section “The MessageSourceResolvable Interface.”</div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                </div>
            </div>
        </div>
        <div class="Section3 RenderAsSection3" id="Sec30">
            <h4 class="Heading">Why Use ApplicationContext As a MessageSource?</h4>
            <div class="Para" id="Par204">To answer this question, we need to jump a little ahead of ourselves and look at the web application support in Spring. The answer, in general, is that you shouldn’t use <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>                as a <span class="EmphasisFontCategoryNonProportional">MessageSource</span> because doing so couples your bean to <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> unnecessarily (this is discussed in more detail
                in the next section). You should use <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> when you are building a web application by using Spring’s MVC framework.</div>
            <div class="Para" id="Par205">The core interface in Spring MVC is <span class="EmphasisFontCategoryNonProportional">Controller</span>. Unlike frameworks such as Struts that require you to implement your controllers by inheriting from a concrete class, Spring simply requires
                that you implement the <span class="EmphasisFontCategoryNonProportional">Controller</span> interface (or annotate your controller class with the <span class="EmphasisFontCategoryNonProportional">@Controller</span> annotation). Having said
                that, Spring provides a collection of useful base classes that you will use to implement your own controllers. Each of these base classes is a subclass (directly or indirectly) of the <span class="EmphasisFontCategoryNonProportional">ApplicationObjectSupport</span>                class, which is a convenient superclass for any application objects that want to be aware of <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>. Remember that in a web application setting, <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>                is loaded automatically.</div>
            <div class="Para" id="Par206"> <span class="EmphasisFontCategoryNonProportional">ApplicationObjectSupport</span> accesses this <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>, wraps it in a <span class="EmphasisFontCategoryNonProportional">MessageSourceAccessor</span>                object, and makes that available to your controller via the protected <span class="EmphasisFontCategoryNonProportional">getMessageSourceAccessor()</span> method. MessageSourceAccessor provides a wide array of convenient methods for working
                with <span class="EmphasisFontCategoryNonProportional">MessageSource</span> instances. Provides a wide array of convenient methods for working with <span class="EmphasisFontCategoryNonProportional">MessageSource</span> instances. This
                form of auto-injection is quite beneficial; it removes the need for all of your controllers to expose a <span class="EmphasisFontCategoryNonProportional">MessageSource</span> property.</div>
            <div class="Para" id="Par207">However, this is not the best reason for using <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> as a <span class="EmphasisFontCategoryNonProportional">MessageSource</span> in your web application. The main reason
                to use <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> rather than a manually defined <span class="EmphasisFontCategoryNonProportional">MessageSource</span> bean is that Spring does, where possible, expose
                <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>, as a <span class="EmphasisFontCategoryNonProportional">MessageSource</span>, to the view tier. This means when you are using Spring’s JSP tag library, the <span class="EmphasisFontCategoryNonProportional">&lt;spring:message&gt;</span>                    tag automatically reads messages from <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>, and when you are using JSTL, the <span class="EmphasisFontCategoryNonProportional">&lt;fmt:message&gt;</span> tag does
                    the same.</div>
            <div class="Para" id="Par208">All of these benefits mean that it is better to use the <span class="EmphasisFontCategoryNonProportional">MessageSource</span> support in <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> when you are building a web
                application, rather than manage an instance of <span class="EmphasisFontCategoryNonProportional">MessageSource</span> separately. This is especially true when you consider that all you need to do to take advantage of this feature is to
                configure a <span class="EmphasisFontCategoryNonProportional">MessageSource</span> bean with the name <span class="EmphasisFontCategoryNonProportional">messageSource</span>.</div>
        </div>
    </div>
    <div class="Section2 RenderAsSection2" id="Sec31">
        <h3 class="Heading">Using MessageSource in Stand-Alone Applications</h3>
        <div class="Para" id="Par209">When you are using <span class="EmphasisFontCategoryNonProportional">MessageSource</span> in stand-alone applications, where Spring offers no additional support other than to nest the <span class="EmphasisFontCategoryNonProportional">MessageSource</span>            bean automatically in <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>, it is best to make the <span class="EmphasisFontCategoryNonProportional">MessageSource</span> available by using dependency injection. You can
            opt to make your bean <span class="EmphasisFontCategoryNonProportional">ApplicationContextAware</span>, but doing so precludes its use in a <span class="EmphasisFontCategoryNonProportional">BeanFactory</span> context. Add to this that you
            complicate testing without any discernible benefit, and it is clear that you should stick to using dependency injection to access <span class="EmphasisFontCategoryNonProportional">MessageSource</span> objects in a stand-alone setting.</div>
        <div class="Section3 RenderAsSection3" id="Sec32">
            <h4 class="Heading">The <span id="ITerm90">MessageSourceResolvable            </span> Interface</h4>
            <div class="Para" id="Par210">You can use an object that implements <span class="EmphasisFontCategoryNonProportional">MessageSourceResolvable</span> in place of a key and a set of arguments when you are looking up a message from a <span class="EmphasisFontCategoryNonProportional">MessageSource</span>.
                This interface is most widely used in the Spring validation libraries to link <span class="EmphasisFontCategoryNonProportional">Error</span> objects to their internationalized error messages.</div>
    </div>
    </div>
    <div class="Section2 RenderAsSection2" id="Sec33">
        <h3 class="Heading">Application Events</h3>
        <div class="Para" id="Par211">Another feature of <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> not present in <span class="EmphasisFontCategoryNonProportional">BeanFactory</span> is the ability to publish and receive events by using <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>            as a broker. In this section, you will take a look at its usage.</div>
        <div class="Section3 RenderAsSection3" id="Sec34">
            <h4 class="Heading">Using Application Events</h4>
            <div class="Para" id="Par212">An event is a class derived from <span id="ITerm91">                  <span class="EmphasisFontCategoryNonProportional">ApplicationEvent</span> </span>, which itself derives from <span class="EmphasisFontCategoryNonProportional">java.util.EventObject</span>.
                Any bean can listen for events by implementing the <span class="EmphasisFontCategoryNonProportional">ApplicationListener&lt;T&gt;</span> interface; <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> automatically
                registers any bean that implements this interface as a listener when it is configured. Events are published using the <span class="EmphasisFontCategoryNonProportional">ApplicationEventPublisher.publishEvent()</span> method, so the publishing
                class must have knowledge of <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> (which extends the <span class="EmphasisFontCategoryNonProportional">ApplicationEventPublisher</span> interface). In a web application,
                this is simple because many of your classes are derived from Spring Framework classes that allow access to <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> through a protected method. In a stand-alone application,
                you can have your publishing bean implement <span class="EmphasisFontCategoryNonProportional">ApplicationContextAware</span> to enable it to publish events.</div>
            <div class="Para" id="Par213">The following code sample shows an example of a basic event class:</div>
            <pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.ApplicationEvent</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">MessageEvent</span> <span style="color:#00f;font-weight:700">extends</span> <span style="font-style:italic">ApplicationEvent</span> {
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">String</span> msg;

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#0000a2;font-weight:700">MessageEvent</span>(<span style="color:#00f;font-weight:700">Object</span> <span style="font-style:italic">source</span>, <span style="color:#00f;font-weight:700">String</span> <span style="font-style:italic">msg</span>) {
        <span style="color:#318495">super</span>(source);
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>msg <span style="color:#00f;font-weight:700">=</span> msg;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">String</span> <span style="color:#0000a2;font-weight:700">getMessage</span>() {
        <span style="color:#00f;font-weight:700">return</span> msg;
    }
}
</pre>
            <div class="Para" id="Par215">This code is quite basic; the only point of note is that <span class="EmphasisFontCategoryNonProportional">ApplicationEvent</span> has a single constructor that accepts a reference to the source of the event. This is reflected in the constructor
                for <span class="EmphasisFontCategoryNonProportional">MessageEvent</span>. Here, you can see the code for the listener:</div>
            <pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.ApplicationListener</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">MessageEventListener</span>
        <span style="color:#00f;font-weight:700">implements</span> <span style="font-style:italic">ApplicationListener&lt;<span style="color:#00f;font-weight:700">MessageEvent</span>&gt;</span> {
    <span style="color:#00f;font-weight:700">@Override</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">onApplicationEvent</span>(<span style="color:#00f;font-weight:700">MessageEvent</span> <span style="font-style:italic">event</span>) {
        <span style="color:#00f;font-weight:700">MessageEvent</span> msgEvt <span style="color:#00f;font-weight:700">=</span> (<span style="color:#00f;font-weight:700">MessageEvent</span>) event;
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">Received: </span> <span style="color:#00f;font-weight:700">+</span> msgEvt<span style="color:#00f;font-weight:700">.</span>getMessage());
    }
}
</pre>
            <div class="Para" id="Par217">The <span class="EmphasisFontCategoryNonProportional">ApplicationListener</span> interface defines a single method, <span class="EmphasisFontCategoryNonProportional">onApplicationEvent</span>, that is called by Spring when an event is raised.
                <span class="EmphasisFontCategoryNonProportional">MessageEventListener</span> shows its interest only in events of type <span class="EmphasisFontCategoryNonProportional">MessageEvent</span> (or its subclasses) by implementing the strongly
                typed <span class="EmphasisFontCategoryNonProportional">ApplicationListener</span> interface. If a <span class="EmphasisFontCategoryNonProportional">MessageEvent</span> was received, it writes the message to <span class="EmphasisFontCategoryNonProportional">stdout</span>.
                Publishing events is simple; it is just a matter of creating an instance of the event class and passing it to the <span class="EmphasisFontCategoryNonProportional">ApplicationEventPublisher.publishEvent()</span> method, as shown here:</div>
            <pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.beans.BeansException</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.ApplicationContext</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.ApplicationContextAware</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.support.ClassPathXmlApplicationContext</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">Publisher</span> <span style="color:#00f;font-weight:700">implements</span> <span style="font-style:italic">ApplicationContextAware</span> {
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">ApplicationContext</span> ctx;

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setApplicationContext</span>(<span style="color:#00f;font-weight:700">ApplicationContext</span> <span style="font-style:italic">applicationContext</span>)
            <span style="color:#00f;font-weight:700">throws</span> <span style="color:#00f;font-weight:700">BeansException</span> {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>ctx <span style="color:#00f;font-weight:700">=</span> applicationContext;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">publish</span>(<span style="color:#00f;font-weight:700">String</span> <span style="font-style:italic">message</span>) {
        ctx<span style="color:#00f;font-weight:700">.</span>publishEvent(<span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">MessageEvent</span>(<span style="color:#318495">this</span>, message));
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span>... <span style="font-style:italic">args</span>) {
        <span style="color:#00f;font-weight:700">ApplicationContext</span> ctx <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">ClassPathXmlApplicationContext</span>(
                <span style="color:#036a07">classpath:spring/app-context-xml.xml</span>);
        <span style="color:#00f;font-weight:700">Publisher</span> pub <span style="color:#00f;font-weight:700">=</span> (<span style="color:#00f;font-weight:700">Publisher</span>) ctx<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#036a07">publisher</span>);
        pub<span style="color:#00f;font-weight:700">.</span>publish(<span style="color:#036a07">I send an SOS to the world... </span>);
        pub<span style="color:#00f;font-weight:700">.</span>publish(<span style="color:#036a07">... I hope that someone gets my...</span>);
        pub<span style="color:#00f;font-weight:700">.</span>publish(<span style="color:#036a07">... Message in a bottle</span>);
    }
}
</pre>
        <div class="Para" id="Par219">Here you can see that the <span class="EmphasisFontCategoryNonProportional">Publisher</span> class retrieves an instance of itself from <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> and then, using the <span class="EmphasisFontCategoryNonProportional">publish()</span>            method, publishes two <span class="EmphasisFontCategoryNonProportional">MessageEvent</span> instances to <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>. The <span class="EmphasisFontCategoryNonProportional">Publisher</span>            bean instance accesses the <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> instance by implementing <span class="EmphasisFontCategoryNonProportional">ApplicationContextAware</span>. Here is the configuration for
            this example (<span class="EmphasisFontCategoryNonProportional">app-context-xml.xml</span>):</div>
        <pre style="background:#fff;color:#000"><span style="color:#1c02ff">&lt;<span style="font-weight:700">beans</span> ...&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">publisher</span>
        <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch4.Publisher</span>/&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">messageEventListener</span>
        <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch4.MessageEventListener</span>/&gt;</span>
<span style="color:#1c02ff">&lt;/<span style="font-weight:700">beans</span>&gt;</span>
</pre>
        <div class="Para" id="Par221">Notice that you do not need special configuration to register <span class="EmphasisFontCategoryNonProportional">MessageEventListener</span> with <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>; it is picked up automatically
            by Spring. Running this example results in the following output:</div>
        <div class="Para" id="Par222">
            <div class="ProgramCode" id="PC61">
                <div class="FixedLine">Received: I send an SOS to the world...</div>
                <div class="FixedLine">Received: ... I hope that someone gets my...</div>
                <div class="FixedLine">Received: ... Message in a bottle</div>
            </div>
        </div>
    </div>
    <div class="Section3 RenderAsSection3" id="Sec35">
        <h4 class="Heading">Considerations for <span id="ITerm94">Event Usage                          </span> </h4>
        <div class="Para" id="Par223">In many cases in an application, certain components need to be notified of certain events. Often you do this by writing code to notify each component explicitly or by using a messaging technology such as JMS. The drawback of writing code to notify
            each component in turn is that you are coupling those components to the publisher, in many cases unnecessarily.</div>
        <div class="Para" id="Par224">Consider a situation whereby you cache product details in your application to avoid trips to the database. Another component allows product details to be modified and persisted to the database. To avoid making the cache invalid, the update component
            explicitly notifies the cache that the user details have changed. In this example, the update component is coupled to a component that, really, has nothing to do with its business responsibility. A better solution would be to have the update
            component publish an event every time a product’s details are modified and then have interested components, such as the cache, listen for that event. This has the benefit of keeping the components decoupled, which makes it simple to remove
            the cache if needed or to add another listener that is interested in knowing when a product’s details change.</div>
        <div class="Para" id="Par225">Using JMS in this case would be overkill because the process of invalidating the product’s entry in the cache is quick and is not business critical. The use of the Spring event infrastructure adds very little overhead to your application.</div>
        <div class="Para" id="Par226">Typically, we use events for reactionary logic that executes quickly and is not part of the main application logic. In the previous example, the invalidation of a product in cache happens in reaction to the updating of product details, it executes
            quickly (or it should), and it is not part of the main function of the application. For processes that are long running and form part of the main business logic, it is recommended to use JMS or similar messaging systems such as RabbitMQ. The
            main benefits of using JMS are that it is more suited to long-running processes, and as the system grows, you can, if necessary, factor the JMS-driven processing of messages containing business information onto a separate <span id="ITerm95">machine                          </span>.</div>
    </div>
    </div>
    </div>
    <div class="Section1 RenderAsSection1" id="Sec36">
        <h2 class="Heading">Accessing Resources</h2>
        <div class="Para" id="Par227">Often an application needs to access a variety of resources in different forms. You might need to access some configuration data stored in a file in the file system, some image data stored in a JAR file on the classpath, or maybe some data on
            a server elsewhere. Spring provides a unified mechanism for accessing resources in a protocol-independent way. This means your application can access a file resource in the same way, whether it is stored in the file system, in the classpath,
            or on a remote server.</div>
        <div class="Para" id="Par228">At the core of Spring’s resource support is the <span class="EmphasisFontCategoryNonProportional">org.springframework.core.io.Resource</span> interface. The <span id="ITerm96">              <span class="EmphasisFontCategoryNonProportional">Resource</span>            </span> interface defines ten self-explanatory methods: <span class="EmphasisFontCategoryNonProportional">contentLength()</span>, <span class="EmphasisFontCategoryNonProportional">exists()</span>, <span class="EmphasisFontCategoryNonProportional">getDescription()</span>,
            <span class="EmphasisFontCategoryNonProportional">getFile()</span>, <span class="EmphasisFontCategoryNonProportional">getFileName()</span>, <span class="EmphasisFontCategoryNonProportional">getURI()</span>, <span class="EmphasisFontCategoryNonProportional">getURL()</span>,
            <span class="EmphasisFontCategoryNonProportional">isOpen()</span>, <span class="EmphasisFontCategoryNonProportional">isReadable()</span>, and <span class="EmphasisFontCategoryNonProportional">lastModified()</span>. In addition to these ten
            methods, there is one that is not quite so self-explanatory: <span class="EmphasisFontCategoryNonProportional">createRelative()</span>. The <span class="EmphasisFontCategoryNonProportional">createRelative()</span> method creates a new
            <span class="EmphasisFontCategoryNonProportional">Resource</span> instance by using a path that is relative to the instance on which it is invoked. You can provide your own <span class="EmphasisFontCategoryNonProportional">Resource</span> implementations, although that is outside the scope
                of this chapter, but in most cases, you use one of the built-in implementations for accessing a file (the <span class="EmphasisFontCategoryNonProportional">FileSystemResource</span> class), a classpath (the <span class="EmphasisFontCategoryNonProportional">ClassPathResource</span>                class), or URL resources (the <span class="EmphasisFontCategoryNonProportional">UrlResource</span> class). Internally, Spring uses another interface, <span class="EmphasisFontCategoryNonProportional">ResourceLoader</span>, and the default
                implementation, <span class="EmphasisFontCategoryNonProportional">DefaultResourceLoader</span>, to locate and create <span class="EmphasisFontCategoryNonProportional">Resource</span> instances. However, you generally won’t interact with
                <span class="EmphasisFontCategoryNonProportional">DefaultResourceLoader</span>, instead using another <span class="EmphasisFontCategoryNonProportional">ResourceLoader</span> implementation, called <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>.
                Here is a sample application that accesses three resources by using <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>:</div>
        <pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">java.io.File</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.ApplicationContext</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.support.ClassPathXmlApplicationContext</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.core.io.Resource</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">ResourceDemo</span> {
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span>... <span style="font-style:italic">args</span>) <span style="color:#00f;font-weight:700">throws</span> <span style="color:#00f;font-weight:700">Exception</span> {
        <span style="color:#00f;font-weight:700">ApplicationContext</span> ctx <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">ClassPathXmlApplicationContext</span>();
        <span style="color:#00f;font-weight:700">File</span> file <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">File</span><span style="color:#00f;font-weight:700">.</span>createTempFile(<span style="color:#036a07">test</span>, <span style="color:#036a07">txt</span>);
        file<span style="color:#00f;font-weight:700">.</span>deleteOnExit();
        <span style="color:#00f;font-weight:700">Resource</span> res1 <span style="color:#00f;font-weight:700">=</span> ctx<span style="color:#00f;font-weight:700">.</span>getResource(<span style="color:#036a07">file://</span> <span style="color:#00f;font-weight:700">+</span> file<span style="color:#00f;font-weight:700">.</span>getPath());
        displayInfo(res1);
        <span style="color:#00f;font-weight:700">Resource</span> res2 <span style="color:#00f;font-weight:700">=</span> ctx<span style="color:#00f;font-weight:700">.</span>getResource(<span style="color:#036a07">classpath:test.txt</span>);
        displayInfo(res2);
        <span style="color:#00f;font-weight:700">Resource</span> res3 <span style="color:#00f;font-weight:700">=</span> ctx<span style="color:#00f;font-weight:700">.</span>getResource(<span style="color:#036a07">http://www.google.com</span>);
        displayInfo(res3);
    }

    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">displayInfo</span>(<span style="color:#00f;font-weight:700">Resource</span> <span style="font-style:italic">res</span>) <span style="color:#00f;font-weight:700">throws</span> <span style="color:#00f;font-weight:700">Exception</span> {
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(res<span style="color:#00f;font-weight:700">.</span>getClass());
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(res<span style="color:#00f;font-weight:700">.</span>getURL()<span style="color:#00f;font-weight:700">.</span>getContent());
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07"></span>);
    }
}
</pre>
        <div class="Para" id="Par230">Notice that in each call to <span class="EmphasisFontCategoryNonProportional">getResource()</span>, we pass in a URI for each resource. You will recognize the common <span class="EmphasisFontCategoryNonProportional">file:</span> and <span class="EmphasisFontCategoryNonProportional">http:</span>            protocols that we pass in for <span class="EmphasisFontCategoryNonProportional">res1</span> and <span class="EmphasisFontCategoryNonProportional">res3</span>. The <span class="EmphasisFontCategoryNonProportional">classpath:</span> protocol
            we use for <span class="EmphasisFontCategoryNonProportional">res2</span> is Spring-specific and indicates that <span class="EmphasisFontCategoryNonProportional">ResourceLoader</span> should look in the classpath for the resource. Running this
            example results in the following output:</div>
        <div class="Para" id="Par231">
            <div class="ProgramCode" id="PC63">
                <div class="LineGroup">
                    <div class="FixedLine">class org.springframework.core.io.UrlResource</div>
                    <div class="FixedLine">java.io.BufferedInputStream@3567135c</div>
                </div>
                <div class="LineGroup">
                    <div class="FixedLine">class org.springframework.core.io.ClassPathResource</div>
                    <div class="FixedLine">sun.net.www.content.text.PlainTextInputStream@90f6bfd</div>
                </div>
                <div class="LineGroup">
                    <div class="FixedLine">class org.springframework.core.io.UrlResource</div>
                    <div class="FixedLine">sun.net.www.protocol.http.HttpURLConnection$HttpInputStream@735b5592</div>
                </div>
            </div>
        </div>
        <div class="Para" id="Par232">Notice that for both <span id="ITerm97">the        </span> <span class="EmphasisFontCategoryNonProportional">file:</span> and <span class="EmphasisFontCategoryNonProportional">http:</span> protocols, Spring returns a <span class="EmphasisFontCategoryNonProportional">UrlResource</span>            instance. Spring does include a <span class="EmphasisFontCategoryNonProportional">FileSystemResource</span> class, but the <span class="EmphasisFontCategoryNonProportional">DefaultResourceLoader</span> does not use this class at all. It’s
            because Spring’s default resource-loading strategy treats the URL and file as the same type of resource with difference protocols (<span class="EmphasisFontCategoryNonProportional">file:</span> and <span class="EmphasisFontCategoryNonProportional">http:</span>).
            If an instance of <span class="EmphasisFontCategoryNonProportional">FileSystemResource</span> is required, use <span class="EmphasisFontCategoryNonProportional">FileSystemResourceLoader</span>. Once a <span class="EmphasisFontCategoryNonProportional">Resource</span>            instance is obtained, you are free to access the contents as you see fit, using <span class="EmphasisFontCategoryNonProportional">getFile()</span>, <span class="EmphasisFontCategoryNonProportional">getInputStream()</span>, or <span class="EmphasisFontCategoryNonProportional">getURL()</span>.
            In some cases, such as when you are using the <span class="EmphasisFontCategoryNonProportional">http:</span> protocol, the call to <span class="EmphasisFontCategoryNonProportional">getFile()</span> results in a <span class="EmphasisFontCategoryNonProportional">FileNotFoundException</span>.
            For this reason, we recommend that you use <span class="EmphasisFontCategoryNonProportional">getInputStream()</span> to access resource contents because it is likely to function for all possible resource types.</div>
    </div>
    <div class="Section1 RenderAsSection1" id="Sec37">
        <h2 class="Heading">Configuration Using Java Classes</h2>
        <div class="Para" id="Par233">Besides XML and property file configuration, you can use Java classes to configure Spring’s <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>. Code samples were introduced here and there, until now, to make you comfortable
            with the annotations-style configuration. Spring JavaConfig used to be a separate project, but starting with Spring 3.0, its major features for configuration using Java classes was merged into the core Spring Framework. In this section, we
            show how to use Java classes to configure Spring’s <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> and its equivalent when using XML configuration.</div>
        <div class="Section2 RenderAsSection2" id="Sec38">
            <h3 class="Heading">ApplicationContext Configuration in Java</h3>
            <div class="Para" id="Par234">Let’s see how Spring’s <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> can be configured by using Java classes; we’ll reference the same example for message provider and renderer that we presented in Chapter
                <span class="ExternalRef"><a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_2_Chapter.html"><span class="RefSource">2</span></a></span> and Chapter <span class="ExternalRef"><a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_3_Chapter.html"><span class="RefSource">3</span></a>
                    </span>. The following code recaps the message provider interface and a configurable message provider:<a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_4_Chapter.html#Fn2" id="Fn2_source"><sup>2</sup></a>                    </div>
            <pre style="background:#fff;color:#000"><span style="color:#06f;font-style:italic">//chapter02/hello-world/src/main/java/com/apress/prospring5/</span>
<span style="color:#06f;font-style:italic">//    ch2/decoupled/MessageProvider.java</span>
<span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch2.decoupled</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">interface</span> <span style="text-decoration:underline">MessageProvider</span> {
    <span style="color:#00f;font-weight:700">String</span> <span style="color:#0000a2;font-weight:700">getMessage</span>();
}
<span style="color:#06f;font-style:italic">//chapter03/constructor-injection/src/main/java/com/apress/prospring5/</span>
<span style="color:#06f;font-style:italic">//    ch3/xml/ConfigurableMessageProvider.java</span>
<span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.xml</span>;
        <span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch2.decoupled.MessageProvider</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">ConfigurableMessageProvider</span> <span style="color:#00f;font-weight:700">implements</span> <span style="font-style:italic">MessageProvider</span> {
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">String</span> message <span style="color:#00f;font-weight:700">=</span> <span style="color:#036a07">Default  message</span>;

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#0000a2;font-weight:700">ConfigurableMessageProvider</span>() {
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#0000a2;font-weight:700">ConfigurableMessageProvider</span>(<span style="color:#00f;font-weight:700">String</span> <span style="font-style:italic">message</span>) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>message <span style="color:#00f;font-weight:700">=</span> message;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setMessage</span>(<span style="color:#00f;font-weight:700">String</span> <span style="font-style:italic">message</span>) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>message <span style="color:#00f;font-weight:700">=</span> message;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">String</span> <span style="color:#0000a2;font-weight:700">getMessage</span>() {
        <span style="color:#00f;font-weight:700">return</span> message;
    }
}
</pre>
            <div class="Para" id="Par237">The following code snippet shows the <span id="ITerm98">                <span class="EmphasisFontCategoryNonProportional">MessageRenderer</span> </span> interface and the <span id="ITerm99">                <span class="EmphasisFontCategoryNonProportional">StandardOutMessageRenderer</span>                </span> implementation:</div>
            <pre style="background:#fff;color:#000"><span style="color:#06f;font-style:italic">//chapter02/hello-world/src/main/java/com/apress/prospring5/</span>
<span style="color:#06f;font-style:italic">//     ch2/decoupled/MessageRenderer.java</span>
<span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch2.decoupled</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">interface</span> <span style="text-decoration:underline">MessageRenderer</span> {
    <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">render</span>();

    <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setMessageProvider</span>(<span style="color:#00f;font-weight:700">MessageProvider</span> <span style="font-style:italic">provider</span>);

    <span style="color:#00f;font-weight:700">MessageProvider</span> <span style="color:#0000a2;font-weight:700">getMessageProvider</span>();
}
<span style="color:#06f;font-style:italic">//chapter02/hello-world/src/main/java/com/apress/prospring5/</span>
<span style="color:#06f;font-style:italic">//     ch2/decoupled/StandardOutMessageRenderer.java</span>
<span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch2.decoupled</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">StandardOutMessageRenderer</span>
        <span style="color:#00f;font-weight:700">implements</span> <span style="font-style:italic">MessageRenderer</span> {
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">MessageProvider</span> messageProvider;

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#0000a2;font-weight:700">StandardOutMessageRenderer</span>() {
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07"> --&gt;
                StandardOutMessageRenderer:constructor called </span>);
    }

    <span style="color:#00f;font-weight:700">@Override</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">render</span>() {
        <span style="color:#00f;font-weight:700">if</span> (messageProvider <span style="color:#00f;font-weight:700">==</span> <span style="color:#585cf6;font-weight:700">null</span>) {
            <span style="color:#00f;font-weight:700">throw</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">RuntimeException</span>(
                    <span style="color:#036a07">You must set the property messageProvider of class:</span>
                            <span style="color:#00f;font-weight:700">+</span> <span style="color:#00f;font-weight:700">StandardOutMessageRenderer</span><span style="color:#00f;font-weight:700">.</span>class<span style="color:#00f;font-weight:700">.</span>getName());
        }
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(messageProvider<span style="color:#00f;font-weight:700">.</span>getMessage());
    }

    <span style="color:#00f;font-weight:700">@Override</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setMessageProvider</span>(<span style="color:#00f;font-weight:700">MessageProvider</span> <span style="font-style:italic">provider</span>) {
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07"> --&gt;
                StandardOutMessageRenderer:setting the provider </span>);
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>messageProvider <span style="color:#00f;font-weight:700">=</span> provider;
    }

    <span style="color:#00f;font-weight:700">@Override</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">MessageProvider</span> <span style="color:#0000a2;font-weight:700">getMessageProvider</span>() {
        <span style="color:#00f;font-weight:700">return</span> <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>messageProvider;
    }
}
</pre>
        <div class="Para" id="Par239">The following configuration snippet depicts the <span id="ITerm102">XML configuration                                  </span> (<span class="EmphasisFontCategoryNonProportional">app-context-xml.xml</span>):</div>
        <pre style="background:#fff;color:#000"><span style="color:#1c02ff">&lt;<span style="font-weight:700">beans</span> ...&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">messageRenderer</span>
      <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch2.decoupled.StandardOutMessageRenderer</span>
      <span style="font-style:italic">p</span>:messageProvider-ref=<span style="color:#036a07">messageProvider</span>/&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">messageProvider</span>
      <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch3.xml.ConfigurableMessageProvider</span>
      <span style="font-style:italic">c</span>:message=<span style="color:#036a07">This is a configurable message</span>/&gt;</span>
<span style="color:#1c02ff">&lt;/<span style="font-weight:700">beans</span>&gt;</span>
</pre>
        <div class="Para" id="Par241">The class to test this might look pretty familliar as well, as shown here:</div>
        <pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch2.decoupled.MessageRenderer</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.ApplicationContext</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.support.ClassPathXmlApplicationContext</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">JavaConfigXMLExample</span> {
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span>... <span style="font-style:italic">args</span>) {
        <span style="color:#00f;font-weight:700">ApplicationContext</span> ctx <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">ClassPathXmlApplicationContext</span>(<span style="color:#036a07">
                classpath:spring / app - context - xml.xml </span>);
        <span style="color:#00f;font-weight:700">MessageRenderer</span> renderer <span style="color:#00f;font-weight:700">=</span>
                ctx<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#036a07">messageRenderer</span>, <span style="color:#00f;font-weight:700">MessageRenderer</span><span style="color:#00f;font-weight:700">.</span>class);
        renderer<span style="color:#00f;font-weight:700">.</span>render();
    }
}
</pre>
        <div class="Para" id="Par243">Running this program produces the following <span id="ITerm103">output                                  </span>:</div>
        <div class="Para" id="Par244">
            <div class="ProgramCode" id="PC68">
                <div class="FixedLine">--&gt; StandardOutMessageRenderer: constructor called</div>
                <div class="FixedLine">--&gt; StandardOutMessageRenderer: setting the provider</div>
                <div class="FixedLine">This is a  configurable message</div>
            </div>
        </div>
        <div class="Para" id="Par245">To get rid of the XML configuration, the <span class="EmphasisFontCategoryNonProportional">app-context-xml.xml</span> file must be replaced by a special class, called a <span class="EmphasisTypeItalic">configuration class</span>, that will be
            annotated with <span class="EmphasisFontCategoryNonProportional">@Configuration</span>. The <span class="EmphasisFontCategoryNonProportional">@Configuration</span> annotation is used to inform Spring that this is a Java-based configuration
            file. This class will contain methods annotated with <span class="EmphasisFontCategoryNonProportional">@Bean</span> definitions that represent the bean declarations. The <span class="EmphasisFontCategoryNonProportional">@Bean</span> annotation
            is used to declare a Spring bean and the DI requirements. The <span class="EmphasisFontCategoryNonProportional">@Bean</span> annotation is equivalent to the <span class="EmphasisFontCategoryNonProportional">&lt;bean&gt;</span> tag, the method
            name is equivalent to the <span class="EmphasisFontCategoryNonProportional">id</span> attribute within the <span class="EmphasisFontCategoryNonProportional">&lt;bean&gt;</span> tag, and when instantiating the <span class="EmphasisFontCategoryNonProportional">MessageRender</span>            bean, setter injection is achieved by calling the corresponding method to get the message provider, which is the same as using the <span class="EmphasisFontCategoryNonProportional">&lt;ref&gt;</span> attribute in the XML configuration. These
            annotations and this type of configuration were introduced in previous chapters to make you familiar with them, but they were not covered in detail until now. The following code snippet depicts the <span class="EmphasisFontCategoryNonProportional">AppConfig</span>            contents that are equivalent to the XML configuration previously introduced:</div>
        <pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch2.decoupled.MessageProvider</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch2.decoupled.MessageRenderer</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch2.decoupled.StandardOutMessageRenderer</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.xml.ConfigurableMessageProvider</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.annotation.Bean</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.annotation.Configuration</span>;

@<span style="color:#00f;font-weight:700">Configuration</span>
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">AppConfig</span> {
    <span style="color:#00f;font-weight:700">@Bean</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">MessageProvider</span> <span style="color:#0000a2;font-weight:700">messageProvider</span>() {
        <span style="color:#00f;font-weight:700">return</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">ConfigurableMessageProvider</span>();
    }

    <span style="color:#00f;font-weight:700">@Bean</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">MessageRenderer</span> <span style="color:#0000a2;font-weight:700">messageRenderer</span>() {
        <span style="color:#00f;font-weight:700">MessageRenderer</span> renderer <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">StandardOutMessageRenderer</span>();
        renderer<span style="color:#00f;font-weight:700">.</span>setMessageProvider(messageProvider());
        <span style="color:#00f;font-weight:700">return</span> renderer;
    }
}
</pre>
        <div class="Para" id="Par247">The following code snippet shows how to initialize the <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> instance from the Java configuration <span id="ITerm104">file                                  </span>:</div>
        <pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch2.decoupled.MessageRenderer</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.ApplicationContext</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.annotation.AnnotationConfigApplicationContext</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">JavaConfigExampleOne</span> {
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span>... <span style="font-style:italic">args</span>) {
        <span style="color:#00f;font-weight:700">ApplicationContext</span> ctx <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">new</span>
                <span style="color:#00f;font-weight:700">AnnotationConfigApplicationContext</span>(<span style="color:#00f;font-weight:700">AppConfig</span><span style="color:#00f;font-weight:700">.</span>class);
        <span style="color:#00f;font-weight:700">MessageRenderer</span> renderer <span style="color:#00f;font-weight:700">=</span>
                ctx<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#036a07">messageRenderer</span>, <span style="color:#00f;font-weight:700">MessageRenderer</span><span style="color:#00f;font-weight:700">.</span>class);
        renderer<span style="color:#00f;font-weight:700">.</span>render();
    }
}
</pre>
    <div class="Para" id="Par249">From the previous listing, we use the <span class="EmphasisFontCategoryNonProportional">AnnotationConfigApplicationContext</span> class, passing in the configuration class as the constructor argument (you can pass multiple configuration classes to
        it via the JDK varargs feature). Afterward, you can use <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> returned as usual. Sometimes for testing purposes, the configuration class can be declared as a <span id="ITerm105">static internal class                                  </span>,
        as depicted here:</div>
    <pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch2.decoupled.MessageProvider</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch2.decoupled.MessageRenderer</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch2.decoupled.StandardOutMessageRenderer</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.xml.ConfigurableMessageProvider</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.ApplicationContext</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.annotation.AnnotationConfigApplicationContext</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.annotation.Bean</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.annotation.Configuration</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">JavaConfigSimpleExample</span> {
    <span style="color:#00f;font-weight:700">@Configuration</span>
    <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">AppConfigOne</span> {
        <span style="color:#00f;font-weight:700">@Bean</span>
        <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">MessageProvider</span> <span style="color:#0000a2;font-weight:700">messageProvider</span>() {
            <span style="color:#00f;font-weight:700">return</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">ConfigurableMessageProvider</span>();
        }

        <span style="color:#00f;font-weight:700">@Bean</span>
        <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">MessageRenderer</span> <span style="color:#0000a2;font-weight:700">messageRenderer</span>() {
            <span style="color:#00f;font-weight:700">MessageRenderer</span> renderer <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">StandardOutMessageRenderer</span>();
            renderer<span style="color:#00f;font-weight:700">.</span>setMessageProvider(messageProvider());
            <span style="color:#00f;font-weight:700">return</span> renderer;
        }
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span>... <span style="font-style:italic">args</span>) {
        <span style="color:#00f;font-weight:700">ApplicationContext</span> ctx <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">new</span>
                <span style="color:#00f;font-weight:700">AnnotationConfigApplicationContext</span>(<span style="color:#00f;font-weight:700">AppConfig</span><span style="color:#00f;font-weight:700">.</span>class);
        <span style="color:#00f;font-weight:700">MessageRenderer</span> renderer <span style="color:#00f;font-weight:700">=</span>
                ctx<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#036a07">messageRenderer</span>, <span style="color:#00f;font-weight:700">MessageRenderer</span><span style="color:#00f;font-weight:700">.</span>class);
        renderer<span style="color:#00f;font-weight:700">.</span>render();
    }
}
</pre>
    <div class="Para ParaOneEmphasisChild" id="Par251">The <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> instance returned can be used as usual, and the output will be the same as in the case of the XML configured application.</div>
    <div class="Para" id="Par252">
        <div class="ProgramCode" id="PC72">
            <div class="FixedLine"> --&gt; StandardOutMessageRenderer: constructor called</div>
            <div class="FixedLine"> --&gt; StandardOutMessageRenderer: setting the provider</div>
            <div class="FixedLine">Default  message</div>
        </div>
    </div>
    <div class="Para" id="Par253">Having seen the basic usage of a Java configuration class, let’s proceed to more configuration options. For the message provider, let’s say we want to externalize the message into a properties file (<span class="EmphasisFontCategoryNonProportional">message.properties</span>)
        and then inject it into <span class="EmphasisFontCategoryNonProportional">ConfigurableMessageProvider</span> by using constructor injection. The content of <span class="EmphasisFontCategoryNonProportional">message.properties</span> is as follows:</div>
    <div class="Para" id="Par254">
        <div class="ProgramCode" id="PC73">
            <div class="FixedLine">message=Only hope can keep me together</div>
        </div>
        </div>
        <div class="Para" id="Par255">Let’s see the revised testing program, which loads the properties files by using the <span id="ITerm107">                <span class="EmphasisFontCategoryNonProportional">@PropertySource</span> </span> annotation and then injects them into the
            message provider implementation.</div>
        <pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch2.decoupled.MessageProvider</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch2.decoupled.MessageRenderer</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch2.decoupled.StandardOutMessageRenderer</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.beans.factory.annotation.Autowired</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.annotation.Bean</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.annotation.Configuration</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.annotation.PropertySource</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.core.env.Environment</span>;

@<span style="color:#00f;font-weight:700">Configuration</span>
@PropertySource(value <span style="color:#00f;font-weight:700">=</span> <span style="color:#036a07">classpath:message.properties</span>)
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">AppConfigOne</span> {
    <span style="color:#00f;font-weight:700">@Autowired</span>
    <span style="color:#00f;font-weight:700">Environment</span> env;

    <span style="color:#00f;font-weight:700">@Bean</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">MessageProvider</span> <span style="color:#0000a2;font-weight:700">messageProvider</span>() {
        <span style="color:#00f;font-weight:700">return</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">ConfigurableMessageProvider</span>(env<span style="color:#00f;font-weight:700">.</span>getProperty(<span style="color:#036a07">message</span>));
    }

    <span style="color:#00f;font-weight:700">@Bean</span>(<span style="color:#c5060b;font-weight:700">name</span> <span style="color:#00f;font-weight:700">=</span> <span style="color:#036a07">messageRenderer</span>)
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">MessageRenderer</span> <span style="color:#0000a2;font-weight:700">messageRenderer</span>() {
        <span style="color:#00f;font-weight:700">MessageRenderer</span> renderer <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">StandardOutMessageRenderer</span>();
        renderer<span style="color:#00f;font-weight:700">.</span>setMessageProvider(messageProvider());
        <span style="color:#00f;font-weight:700">return</span> renderer;
    }
}
</pre>
        <div class="Para" id="Par257">Configuration classes were introduced in Chapter <span class="ExternalRef"><a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_3_Chapter.html"><span class="RefSource">3</span></a>
            </span>
            to show equivalents for XML elements and attributes. Bean declarations can be annotated with other annotations related to bean scopes, loading type, and dependencies. In the following code snippet, the <span id="ITerm109">                <span class="EmphasisFontCategoryNonProportional">AppConfigOne</span>            </span> configuration class is enriched with annotations on bean declarations:</div>
        <pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch2.decoupled.MessageProvider</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch2.decoupled.MessageRenderer</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch2.decoupled.StandardOutMessageRenderer</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.beans.factory.annotation.Autowired</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.annotation.*</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.core.env.Environment</span>;

@<span style="color:#00f;font-weight:700">Configuration</span>
@PropertySource(value <span style="color:#00f;font-weight:700">=</span> <span style="color:#036a07">classpath:message.properties</span>)
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">AppConfig</span> {
    <span style="color:#00f;font-weight:700">@Autowired</span>
    <span style="color:#00f;font-weight:700">Environment</span> env;

    <span style="color:#00f;font-weight:700">@Bean</span>
    <span style="color:#00f;font-weight:700">@Lazy</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">MessageProvider</span> <span style="color:#0000a2;font-weight:700">messageProvider</span>() {
        <span style="color:#00f;font-weight:700">return</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">ConfigurableMessageProvider</span>(env<span style="color:#00f;font-weight:700">.</span>getProperty(<span style="color:#036a07">message</span>));
    }

    <span style="color:#00f;font-weight:700">@Bean</span>(<span style="color:#c5060b;font-weight:700">name</span> <span style="color:#00f;font-weight:700">=</span> <span style="color:#036a07">messageRenderer</span>)
    <span style="color:#00f;font-weight:700">@Scope</span>(<span style="color:#c5060b;font-weight:700">value</span> <span style="color:#00f;font-weight:700">=</span> <span style="color:#036a07">prototype</span>)
    <span style="color:#00f;font-weight:700">@DependsOn</span>(<span style="color:#c5060b;font-weight:700">value</span> <span style="color:#00f;font-weight:700">=</span> <span style="color:#036a07">messageProvider</span>)
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">MessageRenderer</span> <span style="color:#0000a2;font-weight:700">messageRenderer</span>() {
        <span style="color:#00f;font-weight:700">MessageRenderer</span> renderer <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">StandardOutMessageRenderer</span>();
        renderer<span style="color:#00f;font-weight:700">.</span>setMessageProvider(messageProvider());
        <span style="color:#00f;font-weight:700">return</span> renderer;
    }
}
</pre>
        <div class="Para" id="Par259">In the previous code sample, a few annotations were introduced that are explained in Table <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_4_Chapter.html#Tab3">4-3</a></span>.
            Beans that are defined using a stereotype annotation like <span class="EmphasisFontCategoryNonProportional">@</span> <span id="ITerm111">                <span class="EmphasisFontCategoryNonProportional">Component</span> </span>, <span id="ITerm112">                <span class="EmphasisFontCategoryNonProportional">@Service</span>            </span>, and others can be used in a Java configuration class, by enabling component scanning and autowiring them where needed. In the following example, we declare <span class="EmphasisFontCategoryNonProportional">ConfigurableMessageProvider</span>            as a service bean.
            <div class="Table" id="Tab3">
                <div class="Caption" xml:lang="en">
                    <div class="CaptionContent"><span class="CaptionNumber">Table 4-3.</span>
                        <div class="SimplePara">Java Configuration Annotations Table</div>
                    </div>
                </div>
                <table border="1">
                    <colgroup>
                        <col>
                        <col>
                    </colgroup>
                    <thead>
                        <tr class="header">
                            <th>
                                <div class="SimplePara">Annotation</div>
                            </th>
                            <th>
                                <div class="SimplePara">Description</div>
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="noclass">
                            <td>
                                <div class="SimplePara"> <span class="EmphasisFontCategoryNonProportional">@PropertySource</span> </div>
                            </td>
                            <td>
                                <div class="SimplePara">This annotation is used to load properties files into Spring’s <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>, which accepts the location as the argument (more than one location can be provided).
                                    For XML, <span class="EmphasisFontCategoryNonProportional">&lt;context:property-placeholder&gt;</span> serves the same purpose.</div>
                            </td>
                        </tr>
                        <tr class="noclass">
                            <td>
                                <div class="SimplePara"> <span class="EmphasisFontCategoryNonProportional">@Lazy</span> </div>
                            </td>
                            <td>
                                <div class="SimplePara">This annotation instructs Spring to instantiate the bean only when requested (same as <span class="EmphasisFontCategoryNonProportional">lazy-init=&quot;true&quot;</span> in XML). This annotation has a default <span class="EmphasisFontCategoryNonProportional">value</span>                                    attribute that is <span class="EmphasisFontCategoryNonProportional">true</span> by default; thus, using <span class="EmphasisFontCategoryNonProportional">@Lazy(value=true)</span> is equivalent to using <span class="EmphasisFontCategoryNonProportional">@Lazy</span>.</div>
                            </td>
                        </tr>
                        <tr class="noclass">
                            <td>
                                <div class="SimplePara"> <span class="EmphasisFontCategoryNonProportional">@Scope</span> </div>
                            </td>
                            <td>
                                <div class="SimplePara">This is used to define the bean scope, when the desired scope is other than singleton.</div>
                            </td>
                        </tr>
                        <tr class="noclass">
                            <td>
                                <div class="SimplePara"> <span class="EmphasisFontCategoryNonProportional">@DependsOn</span> </div>
                            </td>
                            <td>
                                <div class="SimplePara">This annotation tells Spring that a certain bean depends on some other beans, so Spring will make sure that those beans are instantiated first.</div>
                            </td>
                        </tr>
                        <tr class="noclass">
                            <td>
                                <div class="SimplePara"> <span class="EmphasisFontCategoryNonProportional">@Autowired</span> </div>
                            </td>
                            <td>
                                <div class="SimplePara">This annotation is used here on the <span class="EmphasisFontCategoryNonProportional">env</span> variable, which is of <span class="EmphasisFontCategoryNonProportional">Environment</span> type. This is the <span class="EmphasisFontCategoryNonProportional">Environment</span>                                    abstraction feature that Spring provides. We discuss it later in this chapter.</div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4.annotated</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch2.decoupled.MessageProvider</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.beans.factory.annotation.Autowired</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.beans.factory.annotation.Value</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.stereotype.Service</span>;

@Service(<span style="color:#036a07">provider</span>)
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">ConfigurableMessageProvider</span> <span style="color:#00f;font-weight:700">implements</span> <span style="font-style:italic">MessageProvider</span> {
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">String</span> message;

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#0000a2;font-weight:700">ConfigurableMessageProvider</span>(
            @<span style="color:#00f;font-weight:700">Value</span>(&quot;<span style="color:#00f;font-weight:700">Love</span> <span style="font-style:italic">on</span> <span style="font-style:italic">the</span> <span style="font-style:italic">weekend</span>&quot;) String message) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>message <span style="color:#00f;font-weight:700">=</span> message;
    }

    <span style="color:#00f;font-weight:700">@Override</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">String</span> <span style="color:#0000a2;font-weight:700">getMessage</span>() {
        <span style="color:#00f;font-weight:700">return</span> <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>message;
    }
}
</pre>
        <div class="Para" id="Par261">Here you can see the configuration class</div>
        <pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch2.decoupled.MessageProvider</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch2.decoupled.MessageRenderer</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch2.decoupled.StandardOutMessageRenderer</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.beans.factory.annotation.Autowired</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.annotation.*</span>;

@<span style="color:#00f;font-weight:700">Configuration</span>
@ComponentScan(basePackages <span style="color:#00f;font-weight:700">=</span> {<span style="color:#036a07">com.apress.prospring5.ch4.annotated</span>})
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">AppConfigTwo</span> {
    <span style="color:#00f;font-weight:700">@Autowired</span>
    <span style="color:#00f;font-weight:700">MessageProvider</span> provider;

    <span style="color:#00f;font-weight:700">@Bean</span>(<span style="color:#c5060b;font-weight:700">name</span> <span style="color:#00f;font-weight:700">=</span> <span style="color:#036a07">messageRenderer</span>)
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">MessageRenderer</span> <span style="color:#0000a2;font-weight:700">messageRenderer</span>() {
        <span style="color:#00f;font-weight:700">MessageRenderer</span> renderer <span style="color:#00f;font-weight:700">=</span>
                <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">StandardOutMessageRenderer</span>();
        renderer<span style="color:#00f;font-weight:700">.</span>setMessageProvider(provider);
        <span style="color:#00f;font-weight:700">return</span> renderer;
    }
}
</pre>
        <div class="Para" id="Par263"> <span id="ITerm113">                <span class="EmphasisFontCategoryNonProportional">@ComponentScan</span> </span> defines the packages that Spring should scan for annotations for bean definitions. It’s the same as the <span class="EmphasisFontCategoryNonProportional">&lt;context:component-scan&gt;</span>            tag in the XML configuration. Execute the code in the following example:</div>
        <pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch2.decoupled.MessageRenderer</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.ApplicationContext</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.annotation.AnnotationConfigApplicationContext</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">JavaConfigExampleTwo</span> {
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span>... <span style="font-style:italic">args</span>) {
        <span style="color:#00f;font-weight:700">ApplicationContext</span> ctx <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">new</span>
                <span style="color:#00f;font-weight:700">AnnotationConfigApplicationContext</span>(<span style="color:#00f;font-weight:700">AppConfigTwo</span><span style="color:#00f;font-weight:700">.</span>class);
        <span style="color:#00f;font-weight:700">MessageRenderer</span> renderer <span style="color:#00f;font-weight:700">=</span>
                ctx<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#036a07">messageRenderer</span>, <span style="color:#00f;font-weight:700">MessageRenderer</span><span style="color:#00f;font-weight:700">.</span>class);
        renderer<span style="color:#00f;font-weight:700">.</span>render();
    }
}
</pre>
        <div class="Para" id="Par265">You will get the following result:</div>
        <div class="Para" id="Par266">
            <div class="ProgramCode" id="PC79">
                <div class="FixedLine"> --&gt; StandardOutMessageRenderer: constructor called</div>
                <div class="FixedLine"> --&gt; StandardOutMessageRenderer: setting the provider</div>
                <div class="FixedLine">Love on the <span id="ITerm114">weekend                                              </span> </div>
            </div>
        </div>
        <div class="Para" id="Par267">An application can also have multiple configuration classes, which can be used decouple configuration and organize beans by purpose (for example, one class can be dedicated to DAO beans declaration, one for the Service beans declaration, and so
            forth). Let’s define the <span class="EmphasisFontCategoryNonProportional">provider</span> bean using another configuration class named <span class="EmphasisFontCategoryNonProportional">AppConfigFour</span>. The bean can be accessed from another
            configuration class by importing the beans defined by this class. This is achieved by annotating the target configuration class <span class="EmphasisFontCategoryNonProportional">AppConfigThree</span> with <span class="EmphasisFontCategoryNonProportional">@Import</span>.</div>
        <pre style="background:#fff;color:#000"><span style="color:#06f;font-style:italic">//AppConfigFour.java</span>
<span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4.multiple</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.annotation.ComponentScan</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.annotation.Configuration</span>;

@<span style="color:#00f;font-weight:700">Configuration</span>
@ComponentScan(basePackages <span style="color:#00f;font-weight:700">=</span> {<span style="color:#036a07">com.apress.prospring5.ch4.annotated</span>})
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">AppConfigFour</span> {
}
<span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4.multiple</span>;
        <span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch2.decoupled.MessageProvider</span>;
        <span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch2.decoupled.MessageRenderer</span>;
        <span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch2.decoupled.StandardOutMessageRenderer</span>;
        <span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.beans.factory.annotation.Autowired</span>;
        <span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.annotation.Bean</span>;
        <span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.annotation.Configuration</span>;
        <span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.annotation.Import</span>;

@<span style="color:#00f;font-weight:700">Configuration</span>
@Import(<span style="color:#00f;font-weight:700">AppConfigFour</span><span style="color:#00f;font-weight:700">.</span>class)
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">AppConfigThree</span> {
    <span style="color:#00f;font-weight:700">@Autowired</span>
    <span style="color:#00f;font-weight:700">MessageProvider</span> provider;

    <span style="color:#00f;font-weight:700">@Bean</span>(<span style="color:#c5060b;font-weight:700">name</span> <span style="color:#00f;font-weight:700">=</span> <span style="color:#036a07">messageRenderer</span>)
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">MessageRenderer</span> <span style="color:#0000a2;font-weight:700">messageRenderer</span>() {
        <span style="color:#00f;font-weight:700">MessageRenderer</span> renderer <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">StandardOutMessageRenderer</span>();
        renderer<span style="color:#00f;font-weight:700">.</span>setMessageProvider(provider);
        <span style="color:#00f;font-weight:700">return</span> renderer;
    }
}
</pre>
            <div class="Para" id="Par269">If in the main method in class <span class="EmphasisFontCategoryNonProportional">JavaConfigExampleTwo</span> you replace the class <span class="EmphasisFontCategoryNonProportional">AppConfigTwo</span> with <span class="EmphasisFontCategoryNonProportional">AppConfigThree</span>,
                then when the example is run, the same output is printed.</div>
            </div>
            <div class="Section2 RenderAsSection2" id="Sec39">
                <h3 class="Heading"> <span id="ITerm115">Spring Mixed Configuration                      </span> </h3>
                <div class="Para" id="Par270">But Spring can do so much more than that. Spring allows mixing XML and Java configuration classes. This is useful when applications come with legacy code that cannot be changed for some reason. To import bean declarations from an XML file,
                    the <span class="EmphasisFontCategoryNonProportional">@ImportResource</span> annotation can be used. In the following configuration snippet, you can see the <span class="EmphasisFontCategoryNonProportional">provider</span> bean declared
                    in an XML file named <span class="EmphasisFontCategoryNonProportional">app-context-xml-01.xml</span>:</div>
                <pre style="background:#fff;color:#000"><span style="color:#1c02ff">&lt;<span style="font-weight:700">beans</span> ...&gt;</span>
   <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">provider</span>
            <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch4.ConfigurableMessageProvider</span>
         <span style="font-style:italic">p</span>:message=<span style="color:#036a07">Love on the weekend</span> /&gt;</span>
<span style="color:#1c02ff">&lt;/<span style="font-weight:700">beans</span>&gt;</span>
</pre>
                <div class="Para" id="Par272">The next code sample depicts class <span class="EmphasisFontCategoryNonProportional">AppConfigFive</span> where the beans declared in the XML file are imported. If in the main method in <span class="EmphasisFontCategoryNonProportional">classJavaConfigExampleTwo</span>                    we replace class <span class="EmphasisFontCategoryNonProportional">AppConfigTwo</span> with <span class="EmphasisFontCategoryNonProportional">AppConfigFive</span>, then when the example is run, the same output is printed.</div>
                <pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4.mixed</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch2.decoupled.MessageProvider</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch2.decoupled.MessageRenderer</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch2.decoupled.StandardOutMessageRenderer</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.beans.factory.annotation.Autowired</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.annotation.Bean</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.annotation.Configuration</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.annotation.ImportResource</span>;

@<span style="color:#00f;font-weight:700">Configuration</span>
@ImportResource(value <span style="color:#00f;font-weight:700">=</span> <span style="color:#036a07">classpath:spring/app-context-xml-01.xml</span>)
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">AppConfigFive</span> {
    <span style="color:#00f;font-weight:700">@Autowired</span>
    <span style="color:#00f;font-weight:700">MessageProvider</span> provider;

    <span style="color:#00f;font-weight:700">@Bean</span>(<span style="color:#c5060b;font-weight:700">name</span> <span style="color:#00f;font-weight:700">=</span> <span style="color:#036a07">messageRenderer</span>)
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">MessageRenderer</span> <span style="color:#0000a2;font-weight:700">messageRenderer</span>() {
        <span style="color:#00f;font-weight:700">MessageRenderer</span> renderer <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">StandardOutMessageRenderer</span>();
        renderer<span style="color:#00f;font-weight:700">.</span>setMessageProvider(provider);
        <span style="color:#00f;font-weight:700">return</span> renderer;
    }
}
</pre>
            <div class="Para" id="Par274">Also, the reverse can be done as well: beans defined in Java configuration classes can be imported into XML configuration files. In the next example, the <span class="EmphasisFontCategoryNonProportional">messageRenderer</span> bean is defined
                in the XML file, and its dependency, the <span class="EmphasisFontCategoryNonProportional">provider</span> bean, is defined in configuration class <span class="EmphasisFontCategoryNonProportional">AppConfigSix</span>. The contents of the
                XML configuration file, <span class="EmphasisFontCategoryNonProportional">app-context-xml-02.xml</span>, are depicted here:</div>
            <pre style="background:#fff;color:#000"><span style="color:#1c02ff">&lt;<span style="font-weight:700">beans</span> ...&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">context</span><span style="font-weight:700">:</span><span style="font-weight:700">annotation-config</span>/&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch4.mixed.AppConfigSix</span>/&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">messageRenderer</span>
            <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch2.decoupled.StandardOutMessageRenderer</span>
          <span style="font-style:italic">p</span>:messageProvider-ref=<span style="color:#036a07">provider</span>/&gt;</span>
<span style="color:#1c02ff">&lt;/<span style="font-weight:700">beans</span>&gt;</span>
</pre>
            <div class="Para" id="Par276">A bean of the configuration class type must be declared, and support for annotated methods must be enabled using <span class="EmphasisFontCategoryNonProportional">&lt;context:annotation-config/&gt;</span>. This enables for beans declared in
                the class to be configured as dependencies for beans declared in the XML file. The configuration class <span class="EmphasisFontCategoryNonProportional">AppConfigSix</span> is pretty simple.</div>
            <pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4.mixed</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch2.decoupled.MessageProvider</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4.annotated.ConfigurableMessageProvider</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.annotation.Bean</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.annotation.Configuration</span>;

@<span style="color:#00f;font-weight:700">Configuration</span>
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">AppConfigSix</span> {
    <span style="color:#00f;font-weight:700">@Bean</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">MessageProvider</span> <span style="color:#0000a2;font-weight:700">provider</span>() {
        <span style="color:#00f;font-weight:700">return</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">ConfigurableMessageProvider</span>(<span style="color:#036a07">Love on the weekend</span>);
    }
}
</pre>
            <div class="Para" id="Par278">Creating an <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> instance is done using <span class="EmphasisFontCategoryNonProportional">ClassPathXmlApplicationContext</span>, which has been used a lot until now.</div>
            <pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch2.decoupled.MessageRenderer</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4.mixed.AppConfigFive</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.ApplicationContext</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.annotation.AnnotationConfigApplicationContext</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.support.ClassPathXmlApplicationContext</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">JavaConfigExampleThree</span> {
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span>... <span style="font-style:italic">args</span>) {
        <span style="color:#00f;font-weight:700">ApplicationContext</span> ctx <span style="color:#00f;font-weight:700">=</span>
                <span style="color:#00f;font-weight:700">new</span> ClassPathXmlApplicationContext
                        (&quot;classpath:spring/app-context-xml-02.xml&quot;);
        <span style="color:#00f;font-weight:700">MessageRenderer</span> renderer <span style="color:#00f;font-weight:700">=</span>
                ctx<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#036a07">messageRenderer</span>, <span style="color:#00f;font-weight:700">MessageRenderer</span><span style="color:#00f;font-weight:700">.</span>class);
        renderer<span style="color:#00f;font-weight:700">.</span>render();
    }
}
</pre>
                <div class="Para" id="Par280">Running the previous code yields the same output that was depicted <span id="ITerm117">previously                      </span>.</div>
                <div class="Para ParaTypeImportant" id="Par281"> <img alt="A315511_5_En_4_Figa_HTML.jpg" data-mfp-src="/library/view/pro-spring-5/9781484228081/A315511_5_En_4_Figa_HTML.jpg" height="28" src="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_4_Figa_HTML.jpg" width="30"/>                    Application infrastructure services can also be defined in Java configuration classes. For example, <span class="EmphasisFontCategoryNonProportional">@EnableTransactionManagement</span> defines that we will use Spring’s transaction
                    management feature, which is discussed further in Chapter <span class="ExternalRef"><a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_9_Chapter.html"><span class="RefSource">9</span></a>
                    </span>, and <span class="EmphasisFontCategoryNonProportional">@EnableWebSecurity</span> and <span class="EmphasisFontCategoryNonProportional">@EnableGlobalMethodSecurity</span> are used to enable a Spring Security context, which will be
                    discussed more in Chapter <span class="ExternalRef"><a href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_16_Chapter.html"><span class="RefSource">16</span></a>
                    </span>.</div>
                </div>
                <div class="Section2 RenderAsSection2" id="Sec40">
                    <h3 class="Heading">Java or XML Configuration?</h3>
                    <div class="Para ParaOneEmphasisChild" id="Par282">As you already saw, using Java classes can achieve the same level of <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> configuration as XML. So, which one should you use? The consideration is quite like the
                        one of whether to use XML or Java annotations for DI configuration. Each approach has its own pros and cons. However, the recommendation is the same; that is, when you and your team decide on the approach to use, stick to it and
                        keep the configuration style persistent, instead of scattered around between Java classes and XML files. Using one approach will make the maintenance work much easier.</div>
                </div>
                </div>
                <div class="Section1 RenderAsSection1" id="Sec41">
                    <h2 class="Heading">Profiles</h2>
                    <div class="Para ParaOneEmphasisChild" id="Par283">Another interesting feature that Spring provides is the concept of configuration profiles. Basically, a profile instructs Spring to configure only the <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> instance
                        that was defined when the specified profile was active. In this section, we demonstrate how to use profiles in a simple program.</div>
                    <div class="Section2 RenderAsSection2" id="Sec42">
                        <h3 class="Heading">An Example of Using the Spring Profiles Feature</h3>
                        <div class="Para" id="Par284">Let’s say there is a service called <span id="ITerm118">                <span class="EmphasisFontCategoryNonProportional">FoodProviderService</span> </span> that is responsible for providing food to schools, including kindergarten
                            and high school. The <span class="EmphasisFontCategoryNonProportional">FoodProviderService</span> interface has only one method called <span class="EmphasisFontCategoryNonProportional">provideLunchSet()</span>, which produces
                            the lunch set to each student for the calling school. A lunch set is a list of <span class="EmphasisFontCategoryNonProportional">Food</span> objects, which is a simple class that has only a <span class="EmphasisFontCategoryNonProportional">name</span>                            attribute. The following code snippet shows the <span class="EmphasisFontCategoryNonProportional">Food</span> class:</div>
                        <pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">Food</span> {
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">String</span> name;

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#0000a2;font-weight:700">Food</span>() {
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#0000a2;font-weight:700">Food</span>(<span style="color:#00f;font-weight:700">String</span> <span style="font-style:italic">name</span>) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>name <span style="color:#00f;font-weight:700">=</span> name;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">String</span> <span style="color:#0000a2;font-weight:700">getName</span>() {
        <span style="color:#00f;font-weight:700">return</span> name;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setName</span>(<span style="color:#00f;font-weight:700">String</span> <span style="font-style:italic">name</span>) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>name <span style="color:#00f;font-weight:700">=</span> name;
    }
}
</pre>
                        <div class="Para ParaOneEmphasisChild" id="Par286">And here is the <span class="EmphasisFontCategoryNonProportional">FoodProviderService</span> interface:</div>
                        <div class="Para" id="Par287">
                            <div class="ProgramCode" id="PC87">
                                <div class="LineGroup">
                                    <pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">java.util.List</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">interface</span> <span style="text-decoration:underline">FoodProviderService</span> {
    <span style="color:#00f;font-weight:700">List&lt;<span style="color:#00f;font-weight:700">Food</span>&gt;</span> <span style="color:#0000a2;font-weight:700">provideLunchSet</span>();
}
</pre>
                                </div>
                            </div>
                        </div>
                        <div class="Para ParaOneEmphasisChild" id="Par288">Now suppose that there are two providers for the lunch set, one for kindergarten and one for high school. The lunch set produced by them is different, although the service they provide is the same, that is, to provide lunch to
                            students. So, now let’s create two implementations of <span class="EmphasisFontCategoryNonProportional">FoodProviderService</span>, using the same name but putting them into different packages to identify their target school.
                            The two classes are shown here:</div>
                        <pre style="background:#fff;color:#000"><span style="color:#06f;font-style:italic">//chapter04/profiles/src/main/java/com/apress/prospring5/ch4/</span>

highschool<span style="color:#00f;font-weight:700">/</span><span style="color:#00f;font-weight:700">FoodProviderServiceImpl</span><span style="color:#00f;font-weight:700">.</span>java
        <span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4.highschool</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">java.util.ArrayList</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">java.util.List</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4.Food</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4.FoodProviderService</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">FoodProviderServiceImpl</span> <span style="color:#00f;font-weight:700">implements</span> <span style="font-style:italic">FoodProviderService</span> {
    <span style="color:#00f;font-weight:700">@Override</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">List&lt;<span style="color:#00f;font-weight:700">Food</span>&gt;</span> <span style="color:#0000a2;font-weight:700">provideLunchSet</span>() {
        <span style="color:#00f;font-weight:700">List&lt;<span style="color:#00f;font-weight:700">Food</span>&gt;</span> lunchSet <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">ArrayList&lt;&gt;</span>();
        lunchSet<span style="color:#00f;font-weight:700">.</span>add(<span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">Food</span>(<span style="color:#036a07">Coke</span>));
        lunchSet<span style="color:#00f;font-weight:700">.</span>add(<span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">Food</span>(<span style="color:#036a07">Hamburger</span>));
        lunchSet<span style="color:#00f;font-weight:700">.</span>add(<span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">Food</span>(<span style="color:#036a07">French Fries</span>));
        <span style="color:#00f;font-weight:700">return</span> lunchSet;
    }
}
<span style="color:#06f;font-style:italic">//chapter04/profiles/src/main/java/com/apress/prospring5/ch4/</span>
        kindergarten<span style="color:#00f;font-weight:700">/</span><span style="color:#00f;font-weight:700">FoodProviderServiceImpl</span><span style="color:#00f;font-weight:700">.</span>java
                <span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4.kindergarten</span>;
                <span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">java.util.ArrayList</span>;
                <span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">java.util.List</span>;
                <span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4.Food</span>;
                <span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4.FoodProviderService</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">FoodProviderServiceImpl</span> <span style="color:#00f;font-weight:700">implements</span> <span style="font-style:italic">FoodProviderService</span> {
    <span style="color:#00f;font-weight:700">@Override</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">List&lt;<span style="color:#00f;font-weight:700">Food</span>&gt;</span> <span style="color:#0000a2;font-weight:700">provideLunchSet</span>() {
        <span style="color:#00f;font-weight:700">List&lt;<span style="color:#00f;font-weight:700">Food</span>&gt;</span> lunchSet <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">ArrayList&lt;&gt;</span>();
        lunchSet<span style="color:#00f;font-weight:700">.</span>add(<span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">Food</span>(<span style="color:#036a07">Milk</span>));
        lunchSet<span style="color:#00f;font-weight:700">.</span>add(<span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">Food</span>(<span style="color:#036a07">Biscuits</span>));
        <span style="color:#00f;font-weight:700">return</span> lunchSet;
    }
}
</pre>
                        <div class="Para ParaOneEmphasisChild" id="Par290">From the previous listings, you can see that the two implementations provide the same <span class="EmphasisFontCategoryNonProportional">FoodProviderService</span> interface but produce different combinations of food in the lunch
                            set. So, now suppose a kindergarten wants the provider to deliver the lunch set for their students; let’s see how we can use Spring’s profile configuration to achieve this. We will run through the XML configuration first. We
                            will create two XML configuration files, one for the kindergarten profile and the other for the high-school profile. The following configuration snippet depicts the two profile configurations:</div>
                        <pre style="background:#fff;color:#000"><span style="color:#06f;font-style:italic">&lt;!-- highschool-config.xml --&gt;</span>
<span style="color:#1c02ff">&lt;<span style="font-weight:700">beans</span> <span style="font-style:italic">xmlns</span>=<span style="color:#036a07">http://www.springframework.org/schema/beans</span>
    <span style="font-style:italic">xmlns</span>:xsi=<span style="color:#036a07">http://www.w3.org/2001/XMLSchema-instance</span>
    <span style="font-style:italic">xsi</span>:schemaLocation=<span style="color:#036a07">http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans.xsd</span>
        <span style="font-style:italic">profile</span>=<span style="color:#036a07">highschool</span>&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">foodProviderService</span>
      <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch4.highschool.FoodProviderServiceImpl</span>/&gt;</span>
<span style="color:#1c02ff">&lt;/<span style="font-weight:700">beans</span>&gt;</span>
<span style="color:#06f;font-style:italic">&lt;!-- kindergarten-config.xml --&gt;</span>
<span style="color:#1c02ff">&lt;<span style="font-weight:700">beans</span> <span style="font-style:italic">xmlns</span>=<span style="color:#036a07">http://www.springframework.org/schema/beans</span>
    <span style="font-style:italic">xmlns</span>:xsi=<span style="color:#036a07">http://www.w3.org/2001/XMLSchema-instance</span>
    <span style="font-style:italic">xsi</span>:schemaLocation=<span style="color:#036a07">http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans.xsd</span>
        <span style="font-style:italic">profile</span>=<span style="color:#036a07">kindergarten</span>&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">foodProviderService</span>
      <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch4.kindergarten.FoodProviderServiceImpl</span>/&gt;</span>
<span style="color:#1c02ff">&lt;/<span style="font-weight:700">beans</span>&gt;</span>
</pre>
                        <div class="Para" id="Par292">In the previous two configurations, notice the usage of <span class="EmphasisFontCategoryNonProportional">profile=&quot;kindergarten&quot;</span> and <span class="EmphasisFontCategoryNonProportional">profile=&quot;highschool&quot;</span>, respectively,
                            within the <span class="EmphasisFontCategoryNonProportional">&lt;beans&gt;</span> tag. It actually tells Spring that those beans in the file should be instantiated only when the specified profile is active. Now let’s see how
                            to activate the correct profile when using Spring’s <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> in a stand-alone application. The following code snippet shows the testing program:</div>
                        <pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">java.util.List</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.support.GenericXmlApplicationContext</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">ProfileXmlConfigExample</span> {
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span>... <span style="font-style:italic">args</span>) {
        <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span> ctx <span style="color:#00f;font-weight:700">=</span>
                <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span>();
        ctx<span style="color:#00f;font-weight:700">.</span>load(<span style="color:#036a07">classpath:spring/*-config.xml</span>);
        ctx<span style="color:#00f;font-weight:700">.</span>refresh();
        <span style="color:#00f;font-weight:700">FoodProviderService</span> foodProviderService <span style="color:#00f;font-weight:700">=</span>
                ctx<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#036a07">foodProviderService</span>, <span style="color:#00f;font-weight:700">FoodProviderService</span><span style="color:#00f;font-weight:700">.</span>class);
        <span style="color:#00f;font-weight:700">List&lt;<span style="color:#00f;font-weight:700">Food</span>&gt;</span> lunchSet <span style="color:#00f;font-weight:700">=</span> foodProviderService<span style="color:#00f;font-weight:700">.</span>provideLunchSet();
        <span style="color:#00f;font-weight:700">for</span> (<span style="color:#00f;font-weight:700">Food</span> food <span style="color:#00f;font-weight:700">:</span> lunchSet) {
            <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">Food: </span> <span style="color:#00f;font-weight:700">+</span> food<span style="color:#00f;font-weight:700">.</span>getName());
        }
        ctx<span style="color:#00f;font-weight:700">.</span>close();
    }
}
</pre>
                        <div class="Para" id="Par294">The <span class="EmphasisFontCategoryNonProportional">ctx.load()</span> method will load both <span class="EmphasisFontCategoryNonProportional">kindergarten-config.xml</span> and <span class="EmphasisFontCategoryNonProportional">highschool-config.xml</span>,
                            since we pass the method the wildcard as the prefix. In this example, only the beans in the file <span class="EmphasisFontCategoryNonProportional">kindergarten-config.xml</span> will be instantiated by the Spring based on the
                            <span class="EmphasisFontCategoryNonProportional">profile</span> attribute, which is activated by passing the JVM argument <span class="EmphasisFontCategoryNonProportional">-Dspring.profiles.active=&quot;kindergarten&quot;</span>. Running
                            the program with this JVM argument produces the following output:</div>
                        <div class="Para" id="Par295">
                            <div class="ProgramCode" id="PC91">
                                <div class="FixedLine">Food: Milk</div>
                                <div class="FixedLine">Food: Biscuits</div>
                            </div>
                        </div>
                        <div class="Para ParaOneEmphasisChild" id="Par296">This is exactly what the implementation of the kindergarten provider will produce for the lunch set. Now change the profile argument from the previous listing to high school (<span class="EmphasisFontCategoryNonProportional">-Dspring.profiles.active=&quot;highschool&quot;</span>),
                            and the output will change to the following:</div>
                        <div class="Para" id="Par297">
                            <div class="ProgramCode" id="PC92">
                                <div class="FixedLine">Food: Coke</div>
                                <div class="FixedLine">Food: Hamburger</div>
                                <div class="FixedLine">Food: French Fries</div>
                            </div>
                        </div>
                        <div class="Para" id="Par298">You can also programmatically set the profile to use in your code by calling <span class="EmphasisFontCategoryNonProportional">ctx.getEnvironment().setActiveProfiles(&quot;kindergarten&quot;)</span>. Additionally, you can register classes
                            to be enabled by profiles using Java Config by simply adding the <span class="EmphasisFontCategoryNonProportional">@Profile</span> annotation to your class.</div>
                    </div>
                </div>
                <div class="Section1 RenderAsSection1" id="Sec43">
                    <h2 class="Heading">Spring Profiles Using <span id="ITerm122">Java Configuration                  </span> </h2>
                    <div class="Para ParaOneEmphasisChild" id="Par299">Of course, there is a way to configure Spring profiles using Java configuration because developers who do not like XML configuration should get satisfaction as well. The XML files declared in the previous section have to be replaced
                        with the equivalent Java configuration classes. This is how the configuration class for a <span class="EmphasisFontCategoryNonProportional">kindergarten</span> profile looks:</div>
                    <pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4.config</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4.FoodProviderService</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4.kindergarten.FoodProviderServiceImpl</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.annotation.Bean</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.annotation.Configuration</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.annotation.Profile</span>;

@<span style="color:#00f;font-weight:700">Configuration</span>
@Profile(<span style="color:#036a07">kindergarten</span>)
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">KindergartenConfig</span> {
    <span style="color:#00f;font-weight:700">@Bean</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">FoodProviderService</span> <span style="color:#0000a2;font-weight:700">foodProviderService</span>() {
        <span style="color:#00f;font-weight:700">return</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">FoodProviderServiceImpl</span>();
    }
}
</pre>
                    <div class="Para" id="Par301">As you can see, a <span class="EmphasisFontCategoryNonProportional">foodProviderService</span> bean is defined using the <span class="EmphasisFontCategoryNonProportional">@Bean</span> annotation. The class is marked as specific to
                        the <span class="EmphasisFontCategoryNonProportional">kindergarten</span> profile using the <span class="EmphasisFontCategoryNonProportional">@Profile</span> annotation. The class specific to the <span class="EmphasisFontCategoryNonProportional">highschool</span>                        profile is identical, except for the bean type, the profile name, and the class name, <span id="ITerm123">obviously                  </span>.</div>
                    <pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4.config</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4.FoodProviderService</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4.highschool.FoodProviderServiceImpl</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.annotation.Bean</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.annotation.Configuration</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.annotation.Profile</span>;

@<span style="color:#00f;font-weight:700">Configuration</span>
@Profile(<span style="color:#036a07">highschool</span>)
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">HighschoolConfig</span> {
    <span style="color:#00f;font-weight:700">@Bean</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">FoodProviderService</span> <span style="color:#0000a2;font-weight:700">foodProviderService</span>() {
        <span style="color:#00f;font-weight:700">return</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">FoodProviderServiceImpl</span>();
    }
}
</pre>
                    <div class="Para" id="Par303">These classes are used in the same way the XML files are. A context is declared to use both of them, and only one of them will actually be used to create the <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>                        instance depending on the value of the <span class="EmphasisFontCategoryNonProportional">-Dspring.profiles.active</span> JVM option.</div>
                    <pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4.config</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4.Food</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4.FoodProviderService</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.annotation.AnnotationConfigApplicationContext</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.support.GenericApplicationContext</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">java.util.List</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">ProfileJavaConfigExample</span> {
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span>... <span style="font-style:italic">args</span>) {
        <span style="color:#00f;font-weight:700">GenericApplicationContext</span> ctx <span style="color:#00f;font-weight:700">=</span>
                <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">AnnotationConfigApplicationContext</span>(
                        <span style="color:#00f;font-weight:700">KindergartenConfig</span><span style="color:#00f;font-weight:700">.</span>class,
                        <span style="color:#00f;font-weight:700">HighschoolConfig</span><span style="color:#00f;font-weight:700">.</span>class);
        <span style="color:#00f;font-weight:700">FoodProviderService</span> foodProviderService <span style="color:#00f;font-weight:700">=</span>
                ctx<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#036a07">foodProviderService</span>,
                        <span style="color:#00f;font-weight:700">FoodProviderService</span><span style="color:#00f;font-weight:700">.</span>class);
        <span style="color:#00f;font-weight:700">List&lt;<span style="color:#00f;font-weight:700">Food</span>&gt;</span> lunchSet <span style="color:#00f;font-weight:700">=</span> foodProviderService<span style="color:#00f;font-weight:700">.</span>provideLunchSet();
        <span style="color:#00f;font-weight:700">for</span> (<span style="color:#00f;font-weight:700">Food</span> food <span style="color:#00f;font-weight:700">:</span> lunchSet) {
            <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">Food: </span> <span style="color:#00f;font-weight:700">+</span> food<span style="color:#00f;font-weight:700">.</span>getName());
        }
        ctx<span style="color:#00f;font-weight:700">.</span>close();
    }
}
</pre>
                    <div class="Para" id="Par305">By running the previous example with <span class="EmphasisFontCategoryNonProportional">kindergarten</span> as the value for the <span class="EmphasisFontCategoryNonProportional">-Dspring.profiles.active</span> JVM option, the expected
                        output is <span id="ITerm124">printed                  </span>.</div>
                    <div class="Para" id="Par306">
                        <div class="ProgramCode" id="PC96">
                            <div class="FixedLine">Food: Milk</div>
                            <div class="FixedLine">Food: Biscuits</div>
                        </div>
                    </div>
                    <div class="Para" id="Par307">There is also an annotation for configuring used profiles that replaces the <span class="EmphasisFontCategoryNonProportional">-Dspring.profiles.active</span> JVM option, but this can be used only on test classes. As testing Spring
                        applications is covered in Chapter <span class="ExternalRef"><a href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_13_Chapter.html"><span class="RefSource">13</span></a>
                        </span>, it won’t be covered in detail here. But some sample code is included.</div>
                    <pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4.config</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4.FoodProviderService</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.junit.Test</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.junit.runner.RunWith</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.beans.factory.annotation.Autowired</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.test.context.ActiveProfiles</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.test.context.ContextConfiguration</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.test.context.junit4.SpringJUnit4ClassRunner</span>;

<span style="color:#00f;font-weight:700">import static</span> <span style="color:#00f;font-weight:700">org.junit.Assert.assertEquals</span>;
<span style="color:#00f;font-weight:700">import static</span> <span style="color:#00f;font-weight:700">org.junit.Assert.assertFalse</span>;
<span style="color:#00f;font-weight:700">import static</span> <span style="color:#00f;font-weight:700">org.junit.Assert.assertTrue</span>;

@RunWith(<span style="color:#00f;font-weight:700">SpringJUnit4ClassRunner</span><span style="color:#00f;font-weight:700">.</span>class)
@ContextConfiguration(classes <span style="color:#00f;font-weight:700">=</span> {<span style="color:#00f;font-weight:700">KindergartenConfig</span><span style="color:#00f;font-weight:700">.</span>class,
        <span style="color:#00f;font-weight:700">HighschoolConfig</span><span style="color:#00f;font-weight:700">.</span>class})
@ActiveProfiles(<span style="color:#036a07">kindergarten</span>)
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">ProfilesJavaConfigTest</span> {
    <span style="color:#00f;font-weight:700">@Autowired</span>
    <span style="color:#00f;font-weight:700">FoodProviderService</span> foodProviderService;

    <span style="color:#00f;font-weight:700">@Test</span>
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">testProvider</span>() {
        assertTrue(foodProviderService<span style="color:#00f;font-weight:700">.</span>provideLunchSet() <span style="color:#00f;font-weight:700">!=</span> <span style="color:#585cf6;font-weight:700">null</span>);
        assertFalse(foodProviderService<span style="color:#00f;font-weight:700">.</span>provideLunchSet()<span style="color:#00f;font-weight:700">.</span>isEmpty());
        assertEquals(<span style="color:#0000cd">2</span>, foodProviderService<span style="color:#00f;font-weight:700">.</span>provideLunchSet()<span style="color:#00f;font-weight:700">.</span>size());
    }
}
</pre>
                    <div class="Para" id="Par309">As you have probably figured out <span id="ITerm125">yourself                  </span>, the annotation that specifies which profile is used to run this test is <span class="EmphasisFontCategoryNonProportional">@ActiveProfiles(&quot;kindergarten&quot;)</span>.
                        In complex applications, usually there is more than one profile, and more of them can be used to compose the context configuration for a test. This class can be run in any Java smart editor and is automatically run when executing
                        <span class="EmphasisFontCategoryNonProportional">gradle clean build</span>.</div>
                    <div class="Section2 RenderAsSection2" id="Sec44">
                        <h3 class="Heading">Considerations for Using Profiles</h3>
                        <div class="Para" id="Par310">The profiles feature in Spring creates another way for developers to manage the application’s running configuration, which used to be done in build tools (for example, Maven’s profile support). Build tools rely on the arguments
                            passed into the tool to pack the correct configuration/property files into the Java archive (JAR or WAR, depending on the application type) and then deploy to the target environment. Spring’s profile feature lets us as an application
                            developer define the profiles by yourself and activate them either programmatically or by passing in the JVM argument. By using Spring’s profile support, you can now use the same application archive and deploy to all environments
                            by passing in the correct profiles as an argument during JVM startup. For example, you can have applications with different profiles such as <span class="EmphasisFontCategoryNonProportional">(dev, hibernate)</span>, <span class="EmphasisFontCategoryNonProportional">(prd, jdbc)</span>,
                            and so on, with each combination representing the running environment (development or production) and the data access library to use (Hibernate or JDBC). It brings application profile management into the programming side.</div>
                        <div class="Para" id="Par311">But this approach also has its drawbacks. For example, some may argue that putting all the configurations for different environments into application configuration files or Java classes and bundling them together will be error
                            prone if not handled carefully (for example, the administrator may forget to set the correct JVM argument in the application server environment). Packing files for all profiles together will also make the package a bit larger
                            than usual. Again, let the application and configuration requirements drive you to select the approach that best fits your project.</div>
                </div>
                </div>
                <div class="Section1 RenderAsSection1" id="Sec45">
                    <h2 class="Heading">Environment and PropertySource <span id="ITerm126">Abstraction                  </span> </h2>
                    <div class="Para" id="Par312">To set the active profile, we need to access the <span class="EmphasisFontCategoryNonProportional">Environment</span> interface. The <span class="EmphasisFontCategoryNonProportional">Environment</span> interface is an abstraction layer
                        that serves to encapsulate the environment of the running Spring application.</div>
                    <div class="Para ParaOneEmphasisChild" id="Par313">Besides the profile, other key pieces of information encapsulated by the <span class="EmphasisFontCategoryNonProportional">Environment</span> interface are properties. Properties are used to store the application’s underlying environment
                        configuration, such as the location of the application folder, database connection information, and so on.</div>
                    <div class="Para" id="Par314">The <span class="EmphasisFontCategoryNonProportional">Environment</span> and <span class="EmphasisFontCategoryNonProportional">PropertySource</span> abstraction features in Spring assist developers in accessing various configuration
                        information from the running platform. Under the abstraction, all system properties, environment variables, and application properties are served by the <span class="EmphasisFontCategoryNonProportional">Environment</span> interface,
                        which Spring populates when bootstrapping <span id="ITerm127">              <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> </span>. The following code snippet shows a simple example:</div>
                    <pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">java.util.HashMap</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">java.util.Map</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.support.GenericXmlApplicationContext</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.core.env.ConfigurableEnvironment</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.core.env.MapPropertySource</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.core.env.MutablePropertySources</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">EnvironmentSample</span> {
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span>... <span style="font-style:italic">args</span>) {
        <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span> ctx <span style="color:#00f;font-weight:700">=</span>
                <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span>();
        ctx<span style="color:#00f;font-weight:700">.</span>refresh();
        <span style="color:#00f;font-weight:700">ConfigurableEnvironment</span> env <span style="color:#00f;font-weight:700">=</span> ctx<span style="color:#00f;font-weight:700">.</span>getEnvironment();
        <span style="color:#00f;font-weight:700">MutablePropertySources</span> propertySources <span style="color:#00f;font-weight:700">=</span> env<span style="color:#00f;font-weight:700">.</span>getPropertySources();
        <span style="color:#00f;font-weight:700">Map&lt;<span style="color:#00f;font-weight:700">String</span>, <span style="color:#00f;font-weight:700">Object</span>&gt;</span> appMap <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">HashMap&lt;&gt;</span>();
        appMap<span style="color:#00f;font-weight:700">.</span>put(<span style="color:#036a07">user.home</span>, <span style="color:#036a07">application_home</span>);
        propertySources<span style="color:#00f;font-weight:700">.</span>addLast(<span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">MapPropertySource</span>(<span style="color:#036a07">prospring5_MAP</span>, appMap));
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">user.home: </span> <span style="color:#00f;font-weight:700">+</span> <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>getProperty(<span style="color:#036a07">user.home</span>));
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">JAVA_HOME: </span> <span style="color:#00f;font-weight:700">+</span> <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>getenv(<span style="color:#036a07">JAVA_HOME</span>));
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">user.home: </span> <span style="color:#00f;font-weight:700">+</span> env<span style="color:#00f;font-weight:700">.</span>getProperty(<span style="color:#036a07">user.home</span>));
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">JAVA_HOME: </span> <span style="color:#00f;font-weight:700">+</span> env<span style="color:#00f;font-weight:700">.</span>getProperty(<span style="color:#036a07">JAVA_HOME</span>));
        ctx<span style="color:#00f;font-weight:700">.</span>close();
    }
}
</pre>
                    <div class="Para" id="Par316">In the previous code snippet, after the <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> initialization, we get a reference to the <span class="EmphasisFontCategoryNonProportional">ConfigurableEnvironment</span>                        interface. Via the interface, a handle to <span class="EmphasisFontCategoryNonProportional">MutablePropertySources</span> (a default implementation of the <span class="EmphasisFontCategoryNonProportional">PropertySources</span>                        interface, which allows manipulation of the contained property sources) is obtained. Afterward, we construct a map, put the application properties into the map, and then construct a <span class="EmphasisFontCategoryNonProportional">MapPropertySource</span>                        class (a <span class="EmphasisFontCategoryNonProportional">PropertySource</span> subclass that reads keys and values from a <span class="EmphasisFontCategoryNonProportional">Map</span> instance) with the map. Finally, the
                        <span class="EmphasisFontCategoryNonProportional">MapPropertySource</span> class is added to <span class="EmphasisFontCategoryNonProportional">MutablePropertySources</span> via the <span class="EmphasisFontCategoryNonProportional">addLast()</span> method. Run the program, and
                            the following prints:</div>
                    <div class="Para" id="Par317">
                        <div class="ProgramCode" id="PC99">
                            <div class="FixedLine">user.home: /home/jules</div>
                            <div class="FixedLine">JAVA_HOME: /home/jules/bin/java</div>
                            <div class="FixedLine">user.home: /home/jules</div>
                            <div class="FixedLine">JAVA_HOME: /home/jules/bin/java</div>
                            <div class="FixedLine">application.home:  application_home</div>
                        </div>
                    </div>
                    <div class="Para" id="Par318">For the first two lines, the JVM system property <span class="EmphasisFontCategoryNonProportional">user.home</span> and the environment variable <span class="EmphasisFontCategoryNonProportional">JAVA_HOME</span> are retrieved, as before
                        (by using the JVM’s <span class="EmphasisFontCategoryNonProportional">System</span> class). However, for the last three lines, you can see that all the system properties, environment variables, and application properties can be
                        accessed via the <span class="EmphasisFontCategoryNonProportional">Environment</span> interface. You can see how the <span class="EmphasisFontCategoryNonProportional">Environment</span> abstraction can help us manage and access
                        all the various properties within the application’s running environment.</div>
                    <div class="Para" id="Par319">For the <span class="EmphasisFontCategoryNonProportional">PropertySource</span> abstraction, Spring will access the properties in the following default order:
                        <div class="UnorderedList">
                            <ul class="UnorderedListMarkBullet">
                                <li>
                                    <div class="Para" id="Par320">System properties for the running JVM</div>
                                </li>
                                <li>
                                    <div class="Para" id="Par321">Environment variables</div>
                                </li>
                                <li>
                                    <div class="Para" id="Par322">Application-defined properties</div>
                                </li>
                            </ul>
                        </div>
                    </div>
                    <div class="Para" id="Par323">So, for example, suppose we define the same application property, <span class="EmphasisFontCategoryNonProportional">user.home</span>, and add it to the <span class="EmphasisFontCategoryNonProportional">Environment</span> interface
                        via the <span id="ITerm128">              <span class="EmphasisFontCategoryNonProportional">MutablePropertySources</span> </span> class. If you run the program, you will still see that <span class="EmphasisFontCategoryNonProportional">user.home</span>                        is retrieved from the JVM properties, not yours. However, Spring allows you to control the order in which <span class="EmphasisFontCategoryNonProportional">Environment</span> retrieves the properties. The following code snippet
                        shows the revised version:</div>
                    <pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">java.util.HashMap</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">java.util.Map</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.support.GenericXmlApplicationContext</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.core.env.ConfigurableEnvironment</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.core.env.MapPropertySource</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.core.env.MutablePropertySources</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">EnvironmentSample</span> {
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span>... <span style="font-style:italic">args</span>) {
        <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span> ctx <span style="color:#00f;font-weight:700">=</span>
                <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span>();
        ctx<span style="color:#00f;font-weight:700">.</span>refresh();
        <span style="color:#00f;font-weight:700">ConfigurableEnvironment</span> env <span style="color:#00f;font-weight:700">=</span> ctx<span style="color:#00f;font-weight:700">.</span>getEnvironment();
        <span style="color:#00f;font-weight:700">MutablePropertySources</span> propertySources <span style="color:#00f;font-weight:700">=</span> env<span style="color:#00f;font-weight:700">.</span>getPropertySources();
        <span style="color:#00f;font-weight:700">Map&lt;<span style="color:#00f;font-weight:700">String</span>, <span style="color:#00f;font-weight:700">Object</span>&gt;</span> appMap <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">HashMap&lt;&gt;</span>();
        appMap<span style="color:#00f;font-weight:700">.</span>put(<span style="color:#036a07">application.home</span>, <span style="color:#036a07">application_home</span>);
        propertySources<span style="color:#00f;font-weight:700">.</span>addFirst(<span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">MapPropertySource</span>(<span style="color:#036a07">prospring5_MAP</span>, appMap));
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">user.home: </span> <span style="color:#00f;font-weight:700">+</span> <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>getProperty(<span style="color:#036a07">user.home</span>));
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">JAVA_HOME: </span> <span style="color:#00f;font-weight:700">+</span> <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>getenv(<span style="color:#036a07">JAVA_HOME</span>));
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">user.home: </span> <span style="color:#00f;font-weight:700">+</span> env<span style="color:#00f;font-weight:700">.</span>getProperty(<span style="color:#036a07">user.home</span>));
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">JAVA_HOME: </span> <span style="color:#00f;font-weight:700">+</span> env<span style="color:#00f;font-weight:700">.</span>getProperty(<span style="color:#036a07">JAVA_HOME</span>));
        ctx<span style="color:#00f;font-weight:700">.</span>close();
    }
}
</pre>
                    <div class="Para" id="Par325">In the previous code sample, we have defined an application property also called <span class="EmphasisFontCategoryNonProportional">user.home</span> and added it as the first one to search for via the <span class="EmphasisFontCategoryNonProportional">addFirst()</span>                        method of the <span id="ITerm129">              <span class="EmphasisFontCategoryNonProportional">MutablePropertySources</span> </span> class. When you run the program, you will see the following output:</div>
                    <div class="Para" id="Par326">
                        <div class="ProgramCode" id="PC101">
                            <div class="FixedLine">user.home: /home/jules</div>
                            <div class="FixedLine">JAVA_HOME: /home/jules/bin/java</div>
                            <div class="FixedLine">user.home: application_home</div>
                            <div class="FixedLine">JAVA_HOME: /home/jules/bin/java</div>
                        </div>
                    </div>
                    <div class="Para" id="Par327">The first two lines remain the same because we still use the <span class="EmphasisFontCategoryNonProportional">getProperty()</span> and <span class="EmphasisFontCategoryNonProportional">getenv()</span> methods of the JVM <span class="EmphasisFontCategoryNonProportional">System</span>                        class to retrieve them. However, when using the <span class="EmphasisFontCategoryNonProportional">Environment</span> interface, you will see that the <span class="EmphasisFontCategoryNonProportional">user.home</span> property we
                        defined takes precedence since we defined it as the first one to search for property values.</div>
                    <div class="Para" id="Par328">In real life, you seldom need to interact directly with the <span class="EmphasisFontCategoryNonProportional">Environment</span> interface but will use a property placeholder in the form of <span class="EmphasisFontCategoryNonProportional">${}</span>                        (for example, <span class="EmphasisFontCategoryNonProportional">${application.home}</span>) and inject the resolved value into Spring beans. Let’s see this in action. Suppose we had a class to store all the application properties
                        loaded from a property file. The following shows the <span id="ITerm130">              <span class="EmphasisFontCategoryNonProportional">AppProperty</span> </span> class:</div>
                    <pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">AppProperty</span> {
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">String</span> applicationHome;
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">String</span> userHome;

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">String</span> <span style="color:#0000a2;font-weight:700">getApplicationHome</span>() {
        <span style="color:#00f;font-weight:700">return</span> applicationHome;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setApplicationHome</span>(<span style="color:#00f;font-weight:700">String</span> <span style="font-style:italic">applicationHome</span>) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>applicationHome <span style="color:#00f;font-weight:700">=</span> applicationHome;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">String</span> <span style="color:#0000a2;font-weight:700">getUserHome</span>() {
        <span style="color:#00f;font-weight:700">return</span> userHome;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setUserHome</span>(<span style="color:#00f;font-weight:700">String</span> <span style="font-style:italic">userHome</span>) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>userHome <span style="color:#00f;font-weight:700">=</span> userHome;
    }
}
</pre>
                    <div class="Para ParaOneEmphasisChild" id="Par330">Here you can see the contents of the <span class="EmphasisFontCategoryNonProportional">application.properties</span> file:</div>
                    <div class="Para" id="Par331">
                        <div class="ProgramCode" id="PC103">
                            <div class="FixedLine">application.home=application_home</div>
                            <div class="FixedLine">user.home=/home/jules-new</div>
                        </div>
                    </div>
                    <div class="Para" id="Par332">Note that the property file also declares the <span class="EmphasisFontCategoryNonProportional">user.home property</span>. Let’s take a look at the Spring XML configuration; see the following code (<span class="EmphasisFontCategoryNonProportional">app-context-xml.xml</span>):</div>
                    <pre style="background:#fff;color:#000"><span style="color:#1c02ff">&lt;<span style="font-weight:700">beans</span> <span style="font-style:italic">xmlns</span>=<span style="color:#036a07">http://www.springframework.org/schema/beans</span>
       <span style="font-style:italic">xmlns</span>:xsi=<span style="color:#036a07">http://www.w3.org/2001/XMLSchema-instance</span>
       <span style="font-style:italic">xmlns</span>:context=<span style="color:#036a07">http://www.springframework.org/schema/context</span>
       <span style="font-style:italic">xmlns</span>:p=<span style="color:#036a07">http://www.springframework.org/schema/p</span>
       <span style="font-style:italic">xsi</span>:schemaLocation=<span style="color:#036a07">http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans.xsd
        http://www.springframework.org/schema/context
        http://www.springframework.org/schema/context/spring-context.xsd</span>&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">context</span><span style="font-weight:700">:</span><span style="font-weight:700">property-placeholder</span>
         <span style="font-style:italic">location</span>=<span style="color:#036a07">classpath:application.properties</span>/&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">appProperty</span> <span style="font-style:italic">class</span>=<span style="color:#036a07">com.apress.prospring5.ch4.AppProperty</span>
          <span style="font-style:italic">p</span>:applicationHome=<span style="color:#036a07">${application.home}</span>
          <span style="font-style:italic">p</span>:userHome=<span style="color:#036a07">${user.home}</span>/&gt;</span>
<span style="color:#1c02ff">&lt;/<span style="font-weight:700">beans</span>&gt;</span>
</pre>
                <div class="Para" id="Par334">We use the <span class="EmphasisFontCategoryNonProportional">&lt;context:property-placeholder&gt;</span> tag to load the properties into Spring’s <span class="EmphasisFontCategoryNonProportional">Environment</span>, which is wrapped into
                    the <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> interface. We also use the SpEL placeholders to inject the values into the <span class="EmphasisFontCategoryNonProportional">AppProperty</span> bean. The
                    following code snippet shows the testing program:</div>
                <pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.support.GenericXmlApplicationContext</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">PlaceHolderDemo</span> {
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span>... <span style="font-style:italic">args</span>) {
        <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span> ctx <span style="color:#00f;font-weight:700">=</span>
                <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span>();
        ctx<span style="color:#00f;font-weight:700">.</span>load(<span style="color:#036a07">classpath:spring/app-context-xml.xml</span>);
        ctx<span style="color:#00f;font-weight:700">.</span>refresh();
        <span style="color:#00f;font-weight:700">AppProperty</span> appProperty <span style="color:#00f;font-weight:700">=</span> ctx<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#036a07">appProperty</span>,
                <span style="color:#00f;font-weight:700">AppProperty</span><span style="color:#00f;font-weight:700">.</span>class);
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">application.home: </span> <span style="color:#00f;font-weight:700">+</span>
                appProperty<span style="color:#00f;font-weight:700">.</span>getApplicationHome());
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(<span style="color:#036a07">user.home: </span> <span style="color:#00f;font-weight:700">+</span>
                appProperty<span style="color:#00f;font-weight:700">.</span>getUserHome());
        ctx<span style="color:#00f;font-weight:700">.</span>close();
    }
}
</pre>
                <div class="Para" id="Par336">Let’s run the program, and you will see the following output:</div>
                <div class="Para" id="Par337">
                    <div class="ProgramCode" id="PC106">
                        <div class="FixedLine">application.home: application_home</div>
                        <div class="FixedLine">user.home: /Users/jules</div>
                    </div>
                </div>
                <div class="Para" id="Par338">You will see the <span class="EmphasisFontCategoryNonProportional">application.home</span> placeholder is properly resolved, while the <span class="EmphasisFontCategoryNonProportional">user.home</span> property is still retrieved from
                    the JVM properties, which is correct because it’s the default behavior for the <span class="EmphasisFontCategoryNonProportional">PropertySource</span> abstraction. To instruct Spring to give precedence for the values in the <span class="EmphasisFontCategoryNonProportional">application.properties</span>                    file, we add the attribute <span class="EmphasisFontCategoryNonProportional">local-override=&quot;true&quot;</span> to the <span class="EmphasisFontCategoryNonProportional">&lt;context:property-placeholder&gt;</span> tag.</div>
                <div class="Para" id="Par339">
                    <div class="ProgramCode" id="PC107">
                        <div class="FixedLine">&lt;context:property-placeholder local-override=&quot;true&quot;</div>
                        <div class="FixedLine">    location=&quot;classpath:env/application.properties&quot;/&gt;</div>
                    </div>
                </div>
                <div class="Para" id="Par340">The <span class="EmphasisFontCategoryNonProportional">local-override</span> attribute instructs Spring to override the existing properties with the properties defined in this placeholder. Run the program, and you will see that now the
                    <span class="EmphasisFontCategoryNonProportional">user.home</span> property from the <span class="EmphasisFontCategoryNonProportional">application.properties</span> file is retrieved.</div>
                <div class="Para" id="Par341">
                    <div class="ProgramCode" id="PC108">
                        <div class="FixedLine">application.home: application_home</div>
                        <div class="FixedLine">user.home: /home/jules-new</div>
                    </div>
                </div>
                </div>
                <div class="Section1 RenderAsSection1" id="Sec46">
                    <h2 class="Heading">Configuration Using JSR-330 Annotations</h2>
                    <div class="Para" id="Par342">As we discussed in Chapter <span class="ExternalRef"><a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_1_Chapter.html"><span class="RefSource">1</span></a>
                        </span>, JEE 6 provides support for JSR-330 (Dependency Injection for Java), which is a collection of annotations for expressing an application’s DI configuration within a JEE container or other compatible IoC framework. Spring also supports
                        and recognizes those annotations, so although you may not be running your application in a JEE 6 container, you can still use JSR-330 annotations within Spring. Using JSR-330 annotations can help you ease the migration to the JEE
                        6 container or other compatible IoC container (for example, Google Guice) away from Spring.</div>
                    <div class="Para" id="Par343">Again, let’s take the message renderer and message provider as an example and implement it using JSR-330 annotations. To support JSR-330 annotations, you need to add the <span class="EmphasisFontCategoryNonProportional">javax.inject</span>                        <a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_4_Chapter.html#Fn3" id="Fn3_source"><sup>3</sup></a> dependency to the project.</div>
                    <div class="Para" id="Par345">The following code snippet shows the <span id="ITerm132">          <span class="EmphasisFontCategoryNonProportional">MessageProvider</span> and <span class="EmphasisFontCategoryNonProportional">ConfigurableMessageProvider</span> </span>
                        implementation:</div>
                    <pre style="background:#fff;color:#000"><span style="color:#06f;font-style:italic">//chapter04/jsr330/src/main/java/com/apress/prospring5/</span>
     ch4<span style="color:#00f;font-weight:700">/</span><span style="color:#00f;font-weight:700">MessageProvider</span><span style="color:#00f;font-weight:700">.</span>java
             <span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">interface</span> <span style="text-decoration:underline">MessageProvider</span> {
    <span style="color:#00f;font-weight:700">String</span> <span style="color:#0000a2;font-weight:700">getMessage</span>();
}
<span style="color:#06f;font-style:italic">//chapter04/jsr330/src/main/java/com/apress/prospring5/</span>
   ch4<span style="color:#00f;font-weight:700">/</span><span style="color:#00f;font-weight:700">ConfigurableMessageProvider</span><span style="color:#00f;font-weight:700">.</span>java
           <span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4</span>;
           <span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">javax.inject.Inject</span>;
           <span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">javax.inject.Named</span>;

@Named(<span style="color:#036a07">messageProvider</span>)
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">ConfigurableMessageProvider</span>
        <span style="color:#00f;font-weight:700">implements</span> <span style="font-style:italic">MessageProvider</span> {
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">String</span> message <span style="color:#00f;font-weight:700">=</span> <span style="color:#036a07">Default  message</span>;

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#0000a2;font-weight:700">ConfigurableMessageProvider</span>() {
    }

    <span style="color:#00f;font-weight:700">@Inject</span>
    <span style="color:#00f;font-weight:700">@Named</span>(<span style="color:#036a07">message</span>)
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#0000a2;font-weight:700">ConfigurableMessageProvider</span>(<span style="color:#00f;font-weight:700">String</span> <span style="font-style:italic">message</span>) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>message <span style="color:#00f;font-weight:700">=</span> message;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setMessage</span>(<span style="color:#00f;font-weight:700">String</span> <span style="font-style:italic">message</span>) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>message <span style="color:#00f;font-weight:700">=</span> message;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">String</span> <span style="color:#0000a2;font-weight:700">getMessage</span>() {
        <span style="color:#00f;font-weight:700">return</span> message;
    }
}
</pre>
                    <div class="Para" id="Par347">You will notice that all annotations belong to the <span class="EmphasisFontCategoryNonProportional">javax.inject package</span>, which is the JSR-330 standard. This class used <span class="EmphasisFontCategoryNonProportional">@Named</span>                        in two places. First, it can be used to declare an injectable bean (the same as the <span class="EmphasisFontCategoryNonProportional">@Component</span> annotation or other stereotype annotations in Spring). In the listing, the
                        <span class="EmphasisFontCategoryNonProportional">@Named(&quot;messageProvider&quot;)</span> annotation specifies that <span class="EmphasisFontCategoryNonProportional">ConfigurableMessageProvider</span> is an injectable bean and gives it
                        the name <span class="EmphasisFontCategoryNonProportional">messageProvider</span>, which is the same as the <span class="EmphasisFontCategoryNonProportional">name</span> attribute in Spring’s <span class="EmphasisFontCategoryNonProportional">&lt;bean&gt;</span>                        tag. Second, we use constructor injection by using the <span class="EmphasisFontCategoryNonProportional">@Inject</span> annotation before the constructor that accepts a string value. Then, we use <span class="EmphasisFontCategoryNonProportional">@Named</span>                        to specify that we want to inject the value that had the name <span class="EmphasisFontCategoryNonProportional">message</span> assigned. Let’s move on to see the <span class="EmphasisFontCategoryNonProportional">MessageRenderer</span>                        interface and <span id="ITerm134">              <span class="EmphasisFontCategoryNonProportional">StandardOutMessageRenderer</span> </span> implementation.</div>
                    <pre style="background:#fff;color:#000"><span style="color:#06f;font-style:italic">//chapter04/jsr330/src/main/java/com/apress/prospring5/</span>
    ch4<span style="color:#00f;font-weight:700">/</span><span style="color:#00f;font-weight:700">MessageRenderer</span><span style="color:#00f;font-weight:700">.</span>java
            <span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">interface</span> <span style="text-decoration:underline">MessageRenderer</span> {
    <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">render</span>();

    <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setMessageProvider</span>(<span style="color:#00f;font-weight:700">MessageProvider</span> <span style="font-style:italic">provider</span>);

    <span style="color:#00f;font-weight:700">MessageProvider</span> <span style="color:#0000a2;font-weight:700">getMessageProvider</span>();
}
<span style="color:#06f;font-style:italic">//chapter04/jsr330/src/main/java/com/apress/prospring5/</span>
    ch4<span style="color:#00f;font-weight:700">/</span><span style="color:#00f;font-weight:700">StandardOutMessageRenderer</span><span style="color:#00f;font-weight:700">.</span>java
            <span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4</span>;
            <span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">javax.inject.Inject</span>;
            <span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">javax.inject.Named</span>;
            <span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">javax.inject.Singleton</span>;

@Named(<span style="color:#036a07">messageRenderer</span>)
@<span style="color:#00f;font-weight:700">Singleton</span>
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">StandardOutMessageRenderer</span>
        <span style="color:#00f;font-weight:700">implements</span> <span style="font-style:italic">MessageRenderer</span> {
    <span style="color:#00f;font-weight:700">@Inject</span>
    <span style="color:#00f;font-weight:700">@Named</span>(<span style="color:#036a07">messageProvider</span>)
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">MessageProvider</span> messageProvider <span style="color:#00f;font-weight:700">=</span> <span style="color:#585cf6;font-weight:700">null</span>;

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">render</span>() {
        <span style="color:#00f;font-weight:700">if</span> (messageProvider <span style="color:#00f;font-weight:700">==</span> <span style="color:#585cf6;font-weight:700">null</span>) {
            <span style="color:#00f;font-weight:700">throw</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">RuntimeException</span>(
                    <span style="color:#036a07">You must set the property messageProvider of class:</span>
                            <span style="color:#00f;font-weight:700">+</span> <span style="color:#00f;font-weight:700">StandardOutMessageRenderer</span><span style="color:#00f;font-weight:700">.</span>class<span style="color:#00f;font-weight:700">.</span>getName());
        }
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(messageProvider<span style="color:#00f;font-weight:700">.</span>getMessage());
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setMessageProvider</span>(<span style="color:#00f;font-weight:700">MessageProvider</span> <span style="font-style:italic">provider</span>) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>messageProvider <span style="color:#00f;font-weight:700">=</span> provider;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">MessageProvider</span> <span style="color:#0000a2;font-weight:700">getMessageProvider</span>() {
        <span style="color:#00f;font-weight:700">return</span> <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>messageProvider;
    }
}
</pre>
                    <div class="Para" id="Par349">In the previous code snippet, we used <span class="EmphasisFontCategoryNonProportional">@Named</span> to define that it’s an injectable bean. Notice the <span class="EmphasisFontCategoryNonProportional">@Singleton</span> annotation.
                        It’s worth noting that in the JSR-330 standard, a bean’s default scope is nonsingleton, which is like Spring’s <span class="EmphasisFontCategoryNonProportional">prototype</span> scope. So, in a JSR-330 environment, if you want
                        your bean to be a singleton, you need to use the <span class="EmphasisFontCategoryNonProportional">@Singleton</span> annotation. However, using this annotation in Spring actually doesn’t have any effect because Spring’s default
                        scope for bean instantiation is already singleton. We just put it here for a demonstration, and it’s worth noting the difference between Spring and other JSR-330–compatible containers.</div>
                    <div class="Para" id="Par350">For the <span class="EmphasisFontCategoryNonProportional">messageProvider</span> property, we use <span class="EmphasisFontCategoryNonProportional">@Inject</span> for setter injection this time and specify that a bean with the name
                        <span class="EmphasisFontCategoryNonProportional">messageProvider</span> should be used for injection. The following configuration snippet defines a simple Spring XML configuration for the application (<span class="EmphasisFontCategoryNonProportional">app-context-annotation.xml</span>):</div>
                    <pre style="background:#fff;color:#000"><span style="color:#1c02ff">&lt;<span style="font-weight:700">beans</span> ...&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">context</span><span style="font-weight:700">:</span><span style="font-weight:700">component-scan</span>
         <span style="font-style:italic">base-package</span>=<span style="color:#036a07">com.apress.prospring5.ch4</span>/&gt;</span>
    <span style="color:#1c02ff">&lt;<span style="font-weight:700">bean</span> <span style="font-style:italic">id</span>=<span style="color:#036a07">message</span> <span style="font-style:italic">class</span>=<span style="color:#036a07">java.lang.String</span>&gt;</span>
        <span style="color:#1c02ff">&lt;<span style="font-weight:700">constructor-arg</span> <span style="font-style:italic">value</span>=<span style="color:#036a07">Gravity is  working against me</span>/&gt;</span>
   <span style="color:#1c02ff">&lt;/<span style="font-weight:700">bean</span>&gt;</span>
<span style="color:#1c02ff">&lt;/<span style="font-weight:700">beans</span>&gt;</span>
</pre>
                <div class="Para" id="Par352">You don’t need any special tags to use JSR-330; just configure your application like a normal Spring application. We use <span class="EmphasisFontCategoryNonProportional">&lt;context:component-scan&gt;</span> to instruct Spring to scan
                    for the DI-related annotations, and Spring will recognize those JSR-330 annotations. We also declare a Spring bean called <span class="EmphasisFontCategoryNonProportional">message</span> for constructor injection into the <span class="EmphasisFontCategoryNonProportional">ConfigurableMessageProvider</span>                    class. The following code snippet shows the testing program:</div>
                <pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.support.GenericXmlApplicationContext</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">Jsr330Demo</span> {
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span>... <span style="font-style:italic">args</span>) {
        <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span> ctx <span style="color:#00f;font-weight:700">=</span>
                <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">GenericXmlApplicationContext</span>();
        ctx<span style="color:#00f;font-weight:700">.</span>load(<span style="color:#036a07">classpath:spring/app-context-annotation.xml</span>);
        ctx<span style="color:#00f;font-weight:700">.</span>refresh();
        <span style="color:#00f;font-weight:700">MessageRenderer</span> renderer <span style="color:#00f;font-weight:700">=</span> ctx<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#036a07">messageRenderer</span>,
                <span style="color:#00f;font-weight:700">MessageRenderer</span><span style="color:#00f;font-weight:700">.</span>class);
        renderer<span style="color:#00f;font-weight:700">.</span>render();
        ctx<span style="color:#00f;font-weight:700">.</span>close();
    }
}
</pre>
                <div class="Para" id="Par354">Running the program yields the following output:</div>
                <div class="Para" id="Par355">
                    <div class="ProgramCode" id="PC113">
                        <div class="FixedLine">Gravity is working against me</div>
                    </div>
                </div>
                <div class="Para" id="Par356">By using JSR-330, you can ease the migration into other JSR-330–compatible IoC containers (for example, JEE 6–compatible application servers or other DI containers such as Google Guice). However, Spring’s annotations are much more feature
                    rich and flexible than JSR-330 annotations. Some main differences are highlighted here:
                    <div class="UnorderedList">
                        <ul class="UnorderedListMarkBullet">
                            <li>
                                <div class="Para" id="Par357">When using Spring’s <span class="EmphasisFontCategoryNonProportional">@Autowired</span> annotation, you can specify a <span class="EmphasisFontCategoryNonProportional">required</span> attribute to indicate that the DI must
                                    be fulfilled (you can also use Spring’s <span class="EmphasisFontCategoryNonProportional">@Required</span> annotation to declare this requirement), while for JSR-330’s <span class="EmphasisFontCategoryNonProportional">@Inject</span>                                    annotation, there is no such equivalent. Moreover, Spring provides the <span class="EmphasisFontCategoryNonProportional">@Qualifier</span> annotation, which allows more fine-grained control for Spring to perform autowiring
                                    of dependencies based on qualifier name.</div>
                            </li>
                            <li>
                                <div class="Para" id="Par358">JSR-330 supports only singleton and nonsingleton bean scopes, while Spring supports more scopes, which is useful for web applications.</div>
                            </li>
                            <li>
                                <div class="Para ParaOneEmphasisChild" id="Par359">In Spring, you can use the <span class="EmphasisFontCategoryNonProportional">@Lazy</span> annotation to instruct Spring to instantiate the bean only when requested by the application. There’s no such equivalent in JSR-330.</div>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="Para" id="Par360">You can also mix and match Spring and JSR-330 annotations in the same application. However, it is recommended that you settle on either one to maintain a consistent style for your application. One possible way is to use JSR-330 <span id="ITerm136">annotations                  </span>                    as much as possible and use Spring annotations when required. However, this brings you fewer benefits, because you still need to do quite a bit of work in migrating to another DI container. In conclusion, Spring’s annotations approach
                    is recommended over JSR-330 annotations, because Spring’s annotations are much more powerful, unless there is a requirement that your application should be IoC container independent.</div>
                </div>
                <div class="Section1 RenderAsSection1" id="Sec47">
                    <h2 class="Heading">Configuration Using <span id="ITerm137">Groovy        </span> </h2>
                    <div class="Para" id="Par361">New to Spring Framework 4.0 is the ability to configure your bean definitions and <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> by using the Groovy language. This provides developers with another choice
                        in configuration to either replace or supplement XML and/or annotation-based bean configuration. A Spring <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> can be created directly in a Groovy script or
                        loaded from Java, both by way of the <span class="EmphasisFontCategoryNonProportional">GenericGroovyApplicationContext</span> class. First let’s dive into the details by showing how to create bean definitions from an external Groovy
                        script and loading them from Java. In previous sections and chapters, we introduced various bean classes, and to promote some code reusability, we will use in this example the <span class="EmphasisFontCategoryNonProportional">Singer</span>                        class introduced in Chapter <span class="ExternalRef"><a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_3_Chapter.html"><span class="RefSource">3</span></a>
                        </span>. The following code snippet shows the content of this class:</div>
                    <pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.xml</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">Singer</span> {
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">String</span> name;
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">int</span> age;

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setName</span>(<span style="color:#00f;font-weight:700">String</span> <span style="font-style:italic">name</span>) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>name <span style="color:#00f;font-weight:700">=</span> name;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">setAge</span>(<span style="color:#00f;font-weight:700">int</span> <span style="font-style:italic">age</span>) {
        <span style="color:#318495">this</span><span style="color:#00f;font-weight:700">.</span>age <span style="color:#00f;font-weight:700">=</span> age;
    }

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">String</span> <span style="color:#0000a2;font-weight:700">toString</span>() {
        <span style="color:#00f;font-weight:700">return</span> <span style="color:#036a07">&quot;<span style="color:#26b31a">\t</span>Name: &quot;</span> <span style="color:#00f;font-weight:700">+</span> name <span style="color:#00f;font-weight:700">+</span> <span style="color:#036a07">&quot;<span style="color:#26b31a">\n</span><span style="color:#26b31a">\t</span>&quot;</span> <span style="color:#00f;font-weight:700">+</span> <span style="color:#036a07">Age: </span> <span style="color:#00f;font-weight:700">+</span> age;
    }
}
</pre>
                    <div class="Para ParaOneEmphasisChild" id="Par363">As you can see, this is just a Java class with a couple of properties describing a singer. We use this simple Java class here to show that just because you configure your beans in Groovy doesn’t mean your entire code base needs to
                        be rewritten in Groovy. Not only that, but Java classes can be imported from dependencies and used within Groovy scripts. Now, let’s create the Groovy script (<span class="EmphasisFontCategoryNonProportional">beans.groovy</span>)
                        that will be used to create the bean definition, as shown in the previous code snippet:</div>
                    <pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4</span>

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.xml.Singer</span>
beans{
        singer(<span style="color:#00f;font-weight:700">Singer</span>,name<span style="color:#00f;font-weight:700">:</span><span style="color:#036a07">John Mayer</span>,age<span style="color:#00f;font-weight:700">:</span><span style="color:#0000cd">39</span>)
        }
</pre>
                    <div class="Para" id="Par365">This Groovy script starts with a top-level closure called <span class="EmphasisFontCategoryNonProportional">beans</span>, which provides bean definitions to Spring. First, we specify the bean name (<span class="EmphasisFontCategoryNonProportional">singer</span>),
                        and then as arguments we provide the class type (<span class="EmphasisFontCategoryNonProportional">Singer</span>) followed by the property names and values that we would like to set. Next, let’s create a simple test driver in Java,
                        loading bean definitions from the Groovy script, as shown <span id="ITerm138">here        </span>:</div>
                    <pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.xml.Singer</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.ApplicationContext</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.support.GenericGroovyApplicationContext</span>;

<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">GroovyBeansFromJava</span> {
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span>... <span style="font-style:italic">args</span>) {
        <span style="color:#00f;font-weight:700">ApplicationContext</span> context <span style="color:#00f;font-weight:700">=</span>
                <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">GenericGroovyApplicationContext</span>(<span style="color:#036a07">classpath:beans.groovy</span>);
        <span style="color:#00f;font-weight:700">Singer</span> singer <span style="color:#00f;font-weight:700">=</span> context<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#036a07">singer</span>, <span style="color:#00f;font-weight:700">Singer</span><span style="color:#00f;font-weight:700">.</span>class);
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>out<span style="color:#00f;font-weight:700">.</span>println(singer);
    }
}
</pre>
                    <div class="Para" id="Par367">As you can see, the creation of <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> is carried out in typical fashion, but it’s done by using the <span class="EmphasisFontCategoryNonProportional">GenericGroovyApplicationContext</span>                        class and providing your Groovy script that builds the bean definitions.</div>
                    <div class="Para" id="Par368">Before you can run the samples in this section, you need to add a dependency to this project: the <span class="EmphasisFontCategoryNonProportional">groovy-all</span> library. The <span class="EmphasisFontCategoryNonProportional">build.gradle</span>                        configuration file content for the project <span class="EmphasisFontCategoryNonProportional">groovy-config-java</span> is shown here:</div>
                    <pre style="background:#fff;color:#000">apply plugin<span style="color:#00f;font-weight:700">:</span> <span style="color:#036a07">groovy</span>
dependencies {
        compile misc<span style="color:#00f;font-weight:700">.</span>groovy
        compile project(<span style="color:#036a07">:chapter03:bean-inheritance</span>)
}
</pre>
                    <div class="Para" id="Par370">The <span class="EmphasisFontCategoryNonProportional">compile project(&apos;:chapter03:bean-inheritance&apos;)</span> line specifies that the Chapter <span class="ExternalRef"><a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_3_Chapter.html"><span class="RefSource">3</span></a>
                        </span>
                        <span class="EmphasisFontCategoryNonProportional">bean-inheritance</span> project must be compiled and used as a dependency for this project. This is the project containing the <span class="EmphasisFontCategoryNonProportional">Singer</span>                        class.</div>
                    <div class="Para" id="Par371">Gradle configuration files use Groovy syntax, and <span class="EmphasisFontCategoryNonProportional">misc.groovy</span> references the <span class="EmphasisFontCategoryNonProportional">groovy</span> property of the <span class="EmphasisFontCategoryNonProportional">misc</span>                        array defined in the <span class="EmphasisFontCategoryNonProportional">build.gradle</span> file of the parent project. A snippet of the content of this file (configurations related to Groovy) is shown <span id="ITerm139">here        </span>:</div>
                    <pre style="background:#fff;color:#000">ext {
        springVersion <span style="color:#00f;font-weight:700">=</span>  <span style="color:#036a07">5.0.0.M4</span>
        groovyVersion <span style="color:#00f;font-weight:700">=</span>  <span style="color:#036a07">2.4.5</span>
.<span style="color:#00f;font-weight:700">.</span>.
        misc <span style="color:#00f;font-weight:700">=</span> [
                .<span style="color:#00f;font-weight:700">.</span>.
                    groovy<span style="color:#00f;font-weight:700">:</span> <span style="color:#036a07">org.codehaus.groovy:groovy-all:$groovyVersion</span>
        ]
.<span style="color:#00f;font-weight:700">.</span>.
}
</pre>
                <div class="Para ParaOneEmphasisChild" id="Par373">Running the <span class="EmphasisFontCategoryNonProportional">GroovyBeansFromJava</span> class yields the following output:</div>
                <div class="Para" id="Par374">
                    <div class="ProgramCode" id="PC119">
                        <div class="FixedLine">Name: John Mayer</div>
                        <div class="FixedLine">Age: 39</div>
                    </div>
                </div>
                <div class="Para" id="Par375">Now that you have seen how to load bean definitions from Java via an external Groovy script, how can we go about creating the <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span> and bean definitions from a Groovy
                    script alone? Let’s take a look at the Groovy code (<span class="EmphasisFontCategoryNonProportional">GroovyConfig.groovy</span>) listed here:</div>
                <pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4</span>
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch3.xml.Singer</span>
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.support.GenericApplicationContext</span>
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.beans.factory.groovy.GroovyBeanDefinitionReader</span>
def ctx <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">GenericApplicationContext</span>()
def reader <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">new</span> <span style="color:#00f;font-weight:700">GroovyBeanDefinitionReader</span>(ctx)
reader<span style="color:#00f;font-weight:700">.</span>beans {
    singer(<span style="color:#00f;font-weight:700">Singer</span>, name<span style="color:#00f;font-weight:700">:</span> <span style="color:#036a07">John Mayer</span>, age<span style="color:#00f;font-weight:700">:</span> <span style="color:#0000cd">39</span>)
}
ctx<span style="color:#00f;font-weight:700">.</span>refresh()
println ctx<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#036a07">singer</span>)
</pre>
                <div class="Para" id="Par377">When we run this sample, we get same output as before. This time we create an instance of a typical <span class="EmphasisFontCategoryNonProportional">GenericApplicationContext</span> but use <span class="EmphasisFontCategoryNonProportional">GroovyBeanDefinitionReader</span>,
                    which will be used to pass bean definitions to. Then, as in the previous sample, we create a bean from your simple POJO, refresh <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>, and print the string representation
                    of the <span class="EmphasisFontCategoryNonProportional">Singer</span> bean. It doesn’t get any easier than that!</div>
                <div class="Para" id="Par378">As you probably can tell, we are only scratching the surface of what can be done with the Groovy support in Spring. Since you have the full power of the Groovy language, you can do all sorts of interesting things when creating bean definitions.
                    As you have full access to <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>, not only can you configure beans, but you can also work with profile support, property files, and so on. Just keep in mind, with
                    great power comes great <span id="ITerm140">responsibility        </span>.</div>
                </div>
                <div class="Section1 RenderAsSection1" id="Sec48">
                    <h2 class="Heading">Spring Boot</h2>
                    <div class="Para" id="Par379">Until now you’ve learned more than one way to configure a Spring application. Whether it is XML, annotations, Java configuration classes, Groovy scripts, or a mix of all these, now you should have a basic idea of how it’s done. But
                        what if we tell you there is something even cooler than all that?</div>
                    <div class="Para" id="Par380">The Spring Boot project aims to simplify the getting-started experience of building an application by using Spring. Spring Boot takes the guesswork out of manually gathering dependencies and provides some of the most common features
                        needed by most applications, such as metrics and health checks.</div>
                    <div class="Para" id="Par381">Spring Boot takes an <span id="ITerm141">“opinionated” approach                  </span> to achieve the goal of developer simplification by way of providing starter projects for various types of applications that already contain the
                        proper dependencies and versions, which means less time spent to get started. For those who may be looking to get away from XML completely, Spring Boot does not require any configuration to be written in XML.</div>
                    <div class="Para" id="Par382">In this example, we will create the traditional Hello World web application with a twist. You may be surprised to see the minimal amount of code required to do so as compared to your typical Java web application setup. Typically, we
                        have started off samples by defining the dependencies we need to add to your project. Part of Spring Boot’s simplification model is to prepare all the dependencies for you, and when using Maven, for example, you as the developer
                        utilize a parent POM to obtain this functionality. When using Gradle, things become even simpler. There is no parent needed, except a Gradle plug-in and a starter dependency. In the following example, we will create a Spring application
                        that lists all the beans in the context, and then the <span class="EmphasisFontCategoryNonProportional">helloWorld</span> bean is accessed. The Gradle configuration of the <span class="EmphasisFontCategoryNonProportional">boot-simple</span>                        project is depicted here:</div>
                    <pre style="background:#fff;color:#000">buildscript {
    repositories {
        mavenLocal()
        mavenCentral()
        maven { url <span style="color:#036a07">http://repo.spring.io/release</span> }
        maven { url <span style="color:#036a07">http://repo.spring.io/milestone</span> }
        maven { url  <span style="color:#036a07">http://repo.spring.io/snapshot</span> }
        maven { url <span style="color:#036a07">https://repo.spring.io/libs-snapshot</span> }
    }
    dependencies {
        classpath boot<span style="color:#00f;font-weight:700">.</span>springBootPlugin
    }
}
apply plugin<span style="color:#00f;font-weight:700">:</span> <span style="color:#036a07">org.springframework.boot</span>
dependencies {
    compile boot<span style="color:#00f;font-weight:700">.</span>starter
}
</pre>
                    <div class="Para" id="Par384">The <span class="EmphasisFontCategoryNonProportional">boot.springBootPlugin</span> line references the <span class="EmphasisFontCategoryNonProportional">springBootPlugin</span> property of the <span class="EmphasisFontCategoryNonProportional">boot</span>                        array defined in the <span class="EmphasisFontCategoryNonProportional">build.gradle</span> file of the parent project. A snippet of the content of this file (<span id="ITerm142">configurations                  </span> related to
                        Spring Boot only) is depicted here:</div>
                    <pre style="background:#fff;color:#000">ext {
    bootVersion <span style="color:#00f;font-weight:700">=</span> <span style="color:#036a07">2.0.0.BUILD-SNAPSHOT</span>
    .<span style="color:#00f;font-weight:700">.</span>.
    boot <span style="color:#00f;font-weight:700">=</span> [
      springBootPlugin<span style="color:#00f;font-weight:700">:</span>
            <span style="color:#036a07">org.springframework.boot:spring-boot-gradle-plugin:$bootVersion</span>, starter    <span style="color:#00f;font-weight:700">:</span>
            <span style="color:#036a07">org.springframework.boot:spring-boot-starter:$bootVersion</span>, starterWeb    <span style="color:#00f;font-weight:700">:</span>
            <span style="color:#036a07">org.springframework.boot:spring-boot-starter-web:$bootVersion</span>
    ]
    .<span style="color:#00f;font-weight:700">.</span>.
}
</pre>
                    <div class="Para" id="Par386">At the time of this writing, Spring Boot version 2.0.0 has not been released yet. That is why the version is <span class="EmphasisFontCategoryNonProportional">2.0.0.BUILD-SNAPSHOT</span> and we need to add the Spring Snapshot repository,
                        <span class="ExternalRef"><a href="https://repo.spring.io/libs-snapshot"><span class="RefSource">                <span class="EmphasisFontCategoryNonProportional">https://repo.spring.io/libs-snapshot</span> </span>
                        </a>
                        </span>, in the configuration. It is quite possible that after this book, an official version will be released.</div>
                    <div class="Para" id="Par387">Each release of Spring Boot provides a curated list of dependencies it supports. The versions of the necessary libraries are selected so the API matches perfectly, and this is handled by Spring Boot. Therefore, the manual configuration
                        of dependencies versions is not necessary. Upgrading Spring Boot will ensure that those dependencies are upgraded as well. With the previous configuration, a set of dependencies will be added to the project, each with the proper
                        versions so that their API will be compatible. In a smart editor like IntelliJ IDEA, there is a <span id="ITerm143">Gradle Projects                  </span> view, where you can expand each module and inspect the available tasks
                        and dependencies, as shown in Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_4_Chapter.html#Fig3">4-3</a></span>.
                        <div class="Figure" id="Fig3">
                            <div class="MediaObject" id="MO3"><img alt="A315511_5_En_4_Fig3_HTML.jpg" data-mfp-src="/library/view/pro-spring-5/9781484228081/A315511_5_En_4_Fig3_HTML.jpg" height="289" src="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_4_Fig3_HTML.jpg" width="520"/></div>
                            <div class="Caption" xml:lang="en">
                                <div class="CaptionContent"><span class="CaptionNumber">Figure 4-3.</span>
                                    <div class="SimplePara">Gradle Projects view of the boot-simple <span id="ITerm144">project                                  </span> </div>
                                </div>
                        </div>
                    </div>
                </div>
                <div class="Para ParaOneEmphasisChild" id="Par388">Now that the setup is in place, let’s create the classes. The <span class="EmphasisFontCategoryNonProportional">HelloWorld</span> class is shown here:</div>
                <pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.slf4j.Logger</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.slf4j.LoggerFactory</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.stereotype.Component</span>;

@<span style="color:#00f;font-weight:700">Component</span>
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">HelloWorld</span> {
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">Logger</span> logger <span style="color:#00f;font-weight:700">=</span>
            <span style="color:#00f;font-weight:700">LoggerFactory</span><span style="color:#00f;font-weight:700">.</span>getLogger(<span style="color:#00f;font-weight:700">HelloWorld</span><span style="color:#00f;font-weight:700">.</span>class);

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">sayHi</span>() {
        logger<span style="color:#00f;font-weight:700">.</span>info(<span style="color:#036a07">Hello World!</span>);
    }
}
</pre>
                <div class="Para" id="Par390">There is nothing special or complicated about this; it’s just a class with a method and a bean declaration annotation on it. Let’s see how to build a Spring application using Spring Boot and create an <span id="ITerm145">              <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>                    </span> that contains this bean:</div>
                <pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.slf4j.Logger</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.slf4j.LoggerFactory</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.boot.SpringApplication</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.boot.autoconfigure.SpringBootApplication</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.ConfigurableApplicationContext</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">java.util.Arrays</span>;

@<span style="color:#00f;font-weight:700">SpringBootApplication</span>
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">Application</span> {
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">Logger</span> logger <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">LoggerFactory</span><span style="color:#00f;font-weight:700">.</span>getLogger(<span style="color:#00f;font-weight:700">Application</span><span style="color:#00f;font-weight:700">.</span>class);

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span> <span style="font-style:italic">args</span>) <span style="color:#00f;font-weight:700">throws</span> <span style="color:#00f;font-weight:700">Exception</span> {
        <span style="color:#00f;font-weight:700">ConfigurableApplicationContext</span> ctx <span style="color:#00f;font-weight:700">=</span>
                <span style="color:#00f;font-weight:700">SpringApplication</span><span style="color:#00f;font-weight:700">.</span>run(<span style="color:#00f;font-weight:700">Application</span><span style="color:#00f;font-weight:700">.</span>class, args);
        <span style="color:#00f;font-weight:700">assert</span> (ctx <span style="color:#00f;font-weight:700">!=</span> <span style="color:#585cf6;font-weight:700">null</span>);
        logger<span style="color:#00f;font-weight:700">.</span>info(<span style="color:#036a07">The beans you were looking for:</span>);
        <span style="color:#06f;font-style:italic">// listing all bean definition    names</span>
        <span style="color:#00f;font-weight:700">Arrays</span><span style="color:#00f;font-weight:700">.</span>stream(ctx<span style="color:#00f;font-weight:700">.</span>getBeanDefinitionNames())<span style="color:#00f;font-weight:700">.</span>forEach(logger<span style="color:#00f;font-weight:700">:</span><span style="color:#00f;font-weight:700">:</span>info);
        <span style="color:#00f;font-weight:700">HelloWorld</span> hw <span style="color:#00f;font-weight:700">=</span> ctx<span style="color:#00f;font-weight:700">.</span>getBean(<span style="color:#00f;font-weight:700">HelloWorld</span><span style="color:#00f;font-weight:700">.</span>class);
        hw<span style="color:#00f;font-weight:700">.</span>sayHi();
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>in<span style="color:#00f;font-weight:700">.</span>read();
        ctx<span style="color:#00f;font-weight:700">.</span>close();
    }
}
</pre>
                <div class="Para" id="Par392">That is all. Really. And this class could have been smaller, but we wanted to show you how to do some extra things. Let’s cover them all.
                    <div class="UnorderedList">
                        <ul class="UnorderedListMarkBullet">
                            <li>
                                <div class="Para" id="Par393"> <span class="EmphasisTypeItalic">Check that we have a context</span>: The <span class="EmphasisFontCategoryNonProportional">assert</span> statement is used to test your assumption that <span class="EmphasisFontCategoryNonProportional">ctx</span>                                    is not <span class="EmphasisFontCategoryNonProportional">null</span>.</div>
                            </li>
                            <li>
                                <div class="Para" id="Par394"> <span class="EmphasisTypeItalic">Set up logging</span>: Spring Boot comes with a set of logging libraries, so we only have to put under the <span class="EmphasisFontCategoryNonProportional">resources</span> directory the
                                    configuration for the one we want to use. In our case, we chose <span class="EmphasisFontCategoryNonProportional">logback</span>.</div>
                            </li>
                            <li>
                                <div class="Para" id="Par395"> <span class="EmphasisTypeItalic">List all bean definitions in the context</span>: Using Java 8 lambda expressions, you can list all bean definitions in the context in one line. So, we added that line so you can see what
                                    beans are autoconfigured for you out of the box by Spring Boot. In the list you will find the <span class="EmphasisFontCategoryNonProportional">helloWorld</span> bean too.</div>
                            </li>
                            <li>
                                <div class="Para" id="Par396"> <span class="EmphasisTypeItalic">Confirm exit</span>: Without the <span class="EmphasisFontCategoryNonProportional">System.in.read();</span> method, the application prints the beans names, prints <span class="EmphasisFontCategoryNonProportional">HelloWorld</span>,
                                    and then exits. We added that call so the application will wait for the developer to press a key and then exit.</div>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="Para" id="Par397">The novelty here is the <span class="EmphasisFontCategoryNonProportional">@SpringBootApplication</span> annotation. This annotation is a top-level annotation designed to be used only at the class level. It a convenience annotation that
                    is equivalent to declaring the following three:
                    <div class="UnorderedList">
                        <ul class="UnorderedListMarkBullet">
                            <li>
                                <div class="Para" id="Par398"> <span class="EmphasisFontCategoryNonProportional">@Configuration</span>: Marks this class as a configuration class that can declare beans with <span class="EmphasisFontCategoryNonProportional">@Bean</span>.</div>
                            </li>
                            <li>
                                <div class="Para" id="Par399"> <span class="EmphasisFontCategoryNonProportional">@EnableAutoConfiguration</span>: This is a specific Spring Boot annotation from the package <span class="EmphasisFontCategoryNonProportional">org.springframework.boot.autoconfigure</span>                                    that can enable Spring <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>, attempting to guess and configure beans that you are likely to need based on the specified dependencies.</div>
                                <div class="Para" id="Par400"> <span class="EmphasisFontCategoryNonProportional">@EnableAutoConfiguration</span> works well with Spring-provided starter dependencies, but it is not directly tied to them, so other dependencies outside the starters can
                                    be used. For example, if there is a specific embedded server on the classpath, it will be used, unless there is another <span class="EmphasisFontCategoryNonProportional">EmbeddedServletContainerFactory</span> configuration
                                    in the project.</div>
                    </li>
                    <li>
                        <div class="Para" id="Par401"> <span class="EmphasisFontCategoryNonProportional">@ComponentScan</span>: We can declare classes annotated with stereotype annotations that will become beans of some kind. The attribute used to list the packages to scan used with
                            <span class="EmphasisFontCategoryNonProportional">@SpringBootApplication</span> is <span class="EmphasisFontCategoryNonProportional">basePackages</span>. In version 1.3.0, another attribute was added for component scanning:
                            <span class="EmphasisFontCategoryNonProportional">basePackageClasses</span>. This attribute provides a type-safe alternative to <span class="EmphasisFontCategoryNonProportional">basePackages</span> for specifying the packages
                            to scan for annotated components. The package of each class specified will be scanned.</div>
                    </li>
                    </ul>
                </div>
                </div>
                <div class="Para" id="Par402">If the <span class="EmphasisFontCategoryNonProportional">@SpringBootApplication</span> annotation has no component scanning attribute defined, it will scan only the package in which the class annotated with it is located. That is why in
                    the example presented here, the <span class="EmphasisFontCategoryNonProportional">helloWorld</span> bean definition is found, and the bean is created.</div>
                <div class="Para" id="Par403">The previous Spring Boot application was a simple console application with one developer-defined bean and a full-blown out-of-the-box environment. But Spring Boot provides starter dependencies for web applications as well. The dependency
                    to use is <span class="EmphasisFontCategoryNonProportional">spring-boot-starter-web</span>, and in Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_4_Chapter.html#Fig4">4-4</a></span>                    you can see the transitive dependencies of this Boot starter library. In the <span class="EmphasisFontCategoryNonProportional">boot-web</span> project, the <span class="EmphasisFontCategoryNonProportional">HelloWorld</span> class is
                    a Spring controller, which is a special type of class that is used to create a Spring web bean. This is a typical Spring MVC controller class that you will learn about in Chapter <span class="ExternalRef"><a href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_16_Chapter.html"><span class="RefSource">16</span></a>
                    </span>.
                    <div class="Figure" id="Fig4">
                        <div class="MediaObject" id="MO4"><img alt="A315511_5_En_4_Fig4_HTML.jpg" data-mfp-src="/library/view/pro-spring-5/9781484228081/A315511_5_En_4_Fig4_HTML.jpg" height="368" src="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_4_Fig4_HTML.jpg" width="520"/></div>
                        <div class="Caption" xml:lang="en">
                            <div class="CaptionContent"><span class="CaptionNumber">Figure 4-4.</span>
                                <div class="SimplePara">Gradle Projects view of the boot-web <span id="ITerm147">project                                  </span> </div>
                            </div>
                    </div>
                </div>
                </div>
                <pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4.ctrl</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.web.bind.annotation.RequestMapping</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.web.bind.annotation.RestController</span>;

@<span style="color:#00f;font-weight:700">RestController</span>
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">HelloWorld</span> {
    <span style="color:#00f;font-weight:700">@RequestMapping</span>(<span style="color:#036a07">/</span>)
    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">String</span> <span style="color:#0000a2;font-weight:700">sayHi</span>() {
        <span style="color:#00f;font-weight:700">return</span> <span style="color:#036a07">Hello World!</span>;
    }
}
</pre>
                <div class="Para" id="Par405">The annotation used to declare Spring web beans is a specialization of <span class="EmphasisFontCategoryNonProportional">@Component</span>: the <span class="EmphasisFontCategoryNonProportional">@Controller</span> annotation. These types
                    of classes contain methods annotated with <span class="EmphasisFontCategoryNonProportional">@RequestMapping</span>, which are mapped to a certain request URL. The annotation you see in the example <span class="EmphasisFontCategoryNonProportional">@RestController</span>                    is used for practical reasons. It is the <span class="EmphasisFontCategoryNonProportional">@Controller</span> annotation used for REST services. And exposing the <span class="EmphasisFontCategoryNonProportional">helloWorld</span> bean
                    as a REST service is useful here because you do not have to create a full-blown web application with an user interface and other web components that will pollute the basic idea in this section. All the web components introduced here
                    are covered in Chapter <span class="ExternalRef"><a href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_16_Chapter.html"><span class="RefSource">16</span></a>
                    </span>.</div>
                <div class="Para ParaOneEmphasisChild" id="Par406">Next we create your bootstrap class by using a simple <span class="EmphasisFontCategoryNonProportional">main()</span> method, as shown here:</div>
                <pre style="background:#fff;color:#000"><span style="color:#00f;font-weight:700">package</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">com.apress.prospring5.ch4.ctrl.HelloWorld</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.slf4j.Logger</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.slf4j.LoggerFactory</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.boot.SpringApplication</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.boot.autoconfigure.SpringBootApplication</span>;
<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">org.springframework.context.ConfigurableApplicationContext</span>;

<span style="color:#00f;font-weight:700">import</span> <span style="color:#00f;font-weight:700">java.util.Arrays</span>;

@SpringBootApplication(scanBasePackageClasses <span style="color:#00f;font-weight:700">=</span> <span style="color:#00f;font-weight:700">HelloWorld</span><span style="color:#00f;font-weight:700">.</span>class)
<span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">class</span> <span style="text-decoration:underline">WebApplication</span> {
    <span style="color:#00f;font-weight:700">private</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">Logger</span> logger <span style="color:#00f;font-weight:700">=</span>
            <span style="color:#00f;font-weight:700">LoggerFactory</span><span style="color:#00f;font-weight:700">.</span>getLogger(<span style="color:#00f;font-weight:700">WebApplication</span><span style="color:#00f;font-weight:700">.</span>class);

    <span style="color:#00f;font-weight:700">public</span> <span style="color:#00f;font-weight:700">static</span> <span style="color:#00f;font-weight:700">void</span> <span style="color:#0000a2;font-weight:700">main</span>(<span style="color:#00f;font-weight:700">String</span> <span style="font-style:italic">args</span>) <span style="color:#00f;font-weight:700">throws</span> <span style="color:#00f;font-weight:700">Exception</span> {
        <span style="color:#00f;font-weight:700">ConfigurableApplicationContext</span> ctx <span style="color:#00f;font-weight:700">=</span>
                <span style="color:#00f;font-weight:700">SpringApplication</span><span style="color:#00f;font-weight:700">.</span>run(<span style="color:#00f;font-weight:700">WebApplication</span><span style="color:#00f;font-weight:700">.</span>class, args);
        <span style="color:#00f;font-weight:700">assert</span> (ctx <span style="color:#00f;font-weight:700">!=</span> <span style="color:#585cf6;font-weight:700">null</span>);
        logger<span style="color:#00f;font-weight:700">.</span>info(<span style="color:#036a07">Application started...</span>);
        <span style="color:#00f;font-weight:700">System</span><span style="color:#00f;font-weight:700">.</span>in<span style="color:#00f;font-weight:700">.</span>read();
        ctx<span style="color:#00f;font-weight:700">.</span>close();
    }
}
</pre>
                <div class="Para" id="Par408">Because the <span class="EmphasisFontCategoryNonProportional">HelloWorld</span> controller was declared in a different package than the <span class="EmphasisFontCategoryNonProportional">WebApplication</span> class, we created an opportunity
                    to depict how the <span class="EmphasisFontCategoryNonProportional">scanBasePackageClasses</span> attribute is used.</div>
                <div class="Para" id="Par409">At this point, you may be asking yourself: where is the <span class="EmphasisFontCategoryNonProportional">web.xml</span> configuration file and all the other components I must create for a basic web application? You already defined everything
                    needed in the previous listings! Don’t believe it? Compile the project and run the <span class="EmphasisFontCategoryNonProportional">Application</span> class until you see the log message indicating that the application has been started.
                    If you look at the generated log files, you will see a lot going on with such little code. Most notably, it looks like Tomcat is running, and various endpoints such as health checks, environment output information, and metrics are
                    already defined for you. First navigate to <span class="EmphasisFontCategoryNonProportional">http://localhost:8080</span> and you will see the Hello World web page displayed as expected. Next take a look at some of the preconfigured
                    endpoints (for example, <span class="EmphasisFontCategoryNonProportional">http://localhost:8080/health</span>, which returns a JSON representation of the application status). Going further, load <span class="EmphasisFontCategoryNonProportional">http://localhost:8080/metrics</span>                    to get a better understanding of various metrics that are being collected such as heap size, garbage collection, and so on.</div>
                <div class="Para" id="Par410">As you may be able to tell already from this one sample alone, Spring Boot radically simplifies the way you go about creating any type of application. Gone are the days of having to configure numerous files to get a simple web application
                    going, and with an embedded servlet container ready to serve your web application, everything “just works.”</div>
                <div class="Para" id="Par411">While we have shown you a simple example, keep in mind that Spring Boot does not lock you into using what it chooses; it simply takes the “opinionated” approach and chooses defaults for you. If you don’t want to use embedded Tomcat but
                    Jetty instead, simply modify the configuration file to exclude the Tomcat starter module from the <span class="EmphasisFontCategoryNonProportional">spring-boot-starter-web dependency</span>. Utilizing the <span id="ITerm149">Gradle Projects                  </span>                    view is one way to help you visualize what dependencies are being brought into your project. Spring Boot also provides many other starter dependencies for other types of applications, and you are encouraged to read through the documentation
                    for more details.</div>
                <div class="Para" id="Par412">For more information on Spring Boot, please see its project page at <span class="ExternalRef"><a href="http://projects.spring.io/spring-boot/"><span class="RefSource">                <span class="EmphasisFontCategoryNonProportional">http://projects.spring.io/spring-boot/</span>                    </span>
                    </a>
                    </span>.</div>
                </div>
                <div class="Section1 RenderAsSection1" id="Sec49">
                    <h2 class="Heading">Summary</h2>
                    <div class="Para" id="Par413">In this chapter, you saw a wide range of Spring-specific features that complement the core IoC capabilities. You saw how to hook into the life cycle of a bean and to make it aware of the Spring environment. We introduced <span class="EmphasisFontCategoryNonProportional">FactoryBean</span>s
                        as a solution for IoC, enabling a wider set of classes. We also showed how you can use <span class="EmphasisFontCategoryNonProportional">PropertyEditor</span>s to simplify application configuration and to remove the need for artificial
                        <span class="EmphasisFontCategoryNonProportional">String</span>-typed properties. We showed you more than one way to define beans using XML, annotations, and Java configuration. Moreover, we finished with an in-depth look at some
                        additional features offered by <span class="EmphasisFontCategoryNonProportional">ApplicationContext</span>, including i18n, event publication, and resource access.</div>
                    <div class="Para" id="Par414">We also covered features such as using Java classes and the new Groovy syntax instead of XML configuration, profiles support, and the environment and property source abstraction layer. Finally, we discussed using JSR-330 standard annotations
                        in Spring.</div>
                    <div class="Para" id="Par415">The icing on the cake was how to use Spring Boot to configure beans and boot up your application as soon as possible and with little effort.</div>
                    <div class="Para" id="Par416">So far, we have covered the main concepts of the Spring Framework and its features as a DI container as well as other services that the core Spring Framework provides. In the next chapter and onward, we discuss using Spring in specific
                        areas such as AOP, data access, transaction support, and web application support.</div>
                </div>
                <div class="FootnoteSection">
                    <div class="Heading">Footnotes</div>
                    <div class="Footnote" id="Fn1"><span class="FootnoteNumber"><a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_4_Chapter.html#Fn1_source">1</a></span>
                        <div class="FootnoteParas">
                            <div class="Para" id="Par61">Check out this snippet from JEE official Javadoc: <span class="ExternalRef"><a href="http://docs.oracle.com/javaee/7/api/javax/annotation/PostConstruct.html"><span class="RefSource">                              <span class="EmphasisFontCategoryNonProportional">http://docs.oracle.com/javaee/7/api/javax/annotation/PostConstruct.html</span>                                </span>
                                </a>
                                </span>.</div>
                        </div>
                        <div class="ClearBoth"> </div>
                    </div>
                    <div class="Footnote" id="Fn2"><span class="FootnoteNumber"><a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_4_Chapter.html#Fn2_source">2</a></span>
                        <div class="FootnoteParas">
                            <div class="Para" id="Par235">The classes are not created again in the <span class="EmphasisFontCategoryNonProportional">com.apress.prospring5.ch4</span> package, but projects where they are defined are used as dependencies for the <span class="EmphasisFontCategoryNonProportional">java-config</span>                                project.</div>
                        </div>
                        <div class="ClearBoth"> </div>
                    </div>
                    <div class="Footnote" id="Fn3"><span class="FootnoteNumber"><a class="totri-footnote" href="https://learning.oreilly.com/library/view/pro-spring-5/9781484228081/A315511_5_En_4_Chapter.html#Fn3_source">3</a></span>
                        <div class="FootnoteParas">
                            <div class="Para" id="Par344">You can find dependency characteristics, like group IDs and latest versions, on the Maven public repository. For example, this is the dedicated page for <span class="EmphasisFontCategoryNonProportional">java.inject</span>:
                                <span class="ExternalRef"><a href="https://mvnrepository.com/artifact/javax.inject/javax.inject"><span class="RefSource">                    <span class="EmphasisFontCategoryNonProportional">https://mvnrepository.com/artifact/javax.inject/javax.inject</span>                                </span>
                                </a>
                                </span>.</div>
                        </div>
                        <div class="ClearBoth"> </div>
                    </div>
                </div>
                </div>
                </div>
                </div>
                </section>
                </div>
                </div>
</body>

</html>